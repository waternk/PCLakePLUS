_bPorS_ = (1.0 - _fDTotS0_) * (_fDOrgS0_ * _cRhoOM_ + (1 - _fDOrgS0_) * _cRhoIM_) / _cRhoWat_ / ( _fDTotS0_ + (1.0 - _fDTotS0_) * (_fDOrgS0_ * _cRhoOM_ + (1 - _fDOrgS0_) * _cRhoIM_) / _cRhoWat_ );
_bPorCorS_ = _POW_ (_bPorS_ , (_bPorS_ + 1.0));
_sTime_ = time;
_TimeYears_ = _sTime_ / _DaysPerYear_;
_Day_ = _sTime_ - _FLOOR_(_TimeYears_) * _DaysPerYear_;
_uTm_ = _IF_ (_ReadTemp_ _EQ_ _TRUE_ ) _THEN_ _mTemp_ _ELSE_ _cTmAve_ - _cTmVar_ * _COS_(2.0*_Pi_*(_sTime_ + _TenDays_ - _cTimeLag_) / _DaysPerYear_) _ENDIF_;
_uVWind_ = _IF_ (_ReadVWind_ _EQ_ _TRUE_)_THEN_ _mVWind_ _ELSE_ _cVWind_ _ENDIF_;
_ufDay_ = _cfDayAve_ - _cfDayVar_ * _COS_(2.0*_Pi_*(_sTime_+_TenDays_) / _DaysPerYear_);
_uLDay_ = _IF_ (_ReadLOut_ _EQ_ _TRUE_ ) _THEN_ 0.0 _ELSE_ _cLDayAve_ - _cLDayVar_ * _COS_(2.0*_Pi_*(_sTime_+_TenDays_) / _DaysPerYear_) _ENDIF_;
_uLOut_ = _IF_ (_ReadLOut_ _EQ_ _TRUE_ ) _THEN_ _mLOut_ / _ufDay_ _ELSE_ _uLDay_ / _SecsPerDay_ / _ufDay_ _ENDIF_;
_uLPAR0_ = _fPAR_ * (1.0 - _fRefl_) * _uLOut_;
_aExtPhyt_ = _cExtSpPhyt_ * _sDPhytW_;
_aExtDet_ = _cExtSpDet_ * _sDDetW_;
_aExtIM_ = _cExtSpIM_ * _sDIMW_;
_aExtCoefOpen_ = _cExtWat_ + _aExtIM_ + _aExtDet_ + _aExtPhyt_;
_uQInSeason_ = _IF_ (_FALSE_ _EQ_ _UseSeasonLoad_) _THEN_ 0.0 _ELSEIF_ (_Day_ _LT_ _cDayApril1_ - 0.5*_cLengChange_) _THEN_ _cQInWin_ _ELSEIF_ (_Day_ _LT_ _cDayApril1_ + 0.5*_cLengChange_) _THEN_ 0.5*(_cQInWin_ + _cQInSum_) + 0.5*(_cQInWin_ - _cQInSum_) * _COS_(_Pi_/_cLengChange_ * (_Day_ - _cDayApril1_)) _ELSEIF_ (_Day_ _LT_ _cDayOct1_ - 0.5*_cLengChange_) _THEN_ _cQInSum_ _ELSEIF_ (_Day_ _LT_ _cDayOct1_ + 0.5*_cLengChange_) _THEN_ 0.5*(_cQInWin_ + _cQInSum_) - 0.5*(_cQInWin_ - _cQInSum_) * _COS_(_Pi_/_cLengChange_ * (_Day_ - _cDayOct1_)) _ELSE_ _cQInWin_ _ENDIF_;
_uQEvSinus_ = _cQEvAve_ - _cQEvVar_ * _COS_(2.0*_Pi_ * (_sTime_ + _TenDays_ - _cTimeLag_) / _DaysPerYear_);
_uQEv_ = _IF_ (_ReadQEv_ _EQ_ _TRUE_ ) _THEN_ _mQEv_ _ELSE_ _uQEvSinus_ _ENDIF_;
_uQInExtra_ = _IF_ ((_Day_ _GE_ _cDayApril1_ - 0.5*_cLengChange_) _AND_ (_Day_ _LT_ _cDayApril1_ + 0.5*_cLengChange_)) _THEN_ _cQInExtraApril1_ _ELSEIF_ ( (_Day_ _GE_ _cDayOct1_ - 0.5*_cLengChange_) _AND_ (_Day_ _LT_ _cDayOct1_ + 0.5*_cLengChange_) ) _THEN_ _cQInExtraOct1_ _ELSE_ 0.0 _ENDIF_;
_uQOutExtra_ = _IF_ ((_Day_ _GE_ _cDayApril1_ - 0.5*_cLengChange_) _AND_ (_Day_ _LT_ _cDayApril1_ + 0.5*_cLengChange_)) _THEN_ _cQOutExtraApril1_ _ELSEIF_ ( (_Day_ _GE_ _cDayOct1_ - 0.5*_cLengChange_) _AND_ (_Day_ _LT_ _cDayOct1_ + 0.5*_cLengChange_) ) _THEN_ _cQOutExtraOct1_ _ELSE_ 0.0 _ENDIF_;
_uQIn_ = _IF_ (_ReadQIn_ _EQ_ _TRUE_ ) _THEN_ _mQIn_ _ELSEIF_ (_UseSeasonLoad_ _EQ_ _TRUE_ ) _THEN_ _uQInSeason_ + _uQInExtra_ _ELSE_ _cQIn_ + _uQInExtra_ _ENDIF_;
_uQOut_ = _IF_ (_ReadQOut_ _EQ_ _TRUE_ ) _THEN_ _MAX_(_mQOut_, (_sDepthW_ - _cDepthWMax_) * _mmPerm_) _ELSE_ _MAX_(0.0, (_uQIn_ - _uQInExtra_) - _uQEv_ - _cQInf_) + _uQOutExtra_ _ENDIF_;
_uQDil_ = _uQIn_ - _uQEv_;
_ukDil_ = _uQDil_ / _mmPerm_ / _sDepthW_;
_ukDilWat_ = _uQIn_ / _mmPerm_ / _sDepthW_;
_ukOut_ = _IF_ (_InclTran_ _EQ_ _TRUE_ ) _THEN_ _uQOut_ / _mmPerm_ / _sDepthW_ _ELSE_ 0.0 _ENDIF_;
_uTauWat_ = 1.0 / (_ukDilWat_+_NearZero_);
_uTauSubst_ = 1.0 / (_ukDil_+_NearZero_);
_vTranDepthW_ = _IF_ (_InclTran_ _EQ_ _TRUE_ ) _THEN_ (_uQIn_ - _uQEv_ - _cQInf_ - _uQOut_) / _mmPerm_ _ELSE_ 0.0 _ENDIF_;
_oDPhytW_ = _sDPhytW_;
_oPPhytW_ = _sPPhytW_;
_oNPhytW_ = _sNPhytW_;
_aDPhytS_ = _sDPhytS_;
_aPPhytS_ = _sPPhytS_;
_aNPhytS_ = _sNPhytS_;
_oDOMW_ = _sDDetW_ + _oDPhytW_;
_oDSestW_ = _oDOMW_ + _sDIMW_;
_oPOMW_ = _oPPhytW_ + _sPDetW_;
_oPSestW_ = _oPPhytW_ + _sPDetW_ + _sPAIMW_;
_oPInorgW_ = _sPO4W_ + _sPAIMW_;
_oPTotW_ = _oPSestW_ + _sPO4W_;
_oNDissW_ = _sNO3W_ + _sNH4W_;
_oNOMW_ = _oNPhytW_ + _sNDetW_;
_oNSestW_ = _oNOMW_;
_oNkjW_ = _oNSestW_ + _sNH4W_;
_oNTotW_ = _oNkjW_ + _sNO3W_;
_aDTotS_ = _sDIMS_ + _sDHumS_ + _sDDetS_;
_aRhoTotS_ = _aDTotS_ / _cDepthS_;
_aRhoSolidS_ = (_sDIMS_ * _cRhoIM_ + (_sDHumS_ + _sDDetS_) * _cRhoOM_) / _aDTotS_;
_afDTotS_ = 1.0 / (1.0 + _bPorS_/(1.0-_bPorS_) * _cRhoWat_ / _aRhoSolidS_);
_afDOrgS_ = (_sDHumS_ + _sDDetS_) / _aDTotS_;
_afDetS_ = _sDDetS_ / (_sDHumS_ + _sDDetS_);
_afDetTotS_ = _sDDetS_ / (_sDIMS_ + _sDHumS_ + _sDDetS_);
_aPInorgS_ = _sPO4S_ + _sPAIMS_;
_aPTotAvailS_ = _sPDetS_ + _aPInorgS_ + _aPPhytS_;
_aPTotS_ = _aPTotAvailS_ + _sPHumS_;
_afPInorgS_ = _aPInorgS_ / _aDTotS_;
_afPTotS_ = _aPTotS_ / _aDTotS_;
_afPO4S_ = _sPO4S_ / (_aPTotAvailS_ + _NearZero_);
_oPO4S_ = _sPO4S_ / _cDepthS_ / _bPorS_;
_aNDissS_ = _sNH4S_ + _sNO3S_;
_aNkjAvailS_ = _sNDetS_ + _aNPhytS_ + _sNH4S_;
_aNkjS_ = _aNkjAvailS_ + _sNHumS_;
_aNTotAvailS_ = _aNkjAvailS_ + _sNO3S_;
_aNTotS_ = _aNkjS_ + _sNO3S_;
_afNInorgS_ = _aNDissS_ / _aDTotS_;
_afNTotS_ = _aNTotS_ / _aDTotS_;
_oNO3S_ = _sNO3S_ / _cDepthS_ / _bPorS_;
_oNH4S_ = _sNH4S_ / _cDepthS_ / _bPorS_;
_oNDissS_ = _aNDissS_ / _cDepthS_ / _bPorS_;
_rPDIMW_ = _sPAIMW_ / _sDIMW_;
_rPDIMS_ = _sPAIMS_ / _sDIMS_;
_rPDDetW_ = _sPDetW_ / (_sDDetW_+_NearZero_);
_rNDDetW_ = _sNDetW_ / (_sDDetW_+_NearZero_);
_rPDHumS_ = _sPHumS_ / (_sDHumS_+_NearZero_);
_rNDHumS_ = _sNHumS_ / (_sDHumS_+_NearZero_);
_rPDDetS_ = _sPDetS_ / (_sDDetS_+_NearZero_);
_rNDDetS_ = _sNDetS_ / (_sDDetS_+_NearZero_);
_uPLoadSeason_ = _IF_ (_FALSE_ _EQ_ _UseSeasonLoad_) _THEN_ 0.0 _ELSEIF_ (_Day_ _LT_ _cDayApril1_ - 0.5*_cLengChange_) _THEN_ _cPLoadWin_ _ELSEIF_ (_Day_ _LT_ _cDayApril1_ + 0.5*_cLengChange_) _THEN_ 0.5*(_cPLoadWin_ + _cPLoadSum_) + 0.5*(_cPLoadWin_ - _cPLoadSum_) * _COS_(_Pi_/_cLengChange_ * (_Day_ - _cDayApril1_)) _ELSEIF_ (_Day_ _LT_ _cDayOct1_ - 0.5*_cLengChange_) _THEN_ _cPLoadSum_ _ELSEIF_ (_Day_ _LT_ _cDayOct1_ + 0.5*_cLengChange_) _THEN_ 0.5*(_cPLoadWin_ + _cPLoadSum_) - 0.5*(_cPLoadWin_ - _cPLoadSum_) * _COS_(_Pi_/_cLengChange_ * (_Day_ - _cDayOct1_)) _ELSE_ _cPLoadWin_ _ENDIF_;
_uPLoad_ = _IF_ (_ReadPLoad_ _EQ_ _TRUE_ _AND_ _ReadNutFrac_ _EQ_ _TRUE_ ) _THEN_ _mPLoadPO4_ + _mPLoadOrg_ _ELSEIF_ (_ReadPLoad_ _EQ_ _TRUE_ _AND_ _FALSE_ _EQ_ _ReadNutFrac_) _THEN_ _mPLoad_ _ELSEIF_ (_UsePulseLoad_ _EQ_ _TRUE_ ) _THEN_ 0.0 _ELSEIF_ (_UseSeasonLoad_ _EQ_ _TRUE_ ) _THEN_ _uPLoadSeason_ _ELSE_ _cPLoad_ _ENDIF_;
_uPLoadPO4_ = _IF_ (_FALSE_ _EQ_ _ReadPLoad_) _THEN_ _fPO4In_ * _uPLoad_ _ELSEIF_ (_ReadNutFrac_ _EQ_ _TRUE_ ) _THEN_ _mPLoadPO4_ _ELSE_ _fPO4In_ * _mPLoad_ _ENDIF_;
_uPLoadOrg_ = _IF_ (_FALSE_ _EQ_ _ReadPLoad_) _THEN_ (1.0 - _fPO4In_) * _uPLoad_ _ELSEIF_ (_ReadNutFrac_ _EQ_ _TRUE_ ) _THEN_ _mPLoadOrg_ _ELSE_ (1.0 - _fPO4In_) * _mPLoad_ _ENDIF_;
_uPLoadPhytTot_ = _IF_ (_ReadPLoadPhyt_ _EQ_ _TRUE_ ) _THEN_ _mPLoadPhytTot_ _ELSE_ ((_fPhytInSum_+_fPhytInWin_)/2.0 - (_fPhytInSum_-_fPhytInWin_)/2.0 * _COS_(2.0*_Pi_ * (_sTime_ + _TenDays_ - _cTimeLag_) / _DaysPerYear_)) * _uPLoadOrg_ _ENDIF_;
_uPLoadDet_ = _uPLoadOrg_ - _uPLoadPhytTot_;
_uPLoadAIM_ = 0.0;
_uNLoadSeason_ = _IF_ (_FALSE_ _EQ_ _UseSeasonLoad_) _THEN_ 0.0 _ELSEIF_ (_Day_ _LT_ _cDayApril1_ - 0.5*_cLengChange_) _THEN_ _cNLoadWin_ _ELSEIF_ (_Day_ _LT_ _cDayApril1_ + 0.5*_cLengChange_) _THEN_ 0.5*(_cNLoadWin_ + _cNLoadSum_) + 0.5*(_cNLoadWin_ - _cNLoadSum_) * _COS_(_Pi_/_cLengChange_ * (_Day_ - _cDayApril1_)) _ELSEIF_ (_Day_ _LT_ _cDayOct1_ - 0.5*_cLengChange_) _THEN_ _cNLoadSum_ _ELSEIF_ (_Day_ _LT_ _cDayOct1_ + 0.5*_cLengChange_) _THEN_ 0.5*(_cNLoadWin_ + _cNLoadSum_) - 0.5*(_cNLoadWin_ - _cNLoadSum_) * _COS_(_Pi_/_cLengChange_ * (_Day_ - _cDayOct1_)) _ELSE_ _cNLoadWin_ _ENDIF_;
_uNLoadPhytTot_ = _cNPPhytIn_ * _uPLoadPhytTot_;
_uNLoad_ = _IF_ (_ReadNLoad_ _EQ_ _TRUE_ _AND_ _ReadNutFrac_ _EQ_ _TRUE_ ) _THEN_ _mNLoadNH4_ + _mNLoadNO3_ + _mNLoadOrg_ _ELSEIF_ (_ReadNLoad_ _EQ_ _TRUE_ _AND_ _FALSE_ _EQ_ _ReadNutFrac_) _THEN_ _mNLoad_ _ELSEIF_ (_UsePulseLoad_ _EQ_ _TRUE_ ) _THEN_ 0.0 _ELSEIF_ (_ReadPLoad_ _EQ_ _TRUE_ ) _THEN_ _cNPLoadMeas_ * _uPLoad_ _ELSEIF_ (_UseSeasonLoad_ _EQ_ _TRUE_ ) _THEN_ _uNLoadSeason_ _ELSE_ _cNLoad_ _ENDIF_;
_uNLoadDet_ = _IF_ (_FALSE_ _EQ_ _ReadNLoad_) _THEN_ _MIN_(_cNPDetIn_ * _uPLoadDet_, _uNLoad_ - _uNLoadPhytTot_) _ELSEIF_ (_ReadNutFrac_ _EQ_ _TRUE_ ) _THEN_ 0.0 _ELSE_ _MIN_(_cNPDetIn_ * _uPLoadDet_, _uNLoad_ - _uNLoadPhytTot_) _ENDIF_;
_uNLoadOrg_ = _IF_ (_FALSE_ _EQ_ _ReadNLoad_) _THEN_ _uNLoadPhytTot_ + _uNLoadDet_ _ELSEIF_ (_ReadNutFrac_ _EQ_ _TRUE_ ) _THEN_ _mNLoadOrg_ _ELSE_ _uNLoadPhytTot_ + _uNLoadDet_ _ENDIF_;
_uNLoadDiss_ = _IF_ (_FALSE_ _EQ_ _ReadNLoad_) _THEN_ _uNLoad_ - _uNLoadOrg_ _ELSEIF_ (_ReadNutFrac_ _EQ_ _TRUE_ ) _THEN_ 0.0 _ELSE_ _uNLoad_ - _uNLoadOrg_ _ENDIF_;
_uNLoadNH4_ = _IF_ (_FALSE_ _EQ_ _ReadNLoad_) _THEN_ _fNH4DissIn_ * _uNLoadDiss_ _ELSEIF_ (_ReadNutFrac_ _EQ_ _TRUE_ ) _THEN_ _mNLoadNH4_ _ELSE_ _fNH4DissIn_ * _uNLoadDiss_ _ENDIF_;
_uNLoadNO3_ = _IF_ (_FALSE_ _EQ_ _ReadNLoad_) _THEN_ (1.0 - _fNH4DissIn_) * _uNLoadDiss_ _ELSEIF_ (_ReadNutFrac_ _EQ_ _TRUE_ ) _THEN_ _mNLoadNO3_ _ELSE_ (1.0 - _fNH4DissIn_) * _uNLoadDiss_ _ENDIF_;
_uNTotIn_ = _uNLoad_ / (_uQIn_ / _mmPerm_ + _NearZero_);
_uDLoadDet_ = _IF_ (_ReadDLoadDet_ _EQ_ _TRUE_ ) _THEN_ _mDLoadDet_ _ELSE_ _uNLoadDet_ / _cNDDetIn_ _ENDIF_;
_uDLoadPhytTot_ = _uNLoadPhytTot_ / _cNDPhytIn_;
_uDLoadIM_ = _IF_ (_ReadDLoadIM_ _EQ_ _TRUE_ ) _THEN_ _mDLoadIM_ _ELSE_ _cDIMIn_ * _uQIn_ / _mmPerm_ _ENDIF_;
_uDLoad_ = _uDLoadIM_ + _uDLoadDet_ + _uDLoadPhytTot_;
_uPTotIn_ = _uPLoad_ / (_uQIn_ / _mmPerm_ + _NearZero_);
_wDDilIM_ = _ukDil_ * _sDIMW_;
_wDDilDet_ = _ukDil_ * _sDDetW_;
_wPDilPO4_ = _ukDil_ * _sPO4W_;
_wPDilDet_ = _ukDil_*_sPDetW_;
_wPDilAIM_ = _ukDil_ * _sPAIMW_;
_wNDilNH4_ = _ukDil_ * _sNH4W_;
_wNDilNO3_ = _ukDil_ * _sNO3W_;
_wNDilDet_ = _ukDil_ * _sNDetW_;
_wO2Inflow_ = _ukDilWat_ * _cO2In_;
_wO2Outfl_ = _ukDil_ * _sO2W_;
_wDDilPhyt_ = _ukDil_ * _sDPhytW_;
_wPDilPhyt_ = _ukDil_ * _sPPhytW_;
_wNDilPhyt_ = _ukDil_ * _sNPhytW_;
_wDOutflTot_ = _ukOut_ * _oDSestW_;
_wPOutflTot_ = _ukOut_ * _oPTotW_;
_wNOutflTot_ = _ukOut_ * _oNTotW_;
_uDLoadPhyt_ = _uDLoadPhytTot_;
_uPLoadPhyt_ = _uPLoadPhytTot_;
_uNLoadPhyt_ = _uNLoadPhytTot_;
_wDTranPhyt_ = _IF_ (_InclTran_ _EQ_ _TRUE_ ) _THEN_ _uDLoadPhyt_ / _sDepthW_ - _wDDilPhyt_ _ELSE_ 0.0 _ENDIF_;
_wPTranPhyt_ = _IF_ (_InclTran_ _EQ_ _TRUE_ ) _THEN_ _uPLoadPhyt_ / _sDepthW_ - _wPDilPhyt_ _ELSE_ 0.0 _ENDIF_;
_wNTranPhyt_ = _IF_ (_InclTran_ _EQ_ _TRUE_ ) _THEN_ _uNLoadPhyt_ / _sDepthW_ - _wNDilPhyt_ _ELSE_ 0.0 _ENDIF_;
_wDTranIMW_ = _IF_ (_InclTran_ _EQ_ _TRUE_ ) _THEN_ _uDLoadIM_ / _sDepthW_ - _wDDilIM_ _ELSE_ 0.0 _ENDIF_;
_wDTranDetW_ = _IF_ (_InclTran_ _EQ_ _TRUE_ ) _THEN_ _uDLoadDet_ / _sDepthW_ - _wDDilDet_ _ELSE_ 0.0 _ENDIF_;
_wO2TranW_ = _IF_ (_InclTran_ _EQ_ _TRUE_ ) _THEN_ _wO2Inflow_ - _wO2Outfl_ _ELSE_ 0.0 _ENDIF_;
_wPTranPO4W_ = _IF_ (_InclTran_ _EQ_ _TRUE_ ) _THEN_ _uPLoadPO4_ / _sDepthW_ - _wPDilPO4_ _ELSE_ 0.0 _ENDIF_;
_wPTranAIMW_ = _IF_ (_InclTran_ _EQ_ _TRUE_ ) _THEN_ _uPLoadAIM_ / _sDepthW_ - _wPDilAIM_ _ELSE_ 0.0 _ENDIF_;
_wPTranDetW_ = _IF_ (_InclTran_ _EQ_ _TRUE_ ) _THEN_ _uPLoadDet_ / _sDepthW_ - _wPDilDet_ _ELSE_ 0.0 _ENDIF_;
_wNTranNH4W_ = _IF_ (_InclTran_ _EQ_ _TRUE_ ) _THEN_ _uNLoadNH4_ / _sDepthW_ - _wNDilNH4_ _ELSE_ 0.0 _ENDIF_;
_wNTranNO3W_ = _IF_ (_InclTran_ _EQ_ _TRUE_ ) _THEN_ _uNLoadNO3_ / _sDepthW_ - _wNDilNO3_ _ELSE_ 0.0 _ENDIF_;
_wNTranDetW_ = _IF_ (_InclTran_ _EQ_ _TRUE_ ) _THEN_ _uNLoadDet_ / _sDepthW_ - _wNDilDet_ _ELSE_ 0.0 _ENDIF_;
_wDDilTot_ = _wDDilIM_ + _wDDilDet_ + _wDDilPhyt_;
_wPDilTot_ = _wPDilDet_ + _wPDilPO4_ + _wPDilAIM_ + _wPDilPhyt_;
_wNDilTot_ = _wNDilDet_ + _wNDilNO3_ + _wNDilNH4_ + _wNDilPhyt_;
_tPInfPO4W_ = _IF_ (_FALSE_ _EQ_ _InclTran_) _THEN_ 0.0 _ELSEIF_ (_cQInf_ _GE_ 0.0) _THEN_ _cQInf_ / _mmPerm_ * _sPO4W_ _ELSE_ _cQInf_ / _mmPerm_ * _oPO4S_ _ENDIF_;
_tNInfNH4W_ = _IF_ (_FALSE_ _EQ_ _InclTran_) _THEN_ 0.0 _ELSEIF_ (_cQInf_ _GE_ 0.0) _THEN_ _cQInf_ / _mmPerm_ * _sNH4W_ _ELSE_ _cQInf_ / _mmPerm_ * _oNH4S_ _ENDIF_;
_tNInfNO3W_ = _IF_ (_FALSE_ _EQ_ _InclTran_) _THEN_ 0.0 _ELSEIF_ (_cQInf_ _GE_ 0.0) _THEN_ _cQInf_ / _mmPerm_ * _sNO3W_ _ELSE_ _cQInf_ / _mmPerm_ * _oNO3S_ _ENDIF_;
_tPInfPO4S_ = _IF_ (_FALSE_ _EQ_ _InclTran_) _THEN_ 0.0 _ELSEIF_ (_cQInf_ _GE_ 0.0) _THEN_ _cQInf_ / _mmPerm_ * _oPO4S_ _ELSE_ _cQInf_ / _mmPerm_ * _cPO4Ground_ _ENDIF_;
_tNInfNH4S_ = _IF_ (_FALSE_ _EQ_ _InclTran_) _THEN_ 0.0 _ELSEIF_ (_cQInf_ _GE_ 0.0) _THEN_ _cQInf_ / _mmPerm_ * _oNH4S_ _ELSE_ _cQInf_ / _mmPerm_ * _cNH4Ground_ _ENDIF_;
_tNInfNO3S_ = _IF_ (_FALSE_ _EQ_ _InclTran_) _THEN_ 0.0 _ELSEIF_ (_cQInf_ _GE_ 0.0) _THEN_ _cQInf_ / _mmPerm_ * _oNO3S_ _ELSE_ _cQInf_ / _mmPerm_ * _cNO3Ground_ _ENDIF_;
_tNH4LoadS_ = _fNH4LoadS_ * _cNLoadS_;
_tNO3LoadS_ = _cNLoadS_ - _tNH4LoadS_;
_uDErosIM_ = (1.0 - _fDOrgSoil_) * _cDErosTot_;
_uDErosIMS_ = _fSedErosIM_ * _uDErosIM_;
_uDErosIMW_ = _uDErosIM_ - _uDErosIMS_;
_uDErosOM_ = _fDOrgSoil_ * _cDErosTot_;
_uPErosOM_ = _cPDSoilOM_ * _uDErosOM_;
_uNErosOM_ = _cNDSoilOM_ * _uDErosOM_;
_uO2Sat_ = 14.652 - 0.41022 * _uTm_ + 0.007991 * _uTm_*_uTm_ - 0.000077774 * _uTm_*_uTm_*_uTm_;
_kAer_ = _cAerRoot_ * _POW_(_uVWind_ , (0.5)) + _cAerLin_ * _uVWind_ + _cAerSquare_ * _uVWind_*_uVWind_;
_uFunTmAer_ = _POW_ (_cThetaAer_ , (_uTm_-_cTmRef_));
_aFunLemnAer_ = _MAX_(0.0, 1.0 - (_kLemnAer_ * _sDLemn_));
_tO2Aer_ = _kAer_ * _uFunTmAer_ * (_uO2Sat_ - _sO2W_) * _aFunLemnAer_;
_tDTurbFish_ = 0.0;
_tDTurbFishIM_ = _fLutum_ * _sDIMS_ / (_fLutum_ * _sDIMS_ + _sDDetS_) * _tDTurbFish_;
_aDVeg_ = _sDElod_ + _sDChar_ + _sDCera_ + _sDLemn_ + _sDNymp_ + _sDHelo_;
_aFunVegResus_ = _MAX_(1.0 - _kVegResus_ * _aDVeg_, 0.0);
_aFunDimSusp_ = _IF_ (_uTm_ _GE_ 0.1) _THEN_ _cSuspRef_ * ((_cSuspMin_ + _cSuspMax_ / (1.0 + _EXP_(_cSuspSlope_ * (_sDepthW_ - _hDepthSusp_)))) * _POW_(((_cFetch_ +_NearZero_)/ _cFetchRef_),(0.5))) _ELSE_ 0.0 _ENDIF_;
_tDResusTauDead_ = _MIN_(_aFunDimSusp_, _POW_((_aFunDimSusp_ +_NearZero_),(0.5))) * _POW_((_fLutum_ / _fLutumRef_),(0.5)) * _bPorS_;
_tDResusBareDead_ = _tDResusTauDead_ + _tDTurbFish_;
_tDResusDead_ = _tDResusBareDead_ * _aFunVegResus_;
_tDResusIM_ = _fLutum_ * _sDIMS_ / (_fLutum_ * _sDIMS_ + _sDDetS_) * _tDResusDead_;
_tDResusDet_ = _sDDetS_ / (_fLutum_ * _sDIMS_ + _sDDetS_) * _tDResusDead_;
_akResusPhytRef_ = _kResusPhytMax_ * (1.0 - _EXP_(_cResusPhytExp_ * _tDResusDead_));
_tDResusPhytTot_ = _akResusPhytRef_ * _aDPhytS_;
_tPResusDet_ = _rPDDetS_ * _tDResusDet_;
_tPResusPO4_ = _sPO4S_ / _sDDetS_ * _tDResusDet_;
_tPResusAIM_ = _sPAIMS_ / _sDIMS_ * _tDResusIM_;
_tNResusNO3_ = _sNO3S_ / _sDDetS_ * _tDResusDet_;
_tNResusNH4_ = _sNH4S_ / _sDDetS_ * _tDResusDet_;
_tNResusDet_ = _rNDDetS_ * _tDResusDet_;
_aFunTauSetOM_ = _MIN_(1.0 / _POW_((_aFunDimSusp_ +_NearZero_),(0.5)), 1.0);
_aFunTauSetIM_ = _aFunTauSetOM_;
_uFunTmSet_ = _POW_ (_cThetaSet_ , (_uTm_-_cTmRef_));
_uCorVSetIM_ = _aFunTauSetIM_ * _POW_((_fLutumRef_/_fLutum_),(0.5)) * _uFunTmSet_ * _cVSetIM_;
_tDSetIM_ = _uCorVSetIM_ * _sDIMW_;
_tPSetAIM_ = _sPAIMW_ / _sDIMW_ * _tDSetIM_;
_uCorVSetDet_ = _cVSetDet_ * _aFunTauSetOM_ * _uFunTmSet_;
_tDSetDet_ = _uCorVSetDet_ * _sDDetW_;
_tPSetDet_ = _uCorVSetDet_ * _sPDetW_;
_tNSetDet_ = _uCorVSetDet_ * _sNDetW_;
_kPMinDetW_ = _kDMinDetW_;
_kNMinDetW_ = _kDMinDetW_;
_uFunTmMinW_ = _POW_ (_cThetaMinW_ , (_uTm_-_cTmRef_));
_wDMinDetW_ = _kDMinDetW_ * _uFunTmMinW_ * _sDDetW_;
_wPMinDetW_ = _kPMinDetW_ * _uFunTmMinW_ * _sPDetW_;
_wNMinDetW_ = _kNMinDetW_ * _uFunTmMinW_ * _sNDetW_;
_aCorO2BOD_ = _sO2W_ / (_hO2BOD_ + _sO2W_);
_wO2MinDetW_ = _molO2molC_ * _cCPerDW_ * _aCorO2BOD_ * _wDMinDetW_;
_wDDenitW_ = _sNO3W_*_sNO3W_ / (_hNO3Denit_*_hNO3Denit_ + _sNO3W_*_sNO3W_) * (1.0 - _aCorO2BOD_) * _wDMinDetW_;
_wNDenitW_ = _NO3PerC_ * _molNmolC_ * _cCPerDW_ * _wDDenitW_;
_uFunTmNitr_ = _POW_ (_cThetaNitr_ , (_uTm_-_cTmRef_));
_aCorO2NitrW_ = _sO2W_*_sO2W_ / (_hO2Nitr_*_hO2Nitr_ + _sO2W_*_sO2W_);
_wNNitrW_ = _kNitrW_ * _uFunTmNitr_ * _aCorO2NitrW_ * _sNH4W_;
_wO2NitrW_ = _O2PerNH4_ * _molO2molN_ * _wNNitrW_;
_kPMinDetS_ = _kDMinDetS_;
_kNMinDetS_ = _kDMinDetS_;
_uFunTmMinS_ = _POW_ (_cThetaMinS_ , (_uTm_-_cTmRef_));
_tDMinDetS_ = _kDMinDetS_ * _uFunTmMinS_ * _sDDetS_;
_tPMinDetS_ = _kPMinDetS_ * _uFunTmMinS_ * _sPDetS_;
_tNMinDetS_ = _kNMinDetS_ * _uFunTmMinS_ * _sNDetS_;
_uFunTmDif_ = _POW_ (_cThetaDif_ , (_uTm_-_cTmRef_));
_akO2DifCor_ = _kO2Dif_ * _uFunTmDif_ * _cTurbDifO2_ * _bPorCorS_;
_tSOD_ = (_molO2molC_ * _cCPerDW_ * (1.0 - _fRefrDetS_) * _tDMinDetS_ + _O2PerNH4_ * _molO2molN_ * _kNitrS_ * _uFunTmNitr_ * _sNH4S_) / _cDepthS_;
_aDepthOxySed_ = _POW_((2.0 * _sO2W_ * _akO2DifCor_ / _tSOD_),(0.5));
_afOxySed_ = _aDepthOxySed_ / _cDepthS_;
_tDMinOxyDetS_ = _afOxySed_ * (1.0 - _fRefrDetS_) * _tDMinDetS_;
_tO2MinDetS_ = _molO2molC_ * _cCPerDW_ * _tDMinOxyDetS_;
_tDDenitS_ = _oNO3S_*_oNO3S_ / (_hNO3Denit_*_hNO3Denit_ + _oNO3S_*_oNO3S_) * (1.0 - _afOxySed_) * (1.0 - _fRefrDetS_) * _tDMinDetS_;
_tNDenitS_ = _NO3PerC_ * _molNmolC_ * _cCPerDW_ * _tDDenitS_;
_tNNitrS_ = _afOxySed_ * _kNitrS_ * _uFunTmNitr_ * _sNH4S_;
_tO2NitrS_ = _O2PerNH4_ * _molO2molN_ * _tNNitrS_;
_tDMinHumS_ = _kDMinHum_ * _uFunTmMinS_ * _afOxySed_ * _sDHumS_;
_tPMinHumS_ = _kDMinHum_ * _uFunTmMinS_ * _afOxySed_ * _sPHumS_;
_tNMinHumS_ = _kDMinHum_ * _uFunTmMinS_ * _afOxySed_ * _sNHumS_;
_aDepthDif_ = _fDepthDifS_ * _cDepthS_;
_tPDifPO4_ = _kPDifPO4_ * _uFunTmDif_ * _cTurbDifNut_ * _bPorCorS_ * (_oPO4S_ - _sPO4W_ ) / _aDepthDif_;
_tNDifNO3_ = _kNDifNO3_ * _uFunTmDif_ * _cTurbDifNut_ * _bPorCorS_ * (_oNO3S_ - _sNO3W_ ) / _aDepthDif_;
_tNDifNH4_ = _kNDifNH4_ * _uFunTmDif_ * _cTurbDifNut_ * _bPorCorS_ * (_oNH4S_ - _sNH4W_ ) / _aDepthDif_;
_tO2Dif_ = _kO2Dif_ / _aDepthDif_ * _uFunTmDif_ * _cTurbDifO2_ * _bPorCorS_ * _sO2W_;
_tPDifGroundPO4_ = 0.0;
_tNDifGroundNO3_ = 0.0;
_tNDifGroundNH4_ = 0.0;
_aPAdsMaxW_ = _cRelPAdsD_ + _aCorO2BOD_ * _cRelPAdsFe_ * _fFeDIM_ + _cRelPAdsAl_ * _fAlDIM_;
_aKPAdsW_ = (1.0 - _fRedMax_ * (1.0-_aCorO2BOD_)) * _cKPAdsOx_;
_aPIsoAdsW_ = _aPAdsMaxW_ * _aKPAdsW_ * _sPO4W_ / (1.0 + _aKPAdsW_ * _sPO4W_);
_aPEqIMW_ = _aPIsoAdsW_ * _sDIMW_;
_wPSorpIMW_ = _kPSorp_ * (_aPEqIMW_ - _sPAIMW_);
_aPAdsMaxS_ = _cRelPAdsD_ + _afOxySed_ * _cRelPAdsFe_ * _fFeDIM_ + _cRelPAdsAl_ * _fAlDIM_;
_aKPAdsS_ = (1.0 - _fRedMax_ * (1.0-_afOxySed_)) * _cKPAdsOx_;
_aPIsoAdsS_ = _aPAdsMaxS_ * _aKPAdsS_ * _oPO4S_ / (1.0 + _aKPAdsS_ * _oPO4S_);
_aPEqIMS_ = _aPIsoAdsS_ * _sDIMS_;
_tPSorpIMS_ = _kPSorp_ * (_aPEqIMS_ - _sPAIMS_);
_tPChemPO4_ = _MAX_( 0.0, _kPChemPO4_ * (_oPO4S_ - _coPO4Max_) );
_wDAbioIMW_ = (_uDErosIMW_ - _tDSetIM_ + _tDResusIM_) / _sDepthW_;
_wDAbioDetW_ = (- _tDSetDet_ + _tDResusDet_ ) / _sDepthW_ - _wDMinDetW_;
_tDAbioIMS_ = _uDErosIMS_ + _tDSetIM_ - _tDResusIM_;
_tDAbioDetS_ = _tDSetDet_ - _tDResusDet_ - _tDMinDetS_;
_tDAbioHumS_ = _uDErosOM_ + _fRefrDetS_ * _tDMinDetS_ - _tDMinHumS_;
_tDAbioTotT_ = _cDErosTot_ - _wDMinDetW_ * _sDepthW_ - (1.0 - _fRefrDetS_) * _tDMinDetS_ - _tDMinHumS_;
_wO2AbioW_ = _tO2Aer_ / _sDepthW_ - _wO2MinDetW_ - _wO2NitrW_ - (_tO2MinDetS_ + _tO2NitrS_) / _sDepthW_;
_wPAbioDetW_ = - _wPMinDetW_ - (_tPSetDet_ - _tPResusDet_) / _sDepthW_;
_wPAbioPO4W_ = _wPMinDetW_ - _wPSorpIMW_ - _tPInfPO4W_ / _sDepthW_ + _tPDifPO4_ / _sDepthW_ + _tPResusPO4_ / _sDepthW_;
_wPAbioAIMW_ = (- _tPSetAIM_ + _tPResusAIM_) / _sDepthW_ + _wPSorpIMW_;
_tPAbioDetS_ = - _tPMinDetS_ + _tPSetDet_ - _tPResusDet_;
_tPAbioHumS_ = _uPErosOM_ + _fRefrDetS_ * _tPMinDetS_ - _tPMinHumS_;
_tPAbioPO4S_ = _tPInfPO4W_ - _tPInfPO4S_ + (1.0-_fRefrDetS_) * _tPMinDetS_ + _tPMinHumS_ - _tPSorpIMS_ - _tPResusPO4_ - _tPDifPO4_ - _tPDifGroundPO4_ - _tPChemPO4_;
_tPAbioAIMS_ = _tPSetAIM_ - _tPResusAIM_ + _tPSorpIMS_;
_tPAbioTotT_ = _uPErosOM_ - _tPChemPO4_ - _tPInfPO4S_ - _tPDifGroundPO4_;
_wNAbioNH4W_ = _wNMinDetW_ - _wNNitrW_ - _tNInfNH4W_ / _sDepthW_ + (_tNDifNH4_ + _tNResusNH4_) / _sDepthW_;
_wNAbioNO3W_ = _wNNitrW_ - _wNDenitW_ + (_tNDifNO3_ + _tNResusNO3_ - _tNInfNO3W_) / _sDepthW_;
_wNAbioDetW_ = - _wNMinDetW_ - (_tNSetDet_ - _tNResusDet_ ) / _sDepthW_;
_tNAbioNH4S_ = _tNInfNH4W_ - _tNInfNH4S_ + (1.0-_fRefrDetS_) * _tNMinDetS_ + _tNMinHumS_ - _tNResusNH4_ - _tNDifNH4_ - _tNDifGroundNH4_ - _tNNitrS_;
_tNAbioNO3S_ = _tNInfNO3W_ - _tNInfNO3S_ + _tNNitrS_ - _tNDenitS_ - _tNResusNO3_ - _tNDifNO3_ - _tNDifGroundNO3_;
_tNAbioDetS_ = - _tNMinDetS_ + _tNSetDet_ - _tNResusDet_;
_tNAbioHumS_ = _uNErosOM_ + _fRefrDetS_ * _tNMinDetS_ - _tNMinHumS_;
_tNAbioTotT_ = _uNErosOM_ - _tNDenitS_ - _wNDenitW_ * _sDepthW_ - _tNInfNH4S_ - _tNInfNO3S_ - _tNDifGroundNO3_ - _tNDifGroundNH4_;
_fManElod_ = _fManVeg_;
_fManCera_ = _fManVeg_;
_fManChar_ = _fManVeg_;
_fManNymp_ = _fManHelo_;
_kMigrLemn_ = _ckMigrLemn_ + (1.0 - _fObstrLemn_) * _ukOut_;
_aDayInitElod_ = _IF_ (_Day_ _LT_ 1.0 _OR_ _sTime_ _LT_ _BeginTime_ + 1.0) _THEN_ 367 _ELSEIF_ (_uTm_ _GE_ _cTmInitElod_ _AND_ _aDayInitElod_ _GT_ 366) _THEN_ _Day_ _ELSE_ _aDayInitElod_ _ENDIF_;
_bfRootElod_ = _IF_ (_Day_ _LT_ _aDayInitElod_) _THEN_ _fRootElodWin_ _ELSEIF_ (_Day_ _LT_ _aDayInitElod_ + _cLengAllo_) _THEN_ 0.5*(_fRootElodWin_ + _fRootElodSum_) + 0.5*(_fRootElodWin_ - _fRootElodSum_) * _COS_(_Pi_/_cLengAllo_ * (_Day_ - _aDayInitElod_)) _ELSEIF_ (_Day_ _LT_ _cDayWinElod_) _THEN_ _fRootElodSum_ _ELSEIF_ (_Day_ _LT_ _cDayWinElod_ + _cLengAllo_) _THEN_ 0.5*(_fRootElodWin_ + _fRootElodSum_) - 0.5*(_fRootElodWin_ - _fRootElodSum_) * _COS_(_Pi_/_cLengAllo_ * (_Day_ - _cDayWinElod_)) _ELSE_ _fRootElodWin_ _ENDIF_;
_bfShootElod_ = 1.0 - _bfRootElod_;
_aDRootElod_ = _bfRootElod_ * _sDElod_;
_aDShootElod_ = _bfShootElod_ * _sDElod_;
_aDEmergElod_ = _fEmergElod_ * _aDShootElod_;
_aDFloatElod_ = _fFloatElod_ * _aDShootElod_;
_bfSubElod_ = 1.0 - _fFloatElod_ - _fEmergElod_;
_aDSubElod_ = _bfSubElod_ * _aDShootElod_;
_aExtElod_ = _cExtSpElod_ * _aDSubElod_ / _sDepthW_;
_aDepth1Elod_ = _fDepth1Elod_ * _sDepthW_;
_aDepth2Elod_ = _fDepth2Elod_ * _sDepthW_;
_afCovSurfElod_ = _MIN_(1.0, _MAX_(_aDFloatElod_ / (_cDLayerElod_ + _NearZero_), _aDEmergElod_ / (_fEmergElod_ * _cDCarrElod_ + _NearZero_) ) );
_afCovEmergElod_ = _MIN_(1.0, _PerCent_ * _cCovSpElod_ * _aDEmergElod_);
_aCovElod_ = _MIN_(100.0, _cCovSpElod_ * _aDShootElod_);
_aDayInitChar_ = _IF_ (_Day_ _LT_ 1.0 _OR_ _sTime_ _LT_ _BeginTime_ + 1.0) _THEN_ 367 _ELSEIF_ (_uTm_ _GE_ _cTmInitChar_ _AND_ _aDayInitChar_ _GT_ 366) _THEN_ _Day_ _ELSE_ _aDayInitChar_ _ENDIF_;
_bfRootChar_ = _IF_ (_Day_ _LT_ _aDayInitChar_) _THEN_ _fRootCharWin_ _ELSEIF_ (_Day_ _LT_ _aDayInitChar_ + _cLengAllo_) _THEN_ 0.5*(_fRootCharWin_ + _fRootCharSum_) + 0.5*(_fRootCharWin_ - _fRootCharSum_) * _COS_(_Pi_/_cLengAllo_ * (_Day_ - _aDayInitChar_)) _ELSEIF_ (_Day_ _LT_ _cDayWinChar_) _THEN_ _fRootCharSum_ _ELSEIF_ (_Day_ _LT_ _cDayWinChar_ + _cLengAllo_) _THEN_ 0.5*(_fRootCharWin_ + _fRootCharSum_) - 0.5*(_fRootCharWin_ - _fRootCharSum_) * _COS_(_Pi_/_cLengAllo_ * (_Day_ - _cDayWinChar_)) _ELSE_ _fRootCharWin_ _ENDIF_;
_bfShootChar_ = 1.0 - _bfRootChar_;
_aDRootChar_ = _bfRootChar_ * _sDChar_;
_aDShootChar_ = _bfShootChar_ * _sDChar_;
_aDEmergChar_ = _fEmergChar_ * _aDShootChar_;
_aDFloatChar_ = _fFloatChar_ * _aDShootChar_;
_bfSubChar_ = 1.0 - _fFloatChar_ - _fEmergChar_;
_aDSubChar_ = _bfSubChar_ * _aDShootChar_;
_aExtChar_ = _cExtSpChar_ * _aDSubChar_ / _sDepthW_;
_aDepth1Char_ = _fDepth1Char_ * _sDepthW_;
_aDepth2Char_ = _fDepth2Char_ * _sDepthW_;
_afCovSurfChar_ = _MIN_(1.0, _MAX_(_aDFloatChar_ / (_cDLayerChar_ + _NearZero_), _aDEmergChar_ / (_fEmergChar_ * _cDCarrChar_ + _NearZero_) ) );
_afCovEmergChar_ = _MIN_(1.0, _PerCent_ * _cCovSpChar_ * _aDEmergChar_);
_aCovChar_ = _MIN_(100.0, _cCovSpChar_ * _aDShootChar_);
_aDayInitCera_ = _IF_ (_Day_ _LT_ 1.0 _OR_ _sTime_ _LT_ _BeginTime_ + 1.0) _THEN_ 367 _ELSEIF_ (_uTm_ _GE_ _cTmInitCera_ _AND_ _aDayInitCera_ _GT_ 366) _THEN_ _Day_ _ELSE_ _aDayInitCera_ _ENDIF_;
_bfRootCera_ = _IF_ (_Day_ _LT_ _aDayInitCera_) _THEN_ _fRootCeraWin_ _ELSEIF_ (_Day_ _LT_ _aDayInitCera_ + _cLengAllo_) _THEN_ 0.5*(_fRootCeraWin_ + _fRootCeraSum_) + 0.5*(_fRootCeraWin_ - _fRootCeraSum_) * _COS_(_Pi_/_cLengAllo_ * (_Day_ - _aDayInitCera_)) _ELSEIF_ (_Day_ _LT_ _cDayWinCera_) _THEN_ _fRootCeraSum_ _ELSEIF_ (_Day_ _LT_ _cDayWinCera_ + _cLengAllo_) _THEN_ 0.5*(_fRootCeraWin_ + _fRootCeraSum_) - 0.5*(_fRootCeraWin_ - _fRootCeraSum_) * _COS_(_Pi_/_cLengAllo_ * (_Day_ - _cDayWinCera_)) _ELSE_ _fRootCeraWin_ _ENDIF_;
_bfShootCera_ = 1.0 - _bfRootCera_;
_aDRootCera_ = _bfRootCera_ * _sDCera_;
_aDShootCera_ = _bfShootCera_ * _sDCera_;
_aDEmergCera_ = _fEmergCera_ * _aDShootCera_;
_aDFloatCera_ = _fFloatCera_ * _aDShootCera_;
_bfSubCera_ = 1.0 - _fFloatCera_ - _fEmergCera_;
_aDSubCera_ = _bfSubCera_ * _aDShootCera_;
_aExtCera_ = _cExtSpCera_ * _aDSubCera_ / _sDepthW_;
_aDepth1Cera_ = _fDepth1Cera_ * _sDepthW_;
_aDepth2Cera_ = _fDepth2Cera_ * _sDepthW_;
_afCovSurfCera_ = _MIN_(1.0, _MAX_(_aDFloatCera_ / (_cDLayerCera_ + _NearZero_), _aDEmergCera_ / (_fEmergCera_ * _cDCarrCera_ + _NearZero_) ) );
_afCovEmergCera_ = _MIN_(1.0, _PerCent_ * _cCovSpCera_ * _aDEmergCera_);
_aCovCera_ = _MIN_(100.0, _cCovSpCera_ * _aDShootCera_);
_aDayInitLemn_ = _IF_ (_Day_ _LT_ 1.0 _OR_ _sTime_ _LT_ _BeginTime_ + 1.0) _THEN_ 367 _ELSEIF_ (_uTm_ _GE_ _cTmInitLemn_ _AND_ _aDayInitLemn_ _GT_ 366) _THEN_ _Day_ _ELSE_ _aDayInitLemn_ _ENDIF_;
_bfRootLemn_ = _IF_ (_Day_ _LT_ _aDayInitLemn_) _THEN_ _fRootLemnWin_ _ELSEIF_ (_Day_ _LT_ _aDayInitLemn_ + _cLengAllo_) _THEN_ 0.5*(_fRootLemnWin_ + _fRootLemnSum_) + 0.5*(_fRootLemnWin_ - _fRootLemnSum_) * _COS_(_Pi_/_cLengAllo_ * (_Day_ - _aDayInitLemn_)) _ELSEIF_ (_Day_ _LT_ _cDayWinLemn_) _THEN_ _fRootLemnSum_ _ELSEIF_ (_Day_ _LT_ _cDayWinLemn_ + _cLengAllo_) _THEN_ 0.5*(_fRootLemnWin_ + _fRootLemnSum_) - 0.5*(_fRootLemnWin_ - _fRootLemnSum_) * _COS_(_Pi_/_cLengAllo_ * (_Day_ - _cDayWinLemn_)) _ELSE_ _fRootLemnWin_ _ENDIF_;
_bfShootLemn_ = 1.0 - _bfRootLemn_;
_aDRootLemn_ = _bfRootLemn_ * _sDLemn_;
_aDShootLemn_ = _bfShootLemn_ * _sDLemn_;
_aDEmergLemn_ = _fEmergLemn_ * _aDShootLemn_;
_aDFloatLemn_ = _fFloatLemn_ * _aDShootLemn_;
_bfSubLemn_ = 1.0 - _fFloatLemn_ - _fEmergLemn_;
_aDSubLemn_ = _bfSubLemn_ * _aDShootLemn_;
_aExtLemn_ = _cExtSpLemn_ * _aDSubLemn_ / _sDepthW_;
_aDepth1Lemn_ = _fDepth1Lemn_ * _sDepthW_;
_aDepth2Lemn_ = _fDepth2Lemn_ * _sDepthW_;
_afCovSurfLemn_ = _MIN_(1.0, _MAX_(_aDFloatLemn_ / (_cDLayerLemn_ + _NearZero_), _aDEmergLemn_ / (_fEmergLemn_ * _cDCarrLemn_ + _NearZero_) ) );
_afCovEmergLemn_ = _MIN_(1.0, _PerCent_ * _cCovSpLemn_ * _aDEmergLemn_);
_aCovLemn_ = _MIN_(100.0, _cCovSpLemn_ * _aDShootLemn_);
_aDayInitNymp_ = _IF_ (_Day_ _LT_ 1.0 _OR_ _sTime_ _LT_ _BeginTime_ + 1.0) _THEN_ 367 _ELSEIF_ (_uTm_ _GE_ _cTmInitNymp_ _AND_ _aDayInitNymp_ _GT_ 366) _THEN_ _Day_ _ELSE_ _aDayInitNymp_ _ENDIF_;
_bfRootNymp_ = _IF_ (_Day_ _LT_ _aDayInitNymp_) _THEN_ _fRootNympWin_ _ELSEIF_ (_Day_ _LT_ _aDayInitNymp_ + _cLengAllo_) _THEN_ 0.5*(_fRootNympWin_ + _fRootNympSum_) + 0.5*(_fRootNympWin_ - _fRootNympSum_) * _COS_(_Pi_/_cLengAllo_ * (_Day_ - _aDayInitNymp_)) _ELSEIF_ (_Day_ _LT_ _cDayWinNymp_) _THEN_ _fRootNympSum_ _ELSEIF_ (_Day_ _LT_ _cDayWinNymp_ + _cLengAllo_) _THEN_ 0.5*(_fRootNympWin_ + _fRootNympSum_) - 0.5*(_fRootNympWin_ - _fRootNympSum_) * _COS_(_Pi_/_cLengAllo_ * (_Day_ - _cDayWinNymp_)) _ELSE_ _fRootNympWin_ _ENDIF_;
_bfShootNymp_ = 1.0 - _bfRootNymp_;
_aDRootNymp_ = _bfRootNymp_ * _sDNymp_;
_aDShootNymp_ = _bfShootNymp_ * _sDNymp_;
_aDEmergNymp_ = _fEmergNymp_ * _aDShootNymp_;
_aDFloatNymp_ = _fFloatNymp_ * _aDShootNymp_;
_bfSubNymp_ = 1.0 - _fFloatNymp_ - _fEmergNymp_;
_aDSubNymp_ = _bfSubNymp_ * _aDShootNymp_;
_aExtNymp_ = _cExtSpNymp_ * _aDSubNymp_ / _sDepthW_;
_aDepth1Nymp_ = _fDepth1Nymp_ * _sDepthW_;
_aDepth2Nymp_ = _fDepth2Nymp_ * _sDepthW_;
_afCovSurfNymp_ = _MIN_(1.0, _MAX_(_aDFloatNymp_ / (_cDLayerNymp_ + _NearZero_), _aDEmergNymp_ / (_fEmergNymp_ * _cDCarrNymp_ + _NearZero_) ) );
_afCovEmergNymp_ = _MIN_(1.0, _PerCent_ * _cCovSpNymp_ * _aDEmergNymp_);
_aCovNymp_ = _MIN_(100.0, _cCovSpNymp_ * _aDShootNymp_);
_aDayInitHelo_ = _IF_ (_Day_ _LT_ 1.0 _OR_ _sTime_ _LT_ _BeginTime_ + 1.0) _THEN_ 367 _ELSEIF_ (_uTm_ _GE_ _cTmInitHelo_ _AND_ _aDayInitHelo_ _GT_ 366) _THEN_ _Day_ _ELSE_ _aDayInitHelo_ _ENDIF_;
_bfRootHelo_ = _IF_ (_Day_ _LT_ _aDayInitHelo_) _THEN_ _fRootHeloWin_ _ELSEIF_ (_Day_ _LT_ _aDayInitHelo_ + _cLengAllo_) _THEN_ 0.5*(_fRootHeloWin_ + _fRootHeloSum_) + 0.5*(_fRootHeloWin_ - _fRootHeloSum_) * _COS_(_Pi_/_cLengAllo_ * (_Day_ - _aDayInitHelo_)) _ELSEIF_ (_Day_ _LT_ _cDayWinHelo_) _THEN_ _fRootHeloSum_ _ELSEIF_ (_Day_ _LT_ _cDayWinHelo_ + _cLengAllo_) _THEN_ 0.5*(_fRootHeloWin_ + _fRootHeloSum_) - 0.5*(_fRootHeloWin_ - _fRootHeloSum_) * _COS_(_Pi_/_cLengAllo_ * (_Day_ - _cDayWinHelo_)) _ELSE_ _fRootHeloWin_ _ENDIF_;
_bfShootHelo_ = 1.0 - _bfRootHelo_;
_aDRootHelo_ = _bfRootHelo_ * _sDHelo_;
_aDShootHelo_ = _bfShootHelo_ * _sDHelo_;
_aDEmergHelo_ = _fEmergHelo_ * _aDShootHelo_;
_aDFloatHelo_ = _fFloatHelo_ * _aDShootHelo_;
_bfSubHelo_ = 1.0 - _fFloatHelo_ - _fEmergHelo_;
_aDSubHelo_ = _bfSubHelo_ * _aDShootHelo_;
_aExtHelo_ = _cExtSpHelo_ * _aDSubHelo_ / _sDepthW_;
_aDepth1Helo_ = _fDepth1Helo_ * _sDepthW_;
_aDepth2Helo_ = _fDepth2Helo_ * _sDepthW_;
_afCovSurfHelo_ = _MIN_(1.0, _MAX_(_aDFloatHelo_ / (_cDLayerHelo_ + _NearZero_), _aDEmergHelo_ / (_fEmergHelo_ * _cDCarrHelo_ + _NearZero_) ) );
_afCovEmergHelo_ = _MIN_(1.0, _PerCent_ * _cCovSpHelo_ * _aDEmergHelo_);
_aCovHelo_ = _MIN_(100.0, _cCovSpHelo_ * _aDShootHelo_);
_aPVeg_ = _sPElod_ + _sPChar_ + _sPCera_ + _sPLemn_ + _sPNymp_ + _sPHelo_;
_aNVeg_ = _sNElod_ + _sNChar_ + _sNCera_ + _sNLemn_ + _sNNymp_ + _sNHelo_;
_afCovSurfVeg_ = _MIN_(1.0, _afCovSurfElod_ + _afCovSurfChar_ + _afCovSurfCera_ + _afCovSurfLemn_ + _afCovSurfNymp_ + _afCovSurfHelo_);
_afCovEmergVeg_ = _MIN_(1.0, _afCovEmergElod_ + _afCovEmergChar_ + _afCovEmergCera_ + _afCovEmergLemn_ + _afCovEmergNymp_ + _afCovEmergHelo_);
_aExtVeg_ = _aExtElod_ + _aExtChar_ + _aExtCera_ + _aExtLemn_ + _aExtNymp_ + _aExtHelo_;
_aExtCoef_ = _aExtCoefOpen_ + _aExtVeg_;
_aLPARBot_ = _uLPAR0_ * _EXP_(- _aExtCoef_ * _sDepthW_);
_rPDElod_ = _sPElod_ / (_sDElod_+_NearZero_);
_rNDElod_ = _sNElod_ / (_sDElod_+_NearZero_);
_tDMigrElod_ = _kMigrElod_ * (_cDElodIn_ - _sDElod_);
_tPMigrElod_ = _kMigrElod_ * (_cPDElod0_* _cDElodIn_ - _sPElod_);
_tNMigrElod_ = _kMigrElod_ * (_cNDElod0_* _cDElodIn_ - _sNElod_);
_uFunTmProdElod_ = _POW_ (_cQ10ProdElod_ , (0.1 * (_uTm_ - _cTmRef_)));
_uFunTmRespElod_ = _POW_ (_cQ10RespElod_ , (0.1 * (_uTm_ - _cTmRef_)));
_aVPUptMaxCrElod_ = _MAX_( 0.0, _cVPUptMaxElod_ * _uFunTmProdElod_ * (_cPDElodMax_-_rPDElod_) / (_cPDElodMax_-_cPDElodMin_) );
_aVPUptElodW_ = _sPO4W_ * _aVPUptMaxCrElod_ / (_aVPUptMaxCrElod_ / _cAffPUptElod_ + _sPO4W_);
_tPUptElodW_ = _aVPUptElodW_ * (_aDSubElod_ + _aDFloatElod_);
_aVPUptElodS_ = _oPO4S_ * _aVPUptMaxCrElod_ / (_aVPUptMaxCrElod_ / _cAffPUptElod_ + _oPO4S_);
_tPUptElodS_ = _aVPUptElodS_ * _aDRootElod_;
_tPUptElod_ = _tPUptElodW_ + _tPUptElodS_;
_aVNUptMaxCrElod_ = _MAX_( 0.0, _cVNUptMaxElod_ * _uFunTmProdElod_ * (_cNDElodMax_ - _rNDElod_) / (_cNDElodMax_ - _cNDElodMin_));
_ahNUptElod_ = _aVNUptMaxCrElod_ / _cAffNUptElod_;
_aVNUptElodW_ = _oNDissW_ * _aVNUptMaxCrElod_ / (_ahNUptElod_ + _oNDissW_);
_tNUptElodW_ = _aVNUptElodW_ * (_aDSubElod_ + _aDFloatElod_);
_afNH4UptElodW_ = _sNH4W_ * _sNO3W_ / ((_ahNUptElod_ + _sNH4W_) * (_ahNUptElod_ + _sNO3W_ +_NearZero_)) + _sNH4W_ * _ahNUptElod_ / ((_sNH4W_ + _sNO3W_ +_NearZero_) * (_ahNUptElod_ + _sNO3W_ +_NearZero_));
_tNUptNH4ElodW_ = _afNH4UptElodW_ * _tNUptElodW_;
_tNUptNO3ElodW_ = _tNUptElodW_ - _tNUptNH4ElodW_;
_aVNUptElodS_ = _oNDissS_ * _aVNUptMaxCrElod_ / (_ahNUptElod_ + _oNDissS_);
_tNUptElodS_ = _aVNUptElodS_ * _aDRootElod_;
_afNH4UptElodS_ = _oNH4S_ * _oNO3S_ / ((_ahNUptElod_ + _oNH4S_ +_NearZero_) * (_ahNUptElod_ + _oNO3S_ +_NearZero_)) + _oNH4S_ * _ahNUptElod_ / ((_oNH4S_ + _oNO3S_+_NearZero_) * (_ahNUptElod_ + _oNO3S_+_NearZero_));
_tNUptNH4ElodS_ = _afNH4UptElodS_ * _tNUptElodS_;
_tNUptNO3ElodS_ = _tNUptElodS_ - _tNUptNH4ElodS_;
_tNUptElod_ = _tNUptElodW_ + _tNUptElodS_;
_aLPAR1Elod_ = _uLPAR0_ * _EXP_(- _aExtCoefOpen_ * _aDepth1Elod_);
_aLPAR2Elod_ = _aLPAR1Elod_ * _EXP_(- _aExtCoef_ * (_aDepth2Elod_ - _aDepth1Elod_));
_uhLElod_ = _hLRefElod_ * _uFunTmProdElod_;
_aLLimShootElod_ = _fEmergElod_ + _fFloatElod_ * (1.0 - _afCovEmergVeg_) + _bfSubElod_ * (1.0 - _afCovSurfVeg_) * 1.0 / (_aExtCoef_ * _sDepthW_) * _LN_( (1.0 + _aLPAR1Elod_ / _uhLElod_) / (1.0 + _aLPAR2Elod_ / _uhLElod_));
_aMuTmLElod_ = _ufDay_ * _bfShootElod_ * _aLLimShootElod_ * _uFunTmProdElod_ * _cMuMaxElod_;
_aPLimElod_ = _MAX_(0.0, (1.0 - _cPDElodMin_ / (_rPDElod_ + _NearZero_)) * _cPDElodMax_ / (_cPDElodMax_ - _cPDElodMin_));
_aNLimElod_ = _MAX_(0.0, (1.0 - _cNDElodMin_ / (_rNDElod_ + _NearZero_)) * _cNDElodMax_ / (_cNDElodMax_ - _cNDElodMin_));
_aNutLimElod_ = _MIN_( _aPLimElod_, _aNLimElod_);
_aMuElod_ = _aMuTmLElod_ * _aNutLimElod_;
_bkMortElod_ = _IF_ (_Day_ _LT_ _cDayWinElod_) _THEN_ _kMortElodSum_ _ELSEIF_ (_Day_ _LT_ _cDayWinElod_ + _cLengMort_) _THEN_ - _LN_(_fWinElod_) / _cLengMort_ _ELSE_ _kMortElodSum_ _ENDIF_;
_akDIncrElod_ = _aMuTmLElod_ - _kDRespElod_ * _uFunTmRespElod_ - _bkMortElod_;
_tDEnvElod_ = _MAX_(0.0, _akDIncrElod_ / (_cDCarrElod_+_NearZero_) * _sDElod_*_sDElod_);
_tDEnvProdElod_ = _aMuElod_ / _cMuMaxElod_ * _tDEnvElod_;
_tDProdElod_ = _MAX_(0.0, _aMuElod_ * _sDElod_ - _tDEnvProdElod_);
_tDProdSubElod_ = _bfSubElod_ * _tDProdElod_;
_tDRespElod_ = _kDRespElod_ * _uFunTmRespElod_ * _sDElod_;
_tDEnvMortElod_ = _tDEnvElod_ - _tDEnvProdElod_;
_tDMortElod_ = _bkMortElod_ * _sDElod_ + _tDEnvMortElod_;
_tDMortElodW_ = _fDetWMortElod_ * (1.0 - _bfRootElod_) * _tDMortElod_;
_tDMortElodS_ = _tDMortElod_ - _tDMortElodW_;
_tDGrazElodBird_ = _IF_ ( (_sTime_ _GE_ _cYearStartBirds_ * _DaysPerYear_) _AND_ (_Day_ _GE_ _cDayStartBirds_) _AND_ (_Day_ _LE_ _cDayEndBirds_) ) _THEN_ _cPrefElodBird_ * _sDElod_ / (_hDVegBird_ + _sDElod_) * _cBirdsPerha_ / _m2Perha_ * _cDGrazPerBird_ _ELSE_ 0.0 _ENDIF_;
_bkManElod_ = _IF_ ((_Day_ _GE_ _cDayManVeg1_ _AND_ _Day_ _LT_ _cDayManVeg1_ + _cLengMan_) _OR_ (_Day_ _GE_ _cDayManVeg2_ _AND_ _Day_ _LT_ _cDayManVeg2_ + _cLengMan_)) _THEN_ -_LN_(1.0 - _fManElod_) / _cLengMan_ _ELSE_ 0.0 _ENDIF_;
_tDManElod_ = _bkManElod_ * _sDElod_;
_tPManElod_ = _rPDElod_ * _tDManElod_;
_tNManElod_ = _rNDElod_ * _tDManElod_;
_tDBedElod_ = _tDMigrElod_ + _tDProdElod_ - _tDRespElod_ - _tDMortElod_ - _tDGrazElodBird_ - _tDManElod_;
_tO2ProdElod_ = _molO2molC_ * _cCPerDW_ * _tDProdElod_;
_tO2RespElodW_ = _molO2molC_ * _cCPerDW_ * _bfSubElod_ * _tDRespElod_ * _aCorO2BOD_;
_tO2RespElodS_ = _molO2molC_ * _cCPerDW_ * _bfRootElod_ * _tDRespElod_ * _afOxySed_;
_tO2ProdElodS_ = _MIN_ (_tO2RespElodS_, _tO2ProdElod_);
_tO2ProdElodW_ = _MIN_( _tO2ProdElod_ - _tO2ProdElodS_, _bfSubElod_ * _tO2ProdElod_);
_tO2UptNO3ElodW_ = _O2PerNO3_ * _molO2molN_ * _bfSubElod_ * _tNUptNO3ElodW_;
_tO2UptNO3ElodS_ = _O2PerNO3_ * _molO2molN_ * _tNUptNO3ElodS_;
_tPExcrElod_ = (2.0*_rPDElod_) / (_cPDElodMax_ + _rPDElod_) * _rPDElod_ * _tDRespElod_;
_tPExcrElodS_ = _bfRootElod_ * _tPExcrElod_;
_tPExcrElodW_ = _tPExcrElod_ - _tPExcrElodS_;
_tPMortElod_ = _rPDElod_ * _tDMortElod_;
_tPMortElodPO4_ = _fDissMortVeg_ * _tPMortElod_;
_tPMortElodPO4S_ = _bfRootElod_ * _tPMortElodPO4_;
_tPMortElodPO4W_ = _tPMortElodPO4_ - _tPMortElodPO4S_;
_tPMortElodDet_ = _tPMortElod_ - _tPMortElodPO4_;
_tPMortElodDetW_ = _fDetWMortElod_ * (1.0 - _bfRootElod_) * _tPMortElodDet_;
_tPMortElodDetS_ = _tPMortElodDet_ - _tPMortElodDetW_;
_tPGrazElodBird_ = _rPDElod_ * _tDGrazElodBird_;
_tPBedElod_ = _tPMigrElod_ + _tPUptElod_ - _tPExcrElod_ - _tPMortElod_ - _tPGrazElodBird_ - _tPManElod_;
_tNExcrElod_ = (2.0*_rNDElod_) / (_cNDElodMax_ + _rNDElod_) * _rNDElod_ * _tDRespElod_;
_tNExcrElodS_ = _bfRootElod_ * _tNExcrElod_;
_tNExcrElodW_ = _tNExcrElod_ - _tNExcrElodS_;
_tNMortElod_ = _rNDElod_ * _tDMortElod_;
_tNMortElodNH4_ = _fDissMortVeg_ * _tNMortElod_;
_tNMortElodNH4S_ = _bfRootElod_ * _tNMortElodNH4_;
_tNMortElodNH4W_ = _tNMortElodNH4_ - _tNMortElodNH4S_;
_tNMortElodDet_ = _tNMortElod_ - _tNMortElodNH4_;
_tNMortElodDetW_ = _fDetWMortElod_ * (1.0 - _bfRootElod_) * _tNMortElodDet_;
_tNMortElodDetS_ = _tNMortElodDet_ - _tNMortElodDetW_;
_tNGrazElodBird_ = _rNDElod_ * _tDGrazElodBird_;
_tNBedElod_ = _tNMigrElod_ + _tNUptElod_ - _tNExcrElod_ - _tNMortElod_ - _tNGrazElodBird_ - _tNManElod_;
_rPDChar_ = _sPChar_ / (_sDChar_+_NearZero_);
_rNDChar_ = _sNChar_ / (_sDChar_+_NearZero_);
_tDMigrChar_ = _kMigrChar_ * (_cDCharIn_ - _sDChar_);
_tPMigrChar_ = _kMigrChar_ * (_cPDChar0_* _cDCharIn_ - _sPChar_);
_tNMigrChar_ = _kMigrChar_ * (_cNDChar0_* _cDCharIn_ - _sNChar_);
_uFunTmProdChar_ = _POW_ (_cQ10ProdChar_ , (0.1 * (_uTm_ - _cTmRef_)));
_uFunTmRespChar_ = _POW_ (_cQ10RespChar_ , (0.1 * (_uTm_ - _cTmRef_)));
_aVPUptMaxCrChar_ = _MAX_( 0.0, _cVPUptMaxChar_ * _uFunTmProdChar_ * (_cPDCharMax_-_rPDChar_) / (_cPDCharMax_-_cPDCharMin_) );
_aVPUptCharW_ = _sPO4W_ * _aVPUptMaxCrChar_ / (_aVPUptMaxCrChar_ / _cAffPUptChar_ + _sPO4W_);
_tPUptCharW_ = _aVPUptCharW_ * (_aDSubChar_ + _aDFloatChar_);
_aVPUptCharS_ = _oPO4S_ * _aVPUptMaxCrChar_ / (_aVPUptMaxCrChar_ / _cAffPUptChar_ + _oPO4S_);
_tPUptCharS_ = _aVPUptCharS_ * _aDRootChar_;
_tPUptChar_ = _tPUptCharW_ + _tPUptCharS_;
_aVNUptMaxCrChar_ = _MAX_( 0.0, _cVNUptMaxChar_ * _uFunTmProdChar_ * (_cNDCharMax_ - _rNDChar_) / (_cNDCharMax_ - _cNDCharMin_));
_ahNUptChar_ = _aVNUptMaxCrChar_ / _cAffNUptChar_;
_aVNUptCharW_ = _oNDissW_ * _aVNUptMaxCrChar_ / (_ahNUptChar_ + _oNDissW_);
_tNUptCharW_ = _aVNUptCharW_ * (_aDSubChar_ + _aDFloatChar_);
_afNH4UptCharW_ = _sNH4W_ * _sNO3W_ / ((_ahNUptChar_ + _sNH4W_) * (_ahNUptChar_ + _sNO3W_ +_NearZero_)) + _sNH4W_ * _ahNUptChar_ / ((_sNH4W_ + _sNO3W_ +_NearZero_) * (_ahNUptChar_ + _sNO3W_ +_NearZero_));
_tNUptNH4CharW_ = _afNH4UptCharW_ * _tNUptCharW_;
_tNUptNO3CharW_ = _tNUptCharW_ - _tNUptNH4CharW_;
_aVNUptCharS_ = _oNDissS_ * _aVNUptMaxCrChar_ / (_ahNUptChar_ + _oNDissS_);
_tNUptCharS_ = _aVNUptCharS_ * _aDRootChar_;
_afNH4UptCharS_ = _oNH4S_ * _oNO3S_ / ((_ahNUptChar_ + _oNH4S_ +_NearZero_) * (_ahNUptChar_ + _oNO3S_ +_NearZero_)) + _oNH4S_ * _ahNUptChar_ / ((_oNH4S_ + _oNO3S_+_NearZero_) * (_ahNUptChar_ + _oNO3S_+_NearZero_));
_tNUptNH4CharS_ = _afNH4UptCharS_ * _tNUptCharS_;
_tNUptNO3CharS_ = _tNUptCharS_ - _tNUptNH4CharS_;
_tNUptChar_ = _tNUptCharW_ + _tNUptCharS_;
_aLPAR1Char_ = _uLPAR0_ * _EXP_(- _aExtCoefOpen_ * _aDepth1Char_);
_aLPAR2Char_ = _aLPAR1Char_ * _EXP_(- _aExtCoef_ * (_aDepth2Char_ - _aDepth1Char_));
_uhLChar_ = _hLRefChar_ * _uFunTmProdChar_;
_aLLimShootChar_ = _fEmergChar_ + _fFloatChar_ * (1.0 - _afCovEmergVeg_) + _bfSubChar_ * (1.0 - _afCovSurfVeg_) * 1.0 / (_aExtCoef_ * _sDepthW_) * _LN_( (1.0 + _aLPAR1Char_ / _uhLChar_) / (1.0 + _aLPAR2Char_ / _uhLChar_));
_aMuTmLChar_ = _ufDay_ * _bfShootChar_ * _aLLimShootChar_ * _uFunTmProdChar_ * _cMuMaxChar_;
_aPLimChar_ = _MAX_(0.0, (1.0 - _cPDCharMin_ / (_rPDChar_ + _NearZero_)) * _cPDCharMax_ / (_cPDCharMax_ - _cPDCharMin_));
_aNLimChar_ = _MAX_(0.0, (1.0 - _cNDCharMin_ / (_rNDChar_ + _NearZero_)) * _cNDCharMax_ / (_cNDCharMax_ - _cNDCharMin_));
_aNutLimChar_ = _MIN_( _aPLimChar_, _aNLimChar_);
_aMuChar_ = _aMuTmLChar_ * _aNutLimChar_;
_bkMortChar_ = _IF_ (_Day_ _LT_ _cDayWinChar_) _THEN_ _kMortCharSum_ _ELSEIF_ (_Day_ _LT_ _cDayWinChar_ + _cLengMort_) _THEN_ - _LN_(_fWinChar_) / _cLengMort_ _ELSE_ _kMortCharSum_ _ENDIF_;
_akDIncrChar_ = _aMuTmLChar_ - _kDRespChar_ * _uFunTmRespChar_ - _bkMortChar_;
_tDEnvChar_ = _MAX_(0.0, _akDIncrChar_ / (_cDCarrChar_+_NearZero_) * _sDChar_*_sDChar_);
_tDEnvProdChar_ = _aMuChar_ / _cMuMaxChar_ * _tDEnvChar_;
_tDProdChar_ = _MAX_(0.0, _aMuChar_ * _sDChar_ - _tDEnvProdChar_);
_tDProdSubChar_ = _bfSubChar_ * _tDProdChar_;
_tDRespChar_ = _kDRespChar_ * _uFunTmRespChar_ * _sDChar_;
_tDEnvMortChar_ = _tDEnvChar_ - _tDEnvProdChar_;
_tDMortChar_ = _bkMortChar_ * _sDChar_ + _tDEnvMortChar_;
_tDMortCharW_ = _fDetWMortChar_ * (1.0 - _bfRootChar_) * _tDMortChar_;
_tDMortCharS_ = _tDMortChar_ - _tDMortCharW_;
_tDGrazCharBird_ = _IF_ ( (_sTime_ _GE_ _cYearStartBirds_ * _DaysPerYear_) _AND_ (_Day_ _GE_ _cDayStartBirds_) _AND_ (_Day_ _LE_ _cDayEndBirds_) ) _THEN_ _cPrefCharBird_ * _sDChar_ / (_hDVegBird_ + _sDChar_) * _cBirdsPerha_ / _m2Perha_ * _cDGrazPerBird_ _ELSE_ 0.0 _ENDIF_;
_bkManChar_ = _IF_ ((_Day_ _GE_ _cDayManVeg1_ _AND_ _Day_ _LT_ _cDayManVeg1_ + _cLengMan_) _OR_ (_Day_ _GE_ _cDayManVeg2_ _AND_ _Day_ _LT_ _cDayManVeg2_ + _cLengMan_)) _THEN_ -_LN_(1.0 - _fManChar_) / _cLengMan_ _ELSE_ 0.0 _ENDIF_;
_tDManChar_ = _bkManChar_ * _sDChar_;
_tPManChar_ = _rPDChar_ * _tDManChar_;
_tNManChar_ = _rNDChar_ * _tDManChar_;
_tDBedChar_ = _tDMigrChar_ + _tDProdChar_ - _tDRespChar_ - _tDMortChar_ - _tDGrazCharBird_ - _tDManChar_;
_tO2ProdChar_ = _molO2molC_ * _cCPerDW_ * _tDProdChar_;
_tO2RespCharW_ = _molO2molC_ * _cCPerDW_ * _bfSubChar_ * _tDRespChar_ * _aCorO2BOD_;
_tO2RespCharS_ = _molO2molC_ * _cCPerDW_ * _bfRootChar_ * _tDRespChar_ * _afOxySed_;
_tO2ProdCharS_ = _MIN_ (_tO2RespCharS_, _tO2ProdChar_);
_tO2ProdCharW_ = _MIN_( _tO2ProdChar_ - _tO2ProdCharS_, _bfSubChar_ * _tO2ProdChar_);
_tO2UptNO3CharW_ = _O2PerNO3_ * _molO2molN_ * _bfSubChar_ * _tNUptNO3CharW_;
_tO2UptNO3CharS_ = _O2PerNO3_ * _molO2molN_ * _tNUptNO3CharS_;
_tPExcrChar_ = (2.0*_rPDChar_) / (_cPDCharMax_ + _rPDChar_) * _rPDChar_ * _tDRespChar_;
_tPExcrCharS_ = _bfRootChar_ * _tPExcrChar_;
_tPExcrCharW_ = _tPExcrChar_ - _tPExcrCharS_;
_tPMortChar_ = _rPDChar_ * _tDMortChar_;
_tPMortCharPO4_ = _fDissMortVeg_ * _tPMortChar_;
_tPMortCharPO4S_ = _bfRootChar_ * _tPMortCharPO4_;
_tPMortCharPO4W_ = _tPMortCharPO4_ - _tPMortCharPO4S_;
_tPMortCharDet_ = _tPMortChar_ - _tPMortCharPO4_;
_tPMortCharDetW_ = _fDetWMortChar_ * (1.0 - _bfRootChar_) * _tPMortCharDet_;
_tPMortCharDetS_ = _tPMortCharDet_ - _tPMortCharDetW_;
_tPGrazCharBird_ = _rPDChar_ * _tDGrazCharBird_;
_tPBedChar_ = _tPMigrChar_ + _tPUptChar_ - _tPExcrChar_ - _tPMortChar_ - _tPGrazCharBird_ - _tPManChar_;
_tNExcrChar_ = (2.0*_rNDChar_) / (_cNDCharMax_ + _rNDChar_) * _rNDChar_ * _tDRespChar_;
_tNExcrCharS_ = _bfRootChar_ * _tNExcrChar_;
_tNExcrCharW_ = _tNExcrChar_ - _tNExcrCharS_;
_tNMortChar_ = _rNDChar_ * _tDMortChar_;
_tNMortCharNH4_ = _fDissMortVeg_ * _tNMortChar_;
_tNMortCharNH4S_ = _bfRootChar_ * _tNMortCharNH4_;
_tNMortCharNH4W_ = _tNMortCharNH4_ - _tNMortCharNH4S_;
_tNMortCharDet_ = _tNMortChar_ - _tNMortCharNH4_;
_tNMortCharDetW_ = _fDetWMortChar_ * (1.0 - _bfRootChar_) * _tNMortCharDet_;
_tNMortCharDetS_ = _tNMortCharDet_ - _tNMortCharDetW_;
_tNGrazCharBird_ = _rNDChar_ * _tDGrazCharBird_;
_tNBedChar_ = _tNMigrChar_ + _tNUptChar_ - _tNExcrChar_ - _tNMortChar_ - _tNGrazCharBird_ - _tNManChar_;
_rPDCera_ = _sPCera_ / (_sDCera_+_NearZero_);
_rNDCera_ = _sNCera_ / (_sDCera_+_NearZero_);
_tDMigrCera_ = _kMigrCera_ * (_cDCeraIn_ - _sDCera_);
_tPMigrCera_ = _kMigrCera_ * (_cPDCera0_* _cDCeraIn_ - _sPCera_);
_tNMigrCera_ = _kMigrCera_ * (_cNDCera0_* _cDCeraIn_ - _sNCera_);
_uFunTmProdCera_ = _POW_ (_cQ10ProdCera_ , (0.1 * (_uTm_ - _cTmRef_)));
_uFunTmRespCera_ = _POW_ (_cQ10RespCera_ , (0.1 * (_uTm_ - _cTmRef_)));
_aVPUptMaxCrCera_ = _MAX_( 0.0, _cVPUptMaxCera_ * _uFunTmProdCera_ * (_cPDCeraMax_-_rPDCera_) / (_cPDCeraMax_-_cPDCeraMin_) );
_aVPUptCeraW_ = _sPO4W_ * _aVPUptMaxCrCera_ / (_aVPUptMaxCrCera_ / _cAffPUptCera_ + _sPO4W_);
_tPUptCeraW_ = _aVPUptCeraW_ * (_aDSubCera_ + _aDFloatCera_);
_aVPUptCeraS_ = _oPO4S_ * _aVPUptMaxCrCera_ / (_aVPUptMaxCrCera_ / _cAffPUptCera_ + _oPO4S_);
_tPUptCeraS_ = _aVPUptCeraS_ * _aDRootCera_;
_tPUptCera_ = _tPUptCeraW_ + _tPUptCeraS_;
_aVNUptMaxCrCera_ = _MAX_( 0.0, _cVNUptMaxCera_ * _uFunTmProdCera_ * (_cNDCeraMax_ - _rNDCera_) / (_cNDCeraMax_ - _cNDCeraMin_));
_ahNUptCera_ = _aVNUptMaxCrCera_ / _cAffNUptCera_;
_aVNUptCeraW_ = _oNDissW_ * _aVNUptMaxCrCera_ / (_ahNUptCera_ + _oNDissW_);
_tNUptCeraW_ = _aVNUptCeraW_ * (_aDSubCera_ + _aDFloatCera_);
_afNH4UptCeraW_ = _sNH4W_ * _sNO3W_ / ((_ahNUptCera_ + _sNH4W_) * (_ahNUptCera_ + _sNO3W_ +_NearZero_)) + _sNH4W_ * _ahNUptCera_ / ((_sNH4W_ + _sNO3W_ +_NearZero_) * (_ahNUptCera_ + _sNO3W_ +_NearZero_));
_tNUptNH4CeraW_ = _afNH4UptCeraW_ * _tNUptCeraW_;
_tNUptNO3CeraW_ = _tNUptCeraW_ - _tNUptNH4CeraW_;
_aVNUptCeraS_ = _oNDissS_ * _aVNUptMaxCrCera_ / (_ahNUptCera_ + _oNDissS_);
_tNUptCeraS_ = _aVNUptCeraS_ * _aDRootCera_;
_afNH4UptCeraS_ = _oNH4S_ * _oNO3S_ / ((_ahNUptCera_ + _oNH4S_ +_NearZero_) * (_ahNUptCera_ + _oNO3S_ +_NearZero_)) + _oNH4S_ * _ahNUptCera_ / ((_oNH4S_ + _oNO3S_+_NearZero_) * (_ahNUptCera_ + _oNO3S_+_NearZero_));
_tNUptNH4CeraS_ = _afNH4UptCeraS_ * _tNUptCeraS_;
_tNUptNO3CeraS_ = _tNUptCeraS_ - _tNUptNH4CeraS_;
_tNUptCera_ = _tNUptCeraW_ + _tNUptCeraS_;
_aLPAR1Cera_ = _uLPAR0_ * _EXP_(- _aExtCoefOpen_ * _aDepth1Cera_);
_aLPAR2Cera_ = _aLPAR1Cera_ * _EXP_(- _aExtCoef_ * (_aDepth2Cera_ - _aDepth1Cera_));
_uhLCera_ = _hLRefCera_ * _uFunTmProdCera_;
_aLLimShootCera_ = _fEmergCera_ + _fFloatCera_ * (1.0 - _afCovEmergVeg_) + _bfSubCera_ * (1.0 - _afCovSurfVeg_) * 1.0 / (_aExtCoef_ * _sDepthW_) * _LN_( (1.0 + _aLPAR1Cera_ / _uhLCera_) / (1.0 + _aLPAR2Cera_ / _uhLCera_));
_aMuTmLCera_ = _ufDay_ * _bfShootCera_ * _aLLimShootCera_ * _uFunTmProdCera_ * _cMuMaxCera_;
_aPLimCera_ = _MAX_(0.0, (1.0 - _cPDCeraMin_ / (_rPDCera_ + _NearZero_)) * _cPDCeraMax_ / (_cPDCeraMax_ - _cPDCeraMin_));
_aNLimCera_ = _MAX_(0.0, (1.0 - _cNDCeraMin_ / (_rNDCera_ + _NearZero_)) * _cNDCeraMax_ / (_cNDCeraMax_ - _cNDCeraMin_));
_aNutLimCera_ = _MIN_( _aPLimCera_, _aNLimCera_);
_aMuCera_ = _aMuTmLCera_ * _aNutLimCera_;
_bkMortCera_ = _IF_ (_Day_ _LT_ _cDayWinCera_) _THEN_ _kMortCeraSum_ _ELSEIF_ (_Day_ _LT_ _cDayWinCera_ + _cLengMort_) _THEN_ - _LN_(_fWinCera_) / _cLengMort_ _ELSE_ _kMortCeraSum_ _ENDIF_;
_akDIncrCera_ = _aMuTmLCera_ - _kDRespCera_ * _uFunTmRespCera_ - _bkMortCera_;
_tDEnvCera_ = _MAX_(0.0, _akDIncrCera_ / (_cDCarrCera_+_NearZero_) * _sDCera_*_sDCera_);
_tDEnvProdCera_ = _aMuCera_ / _cMuMaxCera_ * _tDEnvCera_;
_tDProdCera_ = _MAX_(0.0, _aMuCera_ * _sDCera_ - _tDEnvProdCera_);
_tDProdSubCera_ = _bfSubCera_ * _tDProdCera_;
_tDRespCera_ = _kDRespCera_ * _uFunTmRespCera_ * _sDCera_;
_tDEnvMortCera_ = _tDEnvCera_ - _tDEnvProdCera_;
_tDMortCera_ = _bkMortCera_ * _sDCera_ + _tDEnvMortCera_;
_tDMortCeraW_ = _fDetWMortCera_ * (1.0 - _bfRootCera_) * _tDMortCera_;
_tDMortCeraS_ = _tDMortCera_ - _tDMortCeraW_;
_tDGrazCeraBird_ = _IF_ ( (_sTime_ _GE_ _cYearStartBirds_ * _DaysPerYear_) _AND_ (_Day_ _GE_ _cDayStartBirds_) _AND_ (_Day_ _LE_ _cDayEndBirds_) ) _THEN_ _cPrefCeraBird_ * _sDCera_ / (_hDVegBird_ + _sDCera_) * _cBirdsPerha_ / _m2Perha_ * _cDGrazPerBird_ _ELSE_ 0.0 _ENDIF_;
_bkManCera_ = _IF_ ((_Day_ _GE_ _cDayManVeg1_ _AND_ _Day_ _LT_ _cDayManVeg1_ + _cLengMan_) _OR_ (_Day_ _GE_ _cDayManVeg2_ _AND_ _Day_ _LT_ _cDayManVeg2_ + _cLengMan_)) _THEN_ -_LN_(1.0 - _fManCera_) / _cLengMan_ _ELSE_ 0.0 _ENDIF_;
_tDManCera_ = _bkManCera_ * _sDCera_;
_tPManCera_ = _rPDCera_ * _tDManCera_;
_tNManCera_ = _rNDCera_ * _tDManCera_;
_tDBedCera_ = _tDMigrCera_ + _tDProdCera_ - _tDRespCera_ - _tDMortCera_ - _tDGrazCeraBird_ - _tDManCera_;
_tO2ProdCera_ = _molO2molC_ * _cCPerDW_ * _tDProdCera_;
_tO2RespCeraW_ = _molO2molC_ * _cCPerDW_ * _bfSubCera_ * _tDRespCera_ * _aCorO2BOD_;
_tO2RespCeraS_ = _molO2molC_ * _cCPerDW_ * _bfRootCera_ * _tDRespCera_ * _afOxySed_;
_tO2ProdCeraS_ = _MIN_ (_tO2RespCeraS_, _tO2ProdCera_);
_tO2ProdCeraW_ = _MIN_( _tO2ProdCera_ - _tO2ProdCeraS_, _bfSubCera_ * _tO2ProdCera_);
_tO2UptNO3CeraW_ = _O2PerNO3_ * _molO2molN_ * _bfSubCera_ * _tNUptNO3CeraW_;
_tO2UptNO3CeraS_ = _O2PerNO3_ * _molO2molN_ * _tNUptNO3CeraS_;
_tPExcrCera_ = (2.0*_rPDCera_) / (_cPDCeraMax_ + _rPDCera_) * _rPDCera_ * _tDRespCera_;
_tPExcrCeraS_ = _bfRootCera_ * _tPExcrCera_;
_tPExcrCeraW_ = _tPExcrCera_ - _tPExcrCeraS_;
_tPMortCera_ = _rPDCera_ * _tDMortCera_;
_tPMortCeraPO4_ = _fDissMortVeg_ * _tPMortCera_;
_tPMortCeraPO4S_ = _bfRootCera_ * _tPMortCeraPO4_;
_tPMortCeraPO4W_ = _tPMortCeraPO4_ - _tPMortCeraPO4S_;
_tPMortCeraDet_ = _tPMortCera_ - _tPMortCeraPO4_;
_tPMortCeraDetW_ = _fDetWMortCera_ * (1.0 - _bfRootCera_) * _tPMortCeraDet_;
_tPMortCeraDetS_ = _tPMortCeraDet_ - _tPMortCeraDetW_;
_tPGrazCeraBird_ = _rPDCera_ * _tDGrazCeraBird_;
_tPBedCera_ = _tPMigrCera_ + _tPUptCera_ - _tPExcrCera_ - _tPMortCera_ - _tPGrazCeraBird_ - _tPManCera_;
_tNExcrCera_ = (2.0*_rNDCera_) / (_cNDCeraMax_ + _rNDCera_) * _rNDCera_ * _tDRespCera_;
_tNExcrCeraS_ = _bfRootCera_ * _tNExcrCera_;
_tNExcrCeraW_ = _tNExcrCera_ - _tNExcrCeraS_;
_tNMortCera_ = _rNDCera_ * _tDMortCera_;
_tNMortCeraNH4_ = _fDissMortVeg_ * _tNMortCera_;
_tNMortCeraNH4S_ = _bfRootCera_ * _tNMortCeraNH4_;
_tNMortCeraNH4W_ = _tNMortCeraNH4_ - _tNMortCeraNH4S_;
_tNMortCeraDet_ = _tNMortCera_ - _tNMortCeraNH4_;
_tNMortCeraDetW_ = _fDetWMortCera_ * (1.0 - _bfRootCera_) * _tNMortCeraDet_;
_tNMortCeraDetS_ = _tNMortCeraDet_ - _tNMortCeraDetW_;
_tNGrazCeraBird_ = _rNDCera_ * _tDGrazCeraBird_;
_tNBedCera_ = _tNMigrCera_ + _tNUptCera_ - _tNExcrCera_ - _tNMortCera_ - _tNGrazCeraBird_ - _tNManCera_;
_rPDLemn_ = _sPLemn_ / (_sDLemn_+_NearZero_);
_rNDLemn_ = _sNLemn_ / (_sDLemn_+_NearZero_);
_tDMigrLemn_ = _kMigrLemn_ * (_cDLemnIn_ - _sDLemn_);
_tPMigrLemn_ = _kMigrLemn_ * (_cPDLemn0_* _cDLemnIn_ - _sPLemn_);
_tNMigrLemn_ = _kMigrLemn_ * (_cNDLemn0_* _cDLemnIn_ - _sNLemn_);
_uFunTmProdLemn_ = _POW_ (_cQ10ProdLemn_ , (0.1 * (_uTm_ - _cTmRef_)));
_uFunTmRespLemn_ = _POW_ (_cQ10RespLemn_ , (0.1 * (_uTm_ - _cTmRef_)));
_aVPUptMaxCrLemn_ = _MAX_( 0.0, _cVPUptMaxLemn_ * _uFunTmProdLemn_ * (_cPDLemnMax_-_rPDLemn_) / (_cPDLemnMax_-_cPDLemnMin_) );
_aVPUptLemnW_ = _sPO4W_ * _aVPUptMaxCrLemn_ / (_aVPUptMaxCrLemn_ / _cAffPUptLemn_ + _sPO4W_);
_tPUptLemnW_ = _aVPUptLemnW_ * (_aDSubLemn_ + _aDFloatLemn_);
_aVPUptLemnS_ = _oPO4S_ * _aVPUptMaxCrLemn_ / (_aVPUptMaxCrLemn_ / _cAffPUptLemn_ + _oPO4S_);
_tPUptLemnS_ = _aVPUptLemnS_ * _aDRootLemn_;
_tPUptLemn_ = _tPUptLemnW_ + _tPUptLemnS_;
_aVNUptMaxCrLemn_ = _MAX_( 0.0, _cVNUptMaxLemn_ * _uFunTmProdLemn_ * (_cNDLemnMax_ - _rNDLemn_) / (_cNDLemnMax_ - _cNDLemnMin_));
_ahNUptLemn_ = _aVNUptMaxCrLemn_ / _cAffNUptLemn_;
_aVNUptLemnW_ = _oNDissW_ * _aVNUptMaxCrLemn_ / (_ahNUptLemn_ + _oNDissW_);
_tNUptLemnW_ = _aVNUptLemnW_ * (_aDSubLemn_ + _aDFloatLemn_);
_afNH4UptLemnW_ = _sNH4W_ * _sNO3W_ / ((_ahNUptLemn_ + _sNH4W_) * (_ahNUptLemn_ + _sNO3W_ +_NearZero_)) + _sNH4W_ * _ahNUptLemn_ / ((_sNH4W_ + _sNO3W_ +_NearZero_) * (_ahNUptLemn_ + _sNO3W_ +_NearZero_));
_tNUptNH4LemnW_ = _afNH4UptLemnW_ * _tNUptLemnW_;
_tNUptNO3LemnW_ = _tNUptLemnW_ - _tNUptNH4LemnW_;
_aVNUptLemnS_ = _oNDissS_ * _aVNUptMaxCrLemn_ / (_ahNUptLemn_ + _oNDissS_);
_tNUptLemnS_ = _aVNUptLemnS_ * _aDRootLemn_;
_afNH4UptLemnS_ = _oNH4S_ * _oNO3S_ / ((_ahNUptLemn_ + _oNH4S_ +_NearZero_) * (_ahNUptLemn_ + _oNO3S_ +_NearZero_)) + _oNH4S_ * _ahNUptLemn_ / ((_oNH4S_ + _oNO3S_+_NearZero_) * (_ahNUptLemn_ + _oNO3S_+_NearZero_));
_tNUptNH4LemnS_ = _afNH4UptLemnS_ * _tNUptLemnS_;
_tNUptNO3LemnS_ = _tNUptLemnS_ - _tNUptNH4LemnS_;
_tNUptLemn_ = _tNUptLemnW_ + _tNUptLemnS_;
_aLPAR1Lemn_ = _uLPAR0_ * _EXP_(- _aExtCoefOpen_ * _aDepth1Lemn_);
_aLPAR2Lemn_ = _aLPAR1Lemn_ * _EXP_(- _aExtCoef_ * (_aDepth2Lemn_ - _aDepth1Lemn_));
_uhLLemn_ = _hLRefLemn_ * _uFunTmProdLemn_;
_aLLimShootLemn_ = _fEmergLemn_ + _fFloatLemn_ * (1.0 - _afCovEmergVeg_) + _bfSubLemn_ * (1.0 - _afCovSurfVeg_) * 1.0 / (_aExtCoef_ * _sDepthW_) * _LN_( (1.0 + _aLPAR1Lemn_ / _uhLLemn_) / (1.0 + _aLPAR2Lemn_ / _uhLLemn_));
_aMuTmLLemn_ = _ufDay_ * _bfShootLemn_ * _aLLimShootLemn_ * _uFunTmProdLemn_ * _cMuMaxLemn_;
_aPLimLemn_ = _MAX_(0.0, (1.0 - _cPDLemnMin_ / (_rPDLemn_ + _NearZero_)) * _cPDLemnMax_ / (_cPDLemnMax_ - _cPDLemnMin_));
_aNLimLemn_ = _MAX_(0.0, (1.0 - _cNDLemnMin_ / (_rNDLemn_ + _NearZero_)) * _cNDLemnMax_ / (_cNDLemnMax_ - _cNDLemnMin_));
_aNutLimLemn_ = _MIN_( _aPLimLemn_, _aNLimLemn_);
_aMuLemn_ = _aMuTmLLemn_ * _aNutLimLemn_;
_bkMortLemn_ = _IF_ (_Day_ _LT_ _cDayWinLemn_) _THEN_ _kMortLemnSum_ _ELSEIF_ (_Day_ _LT_ _cDayWinLemn_ + _cLengMort_) _THEN_ - _LN_(_fWinLemn_) / _cLengMort_ _ELSE_ _kMortLemnSum_ _ENDIF_;
_akDIncrLemn_ = _aMuTmLLemn_ - _kDRespLemn_ * _uFunTmRespLemn_ - _bkMortLemn_;
_tDEnvLemn_ = _MAX_(0.0, _akDIncrLemn_ / (_cDCarrLemn_+_NearZero_) * _sDLemn_*_sDLemn_);
_tDEnvProdLemn_ = _aMuLemn_ / _cMuMaxLemn_ * _tDEnvLemn_;
_tDProdLemn_ = _MAX_(0.0, _aMuLemn_ * _sDLemn_ - _tDEnvProdLemn_);
_tDProdSubLemn_ = _bfSubLemn_ * _tDProdLemn_;
_tDRespLemn_ = _kDRespLemn_ * _uFunTmRespLemn_ * _sDLemn_;
_tDEnvMortLemn_ = _tDEnvLemn_ - _tDEnvProdLemn_;
_tDMortLemn_ = _bkMortLemn_ * _sDLemn_ + _tDEnvMortLemn_;
_tDMortLemnW_ = _fDetWMortLemn_ * (1.0 - _bfRootLemn_) * _tDMortLemn_;
_tDMortLemnS_ = _tDMortLemn_ - _tDMortLemnW_;
_tDGrazLemnBird_ = _IF_ ( (_sTime_ _GE_ _cYearStartBirds_ * _DaysPerYear_) _AND_ (_Day_ _GE_ _cDayStartBirds_) _AND_ (_Day_ _LE_ _cDayEndBirds_) ) _THEN_ _cPrefLemnBird_ * _sDLemn_ / (_hDVegBird_ + _sDLemn_) * _cBirdsPerha_ / _m2Perha_ * _cDGrazPerBird_ _ELSE_ 0.0 _ENDIF_;
_bkManLemn_ = _IF_ ((_Day_ _GE_ _cDayManVeg1_ _AND_ _Day_ _LT_ _cDayManVeg1_ + _cLengMan_) _OR_ (_Day_ _GE_ _cDayManVeg2_ _AND_ _Day_ _LT_ _cDayManVeg2_ + _cLengMan_)) _THEN_ -_LN_(1.0 - _fManLemn_) / _cLengMan_ _ELSE_ 0.0 _ENDIF_;
_tDManLemn_ = _bkManLemn_ * _sDLemn_;
_tPManLemn_ = _rPDLemn_ * _tDManLemn_;
_tNManLemn_ = _rNDLemn_ * _tDManLemn_;
_tDBedLemn_ = _tDMigrLemn_ + _tDProdLemn_ - _tDRespLemn_ - _tDMortLemn_ - _tDGrazLemnBird_ - _tDManLemn_;
_tO2ProdLemn_ = _molO2molC_ * _cCPerDW_ * _tDProdLemn_;
_tO2RespLemnW_ = _molO2molC_ * _cCPerDW_ * _bfSubLemn_ * _tDRespLemn_ * _aCorO2BOD_;
_tO2RespLemnS_ = _molO2molC_ * _cCPerDW_ * _bfRootLemn_ * _tDRespLemn_ * _afOxySed_;
_tO2ProdLemnS_ = _MIN_ (_tO2RespLemnS_, _tO2ProdLemn_);
_tO2ProdLemnW_ = _MIN_( _tO2ProdLemn_ - _tO2ProdLemnS_, _bfSubLemn_ * _tO2ProdLemn_);
_tO2UptNO3LemnW_ = _O2PerNO3_ * _molO2molN_ * _bfSubLemn_ * _tNUptNO3LemnW_;
_tO2UptNO3LemnS_ = _O2PerNO3_ * _molO2molN_ * _tNUptNO3LemnS_;
_tPExcrLemn_ = (2.0*_rPDLemn_) / (_cPDLemnMax_ + _rPDLemn_) * _rPDLemn_ * _tDRespLemn_;
_tPExcrLemnS_ = _bfRootLemn_ * _tPExcrLemn_;
_tPExcrLemnW_ = _tPExcrLemn_ - _tPExcrLemnS_;
_tPMortLemn_ = _rPDLemn_ * _tDMortLemn_;
_tPMortLemnPO4_ = _fDissMortVeg_ * _tPMortLemn_;
_tPMortLemnPO4S_ = _bfRootLemn_ * _tPMortLemnPO4_;
_tPMortLemnPO4W_ = _tPMortLemnPO4_ - _tPMortLemnPO4S_;
_tPMortLemnDet_ = _tPMortLemn_ - _tPMortLemnPO4_;
_tPMortLemnDetW_ = _fDetWMortLemn_ * (1.0 - _bfRootLemn_) * _tPMortLemnDet_;
_tPMortLemnDetS_ = _tPMortLemnDet_ - _tPMortLemnDetW_;
_tPGrazLemnBird_ = _rPDLemn_ * _tDGrazLemnBird_;
_tPBedLemn_ = _tPMigrLemn_ + _tPUptLemn_ - _tPExcrLemn_ - _tPMortLemn_ - _tPGrazLemnBird_ - _tPManLemn_;
_tNExcrLemn_ = (2.0*_rNDLemn_) / (_cNDLemnMax_ + _rNDLemn_) * _rNDLemn_ * _tDRespLemn_;
_tNExcrLemnS_ = _bfRootLemn_ * _tNExcrLemn_;
_tNExcrLemnW_ = _tNExcrLemn_ - _tNExcrLemnS_;
_tNMortLemn_ = _rNDLemn_ * _tDMortLemn_;
_tNMortLemnNH4_ = _fDissMortVeg_ * _tNMortLemn_;
_tNMortLemnNH4S_ = _bfRootLemn_ * _tNMortLemnNH4_;
_tNMortLemnNH4W_ = _tNMortLemnNH4_ - _tNMortLemnNH4S_;
_tNMortLemnDet_ = _tNMortLemn_ - _tNMortLemnNH4_;
_tNMortLemnDetW_ = _fDetWMortLemn_ * (1.0 - _bfRootLemn_) * _tNMortLemnDet_;
_tNMortLemnDetS_ = _tNMortLemnDet_ - _tNMortLemnDetW_;
_tNGrazLemnBird_ = _rNDLemn_ * _tDGrazLemnBird_;
_tNBedLemn_ = _tNMigrLemn_ + _tNUptLemn_ - _tNExcrLemn_ - _tNMortLemn_ - _tNGrazLemnBird_ - _tNManLemn_;
_rPDNymp_ = _sPNymp_ / (_sDNymp_+_NearZero_);
_rNDNymp_ = _sNNymp_ / (_sDNymp_+_NearZero_);
_tDMigrNymp_ = _kMigrNymp_ * (_cDNympIn_ - _sDNymp_);
_tPMigrNymp_ = _kMigrNymp_ * (_cPDNymp0_* _cDNympIn_ - _sPNymp_);
_tNMigrNymp_ = _kMigrNymp_ * (_cNDNymp0_* _cDNympIn_ - _sNNymp_);
_uFunTmProdNymp_ = _POW_ (_cQ10ProdNymp_ , (0.1 * (_uTm_ - _cTmRef_)));
_uFunTmRespNymp_ = _POW_ (_cQ10RespNymp_ , (0.1 * (_uTm_ - _cTmRef_)));
_aVPUptMaxCrNymp_ = _MAX_( 0.0, _cVPUptMaxNymp_ * _uFunTmProdNymp_ * (_cPDNympMax_-_rPDNymp_) / (_cPDNympMax_-_cPDNympMin_) );
_aVPUptNympW_ = _sPO4W_ * _aVPUptMaxCrNymp_ / (_aVPUptMaxCrNymp_ / _cAffPUptNymp_ + _sPO4W_);
_tPUptNympW_ = _aVPUptNympW_ * (_aDSubNymp_ + _aDFloatNymp_);
_aVPUptNympS_ = _oPO4S_ * _aVPUptMaxCrNymp_ / (_aVPUptMaxCrNymp_ / _cAffPUptNymp_ + _oPO4S_);
_tPUptNympS_ = _aVPUptNympS_ * _aDRootNymp_;
_tPUptNymp_ = _tPUptNympW_ + _tPUptNympS_;
_aVNUptMaxCrNymp_ = _MAX_( 0.0, _cVNUptMaxNymp_ * _uFunTmProdNymp_ * (_cNDNympMax_ - _rNDNymp_) / (_cNDNympMax_ - _cNDNympMin_));
_ahNUptNymp_ = _aVNUptMaxCrNymp_ / _cAffNUptNymp_;
_aVNUptNympW_ = _oNDissW_ * _aVNUptMaxCrNymp_ / (_ahNUptNymp_ + _oNDissW_);
_tNUptNympW_ = _aVNUptNympW_ * (_aDSubNymp_ + _aDFloatNymp_);
_afNH4UptNympW_ = _sNH4W_ * _sNO3W_ / ((_ahNUptNymp_ + _sNH4W_) * (_ahNUptNymp_ + _sNO3W_ +_NearZero_)) + _sNH4W_ * _ahNUptNymp_ / ((_sNH4W_ + _sNO3W_ +_NearZero_) * (_ahNUptNymp_ + _sNO3W_ +_NearZero_));
_tNUptNH4NympW_ = _afNH4UptNympW_ * _tNUptNympW_;
_tNUptNO3NympW_ = _tNUptNympW_ - _tNUptNH4NympW_;
_aVNUptNympS_ = _oNDissS_ * _aVNUptMaxCrNymp_ / (_ahNUptNymp_ + _oNDissS_);
_tNUptNympS_ = _aVNUptNympS_ * _aDRootNymp_;
_afNH4UptNympS_ = _oNH4S_ * _oNO3S_ / ((_ahNUptNymp_ + _oNH4S_ +_NearZero_) * (_ahNUptNymp_ + _oNO3S_ +_NearZero_)) + _oNH4S_ * _ahNUptNymp_ / ((_oNH4S_ + _oNO3S_+_NearZero_) * (_ahNUptNymp_ + _oNO3S_+_NearZero_));
_tNUptNH4NympS_ = _afNH4UptNympS_ * _tNUptNympS_;
_tNUptNO3NympS_ = _tNUptNympS_ - _tNUptNH4NympS_;
_tNUptNymp_ = _tNUptNympW_ + _tNUptNympS_;
_aLPAR1Nymp_ = _uLPAR0_ * _EXP_(- _aExtCoefOpen_ * _aDepth1Nymp_);
_aLPAR2Nymp_ = _aLPAR1Nymp_ * _EXP_(- _aExtCoef_ * (_aDepth2Nymp_ - _aDepth1Nymp_));
_uhLNymp_ = _hLRefNymp_ * _uFunTmProdNymp_;
_aLLimShootNymp_ = _fEmergNymp_ + _fFloatNymp_ * (1.0 - _afCovEmergVeg_) + _bfSubNymp_ * (1.0 - _afCovSurfVeg_) * 1.0 / (_aExtCoef_ * _sDepthW_) * _LN_( (1.0 + _aLPAR1Nymp_ / _uhLNymp_) / (1.0 + _aLPAR2Nymp_ / _uhLNymp_));
_aMuTmLNymp_ = _ufDay_ * _bfShootNymp_ * _aLLimShootNymp_ * _uFunTmProdNymp_ * _cMuMaxNymp_;
_aPLimNymp_ = _MAX_(0.0, (1.0 - _cPDNympMin_ / (_rPDNymp_ + _NearZero_)) * _cPDNympMax_ / (_cPDNympMax_ - _cPDNympMin_));
_aNLimNymp_ = _MAX_(0.0, (1.0 - _cNDNympMin_ / (_rNDNymp_ + _NearZero_)) * _cNDNympMax_ / (_cNDNympMax_ - _cNDNympMin_));
_aNutLimNymp_ = _MIN_( _aPLimNymp_, _aNLimNymp_);
_aMuNymp_ = _aMuTmLNymp_ * _aNutLimNymp_;
_bkMortNymp_ = _IF_ (_Day_ _LT_ _cDayWinNymp_) _THEN_ _kMortNympSum_ _ELSEIF_ (_Day_ _LT_ _cDayWinNymp_ + _cLengMort_) _THEN_ - _LN_(_fWinNymp_) / _cLengMort_ _ELSE_ _kMortNympSum_ _ENDIF_;
_akDIncrNymp_ = _aMuTmLNymp_ - _kDRespNymp_ * _uFunTmRespNymp_ - _bkMortNymp_;
_tDEnvNymp_ = _MAX_(0.0, _akDIncrNymp_ / (_cDCarrNymp_+_NearZero_) * _sDNymp_*_sDNymp_);
_tDEnvProdNymp_ = _aMuNymp_ / _cMuMaxNymp_ * _tDEnvNymp_;
_tDProdNymp_ = _MAX_(0.0, _aMuNymp_ * _sDNymp_ - _tDEnvProdNymp_);
_tDProdSubNymp_ = _bfSubNymp_ * _tDProdNymp_;
_tDRespNymp_ = _kDRespNymp_ * _uFunTmRespNymp_ * _sDNymp_;
_tDEnvMortNymp_ = _tDEnvNymp_ - _tDEnvProdNymp_;
_tDMortNymp_ = _bkMortNymp_ * _sDNymp_ + _tDEnvMortNymp_;
_tDMortNympW_ = _fDetWMortNymp_ * (1.0 - _bfRootNymp_) * _tDMortNymp_;
_tDMortNympS_ = _tDMortNymp_ - _tDMortNympW_;
_tDGrazNympBird_ = _IF_ ( (_sTime_ _GE_ _cYearStartBirds_ * _DaysPerYear_) _AND_ (_Day_ _GE_ _cDayStartBirds_) _AND_ (_Day_ _LE_ _cDayEndBirds_) ) _THEN_ _cPrefNympBird_ * _sDNymp_ / (_hDVegBird_ + _sDNymp_) * _cBirdsPerha_ / _m2Perha_ * _cDGrazPerBird_ _ELSE_ 0.0 _ENDIF_;
_bkManNymp_ = _IF_ ((_Day_ _GE_ _cDayManVeg1_ _AND_ _Day_ _LT_ _cDayManVeg1_ + _cLengMan_) _OR_ (_Day_ _GE_ _cDayManVeg2_ _AND_ _Day_ _LT_ _cDayManVeg2_ + _cLengMan_)) _THEN_ -_LN_(1.0 - _fManNymp_) / _cLengMan_ _ELSE_ 0.0 _ENDIF_;
_tDManNymp_ = _bkManNymp_ * _sDNymp_;
_tPManNymp_ = _rPDNymp_ * _tDManNymp_;
_tNManNymp_ = _rNDNymp_ * _tDManNymp_;
_tDBedNymp_ = _tDMigrNymp_ + _tDProdNymp_ - _tDRespNymp_ - _tDMortNymp_ - _tDGrazNympBird_ - _tDManNymp_;
_tO2ProdNymp_ = _molO2molC_ * _cCPerDW_ * _tDProdNymp_;
_tO2RespNympW_ = _molO2molC_ * _cCPerDW_ * _bfSubNymp_ * _tDRespNymp_ * _aCorO2BOD_;
_tO2RespNympS_ = _molO2molC_ * _cCPerDW_ * _bfRootNymp_ * _tDRespNymp_ * _afOxySed_;
_tO2ProdNympS_ = _MIN_ (_tO2RespNympS_, _tO2ProdNymp_);
_tO2ProdNympW_ = _MIN_( _tO2ProdNymp_ - _tO2ProdNympS_, _bfSubNymp_ * _tO2ProdNymp_);
_tO2UptNO3NympW_ = _O2PerNO3_ * _molO2molN_ * _bfSubNymp_ * _tNUptNO3NympW_;
_tO2UptNO3NympS_ = _O2PerNO3_ * _molO2molN_ * _tNUptNO3NympS_;
_tPExcrNymp_ = (2.0*_rPDNymp_) / (_cPDNympMax_ + _rPDNymp_) * _rPDNymp_ * _tDRespNymp_;
_tPExcrNympS_ = _bfRootNymp_ * _tPExcrNymp_;
_tPExcrNympW_ = _tPExcrNymp_ - _tPExcrNympS_;
_tPMortNymp_ = _rPDNymp_ * _tDMortNymp_;
_tPMortNympPO4_ = _fDissMortVeg_ * _tPMortNymp_;
_tPMortNympPO4S_ = _bfRootNymp_ * _tPMortNympPO4_;
_tPMortNympPO4W_ = _tPMortNympPO4_ - _tPMortNympPO4S_;
_tPMortNympDet_ = _tPMortNymp_ - _tPMortNympPO4_;
_tPMortNympDetW_ = _fDetWMortNymp_ * (1.0 - _bfRootNymp_) * _tPMortNympDet_;
_tPMortNympDetS_ = _tPMortNympDet_ - _tPMortNympDetW_;
_tPGrazNympBird_ = _rPDNymp_ * _tDGrazNympBird_;
_tPBedNymp_ = _tPMigrNymp_ + _tPUptNymp_ - _tPExcrNymp_ - _tPMortNymp_ - _tPGrazNympBird_ - _tPManNymp_;
_tNExcrNymp_ = (2.0*_rNDNymp_) / (_cNDNympMax_ + _rNDNymp_) * _rNDNymp_ * _tDRespNymp_;
_tNExcrNympS_ = _bfRootNymp_ * _tNExcrNymp_;
_tNExcrNympW_ = _tNExcrNymp_ - _tNExcrNympS_;
_tNMortNymp_ = _rNDNymp_ * _tDMortNymp_;
_tNMortNympNH4_ = _fDissMortVeg_ * _tNMortNymp_;
_tNMortNympNH4S_ = _bfRootNymp_ * _tNMortNympNH4_;
_tNMortNympNH4W_ = _tNMortNympNH4_ - _tNMortNympNH4S_;
_tNMortNympDet_ = _tNMortNymp_ - _tNMortNympNH4_;
_tNMortNympDetW_ = _fDetWMortNymp_ * (1.0 - _bfRootNymp_) * _tNMortNympDet_;
_tNMortNympDetS_ = _tNMortNympDet_ - _tNMortNympDetW_;
_tNGrazNympBird_ = _rNDNymp_ * _tDGrazNympBird_;
_tNBedNymp_ = _tNMigrNymp_ + _tNUptNymp_ - _tNExcrNymp_ - _tNMortNymp_ - _tNGrazNympBird_ - _tNManNymp_;
_rPDHelo_ = _sPHelo_ / (_sDHelo_+_NearZero_);
_rNDHelo_ = _sNHelo_ / (_sDHelo_+_NearZero_);
_tDMigrHelo_ = _kMigrHelo_ * (_cDHeloIn_ - _sDHelo_);
_tPMigrHelo_ = _kMigrHelo_ * (_cPDHelo0_* _cDHeloIn_ - _sPHelo_);
_tNMigrHelo_ = _kMigrHelo_ * (_cNDHelo0_* _cDHeloIn_ - _sNHelo_);
_uFunTmProdHelo_ = _POW_ (_cQ10ProdHelo_ , (0.1 * (_uTm_ - _cTmRef_)));
_uFunTmRespHelo_ = _POW_ (_cQ10RespHelo_ , (0.1 * (_uTm_ - _cTmRef_)));
_aVPUptMaxCrHelo_ = _MAX_( 0.0, _cVPUptMaxHelo_ * _uFunTmProdHelo_ * (_cPDHeloMax_-_rPDHelo_) / (_cPDHeloMax_-_cPDHeloMin_) );
_aVPUptHeloW_ = _sPO4W_ * _aVPUptMaxCrHelo_ / (_aVPUptMaxCrHelo_ / _cAffPUptHelo_ + _sPO4W_);
_tPUptHeloW_ = _aVPUptHeloW_ * (_aDSubHelo_ + _aDFloatHelo_);
_aVPUptHeloS_ = _oPO4S_ * _aVPUptMaxCrHelo_ / (_aVPUptMaxCrHelo_ / _cAffPUptHelo_ + _oPO4S_);
_tPUptHeloS_ = _aVPUptHeloS_ * _aDRootHelo_;
_tPUptHelo_ = _tPUptHeloW_ + _tPUptHeloS_;
_aVNUptMaxCrHelo_ = _MAX_( 0.0, _cVNUptMaxHelo_ * _uFunTmProdHelo_ * (_cNDHeloMax_ - _rNDHelo_) / (_cNDHeloMax_ - _cNDHeloMin_));
_ahNUptHelo_ = _aVNUptMaxCrHelo_ / _cAffNUptHelo_;
_aVNUptHeloW_ = _oNDissW_ * _aVNUptMaxCrHelo_ / (_ahNUptHelo_ + _oNDissW_);
_tNUptHeloW_ = _aVNUptHeloW_ * (_aDSubHelo_ + _aDFloatHelo_);
_afNH4UptHeloW_ = _sNH4W_ * _sNO3W_ / ((_ahNUptHelo_ + _sNH4W_) * (_ahNUptHelo_ + _sNO3W_ +_NearZero_)) + _sNH4W_ * _ahNUptHelo_ / ((_sNH4W_ + _sNO3W_ +_NearZero_) * (_ahNUptHelo_ + _sNO3W_ +_NearZero_));
_tNUptNH4HeloW_ = _afNH4UptHeloW_ * _tNUptHeloW_;
_tNUptNO3HeloW_ = _tNUptHeloW_ - _tNUptNH4HeloW_;
_aVNUptHeloS_ = _oNDissS_ * _aVNUptMaxCrHelo_ / (_ahNUptHelo_ + _oNDissS_);
_tNUptHeloS_ = _aVNUptHeloS_ * _aDRootHelo_;
_afNH4UptHeloS_ = _oNH4S_ * _oNO3S_ / ((_ahNUptHelo_ + _oNH4S_ +_NearZero_) * (_ahNUptHelo_ + _oNO3S_ +_NearZero_)) + _oNH4S_ * _ahNUptHelo_ / ((_oNH4S_ + _oNO3S_+_NearZero_) * (_ahNUptHelo_ + _oNO3S_+_NearZero_));
_tNUptNH4HeloS_ = _afNH4UptHeloS_ * _tNUptHeloS_;
_tNUptNO3HeloS_ = _tNUptHeloS_ - _tNUptNH4HeloS_;
_tNUptHelo_ = _tNUptHeloW_ + _tNUptHeloS_;
_aLPAR1Helo_ = _uLPAR0_ * _EXP_(- _aExtCoefOpen_ * _aDepth1Helo_);
_aLPAR2Helo_ = _aLPAR1Helo_ * _EXP_(- _aExtCoef_ * (_aDepth2Helo_ - _aDepth1Helo_));
_uhLHelo_ = _hLRefHelo_ * _uFunTmProdHelo_;
_aLLimShootHelo_ = _fEmergHelo_ + _fFloatHelo_ * (1.0 - _afCovEmergVeg_) + _bfSubHelo_ * (1.0 - _afCovSurfVeg_) * 1.0 / (_aExtCoef_ * _sDepthW_) * _LN_( (1.0 + _aLPAR1Helo_ / _uhLHelo_) / (1.0 + _aLPAR2Helo_ / _uhLHelo_));
_aMuTmLHelo_ = _ufDay_ * _bfShootHelo_ * _aLLimShootHelo_ * _uFunTmProdHelo_ * _cMuMaxHelo_;
_aPLimHelo_ = _MAX_(0.0, (1.0 - _cPDHeloMin_ / (_rPDHelo_ + _NearZero_)) * _cPDHeloMax_ / (_cPDHeloMax_ - _cPDHeloMin_));
_aNLimHelo_ = _MAX_(0.0, (1.0 - _cNDHeloMin_ / (_rNDHelo_ + _NearZero_)) * _cNDHeloMax_ / (_cNDHeloMax_ - _cNDHeloMin_));
_aNutLimHelo_ = _MIN_( _aPLimHelo_, _aNLimHelo_);
_aMuHelo_ = _aMuTmLHelo_ * _aNutLimHelo_;
_bkMortHelo_ = _IF_ (_Day_ _LT_ _cDayWinHelo_) _THEN_ _kMortHeloSum_ _ELSEIF_ (_Day_ _LT_ _cDayWinHelo_ + _cLengMort_) _THEN_ - _LN_(_fWinHelo_) / _cLengMort_ _ELSE_ _kMortHeloSum_ _ENDIF_;
_akDIncrHelo_ = _aMuTmLHelo_ - _kDRespHelo_ * _uFunTmRespHelo_ - _bkMortHelo_;
_tDEnvHelo_ = _MAX_(0.0, _akDIncrHelo_ / (_cDCarrHelo_+_NearZero_) * _sDHelo_*_sDHelo_);
_tDEnvProdHelo_ = _aMuHelo_ / _cMuMaxHelo_ * _tDEnvHelo_;
_tDProdHelo_ = _MAX_(0.0, _aMuHelo_ * _sDHelo_ - _tDEnvProdHelo_);
_tDProdSubHelo_ = _bfSubHelo_ * _tDProdHelo_;
_tDRespHelo_ = _kDRespHelo_ * _uFunTmRespHelo_ * _sDHelo_;
_tDEnvMortHelo_ = _tDEnvHelo_ - _tDEnvProdHelo_;
_tDMortHelo_ = _bkMortHelo_ * _sDHelo_ + _tDEnvMortHelo_;
_tDMortHeloW_ = _fDetWMortHelo_ * (1.0 - _bfRootHelo_) * _tDMortHelo_;
_tDMortHeloS_ = _tDMortHelo_ - _tDMortHeloW_;
_tDGrazHeloBird_ = _IF_ ( (_sTime_ _GE_ _cYearStartBirds_ * _DaysPerYear_) _AND_ (_Day_ _GE_ _cDayStartBirds_) _AND_ (_Day_ _LE_ _cDayEndBirds_) ) _THEN_ _cPrefHeloBird_ * _sDHelo_ / (_hDVegBird_ + _sDHelo_) * _cBirdsPerha_ / _m2Perha_ * _cDGrazPerBird_ _ELSE_ 0.0 _ENDIF_;
_bkManHelo_ = _IF_ ((_Day_ _GE_ _cDayManVeg1_ _AND_ _Day_ _LT_ _cDayManVeg1_ + _cLengMan_) _OR_ (_Day_ _GE_ _cDayManVeg2_ _AND_ _Day_ _LT_ _cDayManVeg2_ + _cLengMan_)) _THEN_ -_LN_(1.0 - _fManHelo_) / _cLengMan_ _ELSE_ 0.0 _ENDIF_;
_tDManHelo_ = _bkManHelo_ * _sDHelo_;
_tPManHelo_ = _rPDHelo_ * _tDManHelo_;
_tNManHelo_ = _rNDHelo_ * _tDManHelo_;
_tDBedHelo_ = _tDMigrHelo_ + _tDProdHelo_ - _tDRespHelo_ - _tDMortHelo_ - _tDGrazHeloBird_ - _tDManHelo_;
_tO2ProdHelo_ = _molO2molC_ * _cCPerDW_ * _tDProdHelo_;
_tO2RespHeloW_ = _molO2molC_ * _cCPerDW_ * _bfSubHelo_ * _tDRespHelo_ * _aCorO2BOD_;
_tO2RespHeloS_ = _molO2molC_ * _cCPerDW_ * _bfRootHelo_ * _tDRespHelo_ * _afOxySed_;
_tO2ProdHeloS_ = _MIN_ (_tO2RespHeloS_, _tO2ProdHelo_);
_tO2ProdHeloW_ = _MIN_( _tO2ProdHelo_ - _tO2ProdHeloS_, _bfSubHelo_ * _tO2ProdHelo_);
_tO2UptNO3HeloW_ = _O2PerNO3_ * _molO2molN_ * _bfSubHelo_ * _tNUptNO3HeloW_;
_tO2UptNO3HeloS_ = _O2PerNO3_ * _molO2molN_ * _tNUptNO3HeloS_;
_tPExcrHelo_ = (2.0*_rPDHelo_) / (_cPDHeloMax_ + _rPDHelo_) * _rPDHelo_ * _tDRespHelo_;
_tPExcrHeloS_ = _bfRootHelo_ * _tPExcrHelo_;
_tPExcrHeloW_ = _tPExcrHelo_ - _tPExcrHeloS_;
_tPMortHelo_ = _rPDHelo_ * _tDMortHelo_;
_tPMortHeloPO4_ = _fDissMortVeg_ * _tPMortHelo_;
_tPMortHeloPO4S_ = _bfRootHelo_ * _tPMortHeloPO4_;
_tPMortHeloPO4W_ = _tPMortHeloPO4_ - _tPMortHeloPO4S_;
_tPMortHeloDet_ = _tPMortHelo_ - _tPMortHeloPO4_;
_tPMortHeloDetW_ = _fDetWMortHelo_ * (1.0 - _bfRootHelo_) * _tPMortHeloDet_;
_tPMortHeloDetS_ = _tPMortHeloDet_ - _tPMortHeloDetW_;
_tPGrazHeloBird_ = _rPDHelo_ * _tDGrazHeloBird_;
_tPBedHelo_ = _tPMigrHelo_ + _tPUptHelo_ - _tPExcrHelo_ - _tPMortHelo_ - _tPGrazHeloBird_ - _tPManHelo_;
_tNExcrHelo_ = (2.0*_rNDHelo_) / (_cNDHeloMax_ + _rNDHelo_) * _rNDHelo_ * _tDRespHelo_;
_tNExcrHeloS_ = _bfRootHelo_ * _tNExcrHelo_;
_tNExcrHeloW_ = _tNExcrHelo_ - _tNExcrHeloS_;
_tNMortHelo_ = _rNDHelo_ * _tDMortHelo_;
_tNMortHeloNH4_ = _fDissMortVeg_ * _tNMortHelo_;
_tNMortHeloNH4S_ = _bfRootHelo_ * _tNMortHeloNH4_;
_tNMortHeloNH4W_ = _tNMortHeloNH4_ - _tNMortHeloNH4S_;
_tNMortHeloDet_ = _tNMortHelo_ - _tNMortHeloNH4_;
_tNMortHeloDetW_ = _fDetWMortHelo_ * (1.0 - _bfRootHelo_) * _tNMortHeloDet_;
_tNMortHeloDetS_ = _tNMortHeloDet_ - _tNMortHeloDetW_;
_tNGrazHeloBird_ = _rNDHelo_ * _tDGrazHeloBird_;
_tNBedHelo_ = _tNMigrHelo_ + _tNUptHelo_ - _tNExcrHelo_ - _tNMortHelo_ - _tNGrazHeloBird_ - _tNManHelo_;
_tDMigrVeg_ = _tDMigrElod_ + _tDMigrChar_ + _tDMigrCera_ + _tDMigrLemn_ + _tDMigrNymp_ + _tDMigrHelo_;
_tPMigrVeg_ = _tPMigrElod_ + _tPMigrChar_ + _tPMigrCera_ + _tPMigrLemn_ + _tPMigrNymp_ + _tPMigrHelo_;
_tNMigrVeg_ = _tNMigrElod_ + _tNMigrChar_ + _tNMigrCera_ + _tNMigrLemn_ + _tNMigrNymp_ + _tNMigrHelo_;
_tDProdVeg_ = _tDProdElod_ + _tDProdChar_ + _tDProdCera_ + _tDProdLemn_ + _tDProdNymp_ + _tDProdHelo_;
_tPUptVegW_ = _tPUptElodW_ + _tPUptCharW_ + _tPUptCeraW_ + _tPUptLemnW_ + _tPUptNympW_ + _tPUptHeloW_;
_tPUptVegS_ = _tPUptElodS_ + _tPUptCharS_ + _tPUptCeraS_ + _tPUptLemnS_ + _tPUptNympS_ + _tPUptHeloS_;
_tNUptNH4VegW_ = _tNUptNH4ElodW_ + _tNUptNH4CharW_ + _tNUptNH4CeraW_ + _tNUptNH4LemnW_ + _tNUptNH4NympW_ + _tNUptNH4HeloW_;
_tNUptNH4VegS_ = _tNUptNH4ElodS_ + _tNUptNH4CharS_ + _tNUptNH4CeraS_ + _tNUptNH4LemnS_ + _tNUptNH4NympS_ + _tNUptNH4HeloS_;
_tNUptNO3VegW_ = _tNUptNO3ElodW_ + _tNUptNO3CharW_ + _tNUptNO3CeraW_ + _tNUptNO3LemnW_ + _tNUptNO3NympW_ + _tNUptNO3HeloW_;
_tNUptNO3VegS_ = _tNUptNO3ElodS_ + _tNUptNO3CharS_ + _tNUptNO3CeraS_ + _tNUptNO3LemnS_ + _tNUptNO3NympS_ + _tNUptNO3HeloS_;
_tDRespVeg_ = _tDRespElod_ + _tDRespChar_ + _tDRespCera_ + _tDRespLemn_ + _tDRespNymp_ + _tDRespHelo_;
_tPExcrVegW_ = _tPExcrElodW_ + _tPExcrCharW_ + _tPExcrCeraW_ + _tPExcrLemnW_ + _tPExcrNympW_ + _tPExcrHeloW_;
_tPExcrVegS_ = _tPExcrElodS_ + _tPExcrCharS_ + _tPExcrCeraS_ + _tPExcrLemnS_ + _tPExcrNympS_ + _tPExcrHeloS_;
_tNExcrVegW_ = _tNExcrElodW_ + _tNExcrCharW_ + _tNExcrCeraW_ + _tNExcrLemnW_ + _tNExcrNympW_ + _tNExcrHeloW_;
_tNExcrVegS_ = _tNExcrElodS_ + _tNExcrCharS_ + _tNExcrCeraS_ + _tNExcrLemnS_ + _tNExcrNympS_ + _tNExcrHeloS_;
_tO2ProdVeg_ = _tO2ProdElod_ + _tO2ProdChar_ + _tO2ProdCera_ + _tO2ProdLemn_ + _tO2ProdNymp_ + _tO2ProdHelo_;
_tO2ProdVegW_ = _tO2ProdElodW_ + _tO2ProdCharW_ + _tO2ProdCeraW_ + _tO2ProdLemnW_ + _tO2ProdNympW_ + _tO2ProdHeloW_;
_tO2ProdVegS_ = _tO2ProdElodS_ + _tO2ProdCharS_ + _tO2ProdCeraS_ + _tO2ProdLemnS_ + _tO2ProdNympS_ + _tO2ProdHeloS_;
_tO2RespVegW_ = _tO2RespElodW_ + _tO2RespCharW_ + _tO2RespCeraW_ + _tO2RespLemnW_ + _tO2RespNympW_ + _tO2RespHeloW_;
_tO2RespVegS_ = _tO2RespElodS_ + _tO2RespCharS_ + _tO2RespCeraS_ + _tO2RespLemnS_ + _tO2RespNympS_ + _tO2RespHeloS_;
_tO2UptNO3VegW_ = _tO2UptNO3ElodW_ + _tO2UptNO3CharW_ + _tO2UptNO3CeraW_ + _tO2UptNO3LemnW_ + _tO2UptNO3NympW_ + _tO2UptNO3HeloW_;
_tO2UptNO3VegS_ = _tO2UptNO3ElodS_ + _tO2UptNO3CharS_ + _tO2UptNO3CeraS_ + _tO2UptNO3LemnS_ + _tO2UptNO3NympS_ + _tO2UptNO3HeloS_;
_tDMortVegW_ = _tDMortElodW_ + _tDMortCharW_ + _tDMortCeraW_ + _tDMortLemnW_ + _tDMortNympW_ + _tDMortHeloW_;
_tDMortVegS_ = _tDMortElodS_ + _tDMortCharS_ + _tDMortCeraS_ + _tDMortLemnS_ + _tDMortNympS_ + _tDMortHeloS_;
_tPMortVegPO4W_ = _tPMortElodPO4W_ + _tPMortCharPO4W_ + _tPMortCeraPO4W_ + _tPMortLemnPO4W_ + _tPMortNympPO4W_ + _tPMortHeloPO4W_;
_tPMortVegDetW_ = _tPMortElodDetW_ + _tPMortCharDetW_ + _tPMortCeraDetW_ + _tPMortLemnDetW_ + _tPMortNympDetW_ + _tPMortHeloDetW_;
_tPMortVegPO4S_ = _tPMortElodPO4S_ + _tPMortCharPO4S_ + _tPMortCeraPO4S_ + _tPMortLemnPO4S_ + _tPMortNympPO4S_ + _tPMortHeloPO4S_;
_tPMortVegDetS_ = _tPMortElodDetS_ + _tPMortCharDetS_ + _tPMortCeraDetS_ + _tPMortLemnDetS_ + _tPMortNympDetS_ + _tPMortHeloDetS_;
_tNMortVegNH4W_ = _tNMortElodNH4W_ + _tNMortCharNH4W_ + _tNMortCeraNH4W_ + _tNMortLemnNH4W_ + _tNMortNympNH4W_ + _tNMortHeloNH4W_;
_tNMortVegDetW_ = _tNMortElodDetW_ + _tNMortCharDetW_ + _tNMortCeraDetW_ + _tNMortLemnDetW_ + _tNMortNympDetW_ + _tNMortHeloDetW_;
_tNMortVegNH4S_ = _tNMortElodNH4S_ + _tNMortCharNH4S_ + _tNMortCeraNH4S_ + _tNMortLemnNH4S_ + _tNMortNympNH4S_ + _tNMortHeloNH4S_;
_tNMortVegDetS_ = _tNMortElodDetS_ + _tNMortCharDetS_ + _tNMortCeraDetS_ + _tNMortLemnDetS_ + _tNMortNympDetS_ + _tNMortHeloDetS_;
_tDGrazVegBird_ = _tDGrazElodBird_ + _tDGrazCharBird_ + _tDGrazCeraBird_ + _tDGrazLemnBird_ + _tDGrazNympBird_ + _tDGrazHeloBird_;
_tPGrazVegBird_ = _tPGrazElodBird_ + _tPGrazCharBird_ + _tPGrazCeraBird_ + _tPGrazLemnBird_ + _tPGrazNympBird_ + _tPGrazHeloBird_;
_tNGrazVegBird_ = _tNGrazElodBird_ + _tNGrazCharBird_ + _tNGrazCeraBird_ + _tNGrazLemnBird_ + _tNGrazNympBird_ + _tNGrazHeloBird_;
_tDManVeg_ = _tDManElod_ + _tDManChar_ + _tDManCera_ + _tDManLemn_ + _tDManNymp_ + _tDManHelo_;
_tPManVeg_ = _tPManElod_ + _tPManChar_ + _tPManCera_ + _tPManLemn_ + _tPManNymp_ + _tPManHelo_;
_tNManVeg_ = _tNManElod_ + _tNManChar_ + _tNManCera_ + _tNManLemn_ + _tNManNymp_ + _tNManHelo_;
_aCovSub_ = _MIN_(100.0,_aCovElod_ + _aCovChar_ + _aCovCera_);
_tDAssVegBird_ = _fDAssBird_ * _tDGrazVegBird_;
_tDEgesBird_ = _tDGrazVegBird_ - _tDAssVegBird_;
_tPAssVegBird_ = _fDAssBird_ * _tPGrazVegBird_;
_tPEgesBird_ = _tPGrazVegBird_ - _tPAssVegBird_;
_tPEgesBirdPO4_ = _fDissEgesBird_ * _tPEgesBird_;
_tPEgesBirdDet_ = _tPEgesBird_ - _tPEgesBirdPO4_;
_tNAssVegBird_ = _fDAssBird_ * _tNGrazVegBird_;
_tNEgesBird_ = _tNGrazVegBird_ - _tNAssVegBird_;
_tNEgesBirdNH4_ = _fDissEgesBird_ * _tNEgesBird_;
_tNEgesBirdDet_ = _tNEgesBird_ - _tNEgesBirdNH4_;
_wDBedDetW_ = (_tDMortVegW_ + _tDEgesBird_) / _sDepthW_;
_tDBedDetS_ = _tDMortVegS_;
_tDBedTotT_ = _tDMigrVeg_ + _tDProdVeg_ - _tDRespVeg_ - _tDManVeg_ - _tDAssVegBird_;
_wPBedPO4W_ = (- _tPUptVegW_ + _tPExcrVegW_ + _tPMortVegPO4W_ + _tPEgesBirdPO4_) /_sDepthW_;
_wPBedDetW_ = (_tPMortVegDetW_ + _tPEgesBirdDet_) / _sDepthW_;
_tPBedPO4S_ = - _tPUptVegS_ + _tPExcrVegS_ + _tPMortVegPO4S_;
_tPBedDetS_ = _tPMortVegDetS_;
_tPBedTotT_ = _tPMigrVeg_ - _tPManVeg_ - _tPAssVegBird_;
_wNBedNH4W_ = (- _tNUptNH4VegW_ + _tNExcrVegW_ + _tNMortVegNH4W_ + _tNEgesBirdNH4_) / _sDepthW_;
_wNBedNO3W_ = - _tNUptNO3VegW_ / _sDepthW_;
_wNBedDetW_ = (_tNMortVegDetW_ + _tNEgesBirdDet_) / _sDepthW_;
_tNBedNH4S_ = - _tNUptNH4VegS_ + _tNExcrVegS_ + _tNMortVegNH4S_;
_tNBedNO3S_ = - _tNUptNO3VegS_;
_tNBedDetS_ = _tNMortVegDetS_;
_tNBedTotT_ = _tNMigrVeg_ - _tNManVeg_ - _tNAssVegBird_;
_tO2BedW_ = _tO2ProdVegW_ - _tO2RespVegW_ + _tO2UptNO3VegW_;
_tO2BedS_ = _tO2ProdVegS_ - _tO2RespVegS_ + _tO2UptNO3VegS_;
_UseLoss_ = 1.0;
_uFunTmLoss_ = _EXP_(-0.5/(_cSigTmLoss_*_cSigTmLoss_) *(((_uTm_-_cTmOptLoss_)*(_uTm_-_cTmOptLoss_)) -(_cTmRef_-_cTmOptLoss_)*(_cTmRef_-_cTmOptLoss_)));
_rPDPhytW_ = _sPPhytW_ /(_sDPhytW_+_NearZero_);
_rNDPhytW_ = _sNPhytW_ /(_sDPhytW_+_NearZero_);
_rPDPhytS_ = _sPPhytS_ /(_sDPhytS_+_NearZero_);
_rNDPhytS_ = _sNPhytS_ /(_sDPhytS_+_NearZero_);
_uFunTmPhyt_ = _EXP_(-0.5/(_cSigTmPhyt_*_cSigTmPhyt_) *((_uTm_-_cTmOptPhyt_)*(_uTm_-_cTmOptPhyt_) - (_cTmRef_-_cTmOptPhyt_)*(_cTmRef_-_cTmOptPhyt_)));
_uFunTmProdPhyt_ = _uFunTmPhyt_;
_uFunTmRespPhyt_ = _uFunTmPhyt_;
_aVPUptMaxCrPhyt_ = _MAX_(0.0,_cVPUptMaxPhyt_ * _uFunTmProdPhyt_ *(_cPDPhytMax_ - _rPDPhytW_) /(_cPDPhytMax_ - _cPDPhytMin_));
_aVPUptPhyt_ = _sPO4W_ * _aVPUptMaxCrPhyt_ /(_aVPUptMaxCrPhyt_ / _cAffPUptPhyt_ + _sPO4W_);
_wPUptPhyt_ = _aVPUptPhyt_ * _sDPhytW_;
_aVNUptMaxCrPhyt_ = _MAX_(0.0,_cVNUptMaxPhyt_ * _uFunTmProdPhyt_ * (_cNDPhytMax_ - _rNDPhytW_) /(_cNDPhytMax_ - _cNDPhytMin_));
_ahNUptPhyt_ = _aVNUptMaxCrPhyt_ / _cAffNUptPhyt_;
_aVNUptPhyt_ = _oNDissW_ * _aVNUptMaxCrPhyt_ /(_ahNUptPhyt_ + _oNDissW_);
_wNUptPhyt_ = _aVNUptPhyt_ * _sDPhytW_;
_afNH4UptPhyt_ = _sNH4W_ * _sNO3W_ /((_ahNUptPhyt_ + _sNH4W_) *(_ahNUptPhyt_ + _sNO3W_)) + _sNH4W_ * _ahNUptPhyt_ /((_sNH4W_ + _sNO3W_) *(_ahNUptPhyt_ + _sNO3W_));
_wNUptNH4Phyt_ = _afNH4UptPhyt_ * _wNUptPhyt_;
_wNUptNO3Phyt_ = _wNUptPhyt_ - _wNUptNH4Phyt_;
_uMuMaxTmPhyt_ = _cMuMaxPhyt_ * _uFunTmProdPhyt_;
_aPLimPhyt_ = _MAX_(0.0,(1.0 - _cPDPhytMin_ / (_rPDPhytW_ + _NearZero_)) * _cPDPhytMax_ /(_cPDPhytMax_ - _cPDPhytMin_));
_aNLimPhyt_ = _MAX_(0.0,(1.0 - _cNDPhytMin_ / (_rNDPhytW_ + _NearZero_)) * _cNDPhytMax_ /(_cNDPhytMax_ - _cNDPhytMin_));
_aLLimPhyt_ = _UseSteelePhyt_ *(_EXP_(1.0) /(_aExtCoef_ * _sDepthW_) *(_EXP_(- _aLPARBot_ /(_cLOptRefPhyt_ * _uFunTmProdPhyt_)) - _EXP_(- _uLPAR0_ /(_cLOptRefPhyt_ * _uFunTmProdPhyt_)))) +(1.0 - _UseSteelePhyt_) *(1.0 /(_aExtCoef_ * _sDepthW_) * _LN_((1.0 + _uLPAR0_ / (_hLRefPhyt_ * _uFunTmProdPhyt_)) / (1.0 + _aLPARBot_ /(_hLRefPhyt_ * _uFunTmProdPhyt_))));
_aMuTmLPhyt_ = _ufDay_ *(1.0 - _afCovSurfVeg_) * _aLLimPhyt_ * _uMuMaxTmPhyt_;
_aNutLimPhyt_ = _MIN_(_aPLimPhyt_,_aNLimPhyt_);
_aMuPhyt_ = _aNutLimPhyt_ * _aMuTmLPhyt_;
_wDAssPhyt_ = _aMuPhyt_*_sDPhytW_;
_rChDPhyt_ = _cChDPhytMax_ -(_cChDPhytMax_ - _cChDPhytMin_) * _aLLimPhyt_;
_oChlaPhyt_ = _mgPerg_ * _rChDPhyt_ * _sDPhytW_;
_aExtChPhyt_ = _cExtSpPhyt_ / _rChDPhyt_;
_ukDRespTmPhyt_ = _kDRespPhyt_ * _uFunTmRespPhyt_;
_wDRespPhytW_ = _ukDRespTmPhyt_ * _sDPhytW_;
_ukLossTmPhyt_ = _UseLoss_ * _kLossPhyt_ * _uFunTmLoss_;
_wDLossPhyt_ = _ukLossTmPhyt_ * _sDPhytW_;
_wDMortPhytW_ = _kMortPhytW_ * _sDPhytW_;
_uCorVSetPhyt_ = _cVSetPhyt_ * _aFunTauSetOM_ * _uFunTmSet_;
_tDSetPhyt_ = _uCorVSetPhyt_ * _sDPhytW_;
_tDResusPhyt_ = _sDPhytS_ /(_aDPhytS_+_NearZero_) * _tDResusPhytTot_;
_tDRespPhytS_ = _ukDRespTmPhyt_ * _sDPhytS_;
_tDMortPhytS_ = _kMortPhytS_ * _sDPhytS_;
_ukDDecPhyt_ = _ukDRespTmPhyt_ + _ukLossTmPhyt_ + _kMortPhytW_ +(_uCorVSetPhyt_ * _uFunTmSet_) / _sDepthW_;
_wPExcrPhytW_ = (2.0*_rPDPhytW_) /(_cPDPhytMax_ + _rPDPhytW_) * _rPDPhytW_ * _wDRespPhytW_;
_wPLossPhyt_ = _rPDPhytW_ * _wDLossPhyt_;
_wPMortPhytW_ = _wDMortPhytW_ * _rPDPhytW_;
_tPSetPhyt_ = _rPDPhytW_ * _tDSetPhyt_;
_tPResusPhyt_ = _rPDPhytS_ * _tDResusPhyt_;
_tPExcrPhytS_ = (2.0*_rPDPhytS_) /(_cPDPhytMax_ + _rPDPhytS_) * _rPDPhytS_ * _tDRespPhytS_;
_tPMortPhytS_ = _tDMortPhytS_ * _rPDPhytS_;
_wNExcrPhytW_ = (2.0*_rNDPhytW_) /(_cNDPhytMax_ + _rNDPhytW_) * _rNDPhytW_ * _wDRespPhytW_;
_wNLossPhyt_ = _rNDPhytW_ * _wDLossPhyt_;
_wNMortPhytW_ = _wDMortPhytW_ * _rNDPhytW_;
_tNSetPhyt_ = _rNDPhytW_ * _tDSetPhyt_;
_tNResusPhyt_ = _rNDPhytS_ * _tDResusPhyt_;
_tNExcrPhytS_ = (2.0*_rNDPhytS_) /(_cNDPhytMax_ + _rNDPhytS_) * _rNDPhytS_ * _tDRespPhytS_;
_tNMortPhytS_ = _tDMortPhytS_ * _rNDPhytS_;
_wDPrimPhytW_ = _wDAssPhyt_ - _wDRespPhytW_ - _wDLossPhyt_ - _wDMortPhytW_ -(_tDSetPhyt_ - _tDResusPhyt_) / _sDepthW_;
_wPPrimPhytW_ = _wPUptPhyt_ - _wPExcrPhytW_ - _wPLossPhyt_ - _wPMortPhytW_ -(_tPSetPhyt_ - _tPResusPhyt_) / _sDepthW_;
_wNPrimPhytW_ = _wNUptPhyt_ - _wNExcrPhytW_ - _wNLossPhyt_ - _wNMortPhytW_ -(_tNSetPhyt_ - _tNResusPhyt_) / _sDepthW_;
_tDPrimPhytS_ = _tDSetPhyt_ - _tDResusPhyt_ - _tDMortPhytS_ - _tDRespPhytS_;
_tPPrimPhytS_ = _tPSetPhyt_ - _tPResusPhyt_ - _tPMortPhytS_ - _tPExcrPhytS_;
_tNPrimPhytS_ = _tNSetPhyt_ - _tNResusPhyt_ - _tNMortPhytS_ - _tNExcrPhytS_;
_oChla_ = _oChlaPhyt_;
_wDPrimDetW_ = _wDMortPhytW_ + _wDLossPhyt_;
_tDPrimDetS_ = _tDMortPhytS_;
_tDPrimTotT_ = (_wDAssPhyt_ - _wDRespPhytW_) * _sDepthW_ - _tDRespPhytS_;
_wO2ProdPhyt_ = _molO2molC_ * _cCPerDW_ * _wDAssPhyt_;
_wO2RespPhytW_ = _molO2molC_ * _cCPerDW_ * _wDRespPhytW_ * _aCorO2BOD_;
_wO2UptNO3Phyt_ = _O2PerNO3_ * _molO2molN_ * _wNUptNO3Phyt_;
_wO2PrimW_ = _wO2ProdPhyt_ - _wO2RespPhytW_ + _wO2UptNO3Phyt_;
_tO2RespPhytS_ = _molO2molC_ * _cCPerDW_ * _tDRespPhytS_ * _afOxySed_;
_tO2PrimS_ = _tO2RespPhytS_;
_wPMortPhytPO4W_ = _fDissMortPhyt_ * _wPMortPhytW_;
_wPMortPhytDetW_ = _wPMortPhytW_ - _wPMortPhytPO4W_;
_wPLossPhytPO4_ = _fDissLoss_ * _wPLossPhyt_;
_wPLossPhytDet_ = _wPLossPhyt_ - _wPLossPhytPO4_;
_wPPrimPO4W_ = - _wPUptPhyt_ + _wPExcrPhytW_ + _wPLossPhytPO4_ + _wPMortPhytPO4W_;
_wPPrimDetW_ = _wPLossPhytDet_ + _wPMortPhytDetW_;
_tPMortPhytPO4S_ = _fDissMortPhyt_ * _tPMortPhytS_;
_tPMortPhytDetS_ = _tPMortPhytS_ - _tPMortPhytPO4S_;
_tPPrimDetS_ = _tPMortPhytDetS_;
_tPPrimPO4S_ = _tPExcrPhytS_ + _tPMortPhytPO4S_;
_tPPrimTotT_ = 0.0;
_wNMortPhytNH4W_ = _fDissMortPhyt_ * _wNMortPhytW_;
_wNMortPhytDetW_ = _wNMortPhytW_ - _wNMortPhytNH4W_;
_wNLossPhytNH4_ = _fDissLoss_ * _wNLossPhyt_;
_wNLossPhytDet_ = _wNLossPhyt_ - _wNLossPhytNH4_;
_wNPrimNH4W_ = - _wNUptNH4Phyt_ + _wNExcrPhytW_ + _wNLossPhytNH4_ + _wNMortPhytNH4W_;
_wNPrimNO3W_ = - _wNUptNO3Phyt_;
_wNPrimDetW_ = _wNLossPhytDet_ + _wNMortPhytDetW_;
_tNMortPhytNH4S_ = _fDissMortPhyt_ * _tNMortPhytS_;
_tNMortPhytDetS_ = _tNMortPhytS_ - _tNMortPhytNH4S_;
_tNPrimNH4S_ = _tNExcrPhytS_ + _tNMortPhytNH4S_;
_tNPrimNO3S_ = 0.0;
_tNPrimDetS_ = _tNMortPhytDetS_;
_tNPrimTotT_ = 0.0;
_aPACoef_ = _cPACoefMin_ +(_cPACoefMax_ - _cPACoefMin_) * _hPACoef_ / (_hPACoef_ + _oDOMW_);
_bSecchiMax_ = _sDepthW_ + _cSecchiPlus_;
_aSecchi_ = _MIN_(_bSecchiMax_,_aPACoef_ / _aExtCoefOpen_);
_aDepthEuph_ = _cEuph_ * _aSecchi_;
_aRelDepthEuph_ = _aDepthEuph_ / _sDepthW_;
_aChlaH_ = _oChla_ * _sDepthW_;
_aCovPhytW_ = _cCovSpPhyt_ *(_oDPhytW_ * _sDepthW_);
_rExtChPhyt_ = _aExtPhyt_ /(_oChla_ / _mgPerg_ + _NearZero_);
_tDSetTot_ = _tDSetIM_ + _tDSetDet_ + _tDSetPhyt_;
_tPSetTot_ = _tPSetAIM_ + _tPSetDet_ + _tPSetPhyt_;
_tNSetTot_ = _tNSetDet_ + _tNSetPhyt_;
_tDResusTot_ = _tDResusDead_ + _tDResusPhytTot_;
_tPResusTot_ = _tPResusDet_ + _tPResusAIM_ + _tPResusPhyt_ + _tPResusPO4_;
_tNResusTot_ = _tNResusDet_ + _tNResusNH4_ + _tNResusNO3_ + _tNResusPhyt_;
_bTimeDred_ = _IF_ (_sTime_ _GE_ _cDredStart_ * _DaysPerYear_) _THEN_ (_FLOOR_(_TimeYears_/_cDredInterval_) * _cDredInterval_) * _DaysPerYear_ _ELSE_ -9999.999 _ENDIF_;
_aDepthStart_ = _IF_ (_sTime_ _EQ_ _bTimeDred_) _THEN_ _sDepthW_ _ELSE_ _aDepthStart_ _ENDIF_;
_akDredDepth_ = _IF_ ((_sTime_ _GE_ _bTimeDred_) _AND_ (_sTime_ _LT_ _bTimeDred_ + _cLengDred_) _AND_ (_aDepthStart_ _LE_ _cDepthRef_ - _cDepthS_)) _THEN_ (_LN_(_cDepthRef_ / _aDepthStart_)) / _cLengDred_ _ELSE_ 0.0 _ENDIF_;
_akDred_ = _IF_ ((_sTime_ _GE_ _bTimeDred_) _AND_(_sTime_ _LT_ _bTimeDred_ + _cLengDred_) _AND_(_aDepthStart_ _LE_ _cDepthRef_ - _cDepthS_)) _THEN_ (- _LN_(1.0 - _fEffDred_)) / _cLengDred_ _ELSE_ 0.0 _ENDIF_;
_akDredLemn_ = _IF_ ((_sTime_ _GE_ _bTimeDred_) _AND_(_sTime_ _LT_ _bTimeDred_ + _cLengDred_) _AND_(_aDepthStart_ _LE_ _cDepthRef_ - _cDepthS_)) _THEN_ (- _LN_(1.0 - _fEffDredLemn_)) / _cLengDred_ _ELSE_ 0.0 _ENDIF_;
_vDredDepthW_ = _akDredDepth_ * _sDepthW_;
_tDDredDetS_ = _akDred_ * _sDDetS_;
_tPDredDetS_ = _akDred_ * _sPDetS_;
_tNDredDetS_ = _akDred_ * _sNDetS_;
_tPDredAIMS_ = _akDred_ * _sPAIMS_;
_bRhoSolidSoil_ = _fDOrgSoil_ * _cRhoOM_ +(1 - _fDOrgSoil_) * _cRhoIM_;
_tDDredNetSoil_ = -(_tDDredDetS_ / _cRhoOM_) * _bRhoSolidSoil_;
_tDDredNetIMS_ = (1 - _fDOrgSoil_) * _tDDredNetSoil_;
_tDDredNetHumS_ = _fDOrgSoil_ * _tDDredNetSoil_;
_tPDredNetHumS_ = _cPDSoilOM_ * _tDDredNetHumS_;
_tNDredNetHumS_ = _cNDSoilOM_ * _tDDredNetHumS_;
_tDDredPhytS_ = _akDred_ * _sDPhytS_;
_tPDredPhytS_ = _akDred_ * _sPPhytS_;
_tNDredPhytS_ = _akDred_ * _sNPhytS_;
_tDDredElod_ = _akDred_ * _sDElod_;
_tPDredElod_ = _akDred_ * _sPElod_;
_tNDredElod_ = _akDred_ * _sNElod_;
_tDDredCera_ = _akDred_ * _sDCera_;
_tPDredCera_ = _akDred_ * _sPCera_;
_tNDredCera_ = _akDred_ * _sNCera_;
_tDDredChar_ = _akDred_ * _sDChar_;
_tPDredChar_ = _akDred_ * _sPChar_;
_tNDredChar_ = _akDred_ * _sNChar_;
_tDDredLemn_ = _akDredLemn_ * _sDLemn_;
_tPDredLemn_ = _akDredLemn_ * _sPLemn_;
_tNDredLemn_ = _akDredLemn_ * _sNLemn_;
_tDDredNymp_ = _akDred_ * _sDNymp_;
_tPDredNymp_ = _akDred_ * _sPNymp_;
_tNDredNymp_ = _akDred_ * _sNNymp_;
_tDDredHelo_ = _akDred_ * _sDHelo_;
_tPDredHelo_ = _akDred_ * _sPHelo_;
_tNDredHelo_ = _akDred_ * _sNHelo_;
_tDDredVeg_ = _tDDredElod_+_tDDredCera_+_tDDredChar_+_tDDredLemn_+_tDDredNymp_+_tDDredHelo_;
_tPDredVeg_ = _tPDredElod_+_tPDredCera_+_tPDredChar_+_tPDredLemn_+_tPDredNymp_+_tPDredHelo_;
_tNDredVeg_ = _tNDredElod_+_tNDredCera_+_tNDredChar_+_tNDredLemn_+_tNDredNymp_+_tNDredHelo_;
_tDDredNetTot_ = _tDDredDetS_ - _tDDredNetSoil_ + _tDDredPhytS_ + _tDDredVeg_;
_tPDredNetTot_ = _tPDredDetS_ - _tPDredNetHumS_ + _tPDredAIMS_ + _tPDredPhytS_ + _tPDredVeg_;
_tNDredNetTot_ = _tNDredDetS_ - _tNDredNetHumS_ + _tNDredPhytS_ + _tNDredVeg_;
_tDIMS_ = _tDAbioIMS_;
_tDHumS_ = _tDAbioHumS_;
_tDDetS_ = _tDAbioDetS_ + _tDPrimDetS_ + _tDBedDetS_;
_vDeltaS_ = (_tDIMS_ / _cRhoIM_ +(_tDHumS_ + _tDDetS_) / _cRhoOM_) /(1.0 - _bPorS_);
_tDBurIM_ = _IF_ (_vDeltaS_ _GE_ 0.0) _THEN_ ((_tDHumS_ + _tDDetS_) +(_cRhoOM_ / _cRhoIM_) * _tDIMS_) / ((_sDHumS_ + _sDDetS_) / _sDIMS_ + _cRhoOM_ / _cRhoIM_) _ELSE_ ((_tDHumS_ + _tDDetS_) +(_cRhoOM_ / _cRhoIM_) * _tDIMS_) / (_fDOrgSoil_ /(1.0 - _fDOrgSoil_) + _cRhoOM_ / _cRhoIM_) _ENDIF_;
_tDBurOM_ = _IF_ (_vDeltaS_ _GE_ 0.0) _THEN_ (_sDHumS_ + _sDDetS_) / _sDIMS_ * _tDBurIM_ _ELSE_ _fDOrgSoil_ /(1.0 - _fDOrgSoil_) * _tDBurIM_ _ENDIF_;
_tDBurDet_ = _IF_ (_vDeltaS_ _GE_ 0.0) _THEN_ _sDDetS_ /(_sDHumS_ + _sDDetS_) * _tDBurOM_ _ELSE_ 0.0 _ENDIF_;
_tDBurHum_ = _IF_ (_vDeltaS_ _GE_ 0.0) _THEN_ _tDBurOM_ - _tDBurDet_ _ELSE_ _tDBurOM_ _ENDIF_;
_tDBurTot_ = _IF_ (_vDeltaS_ _GE_ 0.0) _THEN_ _tDBurIM_ + _tDBurOM_ _ELSE_ _tDBurIM_ + _tDBurOM_ _ENDIF_;
_tPBurHum_ = _IF_ (_vDeltaS_ _GE_ 0.0) _THEN_ _rPDHumS_ * _tDBurHum_ _ELSE_ _cPDSoilOM_ * _tDBurHum_ _ENDIF_;
_tPBurDet_ = _IF_ (_vDeltaS_ _GE_ 0.0) _THEN_ _rPDDetS_ * _tDBurDet_ _ELSE_ 0.0 _ENDIF_;
_tPBurAIM_ = _IF_ (_vDeltaS_ _GE_ 0.0) _THEN_ _sPAIMS_ / _sDIMS_ * _tDBurIM_ _ELSE_ 0.0 _ENDIF_;
_tPBurPO4_ = _IF_ (_vDeltaS_ _GE_ 0.0) _THEN_ _sPO4S_ *(_vDeltaS_ / _cDepthS_) _ELSE_ _cPO4Ground_ *(_bPorS_ * _vDeltaS_) _ENDIF_;
_tPBurTot_ = _IF_ (_vDeltaS_ _GE_ 0.0) _THEN_ _tPBurDet_ + _tPBurHum_ + _tPBurAIM_ + _tPBurPO4_ _ELSE_ _tPBurHum_ + _tPBurAIM_ + _tPBurPO4_ _ENDIF_;
_tNBurHum_ = _IF_ (_vDeltaS_ _GE_ 0.0) _THEN_ _rNDHumS_ * _tDBurHum_ _ELSE_ _cNDSoilOM_ * _tDBurHum_ _ENDIF_;
_tNBurDet_ = _IF_ (_vDeltaS_ _GE_ 0.0) _THEN_ _rNDDetS_ * _tDBurDet_ _ELSE_ 0.0 _ENDIF_;
_tNBurNH4_ = _IF_ (_vDeltaS_ _GE_ 0.0) _THEN_ _sNH4S_ *(_vDeltaS_ / _cDepthS_) _ELSE_ _cNH4Ground_ *(_bPorS_ * _vDeltaS_) _ENDIF_;
_tNBurNO3_ = _IF_ (_vDeltaS_ _GE_ 0.0) _THEN_ _sNO3S_ *(_vDeltaS_ / _cDepthS_) _ELSE_ _cNO3Ground_ *(_bPorS_ * _vDeltaS_) _ENDIF_;
_tNBurTot_ = _IF_ (_vDeltaS_ _GE_ 0.0) _THEN_ _tNBurDet_ + _tNBurHum_ + _tNBurNH4_ + _tNBurNO3_ _ELSE_ _tNBurHum_ + _tNBurNH4_ + _tNBurNO3_ _ENDIF_;
_vDeltaW_ = _IF_ (_ConstDepth_ _EQ_ _TRUE_ ) _THEN_ 0.0 _ELSE_ - _vDeltaS_ _ENDIF_;
_aRelDeltaW_ = (_vDeltaW_ + _vDredDepthW_) / _sDepthW_;
_aDTotT_ =(_sDIMW_ + _sDDetW_ + _sDPhytW_) * _sDepthW_ + _aDVeg_ + _sDIMS_ + _sDHumS_ + _sDDetS_ + _aDPhytS_;
_aNTotT_ =(_sNH4W_ + _sNO3W_ + _sNDetW_ + _sNPhytW_) * _sDepthW_ + _aNVeg_ + _sNH4S_ + _sNO3S_ + _sNDetS_ + _sNHumS_ + _sNPhytS_;
_aPTotT_ =(_sPO4W_ + _sPDetW_ + _sPPhytW_ + _sPAIMW_) * _sDepthW_ + _aPVeg_ + _sPO4S_ + _sPDetS_ + _sPHumS_ + _sPPhytS_ + _sPAIMS_;
_aDError_ = _aDTotT_ - _sDExtTotT_;
_aNError_ = _aNTotT_ - _sNExtTotT_;
_aPError_ = _aPTotT_ - _sPExtTotT_;
