%model
defpermanent aDayInitVeg 367
defpermanent bDayInitPhra 367
defpermanent aDepthStart 0
defpermanent bDayRealPhra 367
defpermanent uDayWinVeg 367
defpermanent sTime
defpermanent MassHyp
defpermanent MassEpi
defpermanent MassWM
defpermanent oNH4WHyp
defpermanent oNO3WHyp
defpermanent oPO4WHyp
defpermanent oPAIMWHyp
defpermanent oSiO2WHyp
defpermanent oO2WHyp
defpermanent oDDetWHyp
defpermanent oNDetWHyp
defpermanent oPDetWHyp
defpermanent oSiDetWHyp
defpermanent oDIMWHyp
defpermanent oDDiatWHyp
defpermanent oNDiatWHyp
defpermanent oPDiatWHyp
defpermanent oDGrenWHyp
defpermanent oNGrenWHyp
defpermanent oPGrenWHyp
defpermanent oDBlueWHyp
defpermanent oNBlueWHyp
defpermanent oPBlueWHyp
defpermanent oDZooHyp
defpermanent oNZooHyp
defpermanent oPZooHyp
defpermanent oNH4WM
defpermanent oNO3WM
defpermanent oPO4WM
defpermanent oPAIMWM
defpermanent oSiO2WM
defpermanent oO2WM
defpermanent oDDetWM
defpermanent oNDetWM
defpermanent oPDetWM
defpermanent oSiDetWM
defpermanent oDIMWM
defpermanent oDDiatWM
defpermanent oNDiatWM
defpermanent oPDiatWM
defpermanent oDGrenWM
defpermanent oNGrenWM
defpermanent oPGrenWM
defpermanent oDBlueWM
defpermanent oNBlueWM
defpermanent oPBlueWM
defpermanent oDZooM
defpermanent oNZooM
defpermanent oPZooM
defpermanent oNH4WEpi
defpermanent oNO3WEpi
defpermanent oPO4WEpi
defpermanent oPAIMWEpi
defpermanent oSiO2WEpi
defpermanent oO2WEpi
defpermanent oDDetWEpi
defpermanent oNDetWEpi
defpermanent oPDetWEpi
defpermanent oSiDetWEpi
defpermanent oDIMWEpi
defpermanent oDDiatWEpi
defpermanent oNDiatWEpi
defpermanent oPDiatWEpi
defpermanent oDGrenWEpi
defpermanent oNGrenWEpi
defpermanent oPGrenWEpi
defpermanent oDBlueWEpi
defpermanent oNBlueWEpi
defpermanent oPBlueWEpi
defpermanent oDZooEpi
defpermanent oNZooEpi
defpermanent oPZooEpi
defpermanent TimeYears
defpermanent Day
defpermanent Years
defpermanent uDepthMix
defpermanent aInclStrat
defpermanent uDepthW
defpermanent uVegHeight
defpermanent uVegHeightHyp
defpermanent uVegHeightEpi
defpermanent uVegHeightLight
defpermanent uVegHeightLightEpi
defpermanent uVegHeightLightHyp
defpermanent uDVegHyp
defpermanent uDVegEpi
defpermanent uVegShade
defpermanent aExtPhytHyp
defpermanent aExtDetHyp
defpermanent aExtIMHyp
defpermanent aExtCoefOpenHyp
defpermanent aExtPhytEpi
defpermanent aExtDetEpi
defpermanent aExtIMEpi
defpermanent aExtCoefOpenEpi
defpermanent aTmEpi
defpermanent aTmHyp
defpermanent uTmEpi
defpermanent uTmHyp
defpermanent uTmBot
defpermanent uLAT
defpermanent uSolDecAng
defpermanent uSunRise
defpermanent uSunSet
defpermanent uSunPath
defpermanent uTrans
defpermanent ufDay
defpermanent uLDay
defpermanent uLOut
defpermanent uLPARSurf
defpermanent aDepth2VegHyp
defpermanent aDepth1VegHyp
defpermanent aDepth1VegEpi
defpermanent aDepth2VegEpi
defpermanent aDayInitVeg
defpermanent aLPARBotEpiOpen
defpermanent aLPARBotHypOpen
defpermanent aLPAR1VegEpi
defpermanent aLPAR1VegHyp
defpermanent aLPARVegLight
defpermanent uTmVegAve
defpermanent uFunTmVeg
defpermanent uFunTmProdVeg
defpermanent uhLVeg
defpermanent aLPIVeg
defpermanent uDayWinVeg
defpermanent bfRootVeg
defpermanent bfShootVeg
defpermanent aDShootVeg
defpermanent aDEmergVeg
defpermanent aDFloatVeg
defpermanent bfSubVeg
defpermanent aDSubVeg
defpermanent aExtVegHyp
defpermanent aExtCoefHyp
defpermanent aExtVegEpi
defpermanent aExtCoefEpi
defpermanent aLPARBotEpi
defpermanent uLPARSurfHyp
defpermanent aLPAR2VegEpi
defpermanent aLPAR2VegHyp
defpermanent uVWind
defpermanent aStrat
defpermanent uQInSeason
defpermanent uQEvSinus
defpermanent aQEv
defpermanent uQEv
defpermanent uQInExtra
defpermanent uQIn
defpermanent uQOutExtra
defpermanent uQOutEpi
defpermanent uQOutHyp
defpermanent uQDilEpi
defpermanent uQDilHyp
defpermanent ukDilEpi
defpermanent ukDilHyp
defpermanent ukDilWatEpi
defpermanent ukDilWatHyp
defpermanent ukOutEpi
defpermanent ukOutHyp
defpermanent uTauWatEpi
defpermanent uTauWatHyp
defpermanent uTauWat
defpermanent uTauSubstHyp
defpermanent uFiJvMortHyp
defpermanent uFiJvEgesHyp
defpermanent uFiJvExcrHyp
defpermanent uFiAdMortHyp
defpermanent uFiAdEgesHyp
defpermanent uFiAdExcrHyp
defpermanent uPiscMortHyp
defpermanent uPiscEgesHyp
defpermanent uPiscExcrHyp
defpermanent vTranDepthW
defpermanent vTranHypEpiW
defpermanent vDeltaWHyp
defpermanent vDeltaWEpi
defpermanent afVolHypEpi
defpermanent uExchMaxW
defpermanent akExchWHyp
defpermanent akExchWEpi
defpermanent wDExchIMWHyp
defpermanent wPExchPO4WHyp
defpermanent wPExchAIMWHyp
defpermanent wNExchNH4WHyp
defpermanent wNExchNO3WHyp
defpermanent wSiExchSiO2WHyp
defpermanent wO2ExchWHyp
defpermanent wDExchDetWHyp
defpermanent wPExchDetWHyp
defpermanent wNExchDetWHyp
defpermanent wSiExchDetWHyp
defpermanent wDExchDiatWHyp
defpermanent wPExchDiatWHyp
defpermanent wNExchDiatWHyp
defpermanent wSiExchDiatWHyp
defpermanent wDExchGrenWHyp
defpermanent wPExchGrenWHyp
defpermanent wNExchGrenWHyp
defpermanent wDExchBlueWHyp
defpermanent wPExchBlueWHyp
defpermanent wNExchBlueWHyp
defpermanent wDExchZooWHyp
defpermanent wPExchZooWHyp
defpermanent wNExchZooWHyp
defpermanent wDExchIMWEpi
defpermanent wPExchPO4WEpi
defpermanent wPExchAIMWEpi
defpermanent wNExchNH4WEpi
defpermanent wNExchNO3WEpi
defpermanent wSiExchSiO2WEpi
defpermanent wO2ExchWEpi
defpermanent wDExchDetWEpi
defpermanent wPExchDetWEpi
defpermanent wNExchDetWEpi
defpermanent wSiExchDetWEpi
defpermanent wDExchDiatWEpi
defpermanent wPExchDiatWEpi
defpermanent wNExchDiatWEpi
defpermanent wSiExchDiatWEpi
defpermanent wDExchGrenWEpi
defpermanent wPExchGrenWEpi
defpermanent wNExchGrenWEpi
defpermanent wDExchBlueWEpi
defpermanent wPExchBlueWEpi
defpermanent wNExchBlueWEpi
defpermanent wDExchZooWEpi
defpermanent wPExchZooWEpi
defpermanent wNExchZooWEpi
defpermanent akExchMHyp
defpermanent akExchLHyp
defpermanent oDPhytWHyp
defpermanent oPPhytWHyp
defpermanent oNPhytWHyp
defpermanent aDPhytS
defpermanent aPPhytS
defpermanent aNPhytS
defpermanent oDPhytWEpi
defpermanent oDOMWEpi
defpermanent oDOMWHyp
defpermanent oTDOMW
defpermanent oDSestWHyp
defpermanent oPOMWHyp
defpermanent oPSestWHyp
defpermanent oPInorgWHyp
defpermanent oPTotWHyp
defpermanent oNDissWEpi
defpermanent oNDissWHyp
defpermanent oNOMWHyp
defpermanent oNSestWHyp
defpermanent oNkjWHyp
defpermanent oNTotWHyp
defpermanent bPorS
defpermanent bPorCorS
defpermanent aDTotS
defpermanent aRhoTotS
defpermanent aRhoSolidS
defpermanent afDTotS
defpermanent afDOrgS
defpermanent afDetS
defpermanent afDetTotS
defpermanent aPInorgS
defpermanent aPTotAvailS
defpermanent aPTotS
defpermanent afPInorgS
defpermanent afPTotS
defpermanent afPO4S
defpermanent oPO4S
defpermanent aNDissS
defpermanent aNkjAvailS
defpermanent aNkjS
defpermanent aNTotAvailS
defpermanent aNTotS
defpermanent afNInorgS
defpermanent afNTotS
defpermanent oNO3S
defpermanent oNH4S
defpermanent oNDissS
defpermanent rPDIMWHyp
defpermanent rPDIMS
defpermanent rPDDetWHyp
defpermanent rNDDetWHyp
defpermanent rSiDDetWHyp
defpermanent rPDHumS
defpermanent rNDHumS
defpermanent rPDDetS
defpermanent rNDDetS
defpermanent rSiDDetS
defpermanent oDPhytWM
defpermanent oPPhytWM
defpermanent oNPhytWM
defpermanent oSiDiatWM
defpermanent oDOMWM
defpermanent oDSestWM
defpermanent oPOMWM
defpermanent oPSestWM
defpermanent oPInorgWM
defpermanent oPTotWM
defpermanent oNDissWM
defpermanent oNOMWM
defpermanent oNSestWM
defpermanent oNkjWM
defpermanent oNTotWM
defpermanent bPorSM
defpermanent bPorCorSM
defpermanent aDTotSM
defpermanent aRhoTotSM
defpermanent aRhoSolidSM
defpermanent afDTotSM
defpermanent afDOrgSM
defpermanent afDetSM
defpermanent afDetTotSM
defpermanent aPInorgSM
defpermanent aPTotAvailSM
defpermanent aPTotSM
defpermanent afPInorgSM
defpermanent afPTotSM
defpermanent afPO4SM
defpermanent oPO4SM
defpermanent aNDissSM
defpermanent aNkjAvailSM
defpermanent aNkjSM
defpermanent aNTotAvailSM
defpermanent aNTotSM
defpermanent afNInorgSM
defpermanent afNTotSM
defpermanent oNO3SM
defpermanent oNH4SM
defpermanent oNDissSM
defpermanent rPDIMWM
defpermanent rPDIMSM
defpermanent rPDDetWM
defpermanent rNDDetWM
defpermanent rSiDDetWM
defpermanent rPDHumSM
defpermanent rNDHumSM
defpermanent rPDDetSM
defpermanent rNDDetSM
defpermanent rSiDDetSM
defpermanent aDTotM
defpermanent aPTotM
defpermanent aNTotM
defpermanent aSiTotM
defpermanent aO2TotM
defpermanent uPLoadSeason
defpermanent uPLoad
defpermanent uPLoadPO4
defpermanent uPLoadOrg
defpermanent uPLoadPhytTot
defpermanent uPLoadDet
defpermanent uPLoadAIM
defpermanent uNLoadSeason
defpermanent uNLoadPhytTot
defpermanent uNLoad
defpermanent uNLoadDet
defpermanent uNLoadOrg
defpermanent uNLoadDiss
defpermanent uNLoadNH4
defpermanent uNLoadNO3
defpermanent uNBackLoadHyp
defpermanent uPBackLoadHyp
defpermanent uNTotIn
defpermanent uDLoadDet
defpermanent uDLoadPhytTot
defpermanent uDLoadIM
defpermanent uDLoad
defpermanent uPTotIn
defpermanent uDLoadDiat
defpermanent uPLoadDiat
defpermanent uNLoadDiat
defpermanent uDLoadGren
defpermanent uPLoadGren
defpermanent uNLoadGren
defpermanent uDLoadBlue
defpermanent uPLoadBlue
defpermanent uNLoadBlue
defpermanent wDDilIMHyp
defpermanent wDDilDetHyp
defpermanent wDDilGrenHyp
defpermanent wDDilBlueHyp
defpermanent wDDilDiatHyp
defpermanent wDDilZooHyp
defpermanent wDDilPhytHyp
defpermanent wPDilZooHyp
defpermanent wNDilZooHyp
defpermanent wPDilPO4Hyp
defpermanent wPDilDetHyp
defpermanent wPDilAIMHyp
defpermanent wNDilNH4Hyp
defpermanent wNDilNO3Hyp
defpermanent wNDilDetHyp
defpermanent wO2InflowHyp
defpermanent wO2OutflHyp
defpermanent wPDilDiatHyp
defpermanent wNDilDiatHyp
defpermanent wPDilGrenHyp
defpermanent wNDilGrenHyp
defpermanent wPDilBlueHyp
defpermanent wNDilBlueHyp
defpermanent wPDilPhytHyp
defpermanent wNDilPhytHyp
defpermanent wDOutflTotHyp
defpermanent wPOutflTotHyp
defpermanent wNOutflTotHyp
defpermanent wDTranDiatHyp
defpermanent wPTranDiatHyp
defpermanent wNTranDiatHyp
defpermanent wDTranGrenHyp
defpermanent wPTranGrenHyp
defpermanent wNTranGrenHyp
defpermanent wDTranBlueHyp
defpermanent wPTranBlueHyp
defpermanent wNTranBlueHyp
defpermanent wDTranPhytHyp
defpermanent wPTranPhytHyp
defpermanent wNTranPhytHyp
defpermanent uSiLoadSiO2
defpermanent uSiLoadDet
defpermanent uSiLoadDiat
defpermanent uSiLoad
defpermanent wSiDilSiO2Hyp
defpermanent wSiDilDetHyp
defpermanent wSiDilDiatHyp
defpermanent wSiOutflTotHyp
defpermanent wSiTranSiO2Hyp
defpermanent wSiTranDetWHyp
defpermanent tSiTranTotTHyp
defpermanent wDTranZooHyp
defpermanent wPTranZooHyp
defpermanent wNTranZooHyp
defpermanent wDTranIMWHyp
defpermanent wDTranDetWHyp
defpermanent wO2TranWHyp
defpermanent wPTranPO4WHyp
defpermanent wPTranAIMWHyp
defpermanent wPTranDetWHyp
defpermanent wNTranNH4WHyp
defpermanent wNTranNO3WHyp
defpermanent wNTranDetWHyp
defpermanent wDDilTotHyp
defpermanent wPDilTotHyp
defpermanent wNDilTotHyp
defpermanent wSiDilTotHyp
defpermanent tDTranTotTHyp
defpermanent tPTranTotTHyp
defpermanent tNTranTotTHyp
defpermanent wDExchIMMHyp
defpermanent wPExchPO4MHyp
defpermanent wPExchAIMMHyp
defpermanent wNExchNH4MHyp
defpermanent wNExchNO3MHyp
defpermanent wSiExchSiO2MHyp
defpermanent wO2ExchMHyp
defpermanent wDExchDetMHyp
defpermanent wPExchDetMHyp
defpermanent wNExchDetMHyp
defpermanent wSiExchDetMHyp
defpermanent wDExchDiatMHyp
defpermanent wPExchDiatMHyp
defpermanent wNExchDiatMHyp
defpermanent wSiExchDiatMHyp
defpermanent wDExchGrenMHyp
defpermanent wPExchGrenMHyp
defpermanent wNExchGrenMHyp
defpermanent wDExchBlueMHyp
defpermanent wPExchBlueMHyp
defpermanent wNExchBlueMHyp
defpermanent wDExchZooMHyp
defpermanent wPExchZooMHyp
defpermanent wNExchZooMHyp
defpermanent wDExchIMHyp
defpermanent wPExchPO4Hyp
defpermanent wPExchAIMHyp
defpermanent wNExchNH4Hyp
defpermanent wNExchNO3Hyp
defpermanent wSiExchSiO2Hyp
defpermanent wO2ExchHyp
defpermanent wDExchDetHyp
defpermanent wPExchDetHyp
defpermanent wNExchDetHyp
defpermanent wSiExchDetHyp
defpermanent wDExchDiatHyp
defpermanent wPExchDiatHyp
defpermanent wNExchDiatHyp
defpermanent wSiExchDiatHyp
defpermanent wDExchGrenHyp
defpermanent wPExchGrenHyp
defpermanent wNExchGrenHyp
defpermanent wDExchBlueHyp
defpermanent wPExchBlueHyp
defpermanent wNExchBlueHyp
defpermanent wDExchZooHyp
defpermanent wPExchZooHyp
defpermanent wNExchZooHyp
defpermanent tPInfPO4WHyp
defpermanent tNInfNH4WHyp
defpermanent tNInfNO3WHyp
defpermanent tPInfPO4S
defpermanent tNInfNH4S
defpermanent tNInfNO3S
defpermanent tNH4LoadS
defpermanent tNO3LoadS
defpermanent uDErosIM
defpermanent uDErosIMS
defpermanent uDErosIMW
defpermanent uDErosOM
defpermanent uPErosOM
defpermanent uNErosOM
defpermanent uO2SatEpi
defpermanent uO2SatHyp
defpermanent kAer
defpermanent uFunTmAerEpi
defpermanent uFunTmAerHyp
defpermanent aFunLemnAer
defpermanent tO2BubHyp
defpermanent uFunTmFish
defpermanent tDTurbFish
defpermanent aFunVegResus
defpermanent aFunDimSusp
defpermanent tDResusTauDead
defpermanent tDResusBareDead
defpermanent tDResusDead
defpermanent tDResusIM
defpermanent tDResusDet
defpermanent akResusPhytRef
defpermanent tDResusPhytTot
defpermanent tPResusDet
defpermanent tPResusPO4
defpermanent tPResusAIM
defpermanent tNResusNO3
defpermanent tNResusNH4
defpermanent tNResusDet
defpermanent tSiResusDet
defpermanent aFunTauSetOMHyp
defpermanent aFunTauSetIMHyp
defpermanent uFunTmSetEpi
defpermanent uFunTmSetHyp
defpermanent uCorVSetIMHyp
defpermanent tDSetIMHyp
defpermanent tPSetAIMHyp
defpermanent uCorVSetDetHyp
defpermanent tDSetDetHyp
defpermanent tPSetDetHyp
defpermanent tNSetDetHyp
defpermanent tSiSetDetHyp
defpermanent kPMinDetW
defpermanent kNMinDetW
defpermanent kSiMinDetW
defpermanent uFunTmMinWEpi
defpermanent uFunTmMinWHyp
defpermanent wDMinDetWHyp
defpermanent wPMinDetWHyp
defpermanent wNMinDetWHyp
defpermanent wSiMinDetWHyp
defpermanent aCorO2BODHyp
defpermanent wO2MinDetWHyp
defpermanent wDDenitWHyp
defpermanent wNDenitWHyp
defpermanent uFunTmNitrHyp
defpermanent uFunTmNitrEpi
defpermanent uFunTmNitrS
defpermanent aCorO2NitrWHyp
defpermanent wNNitrWHyp
defpermanent wO2NitrWHyp
defpermanent kPMinDetS
defpermanent kNMinDetS
defpermanent kSiMinDetS
defpermanent uFunTmMinS
defpermanent tDMinDetS
defpermanent tPMinDetS
defpermanent tNMinDetS
defpermanent tSiMinDetS
defpermanent uFunTmDif
defpermanent akO2DifCor
defpermanent tSOD
defpermanent aDepthDif
defpermanent tPDifPO4Hyp
defpermanent tNDifNO3Hyp
defpermanent tNDifNH4Hyp
defpermanent tO2DifHyp
defpermanent tPDifGroundPO4
defpermanent tNDifGroundNO3
defpermanent tNDifGroundNH4
defpermanent aPAdsMaxWHyp
defpermanent aKPAdsWHyp
defpermanent aPIsoAdsWHyp
defpermanent aPEqIMWHyp
defpermanent wPSorpIMWHyp
defpermanent tPChemPO4
defpermanent tSiAbioTotT
defpermanent uQEvPhra
defpermanent tPEvPO4WM
defpermanent tNEvNH4WM
defpermanent tNEvNO3WM
defpermanent tPInfPO4WM
defpermanent tNInfNH4WM
defpermanent tNInfNO3WM
defpermanent tPInfPO4SM
defpermanent tNInfNH4SM
defpermanent tNInfNO3SM
defpermanent tO2AerM
defpermanent tDSetIMM
defpermanent tPSetAIMM
defpermanent tDSetDetM
defpermanent tPSetDetM
defpermanent tNSetDetM
defpermanent tSiSetDetM
defpermanent tDSetDiatM
defpermanent tPSetDiatM
defpermanent tNSetDiatM
defpermanent tSiSetDiatM
defpermanent tDSetGrenM
defpermanent tPSetGrenM
defpermanent tNSetGrenM
defpermanent tDSetBlueM
defpermanent tPSetBlueM
defpermanent tNSetBlueM
defpermanent tDSetPhytM
defpermanent tPSetPhytM
defpermanent tNSetPhytM
defpermanent tDSetTotM
defpermanent wDMinDetWM
defpermanent wPMinDetWM
defpermanent wNMinDetWM
defpermanent wSiMinDetWM
defpermanent aCorO2BODM
defpermanent wO2MinDetWM
defpermanent wDDenitWM
defpermanent wNDenitWM
defpermanent aCorO2NitrWM
defpermanent wNNitrWM
defpermanent wO2NitrWM
defpermanent tDMinDetSM
defpermanent tPMinDetSM
defpermanent tNMinDetSM
defpermanent tSiMinDetSM
defpermanent akO2DifCorM
defpermanent tSODM
defpermanent aDepthOxySedM
defpermanent afOxySedM
defpermanent tDMinOxyDetSM
defpermanent tO2MinDetSM
defpermanent tDDenitSM
defpermanent tNDenitSM
defpermanent tNNitrSM
defpermanent tO2NitrSM
defpermanent tDMinHumSM
defpermanent tPMinHumSM
defpermanent tNMinHumSM
defpermanent aDepthDifM
defpermanent tPDifPO4M
defpermanent tNDifNO3M
defpermanent tNDifNH4M
defpermanent tO2DifM
defpermanent tPDifGroundPO4M
defpermanent tNDifGroundNO3M
defpermanent tNDifGroundNH4M
defpermanent aPAdsMaxWM
defpermanent aKPAdsWM
defpermanent aPIsoAdsWM
defpermanent aPEqIMWM
defpermanent wPSorpIMWM
defpermanent aPAdsMaxSM
defpermanent aKPAdsSM
defpermanent aPIsoAdsSM
defpermanent aPEqIMSM
defpermanent tPSorpIMSM
defpermanent tPChemPO4M
defpermanent aDRootVeg
defpermanent bfSubVegEpi
defpermanent bfSubVegHyp
defpermanent afCovSurfVeg
defpermanent afCovEmergVeg
defpermanent aCovVeg
defpermanent aDVeg
defpermanent aPVeg
defpermanent aNVeg
defpermanent aLPARBotHyp
defpermanent rPDVeg
defpermanent rNDVeg
defpermanent tDMigrVeg
defpermanent tPMigrVeg
defpermanent tNMigrVeg
defpermanent uFunTmRespVeg
defpermanent afPUptVegS
defpermanent afNUptVegS
defpermanent aVPUptMaxCrVeg
defpermanent aVPUptVegWHyp
defpermanent aVPUptVegS
defpermanent aVPUptVegWEpi
defpermanent tPUptVegWEpi
defpermanent tPUptVegWHyp
defpermanent tPUptVegS
defpermanent tPUptVegEpi
defpermanent tPUptVegHyp
defpermanent aVNUptMaxCrVeg
defpermanent ahNUptVeg
defpermanent aVNUptVegWEpi
defpermanent aVNUptVegWHyp
defpermanent afNH4UptVegWEpi
defpermanent afNH4UptVegWHyp
defpermanent tNUptVegWEpi
defpermanent tNUptVegWHyp
defpermanent tNUptNH4VegWEpi
defpermanent tNUptNO3VegWEpi
defpermanent tNUptNH4VegWHyp
defpermanent tNUptNO3VegWHyp
defpermanent aVNUptVegS
defpermanent tNUptVegS
defpermanent afNH4UptVegS
defpermanent tNUptNH4VegS
defpermanent tNUptVegSEpi
defpermanent tNUptNO3VegS
defpermanent tNUptVeg
defpermanent aLLimShootVegEpi
defpermanent aLLimShootVegHyp
defpermanent aMuTmLVegHyp
defpermanent aPLimVeg
defpermanent aNLimVeg
defpermanent aNutLimVeg
defpermanent aMuVegHyp
defpermanent bkMortVeg
defpermanent akDIncrVegHyp
defpermanent tDEnvVegHyp
defpermanent tDEnvProdVegHyp
defpermanent tDProdVegHyp
defpermanent tDProdSubVegHyp
defpermanent tDRespVeg
defpermanent tDEnvMortVegHyp
defpermanent tDMortVegHyp
defpermanent tDMortVegWHyp
defpermanent tDGrazVegBird
defpermanent bkManVeg
defpermanent tDManVeg
defpermanent tPManVeg
defpermanent tNManVeg
defpermanent tO2ProdVegHyp
defpermanent tO2RespVegWHyp
defpermanent aDepthOxySed
defpermanent afOxySed
defpermanent tO2RespVegS
defpermanent tO2ProdVegSHyp
defpermanent tO2ProdVegWHyp
defpermanent tO2UptNO3VegWHyp
defpermanent tO2UptNO3VegS
defpermanent tPExcrVeg
defpermanent tPExcrVegS
defpermanent tPExcrVegW
defpermanent tPMortVegHyp
defpermanent tPMortVegPO4Hyp
defpermanent tPMortVegPO4SHyp
defpermanent tPMortVegPO4WHyp
defpermanent tPMortVegDetHyp
defpermanent tPMortVegDetWHyp
defpermanent tPMortVegDetSHyp
defpermanent tPGrazVegBird
defpermanent tNExcrVeg
defpermanent tNExcrVegS
defpermanent tNExcrVegW
defpermanent tNMortVegHyp
defpermanent tNMortVegNH4Hyp
defpermanent tNMortVegNH4SHyp
defpermanent tNMortVegNH4WHyp
defpermanent tNMortVegDetHyp
defpermanent tNMortVegDetWHyp
defpermanent tNMortVegDetSHyp
defpermanent tNGrazVegBird
defpermanent tDAssVegBird
defpermanent tDEgesBird
defpermanent tPAssVegBird
defpermanent tPEgesBird
defpermanent tPEgesBirdPO4
defpermanent tPEgesBirdDet
defpermanent tNAssVegBird
defpermanent tNEgesBird
defpermanent tNEgesBirdNH4
defpermanent tNEgesBirdDet
defpermanent wDBedDetWHyp
defpermanent aMuTmLVegEpi
defpermanent akDIncrVegEpi
defpermanent tDEnvVegEpi
defpermanent aMuVegEpi
defpermanent tDEnvProdVegEpi
defpermanent tDProdVegEpi
defpermanent tDEnvMortVegEpi
defpermanent tDMortVegEpi
defpermanent tNMortVegEpi
defpermanent tNMortVegNH4Epi
defpermanent tNMortVegNH4SEpi
defpermanent wPBedPO4WHyp
defpermanent wPBedDetWHyp
defpermanent wNBedNH4WHyp
defpermanent wNBedNO3WHyp
defpermanent wNBedDetWHyp
defpermanent tDMortVegSHyp
defpermanent tDBedDetSHyp
defpermanent tO2BedWHyp
defpermanent UseLoss
defpermanent uFunTmLossHyp
defpermanent uFunTmLossEpi
defpermanent rPDBlueWHyp
defpermanent rNDBlueWHyp
defpermanent rPDBlueS
defpermanent rNDBlueS
defpermanent uFunTmBlueHyp
defpermanent uFunTmProdBlueHyp
defpermanent uFunTmRespBlueHyp
defpermanent uFunTmBlueEpi
defpermanent uFunTmProdBlueEpi
defpermanent uFunTmRespBlueEpi
defpermanent uFunTmBlueS
defpermanent uFunTmRespBlueS
defpermanent aVPUptMaxCrBlueHyp
defpermanent aVPUptBlueHyp
defpermanent wPUptBlueHyp
defpermanent aVNUptMaxCrBlueHyp
defpermanent ahNUptBlueHyp
defpermanent aVNUptBlueHyp
defpermanent wNUptBlueHyp
defpermanent afNH4UptBlueHyp
defpermanent wNUptNH4BlueHyp
defpermanent wNUptNO3BlueHyp
defpermanent uMuMaxTmBlueHyp
defpermanent uMuMaxTmBlueEpi
defpermanent aPLimBlueHyp
defpermanent aNLimBlueHyp
defpermanent aSiLimBlueHyp
defpermanent aLLimBlueHyp
defpermanent aMuTmLBlueHyp
defpermanent aNutLimBlueHyp
defpermanent aMuBlueHyp
defpermanent wDAssBlueHyp
defpermanent rChDBlueHyp
defpermanent oChlaBlueHyp
defpermanent aExtChBlueHyp
defpermanent ukDRespTmBlueHyp
defpermanent ukDRespTmBlueEpi
defpermanent ukDRespTmBlueS
defpermanent wDRespBlueWHyp
defpermanent ukLossTmBlueHyp
defpermanent ukLossTmBlueEpi
defpermanent wDLossBlueHyp
defpermanent wDMortBlueWHyp
defpermanent uCorVSetBlueHyp
defpermanent tDSetBlueHyp
defpermanent tDResusBlue
defpermanent tDRespBlueS
defpermanent tDMortBlueS
defpermanent ukDDecBlueHyp
defpermanent wPExcrBlueWHyp
defpermanent wPLossBlueHyp
defpermanent wPMortBlueWHyp
defpermanent tPSetBlueHyp
defpermanent tPResusBlue
defpermanent tPExcrBlueS
defpermanent tPMortBlueS
defpermanent wNExcrBlueWHyp
defpermanent wNLossBlueHyp
defpermanent wNMortBlueWHyp
defpermanent tNSetBlueHyp
defpermanent tNResusBlue
defpermanent tNExcrBlueS
defpermanent tNMortBlueS
defpermanent aFunTauSetOMEpi
defpermanent aFunTauSetIMEpi
defpermanent uCorVSetBlueEpi
defpermanent tDSetBlueEpi
defpermanent rNDBlueWEpi
defpermanent tNSetBlueEpi
defpermanent rPDBlueWEpi
defpermanent tPSetBlueEpi
defpermanent wDPrimBlueWHyp
defpermanent wPPrimBlueWHyp
defpermanent wNPrimBlueWHyp
defpermanent rPDGrenWHyp
defpermanent rNDGrenWHyp
defpermanent rPDGrenS
defpermanent rNDGrenS
defpermanent uFunTmGrenHyp
defpermanent uFunTmGrenEpi
defpermanent uFunTmGrenS
defpermanent uFunTmProdGrenHyp
defpermanent uFunTmRespGrenHyp
defpermanent uFunTmProdGrenEpi
defpermanent uFunTmRespGrenEpi
defpermanent uFunTmRespGrenS
defpermanent aVPUptMaxCrGrenHyp
defpermanent aVPUptGrenHyp
defpermanent wPUptGrenHyp
defpermanent aVNUptMaxCrGrenHyp
defpermanent ahNUptGrenHyp
defpermanent aVNUptGrenHyp
defpermanent wNUptGrenHyp
defpermanent afNH4UptGrenHyp
defpermanent wNUptNH4GrenHyp
defpermanent wNUptNO3GrenHyp
defpermanent uMuMaxTmGrenHyp
defpermanent uMuMaxTmGrenEpi
defpermanent aPLimGrenHyp
defpermanent aNLimGrenHyp
defpermanent aSiLimGrenHyp
defpermanent aLLimGrenHyp
defpermanent aMuTmLGrenHyp
defpermanent aNutLimGrenHyp
defpermanent aMuGrenHyp
defpermanent wDAssGrenHyp
defpermanent rChDGrenHyp
defpermanent oChlaGrenHyp
defpermanent aExtChGrenHyp
defpermanent ukDRespTmGrenHyp
defpermanent ukDRespTmGrenEpi
defpermanent ukDRespTmGrenS
defpermanent wDRespGrenWHyp
defpermanent ukLossTmGrenHyp
defpermanent ukLossTmGrenEpi
defpermanent wDLossGrenHyp
defpermanent wDMortGrenWHyp
defpermanent uCorVSetGrenHyp
defpermanent tDSetGrenHyp
defpermanent tDResusGren
defpermanent tDRespGrenS
defpermanent tDMortGrenS
defpermanent ukDDecGrenHyp
defpermanent wPExcrGrenWHyp
defpermanent wPLossGrenHyp
defpermanent wPMortGrenWHyp
defpermanent tPSetGrenHyp
defpermanent tPResusGren
defpermanent tPExcrGrenS
defpermanent tPMortGrenS
defpermanent wNExcrGrenWHyp
defpermanent wNLossGrenHyp
defpermanent wNMortGrenWHyp
defpermanent tNSetGrenHyp
defpermanent tNResusGren
defpermanent tNExcrGrenS
defpermanent tNMortGrenS
defpermanent uCorVSetGrenEpi
defpermanent tDSetGrenEpi
defpermanent rNDGrenWEpi
defpermanent tNSetGrenEpi
defpermanent rPDGrenWEpi
defpermanent tPSetGrenEpi
defpermanent wDPrimGrenWHyp
defpermanent wPPrimGrenWHyp
defpermanent wNPrimGrenWHyp
defpermanent rPDDiatWHyp
defpermanent rNDDiatWHyp
defpermanent rPDDiatS
defpermanent uFunTmDiatHyp
defpermanent rNDDiatS
defpermanent uFunTmDiatEpi
defpermanent uFunTmDiatS
defpermanent uFunTmProdDiatHyp
defpermanent uFunTmRespDiatHyp
defpermanent uFunTmProdDiatEpi
defpermanent uFunTmRespDiatEpi
defpermanent uFunTmRespDiatS
defpermanent aVPUptMaxCrDiatHyp
defpermanent aVPUptDiatHyp
defpermanent wPUptDiatHyp
defpermanent aVNUptMaxCrDiatHyp
defpermanent ahNUptDiatHyp
defpermanent aVNUptDiatHyp
defpermanent wNUptDiatHyp
defpermanent afNH4UptDiatHyp
defpermanent wNUptNH4DiatHyp
defpermanent wNUptNO3DiatHyp
defpermanent uMuMaxTmDiatHyp
defpermanent uMuMaxTmDiatEpi
defpermanent aPLimDiatHyp
defpermanent aNLimDiatHyp
defpermanent aSiLimDiatHyp
defpermanent aLLimDiatHyp
defpermanent aMuTmLDiatHyp
defpermanent aNutLimDiatHyp
defpermanent aMuDiatHyp
defpermanent wDAssDiatHyp
defpermanent rChDDiatHyp
defpermanent oChlaDiatHyp
defpermanent aExtChDiatHyp
defpermanent ukDRespTmDiatHyp
defpermanent ukDRespTmDiatEpi
defpermanent ukDRespTmDiatS
defpermanent wDRespDiatWHyp
defpermanent ukLossTmDiatHyp
defpermanent ukLossTmDiatEpi
defpermanent wDLossDiatHyp
defpermanent wDMortDiatWHyp
defpermanent uCorVSetDiatHyp
defpermanent tDSetDiatHyp
defpermanent tDResusDiat
defpermanent tDRespDiatS
defpermanent tDMortDiatS
defpermanent ukDDecDiatHyp
defpermanent wPExcrDiatWHyp
defpermanent wPLossDiatHyp
defpermanent wPMortDiatWHyp
defpermanent tPSetDiatHyp
defpermanent tPResusDiat
defpermanent tPExcrDiatS
defpermanent tPMortDiatS
defpermanent wNExcrDiatWHyp
defpermanent wNLossDiatHyp
defpermanent wNMortDiatWHyp
defpermanent tNSetDiatHyp
defpermanent tNResusDiat
defpermanent tNExcrDiatS
defpermanent tNMortDiatS
defpermanent uCorVSetDiatEpi
defpermanent tDSetDiatEpi
defpermanent rPDDiatWEpi
defpermanent tPSetDiatEpi
defpermanent rNDDiatWEpi
defpermanent tNSetDiatEpi
defpermanent wDPrimDiatWHyp
defpermanent wPPrimDiatWHyp
defpermanent wNPrimDiatWHyp
defpermanent oChlaHyp
defpermanent wDAssPhytHyp
defpermanent wDRespPhytWHyp
defpermanent wDMortPhytWHyp
defpermanent tDSetPhytHyp
defpermanent wDLossPhytHyp
defpermanent wDPrimPhytWHyp
defpermanent wPUptPhytHyp
defpermanent wPExcrPhytWHyp
defpermanent wPMortPhytWHyp
defpermanent tPSetPhytHyp
defpermanent tPResusPhyt
defpermanent wPLossPhytHyp
defpermanent wPPrimPhytWHyp
defpermanent wNUptPhytHyp
defpermanent wNUptNH4PhytHyp
defpermanent wNUptNO3PhytHyp
defpermanent wNExcrPhytWHyp
defpermanent wNMortPhytWHyp
defpermanent tNSetPhytHyp
defpermanent tNResusPhyt
defpermanent wNLossPhytHyp
defpermanent wNPrimPhytWHyp
defpermanent tDRespPhytS
defpermanent tDMortPhytS
defpermanent tPExcrPhytS
defpermanent tPMortPhytS
defpermanent tNExcrPhytS
defpermanent tNMortPhytS
defpermanent wSiUptDiatHyp
defpermanent wSiExcrDiatWHyp
defpermanent wSiLossDiatHyp
defpermanent wSiMortDiatWHyp
defpermanent tSiSetDiatHyp
defpermanent tSiResusDiat
defpermanent rCyDBlueHyp
defpermanent oCyanHyp
defpermanent fDDiatHyp
defpermanent wDPrimDetWHyp
defpermanent wO2ProdPhytHyp
defpermanent wO2RespPhytWHyp
defpermanent wO2UptNO3PhytHyp
defpermanent wO2PrimWHyp
defpermanent wPMortPhytPO4WHyp
defpermanent wPMortPhytDetWHyp
defpermanent wPLossPhytPO4Hyp
defpermanent wPLossPhytDetHyp
defpermanent wPPrimPO4WHyp
defpermanent wPPrimDetWHyp
defpermanent tPMortPhytPO4S
defpermanent tPMortPhytDetS
defpermanent tPPrimPO4S
defpermanent tPPrimTotT
defpermanent wNMortPhytNH4WHyp
defpermanent wNMortPhytDetWHyp
defpermanent wNLossPhytNH4Hyp
defpermanent wNLossPhytDetHyp
defpermanent wNPrimNH4WHyp
defpermanent wNPrimNO3WHyp
defpermanent wNPrimDetWHyp
defpermanent tNMortPhytNH4S
defpermanent tNMortPhytDetS
defpermanent tNPrimNH4S
defpermanent tNPrimNO3S
defpermanent tNPrimTotT
defpermanent tSiExcrDiatS
defpermanent tSiMortDiatS
defpermanent wSiPrimSiO2WHyp
defpermanent wSiPrimDetWHyp
defpermanent tSiPrimTotT
defpermanent aPACoefEpi
defpermanent aPACoefHyp
defpermanent bSecchiMaxEpi
defpermanent aSecchiEpi
defpermanent aTransparencyEpi
defpermanent bSecchiMaxHyp
defpermanent aSecchiHyp
defpermanent aSecchiT
defpermanent aTransparencyHyp
defpermanent aTransparencyT
defpermanent aDepthEuphHyp
defpermanent aRelDepthEuphHyp
defpermanent aChlaHHyp
defpermanent aCovPhytWHyp
defpermanent rExtChPhytHyp
defpermanent uFunTmZooHyp
defpermanent uFunTmZooEpi
defpermanent rPDZooHyp
defpermanent rNDZooHyp
defpermanent oDFoodZooHyp
defpermanent aFiltHyp
defpermanent ukDAssTmZooHyp
defpermanent ukDAssTmZooEpi
defpermanent aDSatZooHyp
defpermanent ukDRespTmZooHyp
defpermanent ukDRespTmZooEpi
defpermanent ukDIncrZooHyp
defpermanent ukDIncrZooEpi
defpermanent wDEnvZooHyp
defpermanent wDAssZooHyp
defpermanent wDConsZooHyp
defpermanent wDConsDetZooHyp
defpermanent wDConsDiatZooHyp
defpermanent wDConsGrenZooHyp
defpermanent wDConsBlueZooHyp
defpermanent wDConsPhytZooHyp
defpermanent wDEgesZooHyp
defpermanent aCorDRespZooHyp
defpermanent wDRespZooHyp
defpermanent wDMortZooHyp
defpermanent oPFoodZooHyp
defpermanent rPDFoodZooHyp
defpermanent wPConsDiatZooHyp
defpermanent wPConsGrenZooHyp
defpermanent wPConsBlueZooHyp
defpermanent wPConsPhytZooHyp
defpermanent wPConsDetZooHyp
defpermanent wPConsZooHyp
defpermanent afPAssZooHyp
defpermanent wPAssZooHyp
defpermanent wPEgesZooHyp
defpermanent wPEgesZooPO4Hyp
defpermanent wPEgesZooDetHyp
defpermanent akPExcrZooHyp
defpermanent wPExcrZooHyp
defpermanent wPMortZooHyp
defpermanent wPMortZooPO4Hyp
defpermanent wPMortZooDetHyp
defpermanent oNFoodZooHyp
defpermanent rNDFoodZooHyp
defpermanent wNConsDiatZooHyp
defpermanent wNConsGrenZooHyp
defpermanent wNConsBlueZooHyp
defpermanent wNConsPhytZooHyp
defpermanent wNConsDetZooHyp
defpermanent wNConsZooHyp
defpermanent afNAssZooHyp
defpermanent wNAssZooHyp
defpermanent wNEgesZooHyp
defpermanent wNEgesZooNH4Hyp
defpermanent wNEgesZooDetHyp
defpermanent kNExcrZooHyp
defpermanent wNExcrZooHyp
defpermanent wNMortZooHyp
defpermanent wNMortZooNH4Hyp
defpermanent wNMortZooDetHyp
defpermanent wSiConsDiatZooHyp
defpermanent uFunTmBent
defpermanent aDFoodBent
defpermanent rPDBent
defpermanent rNDBent
defpermanent tDMigrBent
defpermanent aDSatBent
defpermanent ukDIncrBent
defpermanent tDEnvBent
defpermanent tDAssBent
defpermanent aDAssBentSp
defpermanent tDConsBent
defpermanent tDConsDetBent
defpermanent tDConsDiatBent
defpermanent tDConsGrenBent
defpermanent tDConsBlueBent
defpermanent tDConsPhytBent
defpermanent tDEgesBent
defpermanent tDRespBent
defpermanent tDMortBent
defpermanent aPFoodBent
defpermanent rPDFoodBent
defpermanent tPConsDetBent
defpermanent tPConsDiatBent
defpermanent tPConsGrenBent
defpermanent tPConsBlueBent
defpermanent tPConsPhytBent
defpermanent tPConsBent
defpermanent afPAssBent
defpermanent tPAssBent
defpermanent tPEgesBent
defpermanent tPEgesBentPO4
defpermanent tPEgesBentDet
defpermanent tPExcrBent
defpermanent tPMortBent
defpermanent tPMortBentPO4
defpermanent tPMortBentDet
defpermanent tPMigrBent
defpermanent aNFoodBent
defpermanent rNDFoodBent
defpermanent tNMigrBent
defpermanent tNConsDetBent
defpermanent tNConsDiatBent
defpermanent tNConsGrenBent
defpermanent tNConsBlueBent
defpermanent tNConsPhytBent
defpermanent tNConsBent
defpermanent afNAssBent
defpermanent tNAssBent
defpermanent tNEgesBent
defpermanent tNEgesBentNH4
defpermanent tNEgesBentDet
defpermanent tNExcrBent
defpermanent tNMortBent
defpermanent tNMortBentNH4
defpermanent tNMortBentDet
defpermanent tSiConsDiatBent
defpermanent aFunVegFish
defpermanent ukDIncrFiJv
defpermanent aDSatFiAd
defpermanent ukDIncrFiAd
defpermanent ukHarvFish
defpermanent afPAssFiAd
defpermanent afNAssFiAd
defpermanent uFunTmPisc
defpermanent aDCarrPisc
defpermanent aFunVegPisc
defpermanent akDIncrPisc
defpermanent ukHarvPisc
defpermanent tDWebDetS
defpermanent tDWebDiatS
defpermanent tDWebGrenS
defpermanent tDWebBlueS
defpermanent tDWebPhytS
defpermanent tPWebPO4S
defpermanent tPWebDetS
defpermanent tPWebDiatS
defpermanent tPWebGrenS
defpermanent tPWebBlueS
defpermanent tPWebPhytS
defpermanent tNWebNH4S
defpermanent tNWebNO3S
defpermanent tNWebDetS
defpermanent tNWebDiatS
defpermanent tNWebGrenS
defpermanent tNWebBlueS
defpermanent tNWebPhytS
defpermanent wSiWebSiO2W
defpermanent wSiWebDetWHyp
defpermanent tSiWebDetS
defpermanent tSiWebTotT
defpermanent aPrefAveHyp
defpermanent wDConsZoo2Hyp
defpermanent aDConsZooSpHyp
defpermanent aDAssZooSpHyp
defpermanent aDGrazSpHyp
defpermanent aPConsZooSpHyp
defpermanent aPGrazSpHyp
defpermanent aNConsZooSpHyp
defpermanent aNGrazSpHyp
defpermanent afDShootPhra
defpermanent rDSRPhra
defpermanent rPDShootPhra
defpermanent rNDShootPhra
defpermanent rPDRootPhra
defpermanent rNDRootPhra
defpermanent aLengShootPhra
defpermanent bDayInitPhra
defpermanent aDAllPhra
defpermanent tDAllPhra
defpermanent tNTransPhra
defpermanent tPTransPhra
defpermanent aVNUptPhraMaxCr
defpermanent ahNUptPhraS
defpermanent aVNUptPhraS
defpermanent tNUptPhraS
defpermanent tNUptNH4PhraS
defpermanent tNUptNO3PhraS
defpermanent tNUptShootPhra
defpermanent tNUptRootPhra
defpermanent aVPUptPhraMaxCr
defpermanent ahPUptPhraS
defpermanent aVPUptPhraS
defpermanent tPUptPhraS
defpermanent tPUptShootPhra
defpermanent tPUptRootPhra
defpermanent uFunTmProdPhra
defpermanent ukDRespTmPhra
defpermanent aMuPhotPhra
defpermanent aNLimProdPhra
defpermanent aPLimProdPhra
defpermanent aNutLimPhra
defpermanent aMuPhra
defpermanent akDIncrPhra
defpermanent tDDensPhra
defpermanent tDDensProdPhra
defpermanent tDProdPhra
defpermanent tDProdShootPhra
defpermanent tDProdRootPhra
defpermanent tDRespShootPhra
defpermanent tDRespRootPhra
defpermanent tO2RespRootPhra
defpermanent tO2FlowPhra
defpermanent bDayRealPhra
defpermanent aDRealPhra
defpermanent tDRealPhra
defpermanent tNRetrPhra
defpermanent tPRetrPhra
defpermanent tDMortShootPhra
defpermanent tNMortShootPhra
defpermanent tPMortShootPhra
defpermanent tDMortRootPhra
defpermanent tNMortRootPhra
defpermanent tPMortRootPhra
defpermanent tDManShootPhra
defpermanent tNManShootPhra
defpermanent tPManShootPhra
defpermanent tDIMSM
defpermanent tDHumSM
defpermanent tDDetSM
defpermanent vDeltaSM
defpermanent tDBurIMM
defpermanent tDBurOMM
defpermanent tDBurDetM
defpermanent tDBurHumM
defpermanent tDBurTotM
defpermanent tPBurHumM
defpermanent tPBurDetM
defpermanent tPBurAIMM
defpermanent tPBurPO4M
defpermanent tPBurTotM
defpermanent tNBurHumM
defpermanent tNBurDetM
defpermanent tNBurNH4M
defpermanent tNBurNO3M
defpermanent tNBurTotM
defpermanent tSiBurDetM
defpermanent tSiBurTotM
defpermanent vDeltaWM
defpermanent aRelDeltaWM
defpermanent tDSetTotHyp
defpermanent tPSetTotHyp
defpermanent tNSetTotHyp
defpermanent bTimeDred
defpermanent bRhoSolidSoil
defpermanent tDMarsTotT
defpermanent tPMarsTotT
defpermanent tNMarsTotT
defpermanent tSiMarsTotT
defpermanent uTauSubstEpi
defpermanent akExchMEpi
defpermanent afVolMarshEpi
defpermanent akExchLEpi
defpermanent oPPhytWEpi
defpermanent oNPhytWEpi
defpermanent oDSestWEpi
defpermanent oPOMWEpi
defpermanent oPSestWEpi
defpermanent oPInorgWEpi
defpermanent oPTotWEpi
defpermanent oNOMWEpi
defpermanent oNSestWEpi
defpermanent oNkjWEpi
defpermanent oNTotWEpi
defpermanent rPDIMWEpi
defpermanent rPDDetWEpi
defpermanent rNDDetWEpi
defpermanent rSiDDetWEpi
defpermanent wDDilIMEpi
defpermanent wDDilDetEpi
defpermanent wDDilDiatEpi
defpermanent wDDilGrenEpi
defpermanent wDDilBlueEpi
defpermanent wDDilPhytEpi
defpermanent wDDilZooEpi
defpermanent wPDilZooEpi
defpermanent wNDilZooEpi
defpermanent wPDilPO4Epi
defpermanent wPDilDetEpi
defpermanent wPDilAIMEpi
defpermanent wNDilNH4Epi
defpermanent wNDilNO3Epi
defpermanent wNDilDetEpi
defpermanent wO2InflowEpi
defpermanent wO2OutflEpi
defpermanent wPDilDiatEpi
defpermanent wNDilDiatEpi
defpermanent wPDilGrenEpi
defpermanent wNDilGrenEpi
defpermanent wPDilBlueEpi
defpermanent wNDilBlueEpi
defpermanent wPDilPhytEpi
defpermanent wNDilPhytEpi
defpermanent wDOutflTotEpi
defpermanent wPOutflTotEpi
defpermanent wNOutflTotEpi
defpermanent wDTranDiatEpi
defpermanent wPTranDiatEpi
defpermanent wNTranDiatEpi
defpermanent wDTranGrenEpi
defpermanent wPTranGrenEpi
defpermanent wNTranGrenEpi
defpermanent wDTranBlueEpi
defpermanent wPTranBlueEpi
defpermanent wNTranBlueEpi
defpermanent wDTranPhytEpi
defpermanent wPTranPhytEpi
defpermanent wNTranPhytEpi
defpermanent wSiDilSiO2Epi
defpermanent wSiDilDetEpi
defpermanent wSiDilDiatEpi
defpermanent wSiOutflTotEpi
defpermanent wSiTranSiO2Epi
defpermanent wSiTranDetWEpi
defpermanent tSiTranTotTEpi
defpermanent wDTranZooEpi
defpermanent wPTranZooEpi
defpermanent wNTranZooEpi
defpermanent wDTranIMWEpi
defpermanent wDTranDetWEpi
defpermanent wO2TranWEpi
defpermanent wPTranPO4WEpi
defpermanent wPTranAIMWEpi
defpermanent wPTranDetWEpi
defpermanent wNTranNH4WEpi
defpermanent wNTranNO3WEpi
defpermanent wNTranDetWEpi
defpermanent wDDilTotEpi
defpermanent wPDilTotEpi
defpermanent wNDilTotEpi
defpermanent wSiDilTotEpi
defpermanent tDTranTotTEpi
defpermanent tPTranTotTEpi
defpermanent tNTranTotTEpi
defpermanent wDExchIMMEpi
defpermanent wPExchPO4MEpi
defpermanent wPExchAIMMEpi
defpermanent wNExchNH4MEpi
defpermanent wNExchNO3MEpi
defpermanent wSiExchSiO2MEpi
defpermanent wO2ExchMEpi
defpermanent wDExchDetMEpi
defpermanent wPExchDetMEpi
defpermanent wNExchDetMEpi
defpermanent wSiExchDetMEpi
defpermanent wDExchDiatMEpi
defpermanent wPExchDiatMEpi
defpermanent wNExchDiatMEpi
defpermanent wSiExchDiatMEpi
defpermanent wDExchGrenMEpi
defpermanent wPExchGrenMEpi
defpermanent wNExchGrenMEpi
defpermanent wDExchBlueMEpi
defpermanent wPExchBlueMEpi
defpermanent wNExchBlueMEpi
defpermanent wDExchZooMEpi
defpermanent wPExchZooMEpi
defpermanent wNExchZooMEpi
defpermanent wDExchIMEpi
defpermanent wPExchPO4Epi
defpermanent wPExchAIMEpi
defpermanent wNExchNH4Epi
defpermanent wNExchNO3Epi
defpermanent wSiExchSiO2Epi
defpermanent wO2ExchEpi
defpermanent wDExchDetEpi
defpermanent wPExchDetEpi
defpermanent wNExchDetEpi
defpermanent wSiExchDetEpi
defpermanent wDExchDiatEpi
defpermanent wPExchDiatEpi
defpermanent wNExchDiatEpi
defpermanent wSiExchDiatEpi
defpermanent wDExchGrenEpi
defpermanent wPExchGrenEpi
defpermanent wNExchGrenEpi
defpermanent wDExchBlueEpi
defpermanent wPExchBlueEpi
defpermanent wNExchBlueEpi
defpermanent wDExchZooEpi
defpermanent wPExchZooEpi
defpermanent wNExchZooEpi
defpermanent tPInfPO4WEpi
defpermanent tNInfNH4WEpi
defpermanent tNInfNO3WEpi
defpermanent tO2AerEpi
defpermanent tDTurbFishIM
defpermanent uCorVSetIMEpi
defpermanent tDSetIMEpi
defpermanent tPSetAIMEpi
defpermanent uCorVSetDetEpi
defpermanent tDSetDetEpi
defpermanent tPSetDetEpi
defpermanent tNSetDetEpi
defpermanent tSiSetDetEpi
defpermanent wDMinDetWEpi
defpermanent wPMinDetWEpi
defpermanent wNMinDetWEpi
defpermanent wSiMinDetWEpi
defpermanent aCorO2BODEpi
defpermanent wO2MinDetWEpi
defpermanent wDDenitWEpi
defpermanent wNDenitWEpi
defpermanent aCorO2NitrWEpi
defpermanent wNNitrWEpi
defpermanent wO2NitrWEpi
defpermanent tDMinOxyDetS
defpermanent tO2MinDetS
defpermanent tDDenitS
defpermanent tNDenitS
defpermanent tNNitrS
defpermanent tO2NitrS
defpermanent tDMinHumS
defpermanent tPMinHumS
defpermanent tNMinHumS
defpermanent tPDifPO4Epi
defpermanent tNDifNO3Epi
defpermanent tNDifNH4Epi
defpermanent tO2DifEpi
defpermanent aPAdsMaxWEpi
defpermanent aKPAdsWEpi
defpermanent aPIsoAdsWEpi
defpermanent aPEqIMWEpi
defpermanent wPSorpIMWEpi
defpermanent aPAdsMaxS
defpermanent aKPAdsS
defpermanent aPIsoAdsS
defpermanent aPEqIMS
defpermanent tPSorpIMS
defpermanent wO2AbioWHyp
defpermanent wPAbioDetWHyp
defpermanent wPAbioPO4WHyp
defpermanent wPAbioAIMWHyp
defpermanent tPAbioTotT
defpermanent wNAbioNH4WHyp
defpermanent wNAbioNO3WHyp
defpermanent wNAbioDetWHyp
defpermanent wSiAbioSiO2WHyp
defpermanent wSiAbioDetWHyp
defpermanent wDAbioDetWHyp
defpermanent wDAbioIMWHyp
defpermanent wDAbioIMWEpi
defpermanent wDAbioDetWEpi
defpermanent tDAbioIMS
defpermanent tDAbioDetS
defpermanent tDAbioHumS
defpermanent tDAbioTotT
defpermanent wO2AbioWEpi
defpermanent wO2AbioM
defpermanent wPAbioDetWEpi
defpermanent wPAbioPO4WEpi
defpermanent wPAbioAIMWEpi
defpermanent tPAbioDetS
defpermanent tPAbioHumS
defpermanent tPAbioPO4S
defpermanent tPAbioAIMS
defpermanent wNAbioNH4WEpi
defpermanent wNAbioNO3WEpi
defpermanent wNAbioDetWEpi
defpermanent tNAbioNH4S
defpermanent tNAbioNO3S
defpermanent tNAbioDetS
defpermanent tNAbioHumS
defpermanent tNAbioTotT
defpermanent wSiAbioSiO2WEpi
defpermanent wSiAbioDetWEpi
defpermanent tSiAbioDetS
defpermanent tDProdSubVegEpi
defpermanent tDMortVegWEpi
defpermanent tDMortVegSEpi
defpermanent tDBedVeg
defpermanent tO2ProdVegEpi
defpermanent tO2RespVegWEpi
defpermanent tO2ProdVegSEpi
defpermanent tO2ProdVegWEpi
defpermanent tO2BedS
defpermanent tO2UptNO3VegWEpi
defpermanent tPMortVegEpi
defpermanent tPMortVegPO4Epi
defpermanent tPMortVegPO4SEpi
defpermanent tPMortVegPO4WEpi
defpermanent tPMortVegDetEpi
defpermanent tPMortVegDetWEpi
defpermanent tPMortVegDetSEpi
defpermanent tPBedVeg
defpermanent tNMortVegNH4WEpi
defpermanent tNMortVegDetEpi
defpermanent tNMortVegDetWEpi
defpermanent tNMortVegDetSEpi
defpermanent tNBedVeg
defpermanent wDBedDetWEpi
defpermanent tDBedDetSEpi
defpermanent wPBedPO4WEpi
defpermanent wPBedDetWEpi
defpermanent tPBedPO4S
defpermanent tPBedDetS
defpermanent wNBedNH4WEpi
defpermanent wNBedNO3WEpi
defpermanent wNBedDetWEpi
defpermanent tNBedNH4S
defpermanent tNBedNO3S
defpermanent tNBedDetS
defpermanent tO2BedWEpi
defpermanent aVPUptMaxCrBlueEpi
defpermanent aVPUptBlueEpi
defpermanent wPUptBlueEpi
defpermanent aVNUptMaxCrBlueEpi
defpermanent ahNUptBlueEpi
defpermanent aVNUptBlueEpi
defpermanent wNUptBlueEpi
defpermanent afNH4UptBlueEpi
defpermanent wNUptNH4BlueEpi
defpermanent wNUptNO3BlueEpi
defpermanent aPLimBlueEpi
defpermanent aNLimBlueEpi
defpermanent aSiLimBlueEpi
defpermanent aLLimBlueEpi
defpermanent aMuTmLBlueEpi
defpermanent aNutLimBlueEpi
defpermanent aMuBlueEpi
defpermanent wDAssBlueEpi
defpermanent rChDBlueEpi
defpermanent oChlaBlueEpi
defpermanent aExtChBlueEpi
defpermanent wDRespBlueWEpi
defpermanent wDLossBlueEpi
defpermanent wDMortBlueWEpi
defpermanent ukDDecBlueEpi
defpermanent wPExcrBlueWEpi
defpermanent wPLossBlueEpi
defpermanent wPMortBlueWEpi
defpermanent wNExcrBlueWEpi
defpermanent wNLossBlueEpi
defpermanent wNMortBlueWEpi
defpermanent wDPrimBlueWEpi
defpermanent wPPrimBlueWEpi
defpermanent wNPrimBlueWEpi
defpermanent tDPrimBlueS
defpermanent tPPrimBlueS
defpermanent tNPrimBlueS
defpermanent aVPUptMaxCrGrenEpi
defpermanent aVPUptGrenEpi
defpermanent wPUptGrenEpi
defpermanent aVNUptMaxCrGrenEpi
defpermanent ahNUptGrenEpi
defpermanent aVNUptGrenEpi
defpermanent wNUptGrenEpi
defpermanent afNH4UptGrenEpi
defpermanent wNUptNH4GrenEpi
defpermanent wNUptNO3GrenEpi
defpermanent aPLimGrenEpi
defpermanent aNLimGrenEpi
defpermanent aSiLimGrenEpi
defpermanent aLLimGrenEpi
defpermanent aMuTmLGrenEpi
defpermanent aNutLimGrenEpi
defpermanent aMuGrenEpi
defpermanent wDAssGrenEpi
defpermanent rChDGrenEpi
defpermanent oChlaGrenEpi
defpermanent aExtChGrenEpi
defpermanent wDRespGrenWEpi
defpermanent wDLossGrenEpi
defpermanent wDMortGrenWEpi
defpermanent ukDDecGrenEpi
defpermanent wPExcrGrenWEpi
defpermanent wPLossGrenEpi
defpermanent wPMortGrenWEpi
defpermanent wNExcrGrenWEpi
defpermanent wNLossGrenEpi
defpermanent wNMortGrenWEpi
defpermanent wDPrimGrenWEpi
defpermanent wPPrimGrenWEpi
defpermanent wNPrimGrenWEpi
defpermanent tDPrimGrenS
defpermanent tPPrimGrenS
defpermanent tNPrimGrenS
defpermanent aVPUptMaxCrDiatEpi
defpermanent aVPUptDiatEpi
defpermanent wPUptDiatEpi
defpermanent aVNUptMaxCrDiatEpi
defpermanent ahNUptDiatEpi
defpermanent aVNUptDiatEpi
defpermanent wNUptDiatEpi
defpermanent afNH4UptDiatEpi
defpermanent wNUptNH4DiatEpi
defpermanent wNUptNO3DiatEpi
defpermanent aPLimDiatEpi
defpermanent aNLimDiatEpi
defpermanent aSiLimDiatEpi
defpermanent aLLimDiatEpi
defpermanent aMuTmLDiatEpi
defpermanent aNutLimDiatEpi
defpermanent aMuDiatEpi
defpermanent wDAssDiatEpi
defpermanent rChDDiatEpi
defpermanent oChlaDiatEpi
defpermanent aExtChDiatEpi
defpermanent wDRespDiatWEpi
defpermanent wDLossDiatEpi
defpermanent wDMortDiatWEpi
defpermanent ukDDecDiatEpi
defpermanent wPExcrDiatWEpi
defpermanent wPLossDiatEpi
defpermanent wPMortDiatWEpi
defpermanent wNExcrDiatWEpi
defpermanent wNLossDiatEpi
defpermanent wNMortDiatWEpi
defpermanent wDPrimDiatWEpi
defpermanent wPPrimDiatWEpi
defpermanent wNPrimDiatWEpi
defpermanent tDPrimDiatS
defpermanent tPPrimDiatS
defpermanent tNPrimDiatS
defpermanent oChlaEpi
defpermanent oChla
defpermanent aLPIEpi
defpermanent aLMeasEpi
defpermanent oChlaMeasEpi
defpermanent wDAssPhytEpi
defpermanent wDRespPhytWEpi
defpermanent wDMortPhytWEpi
defpermanent tDSetPhytEpi
defpermanent wDLossPhytEpi
defpermanent wDPrimPhytWEpi
defpermanent wPUptPhytEpi
defpermanent wPExcrPhytWEpi
defpermanent wPMortPhytWEpi
defpermanent tPSetPhytEpi
defpermanent wPLossPhytEpi
defpermanent wPPrimPhytWEpi
defpermanent wNUptPhytEpi
defpermanent wNUptNH4PhytEpi
defpermanent wNUptNO3PhytEpi
defpermanent wNExcrPhytWEpi
defpermanent wNMortPhytWEpi
defpermanent tNSetPhytEpi
defpermanent wNLossPhytEpi
defpermanent wNPrimPhytWEpi
defpermanent tDPrimPhytS
defpermanent tPPrimPhytS
defpermanent tNPrimPhytS
defpermanent wSiUptDiatEpi
defpermanent wSiExcrDiatWEpi
defpermanent wSiLossDiatEpi
defpermanent wSiMortDiatWEpi
defpermanent tSiSetDiatEpi
defpermanent wSiPrimDiatWHyp
defpermanent wSiPrimDiatWEpi
defpermanent rCyDBlueEpi
defpermanent oCyanEpi
defpermanent fDDiatEpi
defpermanent wDPrimDetWEpi
defpermanent tDPrimDetS
defpermanent tDPrimTotT
defpermanent wO2ProdPhytEpi
defpermanent wO2RespPhytWEpi
defpermanent wO2UptNO3PhytEpi
defpermanent wO2PrimWEpi
defpermanent tO2RespPhytS
defpermanent tO2PrimS
defpermanent tO2PrimSHyp
defpermanent tO2PrimSEpi
defpermanent wPMortPhytPO4WEpi
defpermanent wPMortPhytDetWEpi
defpermanent wPLossPhytPO4Epi
defpermanent wPLossPhytDetEpi
defpermanent wPPrimPO4WEpi
defpermanent wPPrimDetWEpi
defpermanent tPPrimDetS
defpermanent wNMortPhytNH4WEpi
defpermanent wNMortPhytDetWEpi
defpermanent wNLossPhytNH4Epi
defpermanent wNLossPhytDetEpi
defpermanent wNPrimNH4WEpi
defpermanent wNPrimNO3WEpi
defpermanent wNPrimDetWEpi
defpermanent tNPrimDetS
defpermanent wSiPrimSiO2WEpi
defpermanent wSiPrimDetWEpi
defpermanent tSiPrimDiatS
defpermanent tSiPrimDetS
defpermanent aDepthEuphEpi
defpermanent aRelDepthEuphEpi
defpermanent aChlaHEpi
defpermanent aCovPhytWEpi
defpermanent rExtChPhytEpi
defpermanent rPDZooEpi
defpermanent rNDZooEpi
defpermanent oDFoodZooEpi
defpermanent aFiltEpi
defpermanent aDSatZooEpi
defpermanent wDEnvZooEpi
defpermanent wDAssZooEpi
defpermanent wDConsZooEpi
defpermanent wDConsDetZooEpi
defpermanent wDConsDiatZooEpi
defpermanent wDConsGrenZooEpi
defpermanent wDConsBlueZooEpi
defpermanent wDConsPhytZooEpi
defpermanent wDEgesZooEpi
defpermanent aCorDRespZooEpi
defpermanent wDRespZooEpi
defpermanent wDMortZooEpi
defpermanent oPFoodZooEpi
defpermanent rPDFoodZooEpi
defpermanent wPConsDiatZooEpi
defpermanent wPConsGrenZooEpi
defpermanent wPConsBlueZooEpi
defpermanent wPConsPhytZooEpi
defpermanent wPConsDetZooEpi
defpermanent wPConsZooEpi
defpermanent afPAssZooEpi
defpermanent wPAssZooEpi
defpermanent wPEgesZooEpi
defpermanent wPEgesZooPO4Epi
defpermanent wPEgesZooDetEpi
defpermanent akPExcrZooEpi
defpermanent wPExcrZooEpi
defpermanent wPMortZooEpi
defpermanent wPMortZooPO4Epi
defpermanent wPMortZooDetEpi
defpermanent oNFoodZooEpi
defpermanent rNDFoodZooEpi
defpermanent wNConsDiatZooEpi
defpermanent wNConsGrenZooEpi
defpermanent wNConsBlueZooEpi
defpermanent wNConsPhytZooEpi
defpermanent wNConsDetZooEpi
defpermanent wNConsZooEpi
defpermanent afNAssZooEpi
defpermanent wNAssZooEpi
defpermanent wNEgesZooEpi
defpermanent wNEgesZooNH4Epi
defpermanent wNEgesZooDetEpi
defpermanent kNExcrZooEpi
defpermanent wNExcrZooEpi
defpermanent wNMortZooEpi
defpermanent wNMortZooNH4Epi
defpermanent wNMortZooDetEpi
defpermanent wSiConsDiatZooEpi
defpermanent rPDFiJv
defpermanent rPDFiAd
defpermanent rNDFiJv
defpermanent rNDFiAd
defpermanent tDReprFish
defpermanent tDAgeFish
defpermanent aDTotZoo
defpermanent aPTotZoo
defpermanent aNTotZoo
defpermanent aDSatFiJv
defpermanent tDEnvFiJv
defpermanent tDAssFiJv
defpermanent tDConsFiJv
defpermanent tDEgesFiJv
defpermanent tDRespFiJv
defpermanent tDMortFiJv
defpermanent tDMigrFiJv
defpermanent tDEnvFiAd
defpermanent tDAssFiAd
defpermanent tDConsFiAd
defpermanent tDEgesFiAd
defpermanent tDRespFiAd
defpermanent tDMortFiAd
defpermanent tDHarvFish
defpermanent tDMigrFiAd
defpermanent tDMortFiJvBot
defpermanent tDMortFiJvDet
defpermanent tDMortFiAdBot
defpermanent tDMortFiAdDet
defpermanent tPReprFish
defpermanent tPAgeFish
defpermanent tPMigrFiJv
defpermanent tPConsFiJv
defpermanent afPAssFiJv
defpermanent tPAssFiJv
defpermanent tPEgesFiJv
defpermanent tPExcrFiJv
defpermanent tPMortFiJv
defpermanent tPMigrFiAd
defpermanent tPConsFiAd
defpermanent tPAssFiAd
defpermanent tPEgesFiAd
defpermanent tPExcrFiAd
defpermanent tPMortFiAd
defpermanent tPHarvFish
defpermanent tPMortFiJvBot
defpermanent tPMortFiJvPO4
defpermanent tPMortFiJvDet
defpermanent tPMortFiAdBot
defpermanent tPMortFiAdPO4
defpermanent tPMortFiAdDet
defpermanent tPEgesFiJvPO4
defpermanent tPEgesFiJvDet
defpermanent tPEgesFiAdPO4
defpermanent tPEgesFiAdDet
defpermanent tNReprFish
defpermanent tNAgeFish
defpermanent tNMigrFiJv
defpermanent tNConsFiJv
defpermanent afNAssFiJv
defpermanent tNAssFiJv
defpermanent tNEgesFiJv
defpermanent tNExcrFiJv
defpermanent tNMortFiJv
defpermanent tNMigrFiAd
defpermanent tNConsFiAd
defpermanent tNAssFiAd
defpermanent tNEgesFiAd
defpermanent tNExcrFiAd
defpermanent tNMortFiAd
defpermanent tNHarvFish
defpermanent tNMortFiAdBot
defpermanent tNMortFiAdNH4
defpermanent tNMortFiAdDet
defpermanent tNMortFiJvBot
defpermanent tNMortFiJvNH4
defpermanent tNMortFiJvDet
defpermanent tNEgesFiJvNH4
defpermanent tNEgesFiJvDet
defpermanent tDMigrPisc
defpermanent aDFish
defpermanent aDSatPisc
defpermanent tDEnvPisc
defpermanent tDAssPisc
defpermanent tDConsPisc
defpermanent tDEgesPisc
defpermanent tDConsFiJvPisc
defpermanent tDConsFiAdPisc
defpermanent tDRespPisc
defpermanent tDMortPisc
defpermanent tDMortPiscBot
defpermanent tDMortPiscDet
defpermanent tDHarvPisc
defpermanent aPPisc
defpermanent tPConsFiJvPisc
defpermanent tPConsFiAdPisc
defpermanent tPConsPisc
defpermanent rPDFoodPisc
defpermanent afPAssPisc
defpermanent tPAssPisc
defpermanent tPEgesPisc
defpermanent tPEgesPiscPO4
defpermanent tPEgesPiscDet
defpermanent tPExcrPisc
defpermanent tPMortPisc
defpermanent tPMortPiscBot
defpermanent tPMortPiscPO4
defpermanent tPMortPiscDet
defpermanent tPMigrPisc
defpermanent tPHarvPisc
defpermanent aNPisc
defpermanent tNConsFiJvPisc
defpermanent tNConsFiAdPisc
defpermanent tNConsPisc
defpermanent rNDFoodPisc
defpermanent afNAssPisc
defpermanent tNAssPisc
defpermanent tNEgesPisc
defpermanent tNEgesPiscNH4
defpermanent tNEgesPiscDet
defpermanent tNExcrPisc
defpermanent tNMortPisc
defpermanent tNMortPiscBot
defpermanent tNMortPiscNH4
defpermanent tNMortPiscDet
defpermanent tNMigrPisc
defpermanent tNHarvPisc
defpermanent tDWebBent
defpermanent tPWebBent
defpermanent tNWebBent
defpermanent tDWebFiJv
defpermanent tPWebFiJv
defpermanent tNWebFiJv
defpermanent tDWebFiAd
defpermanent tPWebFiAd
defpermanent tNWebFiAd
defpermanent tDWebPisc
defpermanent wDWebZooHyp
defpermanent wDWebDetWHyp
defpermanent wDWebDiatWHyp
defpermanent wDWebGrenWHyp
defpermanent wDWebBlueWHyp
defpermanent wDWebZooEpi
defpermanent wDWebDetWEpi
defpermanent wDWebDiatWEpi
defpermanent wDWebGrenWEpi
defpermanent wDWebBlueWEpi
defpermanent tDWebTotT
defpermanent wPWebZooHyp
defpermanent wPWebPO4WHyp
defpermanent wPWebDetWHyp
defpermanent wPWebDiatWHyp
defpermanent wPWebGrenWHyp
defpermanent wPWebBlueWHyp
defpermanent wPWebZooEpi
defpermanent wPWebPO4WEpi
defpermanent wPWebDetWEpi
defpermanent wPWebDiatWEpi
defpermanent wPWebGrenWEpi
defpermanent wPWebBlueWEpi
defpermanent tPWebTotT
defpermanent tNEgesFiAdNH4
defpermanent tNEgesFiAdDet
defpermanent wNWebNO3WHyp
defpermanent wNWebNO3WEpi
defpermanent wNWebZooHyp
defpermanent wNWebNH4WHyp
defpermanent wNWebDetWHyp
defpermanent wNWebDiatWHyp
defpermanent wNWebGrenWHyp
defpermanent wNWebBlueWHyp
defpermanent wNWebZooEpi
defpermanent wNWebNH4WEpi
defpermanent wNWebDetWEpi
defpermanent wNWebDiatWEpi
defpermanent wNWebGrenWEpi
defpermanent wNWebBlueWEpi
defpermanent tNWebTotT
defpermanent wSiWebDetWEpi
defpermanent aPrefAveEpi
defpermanent wDConsZoo2Epi
defpermanent aDConsZooSpEpi
defpermanent aDAssZooSpEpi
defpermanent aDGrazSpEpi
defpermanent aPConsZooSpEpi
defpermanent aPGrazSpEpi
defpermanent aNConsZooSpEpi
defpermanent aNGrazSpEpi
defpermanent tDSetTotEpi
defpermanent tPSetTotEpi
defpermanent tNSetTotEpi
defpermanent tDResusTot
defpermanent tPResusTot
defpermanent tNResusTot
defpermanent aDepthStart
defpermanent akDredDepth
defpermanent akDred
defpermanent akDredBent
defpermanent vDredDepthW
defpermanent tDDredDetS
defpermanent tPDredDetS
defpermanent tNDredDetS
defpermanent tSiDredDetS
defpermanent tPDredAIMS
defpermanent tDDredNetSoil
defpermanent tDDredNetIMS
defpermanent tDDredNetHumS
defpermanent tPDredNetHumS
defpermanent tNDredNetHumS
defpermanent tDDredDiatS
defpermanent tPDredDiatS
defpermanent tNDredDiatS
defpermanent tDDredGrenS
defpermanent tPDredGrenS
defpermanent tNDredGrenS
defpermanent tDDredBlueS
defpermanent tPDredBlueS
defpermanent tNDredBlueS
defpermanent tDDredPhytS
defpermanent tPDredPhytS
defpermanent tNDredPhytS
defpermanent tDDredBent
defpermanent tPDredBent
defpermanent tNDredBent
defpermanent tDDredVeg
defpermanent tPDredVeg
defpermanent tNDredVeg
defpermanent tDDredNetTot
defpermanent tPDredNetTot
defpermanent tNDredNetTot
defpermanent tSiDredTot
defpermanent tDIMS
defpermanent tDHumS
defpermanent tDDetS
defpermanent vDeltaS
defpermanent vDeltaW
defpermanent tDBurIM
defpermanent tDBurOM
defpermanent tDBurDet
defpermanent tDBurHum
defpermanent tDBurTot
defpermanent tPBurHum
defpermanent tPBurDet
defpermanent tPBurAIM
defpermanent tPBurPO4
defpermanent tPBurTot
defpermanent tNBurHum
defpermanent tNBurDet
defpermanent tNBurNH4
defpermanent tNBurNO3
defpermanent tNBurTot
defpermanent tSiBurDet
defpermanent tSiBurTot
defpermanent aRelDeltaWEpi
defpermanent aRelDeltaWHyp
defpermanent aPFish
defpermanent aNFish
defpermanent aDRelTotT
defpermanent aNRelTotT
defpermanent aPRelTotT
defpermanent aSiRelTotT
defpermanent aO2RelTotT
defpermanent aDTotTHyp
defpermanent aNTotTHyp
defpermanent aPTotTHyp
defpermanent aSiTotTHyp
defpermanent aO2TotTHyp
defpermanent aDTotT
defpermanent aNTotT
defpermanent aPTotT
defpermanent aSiTotT
defpermanent aO2TotT
defpermanent tDBedTotT
defpermanent tPBedTotT
defpermanent tNBedTotT
defpermanent aDError
defpermanent aNError
defpermanent aPError
defpermanent aSiError
defpermanent aO2Error
defpermanent dDepthWHyp
defpermanent dNH4WHyp
defpermanent dNO3WHyp
defpermanent dPO4WHyp
defpermanent dPAIMWHyp
defpermanent dSiO2WHyp
defpermanent dO2WHyp
defpermanent dDDetWHyp
defpermanent dNDetWHyp
defpermanent dPDetWHyp
defpermanent dSiDetWHyp
defpermanent dDIMWHyp
defpermanent dDDiatWHyp
defpermanent dNDiatWHyp
defpermanent dPDiatWHyp
defpermanent dDGrenWHyp
defpermanent dNGrenWHyp
defpermanent dPGrenWHyp
defpermanent dDBlueWHyp
defpermanent dNBlueWHyp
defpermanent dPBlueWHyp
defpermanent dDZooHyp
defpermanent dNZooHyp
defpermanent dPZooHyp
defpermanent dDFiAd
defpermanent dDFiJv
defpermanent dNFiAd
defpermanent dNFiJv
defpermanent dPFiAd
defpermanent dPFiJv
defpermanent dDPisc
defpermanent dNH4S
defpermanent dNO3S
defpermanent dPO4S
defpermanent dPAIMS
defpermanent dDDetS
defpermanent dNDetS
defpermanent dPDetS
defpermanent dSiDetS
defpermanent dDHumS
defpermanent dNHumS
defpermanent dPHumS
defpermanent dDIMS
defpermanent dDDiatS
defpermanent dNDiatS
defpermanent dPDiatS
defpermanent dDGrenS
defpermanent dNGrenS
defpermanent dPGrenS
defpermanent dDBlueS
defpermanent dNBlueS
defpermanent dPBlueS
defpermanent dDVeg
defpermanent dNVeg
defpermanent dPVeg
defpermanent dDBent
defpermanent dNBent
defpermanent dPBent
defpermanent dDepthWM
defpermanent dNH4WM
defpermanent dNO3WM
defpermanent dPO4WM
defpermanent dPAIMWM
defpermanent dSiO2WM
defpermanent dO2WM
defpermanent dDDetWM
defpermanent dNDetWM
defpermanent dPDetWM
defpermanent dSiDetWM
defpermanent dDIMWM
defpermanent dDDiatWM
defpermanent dNDiatWM
defpermanent dPDiatWM
defpermanent dDGrenWM
defpermanent dNGrenWM
defpermanent dPGrenWM
defpermanent dDBlueWM
defpermanent dNBlueWM
defpermanent dPBlueWM
defpermanent dDZooM
defpermanent dNZooM
defpermanent dPZooM
defpermanent dNH4SM
defpermanent dNO3SM
defpermanent dPO4SM
defpermanent dPAIMSM
defpermanent dDDetSM
defpermanent dNDetSM
defpermanent dPDetSM
defpermanent dSiDetSM
defpermanent dDHumSM
defpermanent dNHumSM
defpermanent dPHumSM
defpermanent dDIMSM
defpermanent dDRootPhra
defpermanent dDShootPhra
defpermanent dNRootPhra
defpermanent dNShootPhra
defpermanent dPRootPhra
defpermanent dPShootPhra
defpermanent dDepthWEpi
defpermanent dNH4WEpi
defpermanent dNO3WEpi
defpermanent dPO4WEpi
defpermanent dPAIMWEpi
defpermanent dSiO2WEpi
defpermanent dO2WEpi
defpermanent dDDetWEpi
defpermanent dNDetWEpi
defpermanent dPDetWEpi
defpermanent dSiDetWEpi
defpermanent dDIMWEpi
defpermanent dDDiatWEpi
defpermanent dNDiatWEpi
defpermanent dPDiatWEpi
defpermanent dDGrenWEpi
defpermanent dNGrenWEpi
defpermanent dPGrenWEpi
defpermanent dDBlueWEpi
defpermanent dNBlueWEpi
defpermanent dPBlueWEpi
defpermanent dDZooEpi
defpermanent dNZooEpi
defpermanent dPZooEpi
defpermanent dDExtTotT
defpermanent dNExtTotT
defpermanent dPExtTotT
defpermanent dSiExtTotT
defpermanent dO2ExtTotT
sTime = t + DayStart;
if CalcMass == true 
MassHyp = sDepthWHyp 
else
MassHyp = 1.0 
end;
if CalcMass == true 
MassEpi = sDepthWEpi 
else
MassEpi = 1.0 
end;
if CalcMass == true 
MassWM = sDepthWM 
else
MassWM = 1.0 
end;
oNH4WHyp = sNH4WHyp / MassHyp;
oNO3WHyp = sNO3WHyp / MassHyp;
oPO4WHyp = sPO4WHyp / MassHyp;
oPAIMWHyp = sPAIMWHyp / MassHyp;
oSiO2WHyp = sSiO2WHyp / MassHyp;
oO2WHyp = sO2WHyp / MassHyp;
oDDetWHyp = sDDetWHyp / MassHyp;
oNDetWHyp = sNDetWHyp / MassHyp;
oPDetWHyp = sPDetWHyp / MassHyp;
oSiDetWHyp = sSiDetWHyp / MassHyp;
oDIMWHyp = sDIMWHyp / MassHyp;
oDDiatWHyp = sDDiatWHyp / MassHyp;
oNDiatWHyp = sNDiatWHyp / MassHyp;
oPDiatWHyp = sPDiatWHyp / MassHyp;
oDGrenWHyp = sDGrenWHyp / MassHyp;
oNGrenWHyp = sNGrenWHyp / MassHyp;
oPGrenWHyp = sPGrenWHyp / MassHyp;
oDBlueWHyp = sDBlueWHyp / MassHyp;
oNBlueWHyp = sNBlueWHyp / MassHyp;
oPBlueWHyp = sPBlueWHyp / MassHyp;
oDZooHyp = sDZooHyp / MassHyp;
oNZooHyp = sNZooHyp / MassHyp;
oPZooHyp = sPZooHyp / MassHyp;
oNH4WM = sNH4WM / MassWM;
oNO3WM = sNO3WM / MassWM;
oPO4WM = sPO4WM / MassWM;
oPAIMWM = sPAIMWM / MassWM;
oSiO2WM = sSiO2WM / MassWM;
oO2WM = sO2WM / MassWM;
oDDetWM = sDDetWM / MassWM;
oNDetWM = sNDetWM / MassWM;
oPDetWM = sPDetWM / MassWM;
oSiDetWM = sSiDetWM / MassWM;
oDIMWM = sDIMWM / MassWM;
oDDiatWM = sDDiatWM / MassWM;
oNDiatWM = sNDiatWM / MassWM;
oPDiatWM = sPDiatWM / MassWM;
oDGrenWM = sDGrenWM / MassWM;
oNGrenWM = sNGrenWM / MassWM;
oPGrenWM = sPGrenWM / MassWM;
oDBlueWM = sDBlueWM / MassWM;
oNBlueWM = sNBlueWM / MassWM;
oPBlueWM = sPBlueWM / MassWM;
oDZooM = sDZooM / MassWM;
oNZooM = sNZooM / MassWM;
oPZooM = sPZooM / MassWM;
oNH4WEpi = sNH4WEpi / MassEpi;
oNO3WEpi = sNO3WEpi / MassEpi;
oPO4WEpi = sPO4WEpi / MassEpi;
oPAIMWEpi = sPAIMWEpi / MassEpi;
oSiO2WEpi = sSiO2WEpi / MassEpi;
oO2WEpi = sO2WEpi / MassEpi;
oDDetWEpi = sDDetWEpi / MassEpi;
oNDetWEpi = sNDetWEpi / MassEpi;
oPDetWEpi = sPDetWEpi / MassEpi;
oSiDetWEpi = sSiDetWEpi / MassEpi;
oDIMWEpi = sDIMWEpi / MassEpi;
oDDiatWEpi = sDDiatWEpi / MassEpi;
oNDiatWEpi = sNDiatWEpi / MassEpi;
oPDiatWEpi = sPDiatWEpi / MassEpi;
oDGrenWEpi = sDGrenWEpi / MassEpi;
oNGrenWEpi = sNGrenWEpi / MassEpi;
oPGrenWEpi = sPGrenWEpi / MassEpi;
oDBlueWEpi = sDBlueWEpi / MassEpi;
oNBlueWEpi = sNBlueWEpi / MassEpi;
oPBlueWEpi = sPBlueWEpi / MassEpi;
oDZooEpi = sDZooEpi / MassEpi;
oNZooEpi = sNZooEpi / MassEpi;
oPZooEpi = sPZooEpi / MassEpi;
TimeYears = sTime / DaysPerYear;
Day = sTime - floor(TimeYears) * DaysPerYear;
Years = YearZero + TimeYears;
if ( calcMixDepth == true ) 
uDepthMix = cAMix * ( ( cFetch )^ (cBMix) ) 
else
uDepthMix = cDepthMix 
end;
if ( InclStrat == false || uDepthMix > cDepthW0 - cMinDepthHyp ) 
aInclStrat = 0.0 
else
aInclStrat = 1.0 
end;
if ( aInclStrat == true ) 
uDepthW = sDepthWHyp + sDepthWEpi 
else
uDepthW = sDepthWEpi 
end;
if ( cVegHeight < uDepthW ) 
uVegHeight = cVegHeight 
else
uVegHeight = uDepthW 
end;
if ( aInclStrat == false ) 
uVegHeightHyp = 0.0 
elseif (uVegHeight > sDepthWHyp ) 
uVegHeightHyp = sDepthWHyp 
else
uVegHeightHyp = uVegHeight 
end;
if ( aInclStrat == false && uVegHeight < sDepthWEpi ) 
uVegHeightEpi = uVegHeight 
elseif ( aInclStrat == false && uVegHeight >= sDepthWEpi ) 
uVegHeightEpi = sDepthWEpi 
elseif (uVegHeight > sDepthWHyp ) 
uVegHeightEpi = uVegHeight -sDepthWHyp 
else
uVegHeightEpi = 0.0 
end;
uVegHeightLight = cVegL *log( 1.0 + uVegHeight );
if (  uVegHeightLight > uVegHeightEpi ) 
uVegHeightLightEpi = uVegHeightEpi 
else
uVegHeightLightEpi = uVegHeightLight 
end;
uVegHeightLightHyp =  uVegHeightLight - uVegHeightLightEpi  ;
uDVegHyp = uVegHeightHyp / uVegHeight * sDVeg;
uDVegEpi = uVegHeightEpi / uVegHeight * sDVeg;
if ( ReadVegShade  ==  true) 
uVegShade = mVegShade 
else
uVegShade = fVegShade 
end;
aExtPhytHyp = cExtSpDiat * oDDiatWHyp + cExtSpGren * oDGrenWHyp + cExtSpBlue * oDBlueWHyp;
aExtDetHyp = cExtSpDet * oDDetWHyp;
aExtIMHyp = cExtSpIM * oDIMWHyp;
aExtCoefOpenHyp = cExtWat + aExtIMHyp + aExtDetHyp + aExtPhytHyp;
aExtPhytEpi = cExtSpDiat * oDDiatWEpi + cExtSpGren * oDGrenWEpi + cExtSpBlue * oDBlueWEpi;
aExtDetEpi = cExtSpDet * oDDetWEpi;
aExtIMEpi = cExtSpIM * oDIMWEpi;
aExtCoefOpenEpi = cExtWat + aExtIMEpi + aExtDetEpi + aExtPhytEpi;
aTmEpi =  cTmAveEpi - cTmVarEpi * cos(2.0*Pi*(sTime + TenDays - cTimeLag) / DaysInYear) ;
aTmHyp =  cTmAveHyp - cTmVarHyp * cos(2.0*Pi*(sTime + TenDays - cTimeLag) / DaysInYear) ;
if (false == InclSeason) 
uTmEpi = cTmAveEpi 
elseif (ReadTemp == true) 
uTmEpi = mTempEpi 
elseif ( aTmEpi > 0.0  ) 
uTmEpi = aTmEpi 
else
uTmEpi =  0.0 
end;
if (false == InclSeason) 
uTmHyp = cTmAveHyp 
elseif (ReadTemp == true) 
uTmHyp = mTempHyp 
elseif ( aTmHyp > 0.0  ) 
uTmHyp = aTmHyp 
else
uTmHyp =  0.0 
end;
if (aInclStrat == true ) 
uTmBot = uTmHyp 
else
uTmBot = uTmEpi 
end;
uLAT= cLAT*2*Pi/360;
if(InclLat == true) 
uSolDecAng = cPhiR*cos(2*Pi*(Day-cDayR)/DaysInYear) 
else
uSolDecAng = 0.0 
end;
if(InclLat == true) 
uSunRise = HoursInDay/(2*Pi)*acos((sin(uLAT)* sin(uSolDecAng))/(cos(uLAT)*cos(uSolDecAng))) 
else
uSunRise = 0.0 
end;
uSunSet=HoursInDay-uSunRise;
if(InclLat == true) 
uSunPath = sin(uLAT)*sin( uSolDecAng )*( uSunSet-uSunRise)- cos(uLAT) * cos (uSolDecAng) * HoursInDay / (2*Pi) * ( sin (2*Pi*uSunSet/HoursInDay ) -sin(2*Pi*uSunRise /HoursInDay )) 
else
uSunPath = 0.0 
end;
if((InclLat == true) && (ConstTrans == false)) 
uTrans = (0.6-0.2*(uSunPath/(uSunSet - uSunRise)))*(1-0.4*fCloudH) *(1-0.7* fCloudM) *(1-0.4*fCloudL)
elseif ((InclLat == true) && (ConstTrans == true)) 
uTrans = cTrans 
else
uTrans = 0.0 
end;
if (false == InclSeason) 
ufDay = cfDayAve 
elseif (InclLat == true) 
ufDay = (uSunSet -uSunRise )/ HoursInDay 
else
ufDay = cfDayAve - cfDayVar * cos( 2.0 *Pi*(sTime+TenDays) / DaysInYear) 
end;
if (false == InclSeason) 
uLDay = cLDayAve 
elseif (ReadLOut == true) 
uLDay = 0.0 
elseif (InclLat == true) 
uLDay = cSolar*uTrans*uSunPath * SecsPerDay /HoursInDay 
else
uLDay = cLDayAve - cLDayVar * cos(2.0*Pi*(sTime+TenDays) / DaysInYear) 
end;
if (false == InclSeason) 
uLOut = uLDay / SecsPerDay / ufDay 
elseif (ReadLOut == true) 
uLOut = mLOut / ufDay 
else
uLOut = uLDay / SecsPerDay / ufDay 
end;
uLPARSurf = fPAR * (1.0 - fRefl) * uLOut;
if ( aInclStrat == true ) 
aDepth2VegHyp = sDepthWHyp 
else
aDepth2VegHyp = 0.0 
end;
if ( aInclStrat == true ) 
aDepth1VegHyp = sDepthWHyp - uVegHeightHyp 
else
aDepth1VegHyp = 0.0 
end;
if ( aInclStrat == true ) 
aDepth1VegEpi = sDepthWEpi - uVegHeightEpi 
else
aDepth1VegEpi = fDepth1Veg * uDepthW 
end;
if ( aInclStrat == true ) 
aDepth2VegEpi = sDepthWEpi 
else
aDepth2VegEpi = fDepth2Veg * uDepthW 
end;
if (Day < 1.0 || sTime < BeginTime + 1.0) 
aDayInitVeg = 367 
elseif (uTmBot >= cTmInitVeg && aDayInitVeg > 366) 
aDayInitVeg = Day 
else
aDayInitVeg = aDayInitVeg 
end;
aLPARBotEpiOpen = uLPARSurf * exp(- aExtCoefOpenEpi * sDepthWEpi);
aLPARBotHypOpen = aLPARBotEpiOpen * exp(- aExtCoefOpenHyp * sDepthWEpi);
aLPAR1VegEpi = uLPARSurf * exp(- aExtCoefOpenEpi * aDepth1VegEpi) * ( 1 - uVegShade );
aLPAR1VegHyp = aLPAR1VegEpi * exp(- aExtCoefOpenHyp * aDepth1VegHyp);
if  ( aInclStrat == true &&  uVegHeight <= sDepthWHyp ) 
aLPARVegLight = aLPAR1VegHyp *   exp(- aExtCoefOpenHyp * uVegHeightLightEpi) 
else
aLPARVegLight = aLPAR1VegEpi *  exp(- aExtCoefOpenEpi * uVegHeightLightEpi)  *  exp(- aExtCoefOpenHyp * uVegHeightLightEpi) 
end;
uTmVegAve = ( uVegHeightHyp * uTmHyp + uVegHeightEpi * uTmEpi ) / uVegHeight;
uFunTmVeg = exp(-0.5/(cSigTmVeg*cSigTmVeg) *((uTmVegAve-cTmOptVeg)*(uTmVegAve-cTmOptVeg) - (cTmRef-cTmOptVeg)*(cTmRef-cTmOptVeg)));
if ( UsePowerVeg < NearZero ) 
uFunTmProdVeg = uFunTmVeg 
else
uFunTmProdVeg = ( ( cQ10ProdVeg )^ (0.1 * (uTmVegAve - cTmRef))) 
end;
uhLVeg = hLRefVeg * uFunTmProdVeg;
if ( aInclStrat == true &&  uVegHeight > sDepthWHyp ) 
aLPIVeg = cPMax*(aLPAR1VegEpi- aLPARVegLight + uhLVeg*log((1.0 +aLPARVegLight/ uhLVeg)  /(1.0 +aLPAR1VegEpi  / uhLVeg) + NearZero  ) )
elseif  ( aInclStrat == true &&  uVegHeight <= sDepthWHyp ) 
aLPIVeg = cPMax*( aLPAR1VegHyp- aLPARVegLight + uhLVeg* log((1.0 +aLPARVegLight/ uhLVeg)  / (1.0 +aLPAR1VegHyp  / uhLVeg) ) ) 
else
aLPIVeg = cPMax * (aLPAR1VegEpi- aLPARVegLight + uhLVeg*log((1.0 +aLPARVegLight/ uhLVeg)  /(1.0 +aLPAR1VegEpi  / uhLVeg) + NearZero  ) )
end;
if UseLWinVeg <= NearZero 
uDayWinVeg = cDayWinVeg 
elseif (Day < 1.0 || sTime < BeginTime + 1.0) 
uDayWinVeg = 367 
elseif (( aLPIVeg / uVegHeightLight )<= cLAlloVeg && uDayWinVeg > 366 && Day > 183 ) 
uDayWinVeg = Day 
else
uDayWinVeg = uDayWinVeg 
end;
if (false == InclSeason) 
bfRootVeg = fRootVegSum 
elseif (Day < aDayInitVeg) 
bfRootVeg = fRootVegWin 
elseif (Day < aDayInitVeg + cLengAllo) 
bfRootVeg = 0.5*(fRootVegWin + fRootVegSum) + 0.5*(fRootVegWin - fRootVegSum) * cos(Pi/cLengAllo * (Day - aDayInitVeg)) 
elseif (Day < uDayWinVeg) 
bfRootVeg = fRootVegSum 
elseif (Day < uDayWinVeg + cLengAllo) 
bfRootVeg = 0.5*(fRootVegWin + fRootVegSum) - 0.5*(fRootVegWin - fRootVegSum) * cos(Pi/cLengAllo * (Day - uDayWinVeg)) 
else
bfRootVeg = fRootVegWin 
end;
bfShootVeg = 1.0 - bfRootVeg;
aDShootVeg = bfShootVeg * sDVeg;
aDEmergVeg = fEmergVeg * aDShootVeg;
aDFloatVeg = fFloatVeg * aDShootVeg;
bfSubVeg = 1.0 - fFloatVeg - fEmergVeg;
aDSubVeg = bfSubVeg * aDShootVeg;
aExtVegHyp = cExtSpVeg * aDSubVeg / sDepthWHyp * (uVegHeightHyp /uDepthW );
aExtCoefHyp = aExtCoefOpenHyp + aExtVegHyp;
aExtVegEpi = cExtSpVeg * aDSubVeg / sDepthWEpi * (uVegHeightEpi /uDepthW ) ;
aExtCoefEpi = aExtCoefOpenEpi + aExtVegEpi;
aLPARBotEpi = uLPARSurf * exp(- aExtCoefEpi * sDepthWEpi);
if ( aInclStrat == true ) 
uLPARSurfHyp = aLPARBotEpi 
else
uLPARSurfHyp = 0.0 
end;
aLPAR2VegEpi = aLPAR1VegEpi * exp(- aExtCoefEpi * (aDepth2VegEpi - aDepth1VegEpi));
aLPAR2VegHyp = aLPAR1VegHyp * exp(- aExtCoefHyp * (aDepth2VegHyp - aDepth1VegHyp));
if (ReadVWind == true)
uVWind = mVWind 
else
uVWind = cVWind 
end;
if (ReadStrat == true) 
aStrat = mStrat 
elseif ((uTmEpi -uTmHyp) >  cStratTm || (uTmHyp -uTmEpi) >  cStratTm) 
aStrat = 1.0  
else
aStrat = 0.0 
end;
if (false == UseSeasonLoad) 
uQInSeason = 0.0 
elseif (Day < cDayApril1 - 0.5*cLengChange) 
uQInSeason = cQInWin 
elseif (Day < cDayApril1 + 0.5*cLengChange) 
uQInSeason = 0.5*(cQInWin + cQInSum) + 0.5*(cQInWin - cQInSum) * cos(Pi/cLengChange * (Day - cDayApril1)) 
elseif (Day < cDayOct1 - 0.5*cLengChange) 
uQInSeason = cQInSum 
elseif (Day < cDayOct1 + 0.5*cLengChange) 
uQInSeason = 0.5*(cQInWin + cQInSum) - 0.5*(cQInWin - cQInSum) * cos(Pi/cLengChange * (Day - cDayOct1)) 
else
uQInSeason = cQInWin 
end;
uQEvSinus = cQEvAve - cQEvVar * cos(2.0*Pi * (sTime + TenDays - cTimeLag) / DaysInYear);
if (10 *uTmEpi /cHeath) <= NearZero 
aQEv = 16 * 2*ufDay * 1 / 30 * ( ( NearZero )^ (cAlpha) ) 
else
aQEv = 16 * 2*ufDay * 1 / 30 * ( ( 10 *uTmEpi /cHeath )^ (cAlpha) ) 
end;
if (false == InclSeason) 
uQEv = cQEvAve 
elseif (ReadQEv == true) 
uQEv = mQEv 
elseif (calcQEv == true ) 
uQEv = aQEv 
else
uQEv = uQEvSinus 
end;
if ((Day >= cDayApril1 - 0.5*cLengChange) && (Day < cDayApril1 + 0.5*cLengChange)) 
uQInExtra = cQInExtraApril1 
elseif ( (Day >= cDayOct1 - 0.5*cLengChange) && (Day < cDayOct1 + 0.5*cLengChange) ) 
uQInExtra = cQInExtraOct1 
else
uQInExtra = 0.0 
end;
if (ReadQIn == true) 
uQIn = mQIn 
elseif (UseSeasonLoad == true) 
uQIn = uQInSeason + uQInExtra 
else
uQIn = cQIn + uQInExtra 
end;
if ((Day >= cDayApril1 - 0.5*cLengChange) && (Day < cDayApril1 + 0.5*cLengChange)) 
uQOutExtra = cQOutExtraApril1 
elseif ( (Day >= cDayOct1 - 0.5*cLengChange) && (Day < cDayOct1 + 0.5*cLengChange) ) 
uQOutExtra = cQOutExtraOct1 
else
uQOutExtra = 0.0 
end;
if (false == ConstDepth) 
uQOutEpi = 0.0 
elseif (ReadQOut == true) 
uQOutEpi = max(mQOut, (sDepthWEpi - cDepthWMax) * cMaxWOut * mmPerm) 
elseif (false == aInclStrat) 
uQOutEpi = max(0.0, (uQIn - uQInExtra) - uQEv - cQInf ) + uQOutExtra 
else
uQOutEpi = max(0.0, (uQIn - uQInExtra) - uQEv - cQInf ) + uQOutExtra 
end;
uQOutHyp = 0.0;
uQDilEpi = uQOutEpi;
uQDilHyp = uQOutHyp;
if (false == InclTran) 
ukDilEpi = 0.0 
else
ukDilEpi = uQDilEpi / mmPerm / sDepthWEpi 
end;
if (false == InclTran) 
ukDilHyp = 0.0 
else
ukDilHyp = uQDilHyp / mmPerm / sDepthWHyp 
end;
ukDilWatEpi = uQIn / mmPerm / sDepthWEpi;
ukDilWatHyp = 0.0;
if (false == InclTran) 
ukOutEpi = 0.0 
else
ukOutEpi = uQOutEpi / mmPerm / sDepthWEpi 
end;
if (false == InclTran) 
ukOutHyp = 0.0 
else
ukOutHyp = uQOutHyp / mmPerm / sDepthWHyp 
end;
if ( aInclStrat == false && cQInf < 0.0 ) 
uTauWatEpi = 1.0 / ((uQIn - cQInf) / mmPerm / sDepthWEpi +NearZero) 
else
uTauWatEpi = 1.0 / ((uQIn ) / mmPerm / sDepthWEpi +NearZero) 
end;
if ( aInclStrat == false )
uTauWatHyp = -9999 
elseif (cQInf < 0.0 ) 
uTauWatHyp = 1.0 / ((- cQInf ) / mmPerm / sDepthWHyp +NearZero) 
else
uTauWatHyp = 1.0 / ( cQInf / mmPerm / sDepthWHyp +NearZero) 
end;
if ( cQInf > 0.0 ) 
uTauWat = 1.0 / (uQIn / mmPerm / uDepthW +NearZero) 
else
uTauWat = 1.0 / ((uQIn - cQInf ) / mmPerm / uDepthW +NearZero) 
end;
uTauSubstHyp = 1.0 / (ukDilHyp+NearZero);
if (aInclStrat == true ) 
uFiJvMortHyp = fFiJvMortHyp 
else
uFiJvMortHyp = 0.0 
end;
if (aInclStrat == true ) 
uFiJvEgesHyp = fFiJvEgesHyp 
else
uFiJvEgesHyp = 0.0 
end;
if (aInclStrat == true ) 
uFiJvExcrHyp = fFiJvExcrHyp 
else
uFiJvExcrHyp = 0.0 
end;
if (aInclStrat == true ) 
uFiAdMortHyp = fFiAdMortHyp 
else
uFiAdMortHyp = 0.0 
end;
if (aInclStrat == true ) 
uFiAdEgesHyp = fFiAdEgesHyp 
else
uFiAdEgesHyp = 0.0 
end;
if (aInclStrat == true ) 
uFiAdExcrHyp = fFiAdExcrHyp 
else
uFiAdExcrHyp = 0.0 
end;
if (aInclStrat == true ) 
uPiscMortHyp = fPiscMortHyp 
else
uPiscMortHyp = 0.0 
end;
if (aInclStrat == true ) 
uPiscEgesHyp = fPiscEgesHyp 
else
uPiscEgesHyp = 0.0 
end;
if (aInclStrat == true ) 
uPiscExcrHyp = fPiscExcrHyp 
else
uPiscExcrHyp = 0.0 
end;
if ( ConstDepth == true) 
vTranDepthW = 0.0 
elseif (false == InclMarsh || fMarsh <= NearZero) 
vTranDepthW = (uQIn - uQEv - cQInf - uQOutHyp - uQOutEpi) / mmPerm 
else
vTranDepthW = ((uQIn - uQEv - cQInf - uQOutHyp - uQOutEpi) / mmPerm) / (1.0 + fMarsh) 
end;
if ( aStrat == true && uDepthMix <= sDepthWEpi ) 
vTranHypEpiW = 0.0 
else
vTranHypEpiW = ( uDepthMix -sDepthWEpi ) * kExchW 
end;
if ( ConstDepth == true || false == aInclStrat ) 
vDeltaWHyp = 0.0 
elseif (false == InclMarsh || fMarsh <= NearZero ) 
vDeltaWHyp = ( - cQInf - uQOutHyp) / mmPerm 
else
vDeltaWHyp = ( - cQInf - uQOutHyp) / mmPerm / (1.0 + fMarsh ) 
end;
if (ConstDepth == true ) 
vDeltaWEpi = 0.0 
elseif ( false == InclMarsh || fMarsh <= NearZero ) 
vDeltaWEpi = (uQIn - uQEv - uQOutEpi - cQInf ) / mmPerm 
else
vDeltaWEpi = (uQIn - uQEv - uQOutEpi - cQInf ) / mmPerm / (1.0 + fMarsh ) 
end;
if (aInclStrat == true && sDepthWHyp > NearZero) 
afVolHypEpi =  sDepthWHyp / sDepthWEpi 
else
afVolHypEpi = 0.0 
end;
if ( aInclStrat == true) 
uExchMaxW = kExchMaxW /( aStrat* fMeta * uDepthW + cDepthMetaMin ) 
else
uExchMaxW = 0.0 
end;
if (aInclStrat == true && sDepthWHyp > NearZero) 
akExchWHyp = ( uExchMaxW  + vTranHypEpiW ) / sDepthWHyp 
else
akExchWHyp = 0.0 
end;
if (aInclStrat == true ) 
akExchWEpi = akExchWHyp * afVolHypEpi 
else
akExchWEpi = 0.0 
end;
if (aInclStrat == true ) 
wDExchIMWHyp = akExchWHyp *(oDIMWHyp - oDIMWEpi) 
else
wDExchIMWHyp = 0.0 
end;
if (aInclStrat == true ) 
wPExchPO4WHyp = akExchWHyp *(oPO4WHyp - oPO4WEpi) 
else
wPExchPO4WHyp = 0.0 
end;
if (aInclStrat == true ) 
wPExchAIMWHyp = akExchWHyp *(oPAIMWHyp - oPAIMWEpi) 
else
wPExchAIMWHyp = 0.0 
end;
if (aInclStrat == true ) 
wNExchNH4WHyp = akExchWHyp *(oNH4WHyp - oNH4WEpi) 
else
wNExchNH4WHyp = 0.0 
end;
if (aInclStrat == true ) 
wNExchNO3WHyp = akExchWHyp *(oNO3WHyp - oNO3WEpi) 
else
wNExchNO3WHyp = 0.0 
end;
if (aInclStrat == true ) 
wSiExchSiO2WHyp = akExchWHyp *(oSiO2WHyp - oSiO2WEpi) 
else
wSiExchSiO2WHyp = 0.0 
end;
if (aInclStrat == true ) 
wO2ExchWHyp = akExchWHyp *(oO2WHyp - oO2WEpi) 
else
wO2ExchWHyp = 0.0 
end;
if (aInclStrat == true ) 
wDExchDetWHyp = akExchWHyp *(oDDetWHyp - oDDetWEpi) 
else
wDExchDetWHyp = 0.0 
end;
if (aInclStrat == true ) 
wPExchDetWHyp = akExchWHyp *(oPDetWHyp - oPDetWEpi) 
else
wPExchDetWHyp = 0.0 
end;
if (aInclStrat == true ) 
wNExchDetWHyp = akExchWHyp *(oNDetWHyp - oNDetWEpi) 
else
wNExchDetWHyp = 0.0 
end;
if (aInclStrat == true ) 
wSiExchDetWHyp = akExchWHyp *(oSiDetWHyp - oSiDetWEpi) 
else
wSiExchDetWHyp = 0.0 
end;
if (aInclStrat == true ) 
wDExchDiatWHyp = akExchWHyp *(oDDiatWHyp - oDDiatWEpi) 
else
wDExchDiatWHyp = 0.0 
end;
if (aInclStrat == true ) 
wPExchDiatWHyp = akExchWHyp *(oPDiatWHyp - oPDiatWEpi) 
else
wPExchDiatWHyp = 0.0 
end;
if (aInclStrat == true ) 
wNExchDiatWHyp = akExchWHyp *(oNDiatWHyp - oNDiatWEpi) 
else
wNExchDiatWHyp = 0.0 
end;
if (aInclStrat == true ) 
wSiExchDiatWHyp = cSiDDiat * wDExchDiatWHyp 
else
wSiExchDiatWHyp = 0.0 
end;
if (aInclStrat == true ) 
wDExchGrenWHyp = akExchWHyp *(oDGrenWHyp - oDGrenWEpi) 
else
wDExchGrenWHyp = 0.0 
end;
if (aInclStrat == true ) 
wPExchGrenWHyp = akExchWHyp *(oPGrenWHyp - oPGrenWEpi) 
else
wPExchGrenWHyp = 0.0 
end;
if (aInclStrat == true ) 
wNExchGrenWHyp = akExchWHyp *(oNGrenWHyp - oNGrenWEpi) 
else
wNExchGrenWHyp = 0.0 
end;
if (aInclStrat == true ) 
wDExchBlueWHyp = akExchWHyp *(oDBlueWHyp - oDBlueWEpi) 
else
wDExchBlueWHyp = 0.0 
end;
if (aInclStrat == true ) 
wPExchBlueWHyp = akExchWHyp *(oPBlueWHyp - oPBlueWEpi) 
else
wPExchBlueWHyp = 0.0 
end;
if (aInclStrat == true ) 
wNExchBlueWHyp = akExchWHyp *(oNBlueWHyp - oNBlueWEpi) 
else
wNExchBlueWHyp = 0.0 
end;
if (aInclStrat == true ) 
wDExchZooWHyp = akExchWHyp *(oDZooHyp - oDZooEpi) 
else
wDExchZooWHyp = 0.0 
end;
if (aInclStrat == true ) 
wPExchZooWHyp = akExchWHyp *(oPZooHyp - oPZooEpi) 
else
wPExchZooWHyp = 0.0 
end;
if (aInclStrat == true ) 
wNExchZooWHyp = akExchWHyp *(oNZooHyp - oNZooEpi) 
else
wNExchZooWHyp = 0.0 
end;
if (aInclStrat == true ) 
wDExchIMWEpi = akExchWEpi *(oDIMWHyp - oDIMWEpi) 
else
wDExchIMWEpi = 0.0 
end;
if (aInclStrat == true ) 
wPExchPO4WEpi = akExchWEpi *(oPO4WHyp - oPO4WEpi) 
else
wPExchPO4WEpi = 0.0 
end;
if (aInclStrat == true ) 
wPExchAIMWEpi = akExchWEpi *(oPAIMWHyp - oPAIMWEpi) 
else
wPExchAIMWEpi = 0.0 
end;
if (aInclStrat == true ) 
wNExchNH4WEpi = akExchWEpi *(oNH4WHyp - oNH4WEpi) 
else
wNExchNH4WEpi = 0.0 
end;
if (aInclStrat == true ) 
wNExchNO3WEpi = akExchWEpi *(oNO3WHyp - oNO3WEpi) 
else
wNExchNO3WEpi = 0.0 
end;
if (aInclStrat == true ) 
wSiExchSiO2WEpi = akExchWEpi *(oSiO2WHyp - oSiO2WEpi) 
else
wSiExchSiO2WEpi = 0.0 
end;
if (aInclStrat == true ) 
wO2ExchWEpi = akExchWEpi *(oO2WHyp - oO2WEpi) 
else
wO2ExchWEpi = 0.0 
end;
if (aInclStrat == true ) 
wDExchDetWEpi = akExchWEpi *(oDDetWHyp - oDDetWEpi) 
else
wDExchDetWEpi = 0.0 
end;
if (aInclStrat == true ) 
wPExchDetWEpi = akExchWEpi *(oPDetWHyp - oPDetWEpi) 
else
wPExchDetWEpi = 0.0 
end;
if (aInclStrat == true ) 
wNExchDetWEpi = akExchWEpi *(oNDetWHyp - oNDetWEpi) 
else
wNExchDetWEpi = 0.0 
end;
if (aInclStrat == true ) 
wSiExchDetWEpi = akExchWEpi *(oSiDetWHyp - oSiDetWEpi) 
else
wSiExchDetWEpi = 0.0 
end;
if (aInclStrat == true ) 
wDExchDiatWEpi = akExchWEpi *(oDDiatWHyp - oDDiatWEpi) 
else
wDExchDiatWEpi = 0.0 
end;
if (aInclStrat == true ) 
wPExchDiatWEpi = akExchWEpi *(oPDiatWHyp - oPDiatWEpi) 
else
wPExchDiatWEpi = 0.0 
end;
if (aInclStrat == true ) 
wNExchDiatWEpi = akExchWEpi *(oNDiatWHyp - oNDiatWEpi) 
else
wNExchDiatWEpi = 0.0 
end;
if (aInclStrat == true ) 
wSiExchDiatWEpi = cSiDDiat * wDExchDiatWEpi 
else
wSiExchDiatWEpi = 0.0 
end;
if (aInclStrat == true ) 
wDExchGrenWEpi = akExchWEpi *(oDGrenWHyp - oDGrenWEpi) 
else
wDExchGrenWEpi = 0.0 
end;
if (aInclStrat == true ) 
wPExchGrenWEpi = akExchWEpi *(oPGrenWHyp - oPGrenWEpi) 
else
wPExchGrenWEpi = 0.0 
end;
if (aInclStrat == true ) 
wNExchGrenWEpi = akExchWEpi *(oNGrenWHyp - oNGrenWEpi) 
else
wNExchGrenWEpi = 0.0 
end;
if (aInclStrat == true ) 
wDExchBlueWEpi = akExchWEpi *(oDBlueWHyp - oDBlueWEpi) 
else
wDExchBlueWEpi = 0.0 
end;
if (aInclStrat == true ) 
wPExchBlueWEpi = akExchWEpi *(oPBlueWHyp - oPBlueWEpi) 
else
wPExchBlueWEpi = 0.0 
end;
if (aInclStrat == true ) 
wNExchBlueWEpi = akExchWEpi *(oNBlueWHyp - oNBlueWEpi) 
else
wNExchBlueWEpi = 0.0 
end;
if (aInclStrat == true ) 
wDExchZooWEpi = akExchWEpi *(oDZooHyp - oDZooEpi) 
else
wDExchZooWEpi = 0.0 
end;
if (aInclStrat == true ) 
wPExchZooWEpi = akExchWEpi *(oPZooHyp - oPZooEpi) 
else
wPExchZooWEpi = 0.0 
end;
if (aInclStrat == true ) 
wNExchZooWEpi = akExchWEpi *(oNZooHyp - oNZooEpi) 
else
wNExchZooWEpi = 0.0 
end;
akExchMHyp = 0.0;
akExchLHyp = 0.0;
oDPhytWHyp = oDDiatWHyp + oDGrenWHyp + oDBlueWHyp;
oPPhytWHyp = oPDiatWHyp + oPGrenWHyp + oPBlueWHyp;
oNPhytWHyp = oNDiatWHyp + oNGrenWHyp + oNBlueWHyp;
aDPhytS = sDDiatS + sDGrenS + sDBlueS ;
aPPhytS = sPDiatS + sPGrenS + sPBlueS ;
aNPhytS = sNDiatS + sNGrenS + sNBlueS;
oDPhytWEpi = oDDiatWEpi + oDGrenWEpi + oDBlueWEpi;
oDOMWEpi = oDDetWEpi + oDPhytWEpi;
oDOMWHyp = oDDetWHyp + oDPhytWHyp;
oTDOMW = oDOMWEpi + oDOMWHyp;
oDSestWHyp = oDOMWHyp + oDIMWHyp;
oPOMWHyp = oPPhytWHyp + oPDetWHyp;
oPSestWHyp = oPPhytWHyp + oPDetWHyp + oPAIMWHyp;
oPInorgWHyp = oPO4WHyp + oPAIMWHyp;
oPTotWHyp = oPSestWHyp + oPO4WHyp;
oNDissWEpi = oNO3WEpi + oNH4WEpi;
oNDissWHyp = oNO3WHyp + oNH4WHyp;
oNOMWHyp = oNPhytWHyp + oNDetWHyp;
oNSestWHyp = oNOMWHyp;
oNkjWHyp = oNSestWHyp + oNH4WHyp;
oNTotWHyp = oNkjWHyp + oNO3WHyp;
bPorS = (1.0 - fDTotS0) * (fDOrgS0 * cRhoOM + (1 - fDOrgS0) * cRhoIM) / cRhoWat / ( fDTotS0 + (1.0 - fDTotS0) * (fDOrgS0 * cRhoOM + (1 - fDOrgS0) * cRhoIM) / cRhoWat );
bPorCorS = ((bPorS )^ (bPorS + 1.0));
aDTotS = sDIMS + sDHumS + sDDetS;
aRhoTotS = aDTotS / cDepthS;
aRhoSolidS = (sDIMS * cRhoIM + (sDHumS + sDDetS) * cRhoOM) / aDTotS;
afDTotS = 1.0 / (1.0 + bPorS/(1.0-bPorS) * cRhoWat / aRhoSolidS);
afDOrgS = (sDHumS + sDDetS) / aDTotS;
afDetS = sDDetS / (sDHumS + sDDetS);
afDetTotS = sDDetS / (sDIMS + sDHumS + sDDetS);
aPInorgS = sPO4S + sPAIMS;
aPTotAvailS = sPDetS + aPInorgS + aPPhytS;
aPTotS = aPTotAvailS + sPHumS;
afPInorgS = aPInorgS / aDTotS;
afPTotS = aPTotS / aDTotS;
afPO4S = sPO4S / (aPTotAvailS + NearZero);
oPO4S = sPO4S / cDepthS / bPorS;
aNDissS = sNH4S + sNO3S;
aNkjAvailS = sNDetS + aNPhytS + sNH4S;
aNkjS = aNkjAvailS + sNHumS;
aNTotAvailS = aNkjAvailS + sNO3S;
aNTotS = aNkjS + sNO3S;
afNInorgS = aNDissS / aDTotS;
afNTotS = aNTotS / aDTotS;
oNO3S = sNO3S / cDepthS / bPorS;
oNH4S = sNH4S / cDepthS / bPorS;
oNDissS = aNDissS / cDepthS / bPorS;
rPDIMWHyp = oPAIMWHyp / oDIMWHyp;
rPDIMS = sPAIMS / sDIMS;
rPDDetWHyp = oPDetWHyp / (oDDetWHyp+NearZero);
rNDDetWHyp = oNDetWHyp / (oDDetWHyp+NearZero);
rSiDDetWHyp = oSiDetWHyp / (oDDetWHyp+NearZero);
rPDHumS = sPHumS / (sDHumS+NearZero);
rNDHumS = sNHumS / (sDHumS+NearZero);
rPDDetS = sPDetS / (sDDetS+NearZero);
rNDDetS = sNDetS / (sDDetS+NearZero);
rSiDDetS = sSiDetS / (sDDetS+NearZero);
if (InclMarsh == true && fMarsh > NearZero) 
oDPhytWM = oDDiatWM + oDGrenWM + oDBlueWM 
else
oDPhytWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
oPPhytWM = oPDiatWM + oPGrenWM + oPBlueWM 
else
oPPhytWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
oNPhytWM = oNDiatWM + oNGrenWM + oNBlueWM 
else
oNPhytWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
oSiDiatWM = cSiDDiat * oDDiatWM 
else
oSiDiatWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
oDOMWM = oDDetWM + oDPhytWM 
else
oDOMWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
oDSestWM = oDOMWM + oDIMWM 
else
oDSestWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
oPOMWM = oPPhytWM + oPDetWM 
else
oPOMWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
oPSestWM = oPPhytWM + oPDetWM + oPAIMWM 
else
oPSestWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
oPInorgWM = oPO4WM + oPAIMWM 
else
oPInorgWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
oPTotWM = oPSestWM + oPO4WM 
else
oPTotWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
oNDissWM = oNO3WM + oNH4WM 
else
oNDissWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
oNOMWM = oNPhytWM + oNDetWM 
else
oNOMWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
oNSestWM = oNOMWM 
else
oNSestWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
oNkjWM = oNSestWM + oNH4WM 
else
oNkjWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
oNTotWM = oNkjWM + oNO3WM 
else
oNTotWM = 0.0 
end;
bPorSM = (1.0 - fDTotSM0) * (fDOrgSM0 * cRhoOM +(1 - fDOrgSM0) * cRhoIM) / cRhoWat /(fDTotSM0 + (1.0 - fDTotSM0) * (fDOrgSM0 * cRhoOM +(1 - fDOrgSM0) * cRhoIM) / cRhoWat);
bPorCorSM = ((bPorSM )^ (bPorSM + 1.0));
if (InclMarsh == true && fMarsh > NearZero) 
aDTotSM = sDIMSM + sDHumSM + sDDetSM 
else
aDTotSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
aRhoTotSM = aDTotSM / cDepthSM 
else
aRhoTotSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
aRhoSolidSM = (sDIMSM * cRhoIM +(sDHumSM + sDDetSM) * cRhoOM) / aDTotSM 
else
aRhoSolidSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
afDTotSM = 1.0 /(1.0 + bPorSM/(1.0-bPorSM) * cRhoWat / aRhoSolidSM) 
else
afDTotSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
afDOrgSM = (sDHumSM + sDDetSM) / aDTotSM 
else
afDOrgSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
afDetSM = sDDetSM /(sDHumSM + sDDetSM) 
else
afDetSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
afDetTotSM = sDDetSM /(sDIMSM + sDHumSM + sDDetSM) 
else
afDetTotSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
aPInorgSM = sPO4SM + sPAIMSM 
else
aPInorgSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
aPTotAvailSM = sPDetSM + aPInorgSM 
else
aPTotAvailSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
aPTotSM = aPTotAvailSM + sPHumSM 
else
aPTotSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
afPInorgSM = aPInorgSM / aDTotSM 
else
afPInorgSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
afPTotSM = aPTotSM / aDTotSM 
else
afPTotSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
afPO4SM = sPO4SM /(aPTotAvailSM + NearZero) 
else
afPO4SM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
oPO4SM = sPO4SM / cDepthSM / bPorSM 
else
oPO4SM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
aNDissSM = sNH4SM + sNO3SM 
else
aNDissSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
aNkjAvailSM = sNDetSM + sNH4SM 
else
aNkjAvailSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
aNkjSM = aNkjAvailSM + sNHumSM 
else
aNkjSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
aNTotAvailSM = aNkjAvailSM + sNO3SM 
else
aNTotAvailSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
aNTotSM = aNkjSM + sNO3SM 
else
aNTotSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
afNInorgSM = aNDissSM / aDTotSM 
else
afNInorgSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
afNTotSM = aNTotSM / aDTotSM 
else
afNTotSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
oNO3SM = sNO3SM / cDepthSM / bPorSM 
else
oNO3SM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
oNH4SM = sNH4SM / cDepthSM / bPorSM 
else
oNH4SM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
oNDissSM = aNDissSM / cDepthSM / bPorSM 
else
oNDissSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
rPDIMWM = oPAIMWM / oDIMWM 
else
rPDIMWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
rPDIMSM = sPAIMSM / sDIMSM 
else
rPDIMSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
rPDDetWM = oPDetWM /(oDDetWM+NearZero) 
else
rPDDetWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
rNDDetWM = oNDetWM /(oDDetWM+NearZero) 
else
rNDDetWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
rSiDDetWM = oSiDetWM /(oDDetWM+NearZero) 
else
rSiDDetWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
rPDHumSM = sPHumSM /(sDHumSM+NearZero) 
else
rPDHumSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
rNDHumSM = sNHumSM /(sDHumSM+NearZero) 
else
rNDHumSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
rPDDetSM = sPDetSM /(sDDetSM+NearZero) 
else
rPDDetSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
rNDDetSM = sNDetSM /(sDDetSM+NearZero) 
else
rNDDetSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
rSiDDetSM = sSiDetSM /(sDDetSM+NearZero) 
else
rSiDDetSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
aDTotM = ((oDIMWM + oDDetWM + oDPhytWM + oDZooM) * sDepthWM + sDIMSM + sDHumSM + sDDetSM + sDShootPhra + sDRootPhra) * fMarsh 
else
aDTotM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
aPTotM = ((oPO4WM + oPDetWM + oPAIMWM + oPPhytWM + oPZooM) * sDepthWM + sPO4SM + sPHumSM + sPDetSM + sPAIMSM + sPShootPhra + sPRootPhra) * fMarsh 
else
aPTotM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
aNTotM = ((oNH4WM + oNO3WM + oNDetWM + oNPhytWM + oNZooM) * sDepthWM + sNH4SM + sNO3SM + sNHumSM + sNDetSM + sNShootPhra + sNRootPhra) * fMarsh 
else
aNTotM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
aSiTotM = ((oSiO2WM + oSiDetWM + oSiDiatWM) * sDepthWM + sSiDetSM) * fMarsh 
else
aSiTotM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
aO2TotM = ((oO2WM) * sDepthWM ) * fMarsh 
else
aO2TotM = 0.0 
end;
if (false == UseSeasonLoad) 
uPLoadSeason = 0.0 
elseif (Day < cDayApril1 - 0.5*cLengChange) 
uPLoadSeason = cPLoadWin 
elseif (Day < cDayApril1 + 0.5*cLengChange) 
uPLoadSeason = 0.5*(cPLoadWin + cPLoadSum) + 0.5*(cPLoadWin - cPLoadSum) * cos(Pi/cLengChange * (Day - cDayApril1)) 
elseif (Day < cDayOct1 - 0.5*cLengChange) 
uPLoadSeason = cPLoadSum 
elseif (Day < cDayOct1 + 0.5*cLengChange) 
uPLoadSeason = 0.5*(cPLoadWin + cPLoadSum) - 0.5*(cPLoadWin - cPLoadSum) * cos(Pi/cLengChange * (Day - cDayOct1)) 
else
uPLoadSeason = cPLoadWin 
end;
if (false == InclTran) 
uPLoad = 0.0 
elseif (ReadPLoad == true && ReadNutFrac == true) 
uPLoad = mPLoadPO4 + mPLoadOrg 
elseif (ReadPLoad == true && false == ReadNutFrac) 
uPLoad = mPLoad 
elseif (UsePulseLoad == true) 
uPLoad = 0.0 
elseif (UseSeasonLoad == true) 
uPLoad = uPLoadSeason 
else
uPLoad = cPLoad 
end;
if (false == ReadPLoad) 
uPLoadPO4 = fPO4In * uPLoad 
elseif (ReadNutFrac == true) 
uPLoadPO4 = mPLoadPO4 
else
uPLoadPO4 = fPO4In * uPLoad 
end;
if (false == ReadPLoad) 
uPLoadOrg = (1.0 - fPO4In) * uPLoad 
elseif (ReadNutFrac == true) 
uPLoadOrg = mPLoadOrg 
else
uPLoadOrg = (1.0 - fPO4In) * uPLoad 
end;
if (false == InclSeason) 
uPLoadPhytTot = (((fPhytInSum + fPhytInWin)/2)*uPLoadOrg) 
elseif (ReadPLoadPhyt == true) 
uPLoadPhytTot = mPLoadPhytTot 
else
uPLoadPhytTot = ((fPhytInSum+fPhytInWin)/2.0 - (fPhytInSum-fPhytInWin)/2.0 * cos(2.0*Pi * (sTime + TenDays - cTimeLag) / DaysInYear)) * uPLoadOrg 
end;
uPLoadDet = uPLoadOrg - uPLoadPhytTot;
uPLoadAIM = 0.0;
if (false == UseSeasonLoad) 
uNLoadSeason = 0.0 
elseif (Day < cDayApril1 - 0.5*cLengChange) 
uNLoadSeason = cNLoadWin 
elseif (Day < cDayApril1 + 0.5*cLengChange) 
uNLoadSeason = 0.5*(cNLoadWin + cNLoadSum) + 0.5*(cNLoadWin - cNLoadSum) * cos(Pi/cLengChange * (Day - cDayApril1)) 
elseif (Day < cDayOct1 - 0.5*cLengChange) 
uNLoadSeason = cNLoadSum 
elseif (Day < cDayOct1 + 0.5*cLengChange) 
uNLoadSeason = 0.5*(cNLoadWin + cNLoadSum) - 0.5*(cNLoadWin - cNLoadSum) * cos(Pi/cLengChange * (Day - cDayOct1)) 
else
uNLoadSeason = cNLoadWin 
end;
uNLoadPhytTot = cNPPhytIn * uPLoadPhytTot;
if (false == InclTran) 
uNLoad = 0.0 
elseif (ReadNLoad == true && ReadNutFrac == true) 
uNLoad = mNLoadNH4 + mNLoadNO3 + mNLoadOrg 
elseif (ReadNLoad == true && false == ReadNutFrac) 
uNLoad = mNLoad 
elseif (UsePulseLoad == true) 
uNLoad = 0.0 
elseif (ReadPLoad == true) 
uNLoad = cNPLoadMeas * uPLoad 
elseif (UseSeasonLoad == true) 
uNLoad = uNLoadSeason 
else
uNLoad = cNLoad 
end;
if (false == ReadNLoad) 
uNLoadDet = min(cNPDetIn * uPLoadDet, uNLoad - uNLoadPhytTot) 
elseif (ReadNutFrac == true) 
uNLoadDet = 0.0 
else
uNLoadDet = min(cNPDetIn * uPLoadDet, uNLoad - uNLoadPhytTot) 
end;
if (false == ReadNLoad) 
uNLoadOrg = uNLoadPhytTot + uNLoadDet 
elseif (ReadNutFrac == true) 
uNLoadOrg = mNLoadOrg 
else
uNLoadOrg = uNLoadPhytTot + uNLoadDet 
end;
if (false == ReadNLoad) 
uNLoadDiss = uNLoad - uNLoadOrg 
elseif (ReadNutFrac == true) 
uNLoadDiss = 0.0 
else
uNLoadDiss = uNLoad - uNLoadOrg 
end;
if (false == ReadNLoad) 
uNLoadNH4 = fNH4DissIn * uNLoadDiss 
elseif (ReadNutFrac == true) 
uNLoadNH4 = mNLoadNH4 
else
uNLoadNH4 = fNH4DissIn * uNLoadDiss 
end;
if (false == ReadNLoad) 
uNLoadNO3 = (1.0 - fNH4DissIn) * uNLoadDiss 
elseif (ReadNutFrac == true) 
uNLoadNO3 = mNLoadNO3 
else
uNLoadNO3 = (1.0 - fNH4DissIn) * uNLoadDiss 
end;
if (false == aInclStrat) 
uNBackLoadHyp = 0.0 
else
uNBackLoadHyp = cNBackLoad 
end;
if (false == aInclStrat) 
uPBackLoadHyp = 0.0 
else
uPBackLoadHyp = cPBackLoad 
end;
uNTotIn = uNLoad / (uQIn / mmPerm + NearZero);
if (ReadDLoadDet == true) 
uDLoadDet = mDLoadDet 
else
uDLoadDet = uNLoadDet / cNDDetIn 
end;
uDLoadPhytTot = uNLoadPhytTot / cNDPhytIn;
if (false == InclTran) 
uDLoadIM = 0.0 
elseif (ReadDLoadIM == true) 
uDLoadIM = mDLoadIM 
else
uDLoadIM = cDIMIn * uQIn / mmPerm 
end;
if (false == InclTran) 
uDLoad = 0.0 
else
uDLoad = uDLoadIM + uDLoadDet + uDLoadPhytTot 
end;
uPTotIn = uPLoad / (uQIn / mmPerm + NearZero);
uDLoadDiat = fDiatPhytIn * uDLoadPhytTot;
uPLoadDiat = fDiatPhytIn * uPLoadPhytTot;
uNLoadDiat = fDiatPhytIn * uNLoadPhytTot;
uDLoadGren = fGrenPhytIn * uDLoadPhytTot;
uPLoadGren = fGrenPhytIn * uPLoadPhytTot;
uNLoadGren = fGrenPhytIn * uNLoadPhytTot;
uDLoadBlue = fBluePhytIn * uDLoadPhytTot;
uPLoadBlue = fBluePhytIn * uPLoadPhytTot;
uNLoadBlue = fBluePhytIn * uNLoadPhytTot;
wDDilIMHyp = ukDilHyp * oDIMWHyp;
wDDilDetHyp = ukDilHyp * oDDetWHyp;
wDDilGrenHyp = ukDilHyp * oDGrenWHyp;
wDDilBlueHyp = ukDilHyp * oDBlueWHyp;
wDDilDiatHyp = ukDilHyp * oDDiatWHyp;
wDDilZooHyp = ukDilHyp * oDZooHyp;
wDDilPhytHyp = wDDilDiatHyp + wDDilGrenHyp + wDDilBlueHyp;
wPDilZooHyp = ukDilHyp * oPZooHyp;
wNDilZooHyp = ukDilHyp * oNZooHyp;
wPDilPO4Hyp = ukDilHyp * oPO4WHyp;
wPDilDetHyp = ukDilHyp*oPDetWHyp;
wPDilAIMHyp = ukDilHyp * oPAIMWHyp;
wNDilNH4Hyp = ukDilHyp * oNH4WHyp;
wNDilNO3Hyp = ukDilHyp * oNO3WHyp;
wNDilDetHyp = ukDilHyp * oNDetWHyp;
wO2InflowHyp = ukDilWatHyp * cO2In;
wO2OutflHyp = ukDilHyp * oO2WHyp;
wPDilDiatHyp = ukDilHyp * oPDiatWHyp;
wNDilDiatHyp = ukDilHyp * oNDiatWHyp;
wPDilGrenHyp = ukDilHyp * oPGrenWHyp;
wNDilGrenHyp = ukDilHyp * oNGrenWHyp;
wPDilBlueHyp = ukDilHyp * oPBlueWHyp;
wNDilBlueHyp = ukDilHyp * oNBlueWHyp;
wPDilPhytHyp = wPDilDiatHyp + wPDilGrenHyp + wPDilBlueHyp;
wNDilPhytHyp = wNDilDiatHyp + wNDilGrenHyp + wNDilBlueHyp;
wDOutflTotHyp = ukOutHyp * oDSestWHyp;
wPOutflTotHyp = ukOutHyp * oPTotWHyp;
wNOutflTotHyp = ukOutHyp * oNTotWHyp;
if (false == InclTran) 
wDTranDiatHyp = 0.0 
else
wDTranDiatHyp = - wDDilDiatHyp 
end;
if (false == InclTran) 
wPTranDiatHyp = 0.0 
else
wPTranDiatHyp = - wPDilDiatHyp 
end;
if (false == InclTran) 
wNTranDiatHyp = 0.0 
else
wNTranDiatHyp = - wNDilDiatHyp 
end;
if (false == InclTran) 
wDTranGrenHyp = 0.0 
else
wDTranGrenHyp = - wDDilGrenHyp 
end;
if (false == InclTran) 
wPTranGrenHyp = 0.0 
else
wPTranGrenHyp = - wPDilGrenHyp 
end;
if (false == InclTran) 
wNTranGrenHyp = 0.0 
else
wNTranGrenHyp = - wNDilGrenHyp 
end;
if (false == InclTran) 
wDTranBlueHyp = 0.0 
else
wDTranBlueHyp = - wDDilBlueHyp 
end;
if (false == InclTran) 
wPTranBlueHyp = 0.0 
else
wPTranBlueHyp = - wPDilBlueHyp 
end;
if (false == InclTran) 
wNTranBlueHyp = 0.0 
else
wNTranBlueHyp = - wNDilBlueHyp 
end;
if (false == InclTran) 
wDTranPhytHyp = 0.0 
else
wDTranPhytHyp = wDTranDiatHyp + wDTranGrenHyp + wDTranBlueHyp 
end;
if (false == InclTran) 
wPTranPhytHyp = 0.0 
else
wPTranPhytHyp = wPTranDiatHyp + wPTranGrenHyp + wPTranBlueHyp 
end;
if (false == InclTran) 
wNTranPhytHyp = 0.0 
else
wNTranPhytHyp = wNTranDiatHyp + wNTranGrenHyp + wNTranBlueHyp 
end;
uSiLoadSiO2 = cSiO2In * uQIn / mmPerm;
uSiLoadDet = cSiDDetIn * uDLoadDet;
uSiLoadDiat = cSiDDiat * uDLoadDiat;
if (false == InclTran) 
uSiLoad = 0.0 
else
uSiLoad = uSiLoadSiO2 + uSiLoadDet + uSiLoadDiat 
end;
wSiDilSiO2Hyp = ukDilHyp * oSiO2WHyp;
wSiDilDetHyp = ukDilHyp * oSiDetWHyp;
wSiDilDiatHyp = cSiDDiat * wDDilDiatHyp;
wSiOutflTotHyp = ukOutHyp * (oSiO2WHyp + oSiDetWHyp + cSiDDiat * oDDiatWHyp);
if (false == InclTran) 
wSiTranSiO2Hyp = 0.0 
else
wSiTranSiO2Hyp = - wSiDilSiO2Hyp 
end;
if (false == InclTran) 
wSiTranDetWHyp = 0.0 
else
wSiTranDetWHyp = - wSiDilDetHyp 
end;
if (false == InclTran) 
tSiTranTotTHyp = 0.0 
else
tSiTranTotTHyp = - (wSiDilDetHyp + wSiDilSiO2Hyp + wSiDilDiatHyp) * sDepthWHyp 
end;
if (false == InclTran) 
wDTranZooHyp = 0.0 
else
wDTranZooHyp =( - wDDilZooHyp) 
end;
if (false == InclTran) 
wPTranZooHyp = 0.0 
else
wPTranZooHyp =( - wPDilZooHyp) 
end;
if (false == InclTran) 
wNTranZooHyp = 0.0 
else
wNTranZooHyp =( - wNDilZooHyp) 
end;
if (false == InclTran) 
wDTranIMWHyp = 0.0 
else
wDTranIMWHyp = - wDDilIMHyp 
end;
if (false == InclTran) 
wDTranDetWHyp = 0.0 
else
wDTranDetWHyp = - wDDilDetHyp 
end;
if (false == InclTran) 
wO2TranWHyp = 0.0 
else
wO2TranWHyp = - wO2OutflHyp 
end;
if (false == InclTran) 
wPTranPO4WHyp = 0.0 
else
wPTranPO4WHyp = - wPDilPO4Hyp 
end;
if (false == InclTran) 
wPTranAIMWHyp = 0.0 
else
wPTranAIMWHyp = - wPDilAIMHyp 
end;
if (false == InclTran) 
wPTranDetWHyp = 0.0 
else
wPTranDetWHyp = - wPDilDetHyp 
end;
if (false == InclTran) 
wNTranNH4WHyp = 0.0 
else
wNTranNH4WHyp = - wNDilNH4Hyp 
end;
if (false == InclTran) 
wNTranNO3WHyp = 0.0 
else
wNTranNO3WHyp = - wNDilNO3Hyp 
end;
if (false == InclTran) 
wNTranDetWHyp = 0.0 
else
wNTranDetWHyp = - wNDilDetHyp 
end;
wDDilTotHyp = wDDilIMHyp + wDDilDetHyp + wDDilPhytHyp;
wPDilTotHyp = wPDilDetHyp + wPDilPO4Hyp + wPDilAIMHyp + wPDilPhytHyp;
wNDilTotHyp = wNDilDetHyp + wNDilNO3Hyp + wNDilNH4Hyp + wNDilPhytHyp;
wSiDilTotHyp = wSiDilDetHyp + wSiDilSiO2Hyp + wSiDilDiatHyp;
if (false == InclTran) 
tDTranTotTHyp = 0.0 
else
tDTranTotTHyp = - wDDilTotHyp * sDepthWHyp 
end;
if (false == InclTran) 
tPTranTotTHyp = 0.0 
else
tPTranTotTHyp = uPLoad - wPDilTotHyp * sDepthWHyp 
end;
if (false == InclTran) 
tNTranTotTHyp = 0.0 
else
tNTranTotTHyp = uNLoad - wNDilTotHyp * sDepthWHyp 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wDExchIMMHyp = akExchMHyp *(oDIMWHyp - oDIMWM) 
else
wDExchIMMHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wPExchPO4MHyp = akExchMHyp *(oPO4WHyp - oPO4WM) 
else
wPExchPO4MHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wPExchAIMMHyp = akExchMHyp *(oPAIMWHyp - oPAIMWM) 
else
wPExchAIMMHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wNExchNH4MHyp = akExchMHyp *(oNH4WHyp - oNH4WM) 
else
wNExchNH4MHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wNExchNO3MHyp = akExchMHyp *(oNO3WHyp - oNO3WM) 
else
wNExchNO3MHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wSiExchSiO2MHyp = akExchMHyp *(oSiO2WHyp - oSiO2WM) 
else
wSiExchSiO2MHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wO2ExchMHyp = akExchMHyp *(oO2WHyp - oO2WM) 
else
wO2ExchMHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wDExchDetMHyp = akExchMHyp *(oDDetWHyp - oDDetWM) 
else
wDExchDetMHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wPExchDetMHyp = akExchMHyp *(oPDetWHyp - oPDetWM) 
else
wPExchDetMHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wNExchDetMHyp = akExchMHyp *(oNDetWHyp - oNDetWM) 
else
wNExchDetMHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wSiExchDetMHyp = akExchMHyp *(oSiDetWHyp - oSiDetWM) 
else
wSiExchDetMHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wDExchDiatMHyp = akExchMHyp *(oDDiatWHyp - oDDiatWM) 
else
wDExchDiatMHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wPExchDiatMHyp = akExchMHyp *(oPDiatWHyp - oPDiatWM) 
else
wPExchDiatMHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wNExchDiatMHyp = akExchMHyp *(oNDiatWHyp - oNDiatWM) 
else
wNExchDiatMHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wSiExchDiatMHyp = cSiDDiat * wDExchDiatMHyp 
else
wSiExchDiatMHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wDExchGrenMHyp = akExchMHyp *(oDGrenWHyp - oDGrenWM) 
else
wDExchGrenMHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wPExchGrenMHyp = akExchMHyp *(oPGrenWHyp - oPGrenWM) 
else
wPExchGrenMHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wNExchGrenMHyp = akExchMHyp *(oNGrenWHyp - oNGrenWM) 
else
wNExchGrenMHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wDExchBlueMHyp = akExchMHyp *(oDBlueWHyp - oDBlueWM) 
else
wDExchBlueMHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wPExchBlueMHyp = akExchMHyp *(oPBlueWHyp - oPBlueWM) 
else
wPExchBlueMHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wNExchBlueMHyp = akExchMHyp *(oNBlueWHyp - oNBlueWM) 
else
wNExchBlueMHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wDExchZooMHyp = akExchMHyp *(oDZooHyp - oDZooM) 
else
wDExchZooMHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wPExchZooMHyp = akExchMHyp *(oPZooHyp - oPZooM) 
else
wPExchZooMHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wNExchZooMHyp = akExchMHyp *(oNZooHyp - oNZooM) 
else
wNExchZooMHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wDExchIMHyp = akExchLHyp *(oDIMWHyp - oDIMWM) 
else
wDExchIMHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wPExchPO4Hyp = akExchLHyp *(oPO4WHyp - oPO4WM) 
else
wPExchPO4Hyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wPExchAIMHyp = akExchLHyp *(oPAIMWHyp - oPAIMWM) 
else
wPExchAIMHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wNExchNH4Hyp = akExchLHyp *(oNH4WHyp - oNH4WM) 
else
wNExchNH4Hyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wNExchNO3Hyp = akExchLHyp *(oNO3WHyp - oNO3WM) 
else
wNExchNO3Hyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wSiExchSiO2Hyp = akExchLHyp *(oSiO2WHyp - oSiO2WM) 
else
wSiExchSiO2Hyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wO2ExchHyp = akExchLHyp *(oO2WHyp - oO2WM) 
else
wO2ExchHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wDExchDetHyp = akExchLHyp *(oDDetWHyp - oDDetWM) 
else
wDExchDetHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wPExchDetHyp = akExchLHyp *(oPDetWHyp - oPDetWM) 
else
wPExchDetHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wNExchDetHyp = akExchLHyp *(oNDetWHyp - oNDetWM) 
else
wNExchDetHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wSiExchDetHyp = akExchLHyp *(oSiDetWHyp - oSiDetWM) 
else
wSiExchDetHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wDExchDiatHyp = akExchLHyp *(oDDiatWHyp - oDDiatWM) 
else
wDExchDiatHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wPExchDiatHyp = akExchLHyp *(oPDiatWHyp - oPDiatWM) 
else
wPExchDiatHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wNExchDiatHyp = akExchLHyp *(oNDiatWHyp - oNDiatWM) 
else
wNExchDiatHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wSiExchDiatHyp = cSiDDiat * wDExchDiatHyp 
else
wSiExchDiatHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wDExchGrenHyp = akExchLHyp *(oDGrenWHyp - oDGrenWM) 
else
wDExchGrenHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wPExchGrenHyp = akExchLHyp *(oPGrenWHyp - oPGrenWM) 
else
wPExchGrenHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wNExchGrenHyp = akExchLHyp *(oNGrenWHyp - oNGrenWM) 
else
wNExchGrenHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wDExchBlueHyp = akExchLHyp *(oDBlueWHyp - oDBlueWM) 
else
wDExchBlueHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wPExchBlueHyp = akExchLHyp *(oPBlueWHyp - oPBlueWM) 
else
wPExchBlueHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wNExchBlueHyp = akExchLHyp *(oNBlueWHyp - oNBlueWM) 
else
wNExchBlueHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wDExchZooHyp = akExchLHyp *(oDZooHyp - oDZooM) 
else
wDExchZooHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wPExchZooHyp = akExchLHyp *(oPZooHyp - oPZooM) 
else
wPExchZooHyp = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wNExchZooHyp = akExchLHyp *(oNZooHyp - oNZooM) 
else
wNExchZooHyp = 0.0 
end;
if (cQInf >= 0.0) 
tPInfPO4WHyp = cQInf / mmPerm * oPO4WHyp 
else
tPInfPO4WHyp = cQInf / mmPerm * oPO4S 
end;
if (cQInf >= 0.0) 
tNInfNH4WHyp = cQInf / mmPerm * oNH4WHyp 
else
tNInfNH4WHyp = cQInf / mmPerm * oNH4S 
end;
if (cQInf >= 0.0) 
tNInfNO3WHyp = cQInf / mmPerm * oNO3WHyp 
else
tNInfNO3WHyp = cQInf / mmPerm * oNO3S 
end;
if (cQInf >= 0.0) 
tPInfPO4S = cQInf / mmPerm * oPO4S 
else
tPInfPO4S = cQInf / mmPerm * cPO4Ground 
end;
if (cQInf >= 0.0) 
tNInfNH4S = cQInf / mmPerm * oNH4S 
else
tNInfNH4S = cQInf / mmPerm * cNH4Ground 
end;
if (cQInf >= 0.0) 
tNInfNO3S = cQInf / mmPerm * oNO3S 
else
tNInfNO3S = cQInf / mmPerm * cNO3Ground 
end;
tNH4LoadS = fNH4LoadS * cNLoadS;
tNO3LoadS = cNLoadS - tNH4LoadS;
uDErosIM = (1.0 - fDOrgSoil) * cDErosTot;
uDErosIMS = fSedErosIM * uDErosIM;
uDErosIMW = uDErosIM - uDErosIMS;
uDErosOM = fDOrgSoil * cDErosTot;
uPErosOM = cPDSoilOM * uDErosOM;
uNErosOM = cNDSoilOM * uDErosOM;
uO2SatEpi = 14.652 - 0.41022 * uTmEpi + 0.007991 * uTmEpi*uTmEpi - 0.000077774 * uTmEpi*uTmEpi*uTmEpi;
uO2SatHyp = 14.652 - 0.41022 * uTmHyp + 0.007991 * uTmHyp*uTmHyp- 0.000077774 *uTmHyp*uTmHyp*uTmHyp;
kAer = cAerRoot * ((uVWind )^ (0.5)) + cAerLin * uVWind + cAerSquare * uVWind*uVWind;
uFunTmAerEpi = ((cThetaAer )^ (uTmEpi-cTmRef));
uFunTmAerHyp = ((cThetaAer )^ (uTmHyp-cTmRef));
aFunLemnAer = 1.0;
if (uO2SatHyp < oO2WHyp ) 
tO2BubHyp = kBub * uFunTmAerHyp * (uO2SatHyp - oO2WHyp) 
else
tO2BubHyp = 0 
end;
if (InclWeb == true) 
uFunTmFish = exp( -0.5/(cSigTmFish*cSigTmFish) * (( max (uTmEpi, uTmHyp * aInclStrat) - cTmOptFish)*( max (uTmEpi, uTmHyp * aInclStrat) - cTmOptFish) - (cTmRef - cTmOptFish)*(cTmRef - cTmOptFish))) 
else
uFunTmFish = 0.0 
end;
if (InclWeb == true) 
tDTurbFish = (kTurbFish * uFunTmFish * sDFiAd) 
else
tDTurbFish = 0.0 
end;
aFunVegResus = max(1.0 - kVegResus * sDVeg, 0.0);
if (uTmEpi >= 0.1) 
aFunDimSusp = cSuspRef * ((cSuspMin + cSuspMax / (1.0 + exp(cSuspSlope * (uDepthW - hDepthSusp)))) * ((((cFetch +NearZero)/ cFetchRef) )^ (0.5))) 
else
aFunDimSusp = 0.0 
end;
tDResusTauDead = min(aFunDimSusp, ((aFunDimSusp +NearZero )^ (0.5))) * ((fLutum / fLutumRef )^ (0.5)) * bPorS;
tDResusBareDead = tDResusTauDead + tDTurbFish;
tDResusDead = tDResusBareDead * aFunVegResus;
tDResusIM = fLutum * sDIMS / (fLutum * sDIMS + sDDetS) * tDResusDead;
tDResusDet = sDDetS / (fLutum * sDIMS + sDDetS) * tDResusDead;
akResusPhytRef = kResusPhytMax * (1.0 - exp(cResusPhytExp * tDResusDead));
tDResusPhytTot = akResusPhytRef * aDPhytS;
tPResusDet = rPDDetS * tDResusDet;
tPResusPO4 = sPO4S / sDDetS * tDResusDet;
tPResusAIM = sPAIMS / sDIMS * tDResusIM;
tNResusNO3 = sNO3S / sDDetS * tDResusDet;
tNResusNH4 = sNH4S / sDDetS * tDResusDet;
tNResusDet = rNDDetS * tDResusDet;
tSiResusDet = rSiDDetS * tDResusDet;
aFunTauSetOMHyp = min(1.0 / ((aFunDimSusp +NearZero )^ (0.5)), 1.0);
aFunTauSetIMHyp = aFunTauSetOMHyp;
uFunTmSetEpi = ((cThetaSet )^ (uTmEpi-cTmRef));
uFunTmSetHyp = ((cThetaSet )^ (uTmHyp-cTmRef));
uCorVSetIMHyp = aFunTauSetIMHyp * (((fLutumRef/fLutum) )^ (0.5)) * uFunTmSetHyp * cVSetIM;
tDSetIMHyp = uCorVSetIMHyp * oDIMWHyp;
tPSetAIMHyp = oPAIMWHyp / oDIMWHyp * tDSetIMHyp;
uCorVSetDetHyp = cVSetDet * aFunTauSetOMHyp * uFunTmSetHyp;
tDSetDetHyp = uCorVSetDetHyp * oDDetWHyp;
tPSetDetHyp = uCorVSetDetHyp * oPDetWHyp;
tNSetDetHyp = uCorVSetDetHyp * oNDetWHyp;
tSiSetDetHyp = uCorVSetDetHyp * oSiDetWHyp;
kPMinDetW = kDMinDetW;
kNMinDetW = kDMinDetW;
kSiMinDetW = kDMinDetW;
uFunTmMinWEpi = ((cThetaMinW )^ (uTmEpi-cTmRef));
uFunTmMinWHyp = ((cThetaMinW )^ (uTmEpi-cTmRef));
if (aInclStrat == false) 
wDMinDetWHyp = 0.0 
else
wDMinDetWHyp = kDMinDetW * uFunTmMinWHyp * oDDetWHyp 
end;
if (aInclStrat == false) 
wPMinDetWHyp = 0.0 
else
wPMinDetWHyp = kPMinDetW * uFunTmMinWHyp * oPDetWHyp 
end;
if (aInclStrat == false) 
wNMinDetWHyp = 0.0 
else
wNMinDetWHyp = kNMinDetW * uFunTmMinWHyp * oNDetWHyp 
end;
if (aInclStrat == false) 
wSiMinDetWHyp = 0.0 
else
wSiMinDetWHyp = kSiMinDetW * uFunTmMinWHyp * oSiDetWHyp 
end;
aCorO2BODHyp = oO2WHyp / (hO2BOD + oO2WHyp);
if (aInclStrat == false) 
wO2MinDetWHyp = 0.0 
else
wO2MinDetWHyp = molO2molC * cCPerDW * aCorO2BODHyp * wDMinDetWHyp 
end;
if (aInclStrat == false) 
wDDenitWHyp = 0.0 
else
wDDenitWHyp = oNO3WHyp*oNO3WHyp / (hNO3Denit*hNO3Denit + oNO3WHyp*oNO3WHyp) * (1.0 - aCorO2BODHyp) * wDMinDetWHyp 
end;
if (aInclStrat == false) 
wNDenitWHyp = 0.0 
else
wNDenitWHyp = NO3PerC * molNmolC * cCPerDW * wDDenitWHyp 
end;
uFunTmNitrHyp = ((cThetaNitr )^ (uTmHyp-cTmRef));
uFunTmNitrEpi = ((cThetaNitr )^ (uTmEpi-cTmRef));
uFunTmNitrS = ((cThetaNitr )^ (uTmBot-cTmRef));
aCorO2NitrWHyp = oO2WHyp*oO2WHyp / (hO2Nitr*hO2Nitr + oO2WHyp*oO2WHyp);
if (aInclStrat == false) 
wNNitrWHyp = 0.0 
else
wNNitrWHyp = kNitrW * uFunTmNitrHyp * aCorO2NitrWHyp * oNH4WHyp 
end;
if (aInclStrat == false) 
wO2NitrWHyp = 0.0 
else
wO2NitrWHyp = O2PerNH4 * molO2molN * wNNitrWHyp 
end;
kPMinDetS = kDMinDetS;
kNMinDetS = kDMinDetS;
kSiMinDetS = kDMinDetS;
uFunTmMinS = ((cThetaMinS )^ (uTmBot-cTmRef));
tDMinDetS = kDMinDetS * uFunTmMinS * sDDetS;
tPMinDetS = kPMinDetS * uFunTmMinS * sPDetS;
tNMinDetS = kNMinDetS * uFunTmMinS * sNDetS;
tSiMinDetS = kSiMinDetS * uFunTmMinS * sSiDetS;
uFunTmDif = ((cThetaDif )^ (uTmEpi-cTmRef));
akO2DifCor = kO2Dif * uFunTmDif * cTurbDifO2 * bPorCorS;
tSOD = (molO2molC * cCPerDW * (1.0 - fRefrDetS) * tDMinDetS + O2PerNH4 * molO2molN * kNitrS * uFunTmNitrS * sNH4S) / cDepthS;
aDepthDif = fDepthDifS * cDepthS;
if ( aInclStrat == true ) 
tPDifPO4Hyp = kPDifPO4 * uFunTmDif * cTurbDifNut * bPorCorS * (oPO4S - oPO4WHyp ) / aDepthDif 
else
tPDifPO4Hyp = 0.0 
end;
if ( aInclStrat == true ) 
tNDifNO3Hyp = kNDifNO3 * uFunTmDif * cTurbDifNut * bPorCorS * (oNO3S - oNO3WHyp ) / aDepthDif 
else
tNDifNO3Hyp = 0.0 
end;
if ( aInclStrat == true ) 
tNDifNH4Hyp = kNDifNH4 * uFunTmDif * cTurbDifNut * bPorCorS * (oNH4S - oNH4WHyp ) / aDepthDif 
else
tNDifNH4Hyp = 0.0 
end;
if ( aInclStrat == true ) 
tO2DifHyp = kO2Dif / aDepthDif * uFunTmDif * cTurbDifO2 * bPorCorS * oO2WHyp 
else
tO2DifHyp = 0.0 
end;
tPDifGroundPO4 = 0.0;
tNDifGroundNO3 = 0.0;
tNDifGroundNH4 = 0.0;
aPAdsMaxWHyp = cRelPAdsD + aCorO2BODHyp * cRelPAdsFe * fFeDIM + cRelPAdsAl * fAlDIM;
aKPAdsWHyp = (1.0 - fRedMax * (1.0-aCorO2BODHyp)) * cKPAdsOx;
aPIsoAdsWHyp = aPAdsMaxWHyp * aKPAdsWHyp * oPO4WHyp / (1.0 + aKPAdsWHyp * oPO4WHyp);
aPEqIMWHyp = aPIsoAdsWHyp * oDIMWHyp;
if (aInclStrat == false) 
wPSorpIMWHyp = 0.0 
else
wPSorpIMWHyp = kPSorp * (aPEqIMWHyp - oPAIMWHyp) 
end;
tPChemPO4 = max( 0.0, kPChemPO4 * (oPO4S - coPO4Max) );
tSiAbioTotT = - fRefrDetS * tSiMinDetS;
if (InclMarsh == true && fMarsh > NearZero) 
uQEvPhra = uQEv 
else
uQEvPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tPEvPO4WM = uQEvPhra / mmPerm * oPO4WM 
else
tPEvPO4WM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tNEvNH4WM = uQEvPhra / mmPerm * oNH4WM 
else
tNEvNH4WM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tNEvNO3WM = uQEvPhra / mmPerm * oNO3WM 
else
tNEvNO3WM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tPInfPO4WM = 0.0 
elseif (cQInf >= 0.0) 
tPInfPO4WM = cQInf / mmPerm * oPO4WM 
else
tPInfPO4WM = cQInf / mmPerm * oPO4SM 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tNInfNH4WM = 0.0 
elseif (cQInf >= 0.0) 
tNInfNH4WM = cQInf / mmPerm * oNH4WM 
else
tNInfNH4WM = cQInf / mmPerm * oNH4SM 
end;
if (false == InclMarsh || fMarsh <= NearZero) 
tNInfNO3WM = 0.0 
elseif (cQInf >= 0.0) 
tNInfNO3WM = cQInf / mmPerm * oNO3WM 
else
tNInfNO3WM = cQInf / mmPerm * oNO3SM 
end;
if (false == InclMarsh || fMarsh <= NearZero) 
tPInfPO4SM = 0.0 
elseif (cQInf >= 0.0) 
tPInfPO4SM = cQInf / mmPerm * oPO4SM 
else
tPInfPO4SM = cQInf / mmPerm * cPO4Ground 
end;
if (false == InclMarsh || fMarsh <= NearZero) 
tNInfNH4SM = 0.0 
elseif (cQInf >= 0.0) 
tNInfNH4SM = cQInf / mmPerm * oNH4SM 
else
tNInfNH4SM = cQInf / mmPerm * oNH4SM 
end;
if (false == InclMarsh || fMarsh <= NearZero) 
tNInfNO3SM = 0.0 
elseif (cQInf >= 0.0) 
tNInfNO3SM = cQInf / mmPerm * oNO3SM 
else
tNInfNO3SM = cQInf / mmPerm * oNO3SM 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tO2AerM = kAer * uFunTmAerEpi *(uO2SatEpi - oO2WM) 
else
tO2AerM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tDSetIMM = cVSetIM * uFunTmSetEpi * oDIMWM 
else
tDSetIMM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tPSetAIMM = cVSetIM * uFunTmSetEpi * oPAIMWM 
else
tPSetAIMM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tDSetDetM = cVSetDet * uFunTmSetEpi * oDDetWM 
else
tDSetDetM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tPSetDetM = cVSetDet * uFunTmSetEpi* oPDetWM 
else
tPSetDetM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tNSetDetM = cVSetDet * uFunTmSetEpi* oNDetWM 
else
tNSetDetM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tSiSetDetM = cVSetDet * uFunTmSetEpi * oSiDetWM 
else
tSiSetDetM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tDSetDiatM = cVSetDiat * uFunTmSetEpi * oDDiatWM 
else
tDSetDiatM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tPSetDiatM = cVSetDiat * uFunTmSetEpi* oPDiatWM 
else
tPSetDiatM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tNSetDiatM = cVSetDiat * uFunTmSetEpi* oNDiatWM 
else
tNSetDiatM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tSiSetDiatM = cVSetDiat * uFunTmSetEpi * oSiDiatWM 
else
tSiSetDiatM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tDSetGrenM = cVSetGren * uFunTmSetEpi * oDGrenWM 
else
tDSetGrenM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tPSetGrenM = cVSetGren * uFunTmSetEpi* oPGrenWM 
else
tPSetGrenM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tNSetGrenM = cVSetGren * uFunTmSetEpi* oNGrenWM 
else
tNSetGrenM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tDSetBlueM = cVSetBlue * uFunTmSetEpi * oDBlueWM 
else
tDSetBlueM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tPSetBlueM = cVSetBlue * uFunTmSetEpi* oPBlueWM 
else
tPSetBlueM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tNSetBlueM = cVSetBlue * uFunTmSetEpi* oNBlueWM 
else
tNSetBlueM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tDSetPhytM = tDSetDiatM + tDSetGrenM + tDSetBlueM 
else
tDSetPhytM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tPSetPhytM = tPSetDiatM + tPSetGrenM + tPSetBlueM 
else
tPSetPhytM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tNSetPhytM = tNSetDiatM + tNSetGrenM + tNSetBlueM 
else
tNSetPhytM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tDSetTotM = tDSetIMM + tDSetDetM + tDSetPhytM 
else
tDSetTotM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wDMinDetWM = kDMinDetW * uFunTmMinWEpi * oDDetWM 
else
wDMinDetWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wPMinDetWM = kPMinDetW * uFunTmMinWEpi * oPDetWM 
else
wPMinDetWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wNMinDetWM = kNMinDetW * uFunTmMinWEpi * oNDetWM 
else
wNMinDetWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wSiMinDetWM = kSiMinDetW * uFunTmMinWEpi * oSiDetWM 
else
wSiMinDetWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
aCorO2BODM = oO2WM /(hO2BOD + oO2WM) 
else
aCorO2BODM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wO2MinDetWM = molO2molC * cCPerDW * aCorO2BODM * wDMinDetWM 
else
wO2MinDetWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wDDenitWM = oNO3WM*oNO3WM /(hNO3Denit*hNO3Denit + oNO3WM*oNO3WM) *(1.0 - aCorO2BODM) * wDMinDetWM 
else
wDDenitWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wNDenitWM = NO3PerC * molNmolC * cCPerDW * wDDenitWM 
else
wNDenitWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
aCorO2NitrWM = oO2WM * oO2WM /(hO2Nitr * hO2Nitr + oO2WM * oO2WM) 
else
aCorO2NitrWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wNNitrWM = kNitrW * uFunTmNitrEpi * aCorO2NitrWM * oNH4WM 
else
wNNitrWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wO2NitrWM = O2PerNH4 * molO2molN * wNNitrWM 
else
wO2NitrWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tDMinDetSM = kDMinDetS * uFunTmMinS * sDDetSM 
else
tDMinDetSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tPMinDetSM = kPMinDetS * uFunTmMinS * sPDetSM 
else
tPMinDetSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tNMinDetSM = kNMinDetS * uFunTmMinS * sNDetSM 
else
tNMinDetSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tSiMinDetSM = kSiMinDetS * uFunTmMinS * sSiDetSM 
else
tSiMinDetSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
akO2DifCorM = kO2Dif * uFunTmDif * cTurbDifO2 * bPorCorSM 
else
akO2DifCorM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tSODM =(molO2molC * cCPerDW *(1.0 - fRefrDetS) * tDMinDetSM + O2PerNH4 * molO2molN * kNitrS * uFunTmNitrEpi * sNH4SM) / cDepthSM 
else
tSODM = 0.0 
end;
if (InclMarsh == false || fMarsh <= NearZero) 
aDepthOxySedM = 0.0 
elseif (2.0 * oO2WM * akO2DifCorM / tSODM) <= NearZero 
aDepthOxySedM = (( NearZero )^ (0.5)) 
else
aDepthOxySedM = (((2.0 * oO2WM * akO2DifCorM / tSODM) )^ (0.5)) 
end;
if (InclMarsh == true && fMarsh > NearZero) 
afOxySedM = aDepthOxySedM / cDepthSM 
else
afOxySedM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tDMinOxyDetSM = afOxySedM *(1.0 - fRefrDetS) * tDMinDetSM 
else
tDMinOxyDetSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tO2MinDetSM = molO2molC * cCPerDW * tDMinOxyDetSM 
else
tO2MinDetSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tDDenitSM = oNO3SM*oNO3SM /(hNO3Denit*hNO3Denit + oNO3SM*oNO3SM) *(1.0 - afOxySedM) *(1.0 - fRefrDetS) * tDMinDetSM 
else
tDDenitSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tNDenitSM = NO3PerC * molNmolC * cCPerDW * tDDenitSM 
else
tNDenitSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tNNitrSM = afOxySedM * kNitrS * uFunTmNitrEpi * sNH4SM 
else
tNNitrSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tO2NitrSM = O2PerNH4 * molO2molN * tNNitrSM 
else
tO2NitrSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tDMinHumSM = kDMinHum * uFunTmMinS * afOxySedM * sDHumSM 
else
tDMinHumSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tPMinHumSM = kDMinHum * uFunTmMinS * afOxySedM * sPHumSM 
else
tPMinHumSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tNMinHumSM = kDMinHum * uFunTmMinS * afOxySedM * sNHumSM 
else
tNMinHumSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
aDepthDifM = fDepthDifS * cDepthSM 
else
aDepthDifM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tPDifPO4M = kPDifPO4 * uFunTmDif * cTurbDifNut * bPorCorSM * (oPO4SM - oPO4WM) / aDepthDifM 
else
tPDifPO4M = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tNDifNO3M = kNDifNO3 * uFunTmDif * cTurbDifNut * bPorCorSM * (oNO3SM - oNO3WM) / aDepthDifM 
else
tNDifNO3M = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tNDifNH4M = kNDifNH4 * uFunTmDif * cTurbDifNut * bPorCorSM * (oNH4SM - oNH4WM) / aDepthDifM 
else
tNDifNH4M = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tO2DifM = kO2Dif / aDepthDifM * uFunTmDif * cTurbDifO2 * bPorCorSM * oO2WM 
else
tO2DifM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tPDifGroundPO4M = 0.0 
else
tPDifGroundPO4M = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tNDifGroundNO3M = 0.0 
else
tNDifGroundNO3M = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tNDifGroundNH4M = 0.0 
else
tNDifGroundNH4M = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
aPAdsMaxWM = cRelPAdsD + aCorO2BODM * cRelPAdsFe * fFeDIM + cRelPAdsAl * fAlDIM 
else
aPAdsMaxWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
aKPAdsWM =(1.0 - fRedMax *(1.0-aCorO2BODM)) * cKPAdsOx 
else
aKPAdsWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
aPIsoAdsWM = aPAdsMaxWM * aKPAdsWM * oPO4WM /(1.0 + aKPAdsWM * oPO4WM) 
else
aPIsoAdsWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
aPEqIMWM = aPIsoAdsWM * oDIMWM 
else
aPEqIMWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wPSorpIMWM = kPSorp *(aPEqIMWM - oPAIMWM) 
else
wPSorpIMWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
aPAdsMaxSM = cRelPAdsD + afOxySedM * cRelPAdsFe * fFeDIM + cRelPAdsAl * fAlDIM 
else
aPAdsMaxSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
aKPAdsSM =(1.0 - fRedMax *(1.0-afOxySedM)) * cKPAdsOx 
else
aKPAdsSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
aPIsoAdsSM = aPAdsMaxSM * aKPAdsSM * oPO4SM /(1.0 + aKPAdsSM * oPO4SM) 
else
aPIsoAdsSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
aPEqIMSM = aPIsoAdsSM * sDIMSM 
else
aPEqIMSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tPSorpIMSM = kPSorp *(aPEqIMSM - sPAIMSM) 
else
tPSorpIMSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tPChemPO4M = max(0.0,kPChemPO4 *(oPO4SM - coPO4Max)) 
else
tPChemPO4M = 0.0 
end;
aDRootVeg = bfRootVeg * sDVeg;
bfSubVegEpi = bfSubVeg * ( uVegHeightEpi / uDepthW );
bfSubVegHyp = bfSubVeg * ( uVegHeightHyp / uDepthW );
afCovSurfVeg = min(1.0, max(aDFloatVeg / (cDLayerVeg + NearZero), aDEmergVeg / (fEmergVeg * cDCarrVeg + NearZero) ) ) ;
afCovEmergVeg = min(1.0, PerCent * cCovSpVeg * aDEmergVeg);
aCovVeg = min(100.0, cCovSpVeg * aDShootVeg);
aDVeg = sDVeg;
aPVeg = sPVeg;
aNVeg = sNVeg;
aLPARBotHyp = uLPARSurfHyp * exp(- aExtCoefHyp * sDepthWHyp);
rPDVeg = sPVeg / (sDVeg+NearZero);
rNDVeg = sNVeg / (sDVeg+NearZero);
tDMigrVeg = kMigrVeg * (cDVegIn - sDVeg);
tPMigrVeg = kMigrVeg * (cPDVeg0* cDVegIn - sPVeg);
tNMigrVeg = kMigrVeg * (cNDVeg0* cDVegIn - sNVeg);
if ( UsePowerVeg < NearZero ) 
uFunTmRespVeg = uFunTmVeg 
else
uFunTmRespVeg = ((cQ10RespVeg )^ (0.1 * (uTmVegAve - cTmRef))) 
end;
if (false == UseEmpUpt) 
afPUptVegS = 0.0 
elseif (bfRootVeg <= NearZero) 
afPUptVegS = 0.0 
elseif (fFloatVeg + bfSubVeg <= NearZero) 
afPUptVegS = 1.0 
elseif (aInclStrat == true && ((oPO4S+NearZero) / (oPO4WHyp+NearZero)) > NearZero ) 
afPUptVegS = fSedUptVegMax / (1.0 + fSedUptVegCoef * ((((oPO4S+NearZero) / (oPO4WHyp+NearZero)) )^ fSedUptVegExp)) 
elseif (aInclStrat == true && ((oPO4S+NearZero) / (oPO4WHyp+NearZero)) <= NearZero ) 
afPUptVegS = fSedUptVegMax / (1.0 + fSedUptVegCoef * (( NearZero )^ fSedUptVegExp)) 
elseif (((oPO4S+NearZero) / (oPO4WEpi+NearZero)) <= NearZero ) 
afPUptVegS = fSedUptVegMax / (1.0 + fSedUptVegCoef * ( (NearZero )^ fSedUptVegExp)) 
else
afPUptVegS = fSedUptVegMax / (1.0 + fSedUptVegCoef * ((((oPO4S+NearZero) / (oPO4WEpi+NearZero)) )^ fSedUptVegExp)) 
end;
if (false == UseEmpUpt) 
afNUptVegS = 0.0 
elseif (bfRootVeg <= NearZero) 
afNUptVegS = 0.0 
elseif (fFloatVeg + bfSubVeg <= NearZero) 
afNUptVegS = 1.0 
elseif ( aInclStrat == true && ((oNDissS+NearZero) / (oNDissWHyp+NearZero)) > NearZero ) 
afNUptVegS = fSedUptVegMax / (1.0 + fSedUptVegCoef * ((((oNDissS+NearZero) / (oNDissWHyp+NearZero)) )^ fSedUptVegExp)) 
elseif ( aInclStrat == true && ((oNDissS+NearZero) / (oNDissWHyp+NearZero)) <= NearZero ) 
afNUptVegS = fSedUptVegMax / (1.0 + fSedUptVegCoef * ((NearZero )^ fSedUptVegExp)) 
elseif ( ((oNDissS+NearZero) / (oNDissWEpi+NearZero)) <= NearZero ) 
afNUptVegS = fSedUptVegMax / (1.0 + fSedUptVegCoef * ((NearZero )^ fSedUptVegExp)) 
else
afNUptVegS = fSedUptVegMax / (1.0 + fSedUptVegCoef * ((((oNDissS+NearZero) / (oNDissWEpi+NearZero)) )^ fSedUptVegExp)) 
end;
if (false == UseEmpUpt) 
aVPUptMaxCrVeg = max( 0.0, cVPUptMaxVeg * uFunTmProdVeg * (cPDVegMax-rPDVeg) / (cPDVegMax-cPDVegMin) ) 
else
aVPUptMaxCrVeg = max( 0.0, cVPUptMaxVeg * uFunTmProdVeg * (cPDVegMax-rPDVeg) / (cPDVegMax-cPDVegMin) ) 
end;
if (false == UseEmpUpt) 
aVPUptVegWHyp = oPO4WHyp * aVPUptMaxCrVeg / (aVPUptMaxCrVeg / cAffPUptVeg + oPO4WHyp) 
else
aVPUptVegWHyp = 0.0 
end;
if (false == UseEmpUpt) 
aVPUptVegS = oPO4S * aVPUptMaxCrVeg / (aVPUptMaxCrVeg / cAffPUptVeg + oPO4S) 
else
aVPUptVegS = 0.0 
end;
if (false == UseEmpUpt) 
aVPUptVegWEpi = oPO4WEpi * aVPUptMaxCrVeg / (aVPUptMaxCrVeg / cAffPUptVeg + oPO4WEpi) 
else
aVPUptVegWEpi = 0.0 
end;
if (false == UseEmpUpt) 
tPUptVegWEpi = aVPUptVegWEpi * (aDSubVeg + aDFloatVeg) 
else
tPUptVegWEpi = (1.0 - afPUptVegS) * aVPUptMaxCrVeg * oPO4WEpi / (aVPUptMaxCrVeg / cAffPUptVeg + oPO4WEpi) * uDVegEpi 
end;
if (false == UseEmpUpt) 
tPUptVegWHyp = aVPUptVegWHyp * (aDSubVeg + aDFloatVeg) 
else
tPUptVegWHyp = (1.0 - afPUptVegS) * aVPUptMaxCrVeg * oPO4WHyp / (aVPUptMaxCrVeg / cAffPUptVeg + oPO4WHyp) * uDVegHyp 
end;
if (false == UseEmpUpt) 
tPUptVegS = aVPUptVegS * aDRootVeg 
else
tPUptVegS = afPUptVegS * aVPUptMaxCrVeg * oPO4S / (aVPUptMaxCrVeg / cAffPUptVeg + oPO4S) * sDVeg 
end;
if (aInclStrat == true ) 
tPUptVegEpi = tPUptVegWEpi + tPUptVegS * uDVegEpi / sDVeg 
elseif (aInclStrat == false && false == UseEmpUpt) 
tPUptVegEpi = tPUptVegWEpi + tPUptVegS 
else
tPUptVegEpi = tPUptVegWEpi + tPUptVegS 
end;
if (aInclStrat == false) 
tPUptVegHyp = 0.0 
elseif (false == UseEmpUpt) 
tPUptVegHyp = tPUptVegWHyp + tPUptVegS * uDVegHyp / sDVeg 
else
tPUptVegHyp = tPUptVegWHyp + tPUptVegS * uDVegHyp / sDVeg 
end;
if (false == UseEmpUpt) 
aVNUptMaxCrVeg = max( 0.0, cVNUptMaxVeg * uFunTmProdVeg * (cNDVegMax - rNDVeg) / (cNDVegMax - cNDVegMin)) 
else
aVNUptMaxCrVeg = max( 0.0, cVNUptMaxVeg * uFunTmProdVeg * (cNDVegMax - rNDVeg) / (cNDVegMax - cNDVegMin)) 
end;
if (false == UseEmpUpt) 
ahNUptVeg = aVNUptMaxCrVeg / cAffNUptVeg 
else
ahNUptVeg = aVNUptMaxCrVeg / cAffNUptVeg 
end;
if (false == UseEmpUpt) 
aVNUptVegWEpi = oNDissWEpi * aVNUptMaxCrVeg / (ahNUptVeg + oNDissWEpi) 
else
aVNUptVegWEpi = 0.0 
end;
if (false == UseEmpUpt) 
aVNUptVegWHyp = oNDissWHyp * aVNUptMaxCrVeg / (ahNUptVeg + oNDissWHyp) 
else
aVNUptVegWHyp = 0.0 
end;
if (false == UseEmpUpt) 
afNH4UptVegWEpi = oNH4WEpi * oNO3WEpi / ((ahNUptVeg + oNH4WEpi) * (ahNUptVeg + oNO3WEpi + NearZero)) + oNH4WEpi * ahNUptVeg / ((oNH4WEpi + oNO3WEpi + NearZero) * (ahNUptVeg + oNO3WEpi + NearZero)) 
else
afNH4UptVegWEpi = oNH4WEpi * oNO3WEpi / ((ahNUptVeg + oNH4WEpi) * (ahNUptVeg + oNO3WEpi + NearZero)) + oNH4WEpi * ahNUptVeg / ((oNH4WEpi + oNO3WEpi + NearZero) * (ahNUptVeg + oNO3WEpi + NearZero)) 
end;
if (false == UseEmpUpt) 
afNH4UptVegWHyp = oNH4WHyp * oNO3WHyp / ((ahNUptVeg + oNH4WHyp) * (ahNUptVeg + oNO3WHyp + NearZero)) + oNH4WHyp * ahNUptVeg / ((oNH4WHyp + oNO3WHyp + NearZero) * (ahNUptVeg + oNO3WHyp + NearZero)) 
else
afNH4UptVegWHyp = oNH4WHyp * oNO3WHyp / ((ahNUptVeg + oNH4WHyp) * (ahNUptVeg + oNO3WHyp + NearZero)) + oNH4WHyp * ahNUptVeg / ((oNH4WHyp + oNO3WHyp + NearZero) * (ahNUptVeg + oNO3WHyp + NearZero)) 
end;
if (false == UseEmpUpt) 
tNUptVegWEpi = aVNUptVegWEpi * (aDSubVeg + aDFloatVeg) 
else
tNUptVegWEpi = (1.0 - afNUptVegS) * aVNUptMaxCrVeg * oNDissWEpi / (aVNUptMaxCrVeg / cAffNUptVeg + oNDissWEpi) * uDVegEpi 
end;
if (false == aInclStrat) 
tNUptVegWHyp = 0.0 
elseif (false == UseEmpUpt) 
tNUptVegWHyp = aVNUptVegWHyp * (aDSubVeg + aDFloatVeg) 
else
tNUptVegWHyp = (1.0 - afNUptVegS) * aVNUptMaxCrVeg * oNDissWHyp / (aVNUptMaxCrVeg / cAffNUptVeg + oNDissWHyp) * uDVegHyp 
end;
if (false == UseEmpUpt) 
tNUptNH4VegWEpi = afNH4UptVegWEpi * tNUptVegWEpi 
else
tNUptNH4VegWEpi = afNH4UptVegWEpi * tNUptVegWEpi 
end;
if (false == UseEmpUpt) 
tNUptNO3VegWEpi = tNUptVegWEpi - tNUptNH4VegWEpi 
else
tNUptNO3VegWEpi = tNUptVegWEpi - tNUptNH4VegWEpi 
end;
if (false == UseEmpUpt) 
tNUptNH4VegWHyp = afNH4UptVegWHyp * tNUptVegWHyp 
else
tNUptNH4VegWHyp = afNH4UptVegWHyp * tNUptVegWHyp 
end;
if (false == UseEmpUpt) 
tNUptNO3VegWHyp = tNUptVegWHyp - tNUptNH4VegWHyp 
else
tNUptNO3VegWHyp = tNUptVegWHyp - tNUptNH4VegWHyp 
end;
if (false == UseEmpUpt) 
aVNUptVegS = oNDissS * aVNUptMaxCrVeg / (ahNUptVeg + oNDissS) 
else
aVNUptVegS = 0.0 
end;
if (false == UseEmpUpt) 
tNUptVegS = aVNUptVegS * aDRootVeg 
else
tNUptVegS = afNUptVegS * aVNUptMaxCrVeg * oNDissS / (aVNUptMaxCrVeg / cAffNUptVeg + oNDissS) * sDVeg 
end;
if (false == UseEmpUpt) 
afNH4UptVegS = oNH4S * oNO3S / ((ahNUptVeg + oNH4S +NearZero) * (ahNUptVeg + oNO3S +NearZero)) + oNH4S * ahNUptVeg / ((oNH4S + oNO3S+NearZero) * (ahNUptVeg + oNO3S+NearZero)) 
else
afNH4UptVegS = oNH4S * oNO3S / ((ahNUptVeg + oNH4S +NearZero) * (ahNUptVeg + oNO3S +NearZero)) + oNH4S * ahNUptVeg / ((oNH4S + oNO3S+NearZero) * (ahNUptVeg + oNO3S+NearZero)) 
end;
if (false == UseEmpUpt) 
tNUptNH4VegS = afNH4UptVegS * tNUptVegS 
else
tNUptNH4VegS = afNH4UptVegS * tNUptVegS 
end;
if (false == UseEmpUpt) 
tNUptVegSEpi = aVNUptVegS * aDRootVeg 
else
tNUptVegSEpi = afNUptVegS * aVNUptMaxCrVeg * oNDissS / (aVNUptMaxCrVeg / cAffNUptVeg + oNDissS) * sDVeg 
end;
if (false == UseEmpUpt) 
tNUptNO3VegS = tNUptVegS - tNUptNH4VegS 
else
tNUptNO3VegS = tNUptVegS - tNUptNH4VegS 
end;
tNUptVeg =tNUptVegWEpi + tNUptVegWHyp + tNUptVegS;
aLLimShootVegEpi = fEmergVeg + fFloatVeg * (1.0 - afCovEmergVeg) + bfSubVegEpi * (1.0 - afCovSurfVeg) * 1.0 / (aExtCoefEpi * sDepthWEpi) * log( (1.0 + aLPAR1VegEpi / uhLVeg) / (1.0 + aLPAR2VegEpi / uhLVeg));
aLLimShootVegHyp = fEmergVeg + fFloatVeg * (1.0 - afCovEmergVeg) + bfSubVegHyp * (1.0 - afCovSurfVeg) * 1.0 / (aExtCoefHyp * sDepthWHyp) * log( (1.0 + aLPAR1VegHyp / uhLVeg) / (1.0 + aLPAR2VegHyp / uhLVeg));
aMuTmLVegHyp = ufDay * bfShootVeg * aLLimShootVegHyp * uFunTmProdVeg * cMuMaxVeg;
aPLimVeg = max(0.0, (1.0 - cPDVegMin / rPDVeg) * cPDVegMax / (cPDVegMax - cPDVegMin) );
aNLimVeg = max(0.0, (1.0 - cNDVegMin / rNDVeg) * cNDVegMax / (cNDVegMax - cNDVegMin) );
aNutLimVeg = min( aPLimVeg, aNLimVeg);
aMuVegHyp = aMuTmLVegHyp * aNutLimVeg;
if (false == InclSeason) 
bkMortVeg = kMortVegSum 
elseif (Day < uDayWinVeg) 
bkMortVeg = kMortVegSum 
elseif (Day < uDayWinVeg + cLengMort) 
bkMortVeg = - log(fWinVeg) / cLengMort 
else
bkMortVeg = kMortVegSum 
end;
akDIncrVegHyp = aMuTmLVegHyp - kDRespVeg * uFunTmRespVeg - bkMortVeg;
tDEnvVegHyp = max(0.0, akDIncrVegHyp / (cDCarrVeg+NearZero) * sDVeg*sDVeg);
tDEnvProdVegHyp = aMuVegHyp / cMuMaxVeg * tDEnvVegHyp;
if (aInclStrat == false) 
tDProdVegHyp = 0.0 
else
tDProdVegHyp = max(0.0, aMuVegHyp * uDVegHyp - tDEnvProdVegHyp) 
end;
tDProdSubVegHyp = bfSubVegHyp * tDProdVegHyp;
tDRespVeg = kDRespVeg * uFunTmRespVeg * sDVeg;
tDEnvMortVegHyp = tDEnvVegHyp - tDEnvProdVegHyp;
if (aInclStrat == false) 
tDMortVegHyp = 0.0 
else
tDMortVegHyp = bkMortVeg * uDVegHyp + tDEnvMortVegHyp 
end;
tDMortVegWHyp = fDetWMortVeg * (1.0 - bfRootVeg) * tDMortVegHyp;
if ( (sTime >= cYearStartBirds * DaysPerYear) && (Day >= cDayStartBirds) && (Day <= cDayEndBirds) ) 
tDGrazVegBird = cPrefVegBird * sDVeg / (hDVegBird + sDVeg) * cBirdsPerha / m2Perha * cDGrazPerBird 
else
tDGrazVegBird = 0.0 
end;
if ((Day >= cDayManVeg1 && Day < cDayManVeg1 + cLengMan) || (Day >= cDayManVeg2 && Day < cDayManVeg2 + cLengMan)) 
bkManVeg = -log(1.0 - fManVeg) / cLengMan 
else
bkManVeg = 0.0 
end;
tDManVeg = bkManVeg * sDVeg;
tPManVeg = rPDVeg * tDManVeg;
tNManVeg = rNDVeg * tDManVeg;
tO2ProdVegHyp = molO2molC * cCPerDW * tDProdVegHyp;
tO2RespVegWHyp = molO2molC * cCPerDW * bfSubVegHyp * tDRespVeg * aCorO2BODHyp;
if(aInclStrat == true && (2.0 * oO2WHyp * akO2DifCor / tSOD) > NearZero ) 
aDepthOxySed = (((2.0 * oO2WHyp * akO2DifCor / tSOD) )^ (0.5)) 
elseif ( aInclStrat == true && (2.0 * oO2WHyp * akO2DifCor / tSOD) <= NearZero ) 
aDepthOxySed = ( ( NearZero )^ (0.5)) 
elseif ( aInclStrat == true && ( 2.0 * oO2WEpi * akO2DifCor / tSOD ) <= NearZero ) 
aDepthOxySed = ( ( NearZero )^ (0.5)) 
else
aDepthOxySed = ( ( ( 2.0 * oO2WEpi * akO2DifCor / tSOD ) )^ (0.5)) 
end;
afOxySed = aDepthOxySed / cDepthS;
tO2RespVegS = molO2molC * cCPerDW * bfRootVeg * tDRespVeg * afOxySed;
tO2ProdVegSHyp = min (tO2RespVegS, tO2ProdVegHyp);
tO2ProdVegWHyp = min( tO2ProdVegHyp - tO2ProdVegSHyp, bfSubVeg * tO2ProdVegHyp);
tO2UptNO3VegWHyp = O2PerNO3 * molO2molN * bfSubVeg * tNUptNO3VegWHyp;
tO2UptNO3VegS = O2PerNO3 * molO2molN * tNUptNO3VegS;
tPExcrVeg = (rPDVeg *2.0)/ (cPDVegMax + rPDVeg) * rPDVeg * tDRespVeg;
tPExcrVegS = bfRootVeg * tPExcrVeg;
tPExcrVegW = tPExcrVeg - tPExcrVegS;
tPMortVegHyp = rPDVeg * tDMortVegHyp;
tPMortVegPO4Hyp = fDissMortVeg * tPMortVegHyp;
tPMortVegPO4SHyp = bfRootVeg * tPMortVegPO4Hyp;
tPMortVegPO4WHyp = tPMortVegPO4Hyp - tPMortVegPO4SHyp;
tPMortVegDetHyp = tPMortVegHyp - tPMortVegPO4Hyp;
tPMortVegDetWHyp = fDetWMortVeg * (1.0 - bfRootVeg) * tPMortVegDetHyp;
tPMortVegDetSHyp = tPMortVegDetHyp - tPMortVegDetWHyp;
tPGrazVegBird = rPDVeg * tDGrazVegBird;
tNExcrVeg = (2.0 * rNDVeg) / (cNDVegMax + rNDVeg) * rNDVeg * tDRespVeg;
tNExcrVegS = bfRootVeg * tNExcrVeg;
tNExcrVegW = tNExcrVeg - tNExcrVegS;
tNMortVegHyp = rNDVeg * tDMortVegHyp;
tNMortVegNH4Hyp = fDissMortVeg * tNMortVegHyp;
if (aInclStrat == true ) 
tNMortVegNH4SHyp = bfRootVeg * tNMortVegNH4Hyp 
else
tNMortVegNH4SHyp = 0.0 
end;
tNMortVegNH4WHyp = tNMortVegNH4Hyp - tNMortVegNH4SHyp;
tNMortVegDetHyp = tNMortVegHyp - tNMortVegNH4Hyp;
tNMortVegDetWHyp = fDetWMortVeg * (1.0 - bfRootVeg) * tNMortVegDetHyp;
tNMortVegDetSHyp = tNMortVegDetHyp - tNMortVegDetWHyp;
tNGrazVegBird = rNDVeg * tDGrazVegBird;
tDAssVegBird = fDAssBird * tDGrazVegBird;
tDEgesBird = tDGrazVegBird - tDAssVegBird;
tPAssVegBird = fDAssBird * tPGrazVegBird;
tPEgesBird = tPGrazVegBird - tPAssVegBird;
tPEgesBirdPO4 = fDissEgesBird * tPEgesBird;
tPEgesBirdDet = tPEgesBird - tPEgesBirdPO4;
tNAssVegBird = fDAssBird * tNGrazVegBird;
tNEgesBird = tNGrazVegBird - tNAssVegBird;
tNEgesBirdNH4 = fDissEgesBird * tNEgesBird;
tNEgesBirdDet = tNEgesBird - tNEgesBirdNH4;
if (aInclStrat == true && InclVeg == true) 
wDBedDetWHyp = (tDMortVegWHyp) / sDepthWHyp 
else
wDBedDetWHyp = 0.0 
end;
aMuTmLVegEpi = ufDay * bfShootVeg * aLLimShootVegEpi * uFunTmProdVeg * cMuMaxVeg;
akDIncrVegEpi = aMuTmLVegEpi - kDRespVeg * uFunTmRespVeg - bkMortVeg;
tDEnvVegEpi = max(0.0, akDIncrVegEpi / (cDCarrVeg+NearZero) * sDVeg*sDVeg);
aMuVegEpi = aMuTmLVegEpi * aNutLimVeg;
tDEnvProdVegEpi = aMuVegEpi / cMuMaxVeg * tDEnvVegEpi;
tDProdVegEpi = max(0.0, aMuVegEpi * uDVegEpi - tDEnvProdVegEpi);
tDEnvMortVegEpi = tDEnvVegEpi - tDEnvProdVegEpi;
tDMortVegEpi = bkMortVeg * uDVegEpi + tDEnvMortVegEpi;
tNMortVegEpi = rNDVeg * tDMortVegEpi;
tNMortVegNH4Epi = fDissMortVeg * tNMortVegEpi;
tNMortVegNH4SEpi = bfRootVeg * tNMortVegNH4Epi;
if (aInclStrat == true && InclVeg == true ) 
wPBedPO4WHyp = (- tPUptVegWHyp + tPExcrVegW * uVegHeightHyp / uVegHeight + tPMortVegPO4WHyp ) /sDepthWHyp 
else
wPBedPO4WHyp = 0.0 
end;
if (aInclStrat == true && InclVeg == true) 
wPBedDetWHyp = (tPMortVegDetWHyp ) / sDepthWHyp 
else
wPBedDetWHyp = 0.0 
end;
if (aInclStrat == true && InclVeg == true ) 
wNBedNH4WHyp = (- tNUptNH4VegWHyp + tNExcrVegW * (uVegHeightHyp /uVegHeight ) + tNMortVegNH4WHyp ) / sDepthWHyp 
else
wNBedNH4WHyp = 0.0 
end;
if (aInclStrat == true && InclVeg == true) 
wNBedNO3WHyp = - tNUptNO3VegWHyp / sDepthWHyp 
else
wNBedNO3WHyp = 0.0 
end;
if (aInclStrat == true && InclVeg == true) 
wNBedDetWHyp = (tNMortVegDetWHyp ) / sDepthWHyp 
else
wNBedDetWHyp = 0.0 
end;
tDMortVegSHyp = tDMortVegHyp - tDMortVegWHyp;
if (aInclStrat == true && InclVeg == true ) 
tDBedDetSHyp = tDMortVegSHyp 
else
tDBedDetSHyp = 0.0 
end;
if (aInclStrat == true && InclVeg == true ) 
tO2BedWHyp = tO2ProdVegWHyp - tO2RespVegWHyp + tO2UptNO3VegWHyp 
else
tO2BedWHyp = 0.0 
end;
if (InclWeb == true) 
UseLoss = 0.0 
else
UseLoss = 1.0 
end;
uFunTmLossHyp = exp(-0.5/(cSigTmLoss*cSigTmLoss) *((uTmHyp-cTmOptLoss)*(uTmHyp-cTmOptLoss) -(cTmRef-cTmOptLoss)*(cTmRef-cTmOptLoss)));
uFunTmLossEpi = exp(-0.5/(cSigTmLoss*cSigTmLoss) *((uTmEpi-cTmOptLoss)*(uTmEpi-cTmOptLoss) -(cTmRef-cTmOptLoss)*(cTmRef-cTmOptLoss)));
rPDBlueWHyp = oPBlueWHyp /(oDBlueWHyp+NearZero);
rNDBlueWHyp = oNBlueWHyp /(oDBlueWHyp+NearZero);
rPDBlueS = sPBlueS /(sDBlueS+NearZero);
rNDBlueS = sNBlueS /(sDBlueS+NearZero);
uFunTmBlueHyp = exp(-0.5/(cSigTmBlue*cSigTmBlue) *((uTmHyp-cTmOptBlue)*(uTmHyp-cTmOptBlue) - (cTmRef-cTmOptBlue)*(cTmRef-cTmOptBlue)));
uFunTmProdBlueHyp = uFunTmBlueHyp;
uFunTmRespBlueHyp = uFunTmBlueHyp;
uFunTmBlueEpi = exp(-0.5/(cSigTmBlue*cSigTmBlue) *((uTmEpi-cTmOptBlue)*(uTmEpi-cTmOptBlue) - (cTmRef-cTmOptBlue)*(cTmRef-cTmOptBlue)));
uFunTmProdBlueEpi = uFunTmBlueEpi;
uFunTmRespBlueEpi = uFunTmBlueEpi;
uFunTmBlueS = exp(-0.5/(cSigTmBlue*cSigTmBlue) *((uTmBot-cTmOptBlue)*(uTmBot-cTmOptBlue) - (cTmRef-cTmOptBlue)*(cTmRef-cTmOptBlue)));
uFunTmRespBlueS = uFunTmBlueS;
aVPUptMaxCrBlueHyp = max(0.0,cVPUptMaxBlue * uFunTmProdBlueHyp *(cPDBlueMax - rPDBlueWHyp) /(cPDBlueMax - cPDBlueMin));
aVPUptBlueHyp = oPO4WHyp * aVPUptMaxCrBlueHyp /(aVPUptMaxCrBlueHyp / cAffPUptBlue + oPO4WHyp);
if (aInclStrat == false) 
wPUptBlueHyp = 0.0 
else
wPUptBlueHyp = aVPUptBlueHyp * oDBlueWHyp 
end;
aVNUptMaxCrBlueHyp = max(0.0,cVNUptMaxBlue * uFunTmProdBlueHyp * (cNDBlueMax - rNDBlueWHyp) /(cNDBlueMax - cNDBlueMin));
ahNUptBlueHyp = aVNUptMaxCrBlueHyp / cAffNUptBlue;
aVNUptBlueHyp = oNDissWHyp * aVNUptMaxCrBlueHyp /(ahNUptBlueHyp + oNDissWHyp);
if (aInclStrat == false) 
wNUptBlueHyp = 0.0 
else
wNUptBlueHyp = aVNUptBlueHyp * oDBlueWHyp 
end;
afNH4UptBlueHyp = oNH4WHyp * oNO3WHyp /((ahNUptBlueHyp + oNH4WHyp) *(ahNUptBlueHyp + oNO3WHyp)) + oNH4WHyp * ahNUptBlueHyp /((oNH4WHyp + oNO3WHyp) *(ahNUptBlueHyp + oNO3WHyp));
if (aInclStrat == false) 
wNUptNH4BlueHyp = 0.0 
else
wNUptNH4BlueHyp = afNH4UptBlueHyp * wNUptBlueHyp 
end;
if (aInclStrat == false) 
wNUptNO3BlueHyp = 0.0 
else
wNUptNO3BlueHyp = wNUptBlueHyp - wNUptNH4BlueHyp 
end;
uMuMaxTmBlueHyp = cMuMaxBlue * uFunTmProdBlueHyp;
uMuMaxTmBlueEpi = cMuMaxBlue * uFunTmProdBlueEpi;
aPLimBlueHyp = max(0.0,(1.0 - cPDBlueMin / rPDBlueWHyp) * cPDBlueMax /(cPDBlueMax - cPDBlueMin));
aNLimBlueHyp = max(0.0,(1.0 - cNDBlueMin / rNDBlueWHyp) * cNDBlueMax /(cNDBlueMax - cNDBlueMin));
aSiLimBlueHyp = oSiO2WHyp /(hSiAssBlue + oSiO2WHyp);
aLLimBlueHyp = UseSteeleBlue *(exp(1.0) /(aExtCoefHyp * sDepthWHyp) *(exp(- aLPARBotHyp /(cLOptRefBlue * uFunTmProdBlueHyp)) - exp(- uLPARSurfHyp /(cLOptRefBlue * uFunTmProdBlueHyp)))) +(1.0 - UseSteeleBlue) *(1.0 /(aExtCoefHyp * sDepthWHyp) * log((1.0 + uLPARSurfHyp / (hLRefBlue * uFunTmProdBlueHyp)) / (1.0 + aLPARBotHyp /(hLRefBlue * uFunTmProdBlueHyp))));
aMuTmLBlueHyp = ufDay *(1.0 - afCovSurfVeg) * aLLimBlueHyp * uMuMaxTmBlueHyp;
aNutLimBlueHyp = min(aPLimBlueHyp,(min(aNLimBlueHyp,aSiLimBlueHyp)));
aMuBlueHyp = aNutLimBlueHyp * aMuTmLBlueHyp;
if (aInclStrat == false) 
wDAssBlueHyp = 0.0 
else
wDAssBlueHyp = aMuBlueHyp*oDBlueWHyp 
end;
rChDBlueHyp = cChDBlueMax -(cChDBlueMax - cChDBlueMin) * aLLimBlueHyp;
oChlaBlueHyp = mgPerg * rChDBlueHyp * oDBlueWHyp;
aExtChBlueHyp = cExtSpBlue / rChDBlueHyp;
ukDRespTmBlueHyp = kDRespBlue * uFunTmRespBlueHyp;
ukDRespTmBlueEpi = kDRespBlue * uFunTmRespBlueEpi;
ukDRespTmBlueS = kDRespBlue * uFunTmRespBlueS;
if (aInclStrat == false) 
wDRespBlueWHyp = 0.0 
else
wDRespBlueWHyp = ukDRespTmBlueHyp * oDBlueWHyp 
end;
ukLossTmBlueHyp = UseLoss * kLossBlue * uFunTmLossHyp;
ukLossTmBlueEpi = UseLoss * kLossBlue * uFunTmLossEpi;
if (aInclStrat == false) 
wDLossBlueHyp = 0.0 
else
wDLossBlueHyp = ukLossTmBlueHyp * oDBlueWHyp 
end;
if (aInclStrat == false) 
wDMortBlueWHyp = 0.0 
else
wDMortBlueWHyp = kMortBlueW * oDBlueWHyp 
end;
uCorVSetBlueHyp = cVSetBlue * aFunTauSetOMHyp * uFunTmSetHyp;
if (aInclStrat == false) 
tDSetBlueHyp = 0.0 
else
tDSetBlueHyp = uCorVSetBlueHyp * oDBlueWHyp 
end;
tDResusBlue = sDBlueS /(aDPhytS+NearZero) * tDResusPhytTot;
tDRespBlueS = ukDRespTmBlueS * sDBlueS;
tDMortBlueS = kMortBlueS * sDBlueS;
ukDDecBlueHyp = ukDRespTmBlueHyp + ukLossTmBlueHyp + kMortBlueW +(uCorVSetBlueHyp * uFunTmSetHyp) / sDepthWHyp;
if (aInclStrat == false) 
wPExcrBlueWHyp = 0.0 
else
wPExcrBlueWHyp = (rPDBlueWHyp * 2.0 )/(cPDBlueMax + rPDBlueWHyp) * rPDBlueWHyp * wDRespBlueWHyp 
end;
if (aInclStrat == false) 
wPLossBlueHyp = 0.0 
else
wPLossBlueHyp = rPDBlueWHyp * wDLossBlueHyp 
end;
if (aInclStrat == false) 
wPMortBlueWHyp = 0.0 
else
wPMortBlueWHyp = kMortBlueW * oPBlueWHyp 
end;
if (aInclStrat == false) 
tPSetBlueHyp = 0.0 
else
tPSetBlueHyp = rPDBlueWHyp * tDSetBlueHyp 
end;
tPResusBlue = rPDBlueS * tDResusBlue;
tPExcrBlueS = (rPDBlueS *2.0)/(cPDBlueMax + rPDBlueS) * rPDBlueS * tDRespBlueS;
tPMortBlueS = kMortBlueS * sPBlueS;
if (aInclStrat == false) 
wNExcrBlueWHyp = 0.0 
else
wNExcrBlueWHyp = (rNDBlueWHyp *2.0)/(cNDBlueMax + rNDBlueWHyp) * rNDBlueWHyp * wDRespBlueWHyp 
end;
if (aInclStrat == false) 
wNLossBlueHyp = 0.0 
else
wNLossBlueHyp = rNDBlueWHyp * wDLossBlueHyp 
end;
if (aInclStrat == false) 
wNMortBlueWHyp = 0.0 
else
wNMortBlueWHyp = kMortBlueW * oNBlueWHyp 
end;
if (aInclStrat == false) 
tNSetBlueHyp = 0.0 
else
tNSetBlueHyp = rNDBlueWHyp * tDSetBlueHyp 
end;
tNResusBlue = rNDBlueS * tDResusBlue;
tNExcrBlueS = (2.0 * rNDBlueS) /(cNDBlueMax + rNDBlueS) * rNDBlueS * tDRespBlueS;
tNMortBlueS = kMortBlueS * sNBlueS;
aFunTauSetOMEpi = min(1.0 / ((aFunDimSusp +NearZero )^ (0.5)), 1.0);
aFunTauSetIMEpi = aFunTauSetOMEpi;
uCorVSetBlueEpi = cVSetBlue * aFunTauSetOMEpi * uFunTmSetEpi;
tDSetBlueEpi = uCorVSetBlueEpi * oDBlueWEpi;
rNDBlueWEpi = oNBlueWEpi /(oDBlueWEpi+NearZero);
tNSetBlueEpi = rNDBlueWEpi * tDSetBlueEpi;
rPDBlueWEpi = oPBlueWEpi /(oDBlueWEpi+NearZero);
tPSetBlueEpi = rPDBlueWEpi * tDSetBlueEpi;
if (aInclStrat == false) 
wDPrimBlueWHyp = 0.0 
else
wDPrimBlueWHyp = wDAssBlueHyp - wDRespBlueWHyp - wDLossBlueHyp - wDMortBlueWHyp -(tDSetBlueHyp - tDSetBlueEpi - tDResusBlue) / sDepthWHyp 
end;
if (aInclStrat == false) 
wPPrimBlueWHyp = 0.0 
else
wPPrimBlueWHyp = wPUptBlueHyp - wPExcrBlueWHyp - wPLossBlueHyp - wPMortBlueWHyp -(tPSetBlueHyp - tPSetBlueEpi - tPResusBlue) / sDepthWHyp 
end;
if (aInclStrat == false) 
wNPrimBlueWHyp = 0.0 
else
wNPrimBlueWHyp = wNUptBlueHyp - wNExcrBlueWHyp - wNLossBlueHyp - wNMortBlueWHyp -(tNSetBlueHyp - tNSetBlueEpi - tNResusBlue) / sDepthWHyp 
end;
rPDGrenWHyp = oPGrenWHyp /(oDGrenWHyp+NearZero);
rNDGrenWHyp = oNGrenWHyp /(oDGrenWHyp+NearZero);
rPDGrenS = sPGrenS /(sDGrenS+NearZero);
rNDGrenS = sNGrenS /(sDGrenS+NearZero);
uFunTmGrenHyp = exp(-0.5/(cSigTmGren*cSigTmGren) *((uTmHyp-cTmOptGren)*(uTmHyp-cTmOptGren) - (cTmRef-cTmOptGren)*(cTmRef-cTmOptGren)));
uFunTmGrenEpi = exp(-0.5/(cSigTmGren*cSigTmGren) *((uTmEpi-cTmOptGren)*(uTmEpi-cTmOptGren) - (cTmRef-cTmOptGren)*(cTmRef-cTmOptGren)));
uFunTmGrenS = exp(-0.5/(cSigTmGren*cSigTmGren) *((uTmBot-cTmOptGren)*(uTmBot-cTmOptGren) - (cTmRef-cTmOptGren)*(cTmRef-cTmOptGren)));
uFunTmProdGrenHyp = uFunTmGrenHyp;
uFunTmRespGrenHyp = uFunTmGrenHyp;
uFunTmProdGrenEpi = uFunTmGrenEpi;
uFunTmRespGrenEpi = uFunTmGrenEpi;
uFunTmRespGrenS = uFunTmGrenS;
aVPUptMaxCrGrenHyp = max(0.0,cVPUptMaxGren * uFunTmProdGrenHyp *(cPDGrenMax - rPDGrenWHyp) /(cPDGrenMax - cPDGrenMin));
aVPUptGrenHyp = oPO4WHyp * aVPUptMaxCrGrenHyp /(aVPUptMaxCrGrenHyp / cAffPUptGren + oPO4WHyp);
if (aInclStrat == false) 
wPUptGrenHyp = 0.0 
else
wPUptGrenHyp = aVPUptGrenHyp * oDGrenWHyp 
end;
aVNUptMaxCrGrenHyp = max(0.0,cVNUptMaxGren * uFunTmProdGrenHyp * (cNDGrenMax - rNDGrenWHyp) /(cNDGrenMax - cNDGrenMin));
ahNUptGrenHyp = aVNUptMaxCrGrenHyp / cAffNUptGren;
aVNUptGrenHyp = oNDissWHyp * aVNUptMaxCrGrenHyp /(ahNUptGrenHyp + oNDissWHyp);
if (aInclStrat == false) 
wNUptGrenHyp = 0.0 
else
wNUptGrenHyp = aVNUptGrenHyp * oDGrenWHyp 
end;
afNH4UptGrenHyp = oNH4WHyp * oNO3WHyp /((ahNUptGrenHyp + oNH4WHyp) *(ahNUptGrenHyp + oNO3WHyp)) + oNH4WHyp * ahNUptGrenHyp /((oNH4WHyp + oNO3WHyp) *(ahNUptGrenHyp + oNO3WHyp));
if (aInclStrat == false) 
wNUptNH4GrenHyp = 0.0 
else
wNUptNH4GrenHyp = afNH4UptGrenHyp * wNUptGrenHyp 
end;
if (aInclStrat == false) 
wNUptNO3GrenHyp = 0.0 
else
wNUptNO3GrenHyp = wNUptGrenHyp - wNUptNH4GrenHyp 
end;
uMuMaxTmGrenHyp = cMuMaxGren * uFunTmProdGrenHyp;
uMuMaxTmGrenEpi = cMuMaxGren * uFunTmProdGrenEpi;
aPLimGrenHyp = max(0.0,(1.0 - cPDGrenMin / rPDGrenWHyp) * cPDGrenMax /(cPDGrenMax - cPDGrenMin));
aNLimGrenHyp = max(0.0,(1.0 - cNDGrenMin / rNDGrenWHyp) * cNDGrenMax /(cNDGrenMax - cNDGrenMin));
aSiLimGrenHyp = oSiO2WHyp /(hSiAssGren + oSiO2WHyp);
aLLimGrenHyp = UseSteeleGren *(exp(1.0) /(aExtCoefHyp * sDepthWHyp) *(exp(- aLPARBotHyp /(cLOptRefGren * uFunTmProdGrenHyp)) - exp(- uLPARSurfHyp /(cLOptRefGren * uFunTmProdGrenHyp)))) +(1.0 - UseSteeleGren) *(1.0 /(aExtCoefHyp * sDepthWHyp) * log((1.0 + uLPARSurfHyp / (hLRefGren * uFunTmProdGrenHyp)) / (1.0 + aLPARBotHyp /(hLRefGren * uFunTmProdGrenHyp))));
aMuTmLGrenHyp = ufDay *(1.0 - afCovSurfVeg) * aLLimGrenHyp * uMuMaxTmGrenHyp;
aNutLimGrenHyp = min(aPLimGrenHyp,(min(aNLimGrenHyp,aSiLimGrenHyp)));
aMuGrenHyp = aNutLimGrenHyp * aMuTmLGrenHyp;
if (aInclStrat == false) 
wDAssGrenHyp = 0.0 
else
wDAssGrenHyp = aMuGrenHyp*oDGrenWHyp 
end;
rChDGrenHyp = cChDGrenMax -(cChDGrenMax - cChDGrenMin) * aLLimGrenHyp;
oChlaGrenHyp = mgPerg * rChDGrenHyp * oDGrenWHyp;
aExtChGrenHyp = cExtSpGren / rChDGrenHyp;
ukDRespTmGrenHyp = kDRespGren * uFunTmRespGrenHyp;
ukDRespTmGrenEpi = kDRespGren * uFunTmRespGrenEpi;
ukDRespTmGrenS = kDRespGren * uFunTmRespGrenS;
if (aInclStrat == false) 
wDRespGrenWHyp = 0.0 
else
wDRespGrenWHyp = ukDRespTmGrenHyp * oDGrenWHyp 
end;
ukLossTmGrenHyp = UseLoss * kLossGren * uFunTmLossHyp;
ukLossTmGrenEpi = UseLoss * kLossGren * uFunTmLossEpi;
if (aInclStrat == false) 
wDLossGrenHyp = 0.0 
else
wDLossGrenHyp = ukLossTmGrenHyp * oDGrenWHyp 
end;
if (aInclStrat == false) 
wDMortGrenWHyp = 0.0 
else
wDMortGrenWHyp = kMortGrenW * oDGrenWHyp 
end;
uCorVSetGrenHyp = cVSetGren * aFunTauSetOMHyp * uFunTmSetHyp;
if (aInclStrat == false) 
tDSetGrenHyp = 0.0 
else
tDSetGrenHyp = uCorVSetGrenHyp * oDGrenWHyp 
end;
tDResusGren = sDGrenS /(aDPhytS+NearZero) * tDResusPhytTot;
tDRespGrenS = ukDRespTmGrenS * sDGrenS;
tDMortGrenS = kMortGrenS * sDGrenS;
ukDDecGrenHyp = ukDRespTmGrenHyp + ukLossTmGrenHyp + kMortGrenW +(uCorVSetGrenHyp * uFunTmSetHyp) / sDepthWHyp;
if (aInclStrat == false) 
wPExcrGrenWHyp = 0.0 
else
wPExcrGrenWHyp = (2.0 *rPDGrenWHyp) /(cPDGrenMax + rPDGrenWHyp) * rPDGrenWHyp * wDRespGrenWHyp 
end;
if (aInclStrat == false) 
wPLossGrenHyp = 0.0 
else
wPLossGrenHyp = rPDGrenWHyp * wDLossGrenHyp 
end;
if (aInclStrat == false) 
wPMortGrenWHyp = 0.0 
else
wPMortGrenWHyp = kMortGrenW * oPGrenWHyp 
end;
if (aInclStrat == false) 
tPSetGrenHyp = 0.0 
else
tPSetGrenHyp = rPDGrenWHyp * tDSetGrenHyp 
end;
tPResusGren = rPDGrenS * tDResusGren;
tPExcrGrenS = (2.0 * rPDGrenS) /(cPDGrenMax + rPDGrenS) * rPDGrenS * tDRespGrenS;
tPMortGrenS = kMortGrenS * sPGrenS;
if (aInclStrat == false) 
wNExcrGrenWHyp = 0.0 
else
wNExcrGrenWHyp = (2.0 * rNDGrenWHyp) /(cNDGrenMax + rNDGrenWHyp) * rNDGrenWHyp * wDRespGrenWHyp 
end;
if (aInclStrat == false) 
wNLossGrenHyp = 0.0 
else
wNLossGrenHyp = rNDGrenWHyp * wDLossGrenHyp 
end;
if (aInclStrat == false) 
wNMortGrenWHyp = 0.0 
else
wNMortGrenWHyp = kMortGrenW * oNGrenWHyp 
end;
if (aInclStrat == false) 
tNSetGrenHyp = 0.0 
else
tNSetGrenHyp = rNDGrenWHyp * tDSetGrenHyp 
end;
tNResusGren = rNDGrenS * tDResusGren;
tNExcrGrenS = (2.0 * rNDGrenS) /(cNDGrenMax + rNDGrenS) * rNDGrenS * tDRespGrenS;
tNMortGrenS = kMortGrenS * sNGrenS;
uCorVSetGrenEpi = cVSetGren * aFunTauSetOMEpi * uFunTmSetEpi;
tDSetGrenEpi = uCorVSetGrenEpi * oDGrenWEpi;
rNDGrenWEpi = oNGrenWEpi /(oDGrenWEpi+NearZero);
tNSetGrenEpi = rNDGrenWEpi * tDSetGrenEpi;
rPDGrenWEpi = oPGrenWEpi /(oDGrenWEpi+NearZero);
tPSetGrenEpi = rPDGrenWEpi * tDSetGrenEpi;
if (aInclStrat == false) 
wDPrimGrenWHyp = 0.0 
else
wDPrimGrenWHyp = wDAssGrenHyp - wDRespGrenWHyp - wDLossGrenHyp - wDMortGrenWHyp -(tDSetGrenHyp -tDSetGrenEpi - tDResusGren) / sDepthWHyp 
end;
if (aInclStrat == false) 
wPPrimGrenWHyp = 0.0 
else
wPPrimGrenWHyp = wPUptGrenHyp - wPExcrGrenWHyp - wPLossGrenHyp - wPMortGrenWHyp -(tPSetGrenHyp -tPSetGrenEpi - tPResusGren) / sDepthWHyp 
end;
if (aInclStrat == false) 
wNPrimGrenWHyp = 0.0 
else
wNPrimGrenWHyp = wNUptGrenHyp - wNExcrGrenWHyp - wNLossGrenHyp - wNMortGrenWHyp -(tNSetGrenHyp -tNSetGrenEpi - tNResusGren) / sDepthWHyp 
end;
rPDDiatWHyp = oPDiatWHyp /(oDDiatWHyp+NearZero);
rNDDiatWHyp = oNDiatWHyp /(oDDiatWHyp+NearZero);
rPDDiatS = sPDiatS /(sDDiatS+NearZero);
uFunTmDiatHyp = exp(-0.5/(cSigTmDiat*cSigTmDiat) *((uTmHyp-cTmOptDiat)*(uTmHyp-cTmOptDiat) - (cTmRef-cTmOptDiat)*(cTmRef-cTmOptDiat)));
rNDDiatS = sNDiatS /(sDDiatS+NearZero);
uFunTmDiatEpi = exp(-0.5/(cSigTmDiat*cSigTmDiat) *((uTmEpi-cTmOptDiat)*(uTmEpi-cTmOptDiat) - (cTmRef-cTmOptDiat)*(cTmRef-cTmOptDiat)));
uFunTmDiatS = exp(-0.5/(cSigTmDiat*cSigTmDiat) *((uTmBot-cTmOptDiat)*(uTmBot-cTmOptDiat) - (cTmRef-cTmOptDiat)*(cTmRef-cTmOptDiat)));
uFunTmProdDiatHyp = uFunTmDiatHyp;
uFunTmRespDiatHyp = uFunTmDiatHyp;
uFunTmProdDiatEpi = uFunTmDiatEpi;
uFunTmRespDiatEpi = uFunTmDiatEpi;
uFunTmRespDiatS = uFunTmDiatS;
aVPUptMaxCrDiatHyp = max(0.0,cVPUptMaxDiat * uFunTmProdDiatHyp *(cPDDiatMax - rPDDiatWHyp) /(cPDDiatMax - cPDDiatMin));
aVPUptDiatHyp = oPO4WHyp * aVPUptMaxCrDiatHyp /(aVPUptMaxCrDiatHyp / cAffPUptDiat + oPO4WHyp);
if (aInclStrat == false) 
wPUptDiatHyp = 0.0 
else
wPUptDiatHyp = aVPUptDiatHyp * oDDiatWHyp 
end;
aVNUptMaxCrDiatHyp = max(0.0,cVNUptMaxDiat * uFunTmProdDiatHyp * (cNDDiatMax - rNDDiatWHyp) /(cNDDiatMax - cNDDiatMin));
ahNUptDiatHyp = aVNUptMaxCrDiatHyp / cAffNUptDiat;
aVNUptDiatHyp = oNDissWHyp * aVNUptMaxCrDiatHyp /(ahNUptDiatHyp + oNDissWHyp);
if (aInclStrat == false) 
wNUptDiatHyp = 0.0 
else
wNUptDiatHyp = aVNUptDiatHyp * oDDiatWHyp 
end;
afNH4UptDiatHyp = oNH4WHyp * oNO3WHyp /((ahNUptDiatHyp + oNH4WHyp) *(ahNUptDiatHyp + oNO3WHyp)) + oNH4WHyp * ahNUptDiatHyp /((oNH4WHyp + oNO3WHyp) *(ahNUptDiatHyp + oNO3WHyp));
if (aInclStrat == false) 
wNUptNH4DiatHyp = 0.0 
else
wNUptNH4DiatHyp = afNH4UptDiatHyp * wNUptDiatHyp 
end;
if (aInclStrat == false) 
wNUptNO3DiatHyp = 0.0 
else
wNUptNO3DiatHyp = wNUptDiatHyp - wNUptNH4DiatHyp 
end;
uMuMaxTmDiatHyp = cMuMaxDiat * uFunTmProdDiatHyp;
uMuMaxTmDiatEpi = cMuMaxDiat * uFunTmProdDiatEpi;
aPLimDiatHyp = max(0.0,(1.0 - cPDDiatMin / rPDDiatWHyp) * cPDDiatMax /(cPDDiatMax - cPDDiatMin));
aNLimDiatHyp = max(0.0,(1.0 - cNDDiatMin / rNDDiatWHyp) * cNDDiatMax /(cNDDiatMax - cNDDiatMin));
aSiLimDiatHyp = oSiO2WHyp /(hSiAssDiat + oSiO2WHyp);
aLLimDiatHyp = UseSteeleDiat *(exp(1.0) /(aExtCoefHyp * sDepthWHyp) *(exp(- aLPARBotHyp /(cLOptRefDiat * uFunTmProdDiatHyp)) - exp(- uLPARSurfHyp /(cLOptRefDiat * uFunTmProdDiatHyp)))) +(1.0 - UseSteeleDiat) *(1.0 /(aExtCoefHyp * sDepthWHyp) * log((1.0 + uLPARSurfHyp / (hLRefDiat * uFunTmProdDiatHyp)) / (1.0 + aLPARBotHyp /(hLRefDiat * uFunTmProdDiatHyp))));
aMuTmLDiatHyp = ufDay *(1.0 - afCovSurfVeg) * aLLimDiatHyp * uMuMaxTmDiatHyp;
aNutLimDiatHyp = min(aPLimDiatHyp,(min(aNLimDiatHyp,aSiLimDiatHyp)));
aMuDiatHyp = aNutLimDiatHyp * aMuTmLDiatHyp;
if (aInclStrat == false) 
wDAssDiatHyp = 0.0 
else
wDAssDiatHyp = aMuDiatHyp*oDDiatWHyp 
end;
rChDDiatHyp = cChDDiatMax -(cChDDiatMax - cChDDiatMin) * aLLimDiatHyp;
oChlaDiatHyp = mgPerg * rChDDiatHyp * oDDiatWHyp;
aExtChDiatHyp = cExtSpDiat / rChDDiatHyp;
ukDRespTmDiatHyp = kDRespDiat * uFunTmRespDiatHyp;
ukDRespTmDiatEpi = kDRespDiat * uFunTmRespDiatEpi;
ukDRespTmDiatS = kDRespDiat * uFunTmRespDiatS;
if (aInclStrat == false) 
wDRespDiatWHyp = 0.0 
else
wDRespDiatWHyp = ukDRespTmDiatHyp * oDDiatWHyp 
end;
ukLossTmDiatHyp = UseLoss * kLossDiat * uFunTmLossHyp;
ukLossTmDiatEpi = UseLoss * kLossDiat * uFunTmLossEpi;
if (aInclStrat == false) 
wDLossDiatHyp = 0.0 
else
wDLossDiatHyp = ukLossTmDiatHyp * oDDiatWHyp 
end;
if (aInclStrat == false) 
wDMortDiatWHyp = 0.0 
else
wDMortDiatWHyp = kMortDiatW * oDDiatWHyp 
end;
uCorVSetDiatHyp = cVSetDiat * aFunTauSetOMHyp * uFunTmSetHyp;
if (aInclStrat == false) 
tDSetDiatHyp = 0.0 
else
tDSetDiatHyp = uCorVSetDiatHyp * oDDiatWHyp 
end;
tDResusDiat = sDDiatS /(aDPhytS+NearZero) * tDResusPhytTot;
tDRespDiatS = ukDRespTmDiatS * sDDiatS;
tDMortDiatS = kMortDiatS * sDDiatS;
ukDDecDiatHyp = ukDRespTmDiatHyp + ukLossTmDiatHyp + kMortDiatW +(uCorVSetDiatHyp * uFunTmSetHyp) / sDepthWHyp;
if (aInclStrat == false) 
wPExcrDiatWHyp = 0.0 
else
wPExcrDiatWHyp = (2.0 * rPDDiatWHyp) /(cPDDiatMax + rPDDiatWHyp) * rPDDiatWHyp * wDRespDiatWHyp 
end;
if (aInclStrat == false) 
wPLossDiatHyp = 0.0 
else
wPLossDiatHyp = rPDDiatWHyp * wDLossDiatHyp 
end;
if (aInclStrat == false) 
wPMortDiatWHyp = 0.0 
else
wPMortDiatWHyp = kMortDiatW * oPDiatWHyp 
end;
if (aInclStrat == false) 
tPSetDiatHyp = 0.0 
else
tPSetDiatHyp = rPDDiatWHyp * tDSetDiatHyp 
end;
tPResusDiat = rPDDiatS * tDResusDiat;
tPExcrDiatS = (2.0 * rPDDiatS) /(cPDDiatMax + rPDDiatS) * rPDDiatS * tDRespDiatS;
tPMortDiatS = kMortDiatS * sPDiatS;
if (aInclStrat == false) 
wNExcrDiatWHyp = 0.0 
else
wNExcrDiatWHyp = (2.0 * rNDDiatWHyp) /(cNDDiatMax + rNDDiatWHyp) * rNDDiatWHyp * wDRespDiatWHyp 
end;
if (aInclStrat == false) 
wNLossDiatHyp = 0.0 
else
wNLossDiatHyp = rNDDiatWHyp * wDLossDiatHyp 
end;
if (aInclStrat == false) 
wNMortDiatWHyp = 0.0 
else
wNMortDiatWHyp = kMortDiatW * oNDiatWHyp 
end;
if (aInclStrat == false) 
tNSetDiatHyp = 0.0 
else
tNSetDiatHyp = rNDDiatWHyp * tDSetDiatHyp 
end;
tNResusDiat = rNDDiatS * tDResusDiat;
tNExcrDiatS = (2.0 * rNDDiatS) /(cNDDiatMax + rNDDiatS) * rNDDiatS * tDRespDiatS;
tNMortDiatS = kMortDiatS * sNDiatS;
uCorVSetDiatEpi = cVSetDiat * aFunTauSetOMEpi * uFunTmSetEpi;
tDSetDiatEpi = uCorVSetDiatEpi * oDDiatWEpi;
rPDDiatWEpi = oPDiatWEpi /(oDDiatWEpi+NearZero);
tPSetDiatEpi = rPDDiatWEpi * tDSetDiatEpi;
rNDDiatWEpi = oNDiatWEpi /(oDDiatWEpi+NearZero);
tNSetDiatEpi = rNDDiatWEpi * tDSetDiatEpi;
if (aInclStrat == false) 
wDPrimDiatWHyp = 0.0 
else
wDPrimDiatWHyp = wDAssDiatHyp - wDRespDiatWHyp - wDLossDiatHyp - wDMortDiatWHyp -(tDSetDiatHyp - tDSetDiatEpi - tDResusDiat) / sDepthWHyp 
end;
if (aInclStrat == false) 
wPPrimDiatWHyp = 0.0 
else
wPPrimDiatWHyp = wPUptDiatHyp - wPExcrDiatWHyp - wPLossDiatHyp - wPMortDiatWHyp -(tPSetDiatHyp -tPSetDiatEpi - tPResusDiat) / sDepthWHyp 
end;
if (aInclStrat == false) 
wNPrimDiatWHyp = 0.0 
else
wNPrimDiatWHyp = wNUptDiatHyp - wNExcrDiatWHyp - wNLossDiatHyp - wNMortDiatWHyp -(tNSetDiatHyp - tNSetDiatEpi - tNResusDiat) / sDepthWHyp 
end;
oChlaHyp = oChlaDiatHyp + oChlaGrenHyp + oChlaBlueHyp;
wDAssPhytHyp = wDAssDiatHyp + wDAssGrenHyp + wDAssBlueHyp;
wDRespPhytWHyp = wDRespDiatWHyp + wDRespGrenWHyp + wDRespBlueWHyp;
wDMortPhytWHyp = wDMortDiatWHyp + wDMortGrenWHyp + wDMortBlueWHyp;
tDSetPhytHyp = tDSetDiatHyp + tDSetGrenHyp + tDSetBlueHyp;
wDLossPhytHyp = wDLossDiatHyp + wDLossGrenHyp + wDLossBlueHyp;
wDPrimPhytWHyp = wDPrimDiatWHyp + wDPrimGrenWHyp + wDPrimBlueWHyp;
wPUptPhytHyp = wPUptDiatHyp + wPUptGrenHyp + wPUptBlueHyp;
wPExcrPhytWHyp = wPExcrDiatWHyp + wPExcrGrenWHyp + wPExcrBlueWHyp;
wPMortPhytWHyp = wPMortDiatWHyp + wPMortGrenWHyp + wPMortBlueWHyp;
tPSetPhytHyp = tPSetDiatHyp + tPSetGrenHyp + tPSetBlueHyp;
tPResusPhyt = tPResusDiat + tPResusGren + tPResusBlue;
wPLossPhytHyp = wPLossDiatHyp + wPLossGrenHyp + wPLossBlueHyp;
wPPrimPhytWHyp = wPPrimDiatWHyp + wPPrimGrenWHyp + wPPrimBlueWHyp;
wNUptPhytHyp = wNUptDiatHyp + wNUptGrenHyp + wNUptBlueHyp;
wNUptNH4PhytHyp = wNUptNH4DiatHyp + wNUptNH4GrenHyp + wNUptNH4BlueHyp;
wNUptNO3PhytHyp = wNUptNO3DiatHyp + wNUptNO3GrenHyp + wNUptNO3BlueHyp;
wNExcrPhytWHyp = wNExcrDiatWHyp + wNExcrGrenWHyp + wNExcrBlueWHyp;
wNMortPhytWHyp = wNMortDiatWHyp + wNMortGrenWHyp + wNMortBlueWHyp;
tNSetPhytHyp = tNSetDiatHyp + tNSetGrenHyp + tNSetBlueHyp;
tNResusPhyt = tNResusDiat + tNResusGren + tNResusBlue;
wNLossPhytHyp = wNLossDiatHyp + wNLossGrenHyp + wNLossBlueHyp;
wNPrimPhytWHyp = wNPrimDiatWHyp + wNPrimGrenWHyp + wNPrimBlueWHyp;
tDRespPhytS = tDRespDiatS + tDRespGrenS + tDRespBlueS;
tDMortPhytS = tDMortDiatS + tDMortGrenS + tDMortBlueS;
tPExcrPhytS = tPExcrDiatS + tPExcrGrenS + tPExcrBlueS;
tPMortPhytS = tPMortDiatS + tPMortGrenS + tPMortBlueS;
tNExcrPhytS = tNExcrDiatS + tNExcrGrenS + tNExcrBlueS;
tNMortPhytS = tNMortDiatS + tNMortGrenS + tNMortBlueS;
wSiUptDiatHyp = cSiDDiat * wDAssDiatHyp;
wSiExcrDiatWHyp = cSiDDiat * wDRespDiatWHyp ;
wSiLossDiatHyp = cSiDDiat * wDLossDiatHyp;
wSiMortDiatWHyp = cSiDDiat * wDMortDiatWHyp;
tSiSetDiatHyp = cSiDDiat * tDSetDiatHyp;
tSiResusDiat = cSiDDiat * tDResusDiat ;
rCyDBlueHyp = cCyDBlueMax -(cCyDBlueMax - cCyDBlueMin) * aLLimBlueHyp;
oCyanHyp = rCyDBlueHyp * oDBlueWHyp * mgPerg;
fDDiatHyp = oDDiatWHyp /(oDDiatWHyp + oDGrenWHyp + oDBlueWHyp + NearZero);
wDPrimDetWHyp = wDMortPhytWHyp + wDLossPhytHyp;
wO2ProdPhytHyp = molO2molC * cCPerDW * wDAssPhytHyp;
wO2RespPhytWHyp = molO2molC * cCPerDW * wDRespPhytWHyp * aCorO2BODHyp;
wO2UptNO3PhytHyp = O2PerNO3 * molO2molN * wNUptNO3PhytHyp;
wO2PrimWHyp = wO2ProdPhytHyp - wO2RespPhytWHyp + wO2UptNO3PhytHyp;
wPMortPhytPO4WHyp = fDissMortPhyt * wPMortPhytWHyp;
wPMortPhytDetWHyp = wPMortPhytWHyp - wPMortPhytPO4WHyp;
wPLossPhytPO4Hyp = fDissLoss * wPLossPhytHyp;
wPLossPhytDetHyp = wPLossPhytHyp - wPLossPhytPO4Hyp;
wPPrimPO4WHyp = - wPUptPhytHyp + wPExcrPhytWHyp + wPLossPhytPO4Hyp + wPMortPhytPO4WHyp;
wPPrimDetWHyp = wPLossPhytDetHyp + wPMortPhytDetWHyp;
tPMortPhytPO4S = fDissMortPhyt * tPMortPhytS;
tPMortPhytDetS = tPMortPhytS - tPMortPhytPO4S;
tPPrimPO4S = tPExcrPhytS + tPMortPhytPO4S;
tPPrimTotT = 0.0;
wNMortPhytNH4WHyp = fDissMortPhyt * wNMortPhytWHyp;
wNMortPhytDetWHyp = wNMortPhytWHyp - wNMortPhytNH4WHyp;
wNLossPhytNH4Hyp = fDissLoss * wNLossPhytHyp;
wNLossPhytDetHyp = wNLossPhytHyp - wNLossPhytNH4Hyp;
wNPrimNH4WHyp = - wNUptNH4PhytHyp + wNExcrPhytWHyp + wNLossPhytNH4Hyp + wNMortPhytNH4WHyp;
wNPrimNO3WHyp = - wNUptNO3PhytHyp;
wNPrimDetWHyp = wNLossPhytDetHyp + wNMortPhytDetWHyp;
tNMortPhytNH4S = fDissMortPhyt * tNMortPhytS;
tNMortPhytDetS = tNMortPhytS - tNMortPhytNH4S;
tNPrimNH4S = tNExcrPhytS + tNMortPhytNH4S;
tNPrimNO3S = 0.0;
tNPrimTotT = 0.0;
tSiExcrDiatS = cSiDDiat * tDRespDiatS ;
tSiMortDiatS = cSiDDiat * tDMortDiatS;
if (aInclStrat == false) 
wSiPrimSiO2WHyp = 0.0 
else
wSiPrimSiO2WHyp = wSiExcrDiatWHyp - wSiUptDiatHyp + tSiExcrDiatS / sDepthWHyp 
end;
wSiPrimDetWHyp = wSiMortDiatWHyp + wSiLossDiatHyp;
tSiPrimTotT = 0.0;
aPACoefEpi = cPACoefMin +(cPACoefMax - cPACoefMin) * hPACoef / (hPACoef + oDOMWEpi);
aPACoefHyp = cPACoefMin +(cPACoefMax - cPACoefMin) * hPACoef / (hPACoef + oDOMWHyp);
bSecchiMaxEpi = sDepthWEpi;
aSecchiEpi = min(bSecchiMaxEpi,aPACoefEpi / aExtCoefOpenEpi);
aTransparencyEpi = aSecchiEpi / sDepthWEpi;
bSecchiMaxHyp = sDepthWHyp + cSecchiPlus;
if ( aInclStrat == true && sDepthWEpi <= aPACoefEpi / aExtCoefOpenEpi ) 
aSecchiHyp = min(bSecchiMaxHyp,aPACoefHyp / aExtCoefOpenHyp - aSecchiEpi) 
elseif ( aInclStrat == true && sDepthWEpi > aPACoefEpi / aExtCoefOpenEpi) 
aSecchiHyp = 0.0 
else
aSecchiHyp = min(bSecchiMaxHyp,aPACoefHyp / aExtCoefOpenHyp) 
end;
if ( aInclStrat == true ) 
aSecchiT = aSecchiEpi +aSecchiHyp 
else
aSecchiT = aSecchiHyp 
end;
aTransparencyHyp = aSecchiHyp / sDepthWHyp;
if ( aInclStrat == true ) 
aTransparencyT = aSecchiT / uDepthW 
else
aTransparencyT = aSecchiT / sDepthWHyp 
end;
aDepthEuphHyp = cEuph * aSecchiHyp;
aRelDepthEuphHyp = aDepthEuphHyp / sDepthWHyp;
aChlaHHyp = oChlaHyp * sDepthWHyp;
aCovPhytWHyp = cCovSpPhyt *(oDPhytWHyp * sDepthWHyp);
rExtChPhytHyp = aExtPhytHyp /(oChlaHyp / mgPerg + NearZero);
uFunTmZooHyp = exp(-0.5/(cSigTmZoo*cSigTmZoo) *((uTmHyp-cTmOptZoo)*(uTmHyp-cTmOptZoo) -(cTmRef-cTmOptZoo)*(cTmRef-cTmOptZoo)));
uFunTmZooEpi = exp(-0.5/(cSigTmZoo*cSigTmZoo) *((uTmEpi-cTmOptZoo)*(uTmEpi-cTmOptZoo) -(cTmRef-cTmOptZoo)*(cTmRef-cTmOptZoo)));
rPDZooHyp = oPZooHyp /(oDZooHyp+NearZero);
rNDZooHyp = oNZooHyp/(oDZooHyp+NearZero);
oDFoodZooHyp = cPrefDiat * oDDiatWHyp + cPrefGren * oDGrenWHyp + cPrefBlue * oDBlueWHyp + cPrefDet * oDDetWHyp;
aFiltHyp = cFiltMax * uFunTmZooHyp * hFilt /(hFilt + oDOMWHyp);
ukDAssTmZooHyp = fDAssZoo * cFiltMax * uFunTmZooHyp * hFilt;
ukDAssTmZooEpi = fDAssZoo * cFiltMax * uFunTmZooEpi * hFilt;
aDSatZooHyp = oDFoodZooHyp /(hFilt + oDOMWHyp);
ukDRespTmZooHyp = kDRespZoo * uFunTmZooHyp;
ukDRespTmZooEpi = kDRespZoo * uFunTmZooEpi;
ukDIncrZooHyp = ukDAssTmZooHyp - ukDRespTmZooHyp - kMortZoo;
ukDIncrZooEpi = ukDAssTmZooEpi - ukDRespTmZooEpi - kMortZoo;
if (aInclStrat == false) 
wDEnvZooHyp = 0.0 
else
wDEnvZooHyp = max(0.0,ukDIncrZooHyp / cDCarrZoo * oDZooHyp*oDZooHyp) 
end;
if (aInclStrat == false) 
wDAssZooHyp = 0.0 
else
wDAssZooHyp = aDSatZooHyp *(ukDAssTmZooHyp * oDZooHyp - wDEnvZooHyp) 
end;
wDConsZooHyp = wDAssZooHyp / fDAssZoo;
wDConsDetZooHyp = cPrefDet*oDDetWHyp / oDFoodZooHyp * wDConsZooHyp;
wDConsDiatZooHyp = cPrefDiat*oDDiatWHyp / oDFoodZooHyp * wDConsZooHyp;
wDConsGrenZooHyp = cPrefGren*oDGrenWHyp / oDFoodZooHyp * wDConsZooHyp;
wDConsBlueZooHyp = cPrefBlue*oDBlueWHyp / oDFoodZooHyp * wDConsZooHyp;
wDConsPhytZooHyp = wDConsDiatZooHyp + wDConsGrenZooHyp + wDConsBlueZooHyp;
wDEgesZooHyp = wDConsZooHyp - wDAssZooHyp;
aCorDRespZooHyp = max(cPDZooRef / rPDZooHyp,cNDZooRef / rNDZooHyp);
if (aInclStrat == false) 
wDRespZooHyp = 0.0 
else
wDRespZooHyp = aCorDRespZooHyp * ukDRespTmZooHyp * oDZooHyp 
end;
if (aInclStrat == false) 
wDMortZooHyp = 0.0 
else
wDMortZooHyp = kMortZoo * oDZooHyp +(1.0 - aDSatZooHyp) * wDEnvZooHyp 
end;
oPFoodZooHyp = cPrefDiat*oPDiatWHyp + cPrefGren*oPGrenWHyp + cPrefBlue*oPBlueWHyp + cPrefDet * oPDetWHyp;
rPDFoodZooHyp = oPFoodZooHyp /(oDFoodZooHyp+NearZero);
wPConsDiatZooHyp = rPDDiatWHyp * wDConsDiatZooHyp;
wPConsGrenZooHyp = rPDGrenWHyp * wDConsGrenZooHyp;
wPConsBlueZooHyp = rPDBlueWHyp * wDConsBlueZooHyp;
wPConsPhytZooHyp = wPConsDiatZooHyp + wPConsGrenZooHyp + wPConsBlueZooHyp;
wPConsDetZooHyp = rPDDetWHyp * wDConsDetZooHyp;
wPConsZooHyp = wPConsPhytZooHyp + wPConsDetZooHyp;
afPAssZooHyp = min(1.0,cPDZooRef / rPDFoodZooHyp * fDAssZoo);
wPAssZooHyp = afPAssZooHyp * wPConsZooHyp;
wPEgesZooHyp = wPConsZooHyp - wPAssZooHyp;
wPEgesZooPO4Hyp = fDissEgesZoo*wPEgesZooHyp;
wPEgesZooDetHyp = wPEgesZooHyp - wPEgesZooPO4Hyp;
akPExcrZooHyp = rPDZooHyp / cPDZooRef * kDRespZoo * uFunTmZooHyp;
if (aInclStrat == false) 
wPExcrZooHyp = 0.0 
else
wPExcrZooHyp = akPExcrZooHyp*oPZooHyp 
end;
wPMortZooHyp = rPDZooHyp * wDMortZooHyp;
wPMortZooPO4Hyp = fDissMortZoo * wPMortZooHyp;
wPMortZooDetHyp = wPMortZooHyp - wPMortZooPO4Hyp;
oNFoodZooHyp = cPrefDiat*oNDiatWHyp + cPrefGren*oNGrenWHyp + cPrefBlue*oNBlueWHyp + cPrefDet*oNDetWHyp;
rNDFoodZooHyp = oNFoodZooHyp /(oDFoodZooHyp+NearZero);
wNConsDiatZooHyp = rNDDiatWHyp*wDConsDiatZooHyp;
wNConsGrenZooHyp = rNDGrenWHyp*wDConsGrenZooHyp;
wNConsBlueZooHyp = rNDBlueWHyp*wDConsBlueZooHyp;
wNConsPhytZooHyp = wNConsDiatZooHyp + wNConsGrenZooHyp + wNConsBlueZooHyp;
wNConsDetZooHyp = rNDDetWHyp*wDConsDetZooHyp;
wNConsZooHyp = wNConsPhytZooHyp + wNConsDetZooHyp;
afNAssZooHyp = min(1.0,cNDZooRef / rNDFoodZooHyp * fDAssZoo);
wNAssZooHyp = afNAssZooHyp*wNConsZooHyp;
wNEgesZooHyp = wNConsZooHyp - wNAssZooHyp;
wNEgesZooNH4Hyp = fDissEgesZoo*wNEgesZooHyp;
wNEgesZooDetHyp = wNEgesZooHyp - wNEgesZooNH4Hyp;
kNExcrZooHyp = rNDZooHyp / cNDZooRef * kDRespZoo * uFunTmZooHyp;
if (aInclStrat == false) 
wNExcrZooHyp = 0.0 
else
wNExcrZooHyp = kNExcrZooHyp*oNZooHyp 
end;
wNMortZooHyp = rNDZooHyp*wDMortZooHyp;
wNMortZooNH4Hyp = fDissMortZoo*wNMortZooHyp;
wNMortZooDetHyp = wNMortZooHyp - wNMortZooNH4Hyp;
wSiConsDiatZooHyp = cSiDDiat * wDConsDiatZooHyp;
uFunTmBent = exp(-0.5/(cSigTmBent*cSigTmBent) *((uTmBot-cTmOptBent)*(uTmBot-cTmOptBent) - (cTmRef-cTmOptBent)*(cTmRef-cTmOptBent)));
aDFoodBent = sDDetS + aDPhytS;
rPDBent = sPBent /(sDBent+NearZero);
rNDBent = sNBent /(sDBent+NearZero);
tDMigrBent = kMigrBent *(cDBentIn - sDBent);
aDSatBent = aDFoodBent /(hDFoodBent + aDFoodBent);
ukDIncrBent = (kDAssBent - kDRespBent) * uFunTmBent - kMortBent;
tDEnvBent = max(0.0,ukDIncrBent / cDCarrBent * sDBent*sDBent);
tDAssBent = aDSatBent *(kDAssBent * uFunTmBent * sDBent - tDEnvBent);
aDAssBentSp = tDAssBent / sDBent;
tDConsBent = tDAssBent / fDAssBent;
tDConsDetBent = sDDetS / aDFoodBent * tDConsBent;
tDConsDiatBent = sDDiatS / aDFoodBent * tDConsBent;
tDConsGrenBent = sDGrenS / aDFoodBent * tDConsBent;
tDConsBlueBent = sDBlueS / aDFoodBent * tDConsBent;
tDConsPhytBent = tDConsDiatBent + tDConsGrenBent + tDConsBlueBent;
tDEgesBent = tDConsBent - tDAssBent;
tDRespBent = (cPDBentRef / rPDBent) * kDRespBent * uFunTmBent * sDBent;
tDMortBent = kMortBent*sDBent +(1.0 - aDSatBent) * tDEnvBent;
aPFoodBent = sPDetS + aPPhytS;
rPDFoodBent = aPFoodBent /(aDFoodBent+NearZero);
tPConsDetBent = rPDDetS * tDConsDetBent;
tPConsDiatBent = rPDDiatS * tDConsDiatBent;
tPConsGrenBent = rPDGrenS * tDConsGrenBent;
tPConsBlueBent = rPDBlueS * tDConsBlueBent;
tPConsPhytBent = tPConsDiatBent + tPConsGrenBent + tPConsBlueBent;
tPConsBent = tPConsDetBent + tPConsPhytBent;
afPAssBent = min(1.0,cPDBentRef / rPDFoodBent * fDAssBent);
tPAssBent = afPAssBent * tPConsBent;
tPEgesBent = tPConsBent - tPAssBent;
tPEgesBentPO4 = fDissEgesBent * tPEgesBent;
tPEgesBentDet = (1.0 - fDissEgesBent) * tPEgesBent;
tPExcrBent = (rPDBent / cPDBentRef) * kDRespBent * uFunTmBent * sPBent;
tPMortBent = rPDBent * tDMortBent;
tPMortBentPO4 = fDissMortBent * tPMortBent;
tPMortBentDet = (1.0-fDissMortBent)*tPMortBent;
tPMigrBent = kMigrBent *(cPDBentRef*cDBentIn - sPBent);
aNFoodBent = sNDetS + aNPhytS;
rNDFoodBent = aNFoodBent /(aDFoodBent+NearZero);
tNMigrBent = kMigrBent *(cNDBentRef*cDBentIn - sNBent);
tNConsDetBent = rNDDetS * tDConsDetBent;
tNConsDiatBent = rNDDiatS * tDConsDiatBent;
tNConsGrenBent = rNDGrenS * tDConsGrenBent;
tNConsBlueBent = rNDBlueS * tDConsBlueBent;
tNConsPhytBent = tNConsDiatBent + tNConsGrenBent + tNConsBlueBent;
tNConsBent = tNConsDetBent + tNConsPhytBent;
afNAssBent = min(1.0,cNDBentRef / rNDFoodBent * fDAssBent);
tNAssBent = afNAssBent * tNConsBent;
tNEgesBent = tNConsBent - tNAssBent;
tNEgesBentNH4 = fDissEgesBent * tNEgesBent;
tNEgesBentDet = (1.0 - fDissEgesBent) * tNEgesBent;
tNExcrBent = (rNDBent / cNDBentRef) * kDRespBent * uFunTmBent * sNBent;
tNMortBent = rNDBent * tDMortBent;
tNMortBentNH4 = fDissMortBent*tNMortBent;
tNMortBentDet = (1.0-fDissMortBent)*tNMortBent;
tSiConsDiatBent = cSiDDiat * tDConsDiatBent;
aFunVegFish = max(0.0,1.0 - cRelVegFish * aCovVeg);
ukDIncrFiJv = (kDAssFiJv - kDRespFiJv) * uFunTmFish - kMortFiJv;
aDSatFiAd = (aFunVegFish * sDBent) *(aFunVegFish * sDBent) /(hDBentFiAd * hDBentFiAd + (aFunVegFish * sDBent) *(aFunVegFish * sDBent));
ukDIncrFiAd = (kDAssFiAd - kDRespFiAd) * uFunTmFish - kMortFiAd;
if (cos(2.0 * Pi * sTime / DaysInYear) > 0.1) 
ukHarvFish = kHarvFishWin 
else
ukHarvFish = kHarvFishSum 
end;
afPAssFiAd = min(1.0,cPDFishRef / rPDBent * fDAssFiAd);
afNAssFiAd = min(1.0,cNDFishRef / rNDBent * fDAssFiAd);
uFunTmPisc = exp(-0.5 /(cSigTmPisc*cSigTmPisc) *((uTmEpi - cTmOptPisc)*(uTmEpi - cTmOptPisc) - (cTmRef - cTmOptPisc)*(cTmRef - cTmOptPisc)));
if (false == InclMarsh || fMarsh <= NearZero) 
aDCarrPisc = max(cDCarrPiscMin,min(cDCarrPiscMax,cDCarrPiscBare)) 
elseif (sDShootPhra < cDPhraMinPisc) 
aDCarrPisc = cDCarrPiscMin 
elseif (aCovVeg < cCovVegMin) 
aDCarrPisc = max(cDCarrPiscMin,min(cDCarrPiscMax,fMarsh *(1.0/PerCent) * cRelPhraPisc)) 
else
aDCarrPisc = max(cDCarrPiscMin,min(cDCarrPiscMax,fMarsh *(1.0/PerCent) *(cRelPhraPisc + cRelVegPisc))) 
end;
aFunVegPisc = aDSubVeg /(hDVegPisc + aDSubVeg + NearZero);
akDIncrPisc = (kDAssPisc * aFunVegPisc - kDRespPisc) * uFunTmPisc - kMortPisc;
if (cos(2.0*Pi * sTime / DaysInYear) > 0.1) 
ukHarvPisc = kHarvPiscWin 
else
ukHarvPisc = kHarvPiscSum 
end;
if (false == InclWeb) 
tDWebDetS = 0.0 
else
tDWebDetS = - tDConsDetBent + tDEgesBent + tDMortBent 
end;
if (false == InclWeb) 
tDWebDiatS = 0.0 
else
tDWebDiatS = - tDConsDiatBent 
end;
if (false == InclWeb) 
tDWebGrenS = 0.0 
else
tDWebGrenS = - tDConsGrenBent 
end;
if (false == InclWeb) 
tDWebBlueS = 0.0 
else
tDWebBlueS = - tDConsBlueBent 
end;
tDWebPhytS = tDWebDiatS + tDWebGrenS + tDWebBlueS;
if (false == InclWeb) 
tPWebPO4S = 0.0 
else
tPWebPO4S = tPExcrBent + tPEgesBentPO4 + tPMortBentPO4 
end;
if (false == InclWeb) 
tPWebDetS = 0.0 
else
tPWebDetS = - tPConsDetBent + tPEgesBentDet + tPMortBentDet 
end;
if (false == InclWeb) 
tPWebDiatS = 0.0 
else
tPWebDiatS = - tPConsDiatBent 
end;
if (false == InclWeb) 
tPWebGrenS = 0.0 
else
tPWebGrenS = - tPConsGrenBent 
end;
if (false == InclWeb) 
tPWebBlueS = 0.0 
else
tPWebBlueS = - tPConsBlueBent 
end;
tPWebPhytS = tPWebDiatS + tPWebGrenS + tPWebBlueS;
if (false == InclWeb) 
tNWebNH4S = 0.0 
else
tNWebNH4S = tNExcrBent + tNEgesBentNH4 + tNMortBentNH4 
end;
if (false == InclWeb) 
tNWebNO3S = 0.0 
else
tNWebNO3S = 0.0 
end;
if (false == InclWeb) 
tNWebDetS = 0.0 
else
tNWebDetS = - tNConsDetBent + tNEgesBentDet + tNMortBentDet 
end;
if (false == InclWeb) 
tNWebDiatS = 0.0 
else
tNWebDiatS = - tNConsDiatBent 
end;
if (false == InclWeb) 
tNWebGrenS = 0.0 
else
tNWebGrenS = - tNConsGrenBent 
end;
if (false == InclWeb) 
tNWebBlueS = 0.0 
else
tNWebBlueS = - tNConsBlueBent 
end;
tNWebPhytS = tNWebDiatS + tNWebGrenS + tNWebBlueS;
wSiWebSiO2W = 0.0;
if (false == InclWeb) 
wSiWebDetWHyp = 0.0 
else
wSiWebDetWHyp = wSiConsDiatZooHyp 
end;
if (false == InclWeb) 
tSiWebDetS = 0.0 
else
tSiWebDetS = tSiConsDiatBent 
end;
if (false == InclWeb) 
tSiWebTotT = 0.0 
else
tSiWebTotT = 0.0 
end;
aPrefAveHyp = (cPrefDiat * oDDiatWHyp + cPrefGren * oDGrenWHyp + cPrefBlue * oDBlueWHyp + cPrefDet * oDDetWHyp) / oDOMWHyp;
if (aInclStrat == false) 
wDConsZoo2Hyp = 0.0 
else
wDConsZoo2Hyp = aFiltHyp * aPrefAveHyp * oDOMWHyp * oDZooHyp 
end;
aDConsZooSpHyp = wDConsZooHyp / oDZooHyp;
aDAssZooSpHyp = wDAssZooHyp / oDZooHyp;
aDGrazSpHyp = wDConsZooHyp / oDOMWHyp;
aPConsZooSpHyp = wPConsZooHyp / oPZooHyp;
aPGrazSpHyp = wPConsZooHyp / oPOMWHyp;
aNConsZooSpHyp = wNConsZooHyp / oNZooHyp;
aNGrazSpHyp = wNConsZooHyp / oNOMWHyp;
if (InclMarsh == true && fMarsh > NearZero) 
afDShootPhra = sDShootPhra /(sDRootPhra + sDShootPhra) 
else
afDShootPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
rDSRPhra = sDShootPhra/sDRootPhra 
else
rDSRPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
rPDShootPhra = sPShootPhra/sDShootPhra 
else
rPDShootPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
rNDShootPhra = sNShootPhra/sDShootPhra 
else
rNDShootPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
rPDRootPhra = sPRootPhra/sDRootPhra 
else
rPDRootPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
rNDRootPhra = sNRootPhra/sDRootPhra 
else
rNDRootPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
aLengShootPhra = sDShootPhra / cDStemPhra / cDensStemPhra 
else
aLengShootPhra = 0.0 
end;
if (Day < 1.0 || sTime < BeginTime + 1.0) 
bDayInitPhra = 367 
elseif (uTmEpi >= cTmInitPhra && bDayInitPhra > 366) 
bDayInitPhra = Day 
else
bDayInitPhra = bDayInitPhra 
end;
if (false == InclMarsh || fMarsh <= NearZero) 
aDAllPhra = 0.0 
elseif (Day < bDayInitPhra) 
aDAllPhra = 0.0 
elseif (Day <= bDayInitPhra + 1.0 / kDAllPhra) 
aDAllPhra = fDAllPhra * sDRootPhra 
else
aDAllPhra = 0.0 
end;
if (false == InclSeason) 
tDAllPhra = 0.0 
elseif (false == InclMarsh || fMarsh <= NearZero) 
tDAllPhra = 0.0 
elseif (Day < bDayInitPhra) 
tDAllPhra = 0.0 
elseif (Day <= bDayInitPhra + 1.0 / kDAllPhra) 
tDAllPhra = kDAllPhra * aDAllPhra 
else
tDAllPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tNTransPhra = rNDRootPhra * tDAllPhra 
else
tNTransPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tPTransPhra = rPDRootPhra * tDAllPhra 
else
tPTransPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
aVNUptPhraMaxCr = max(0.0,cVNUptPhraMax * ((cQ10ProdPhra )^ (0.1 *(uTmEpi - cTmRef))) *(cNDPhraMax - rNDRootPhra) /(cNDPhraMax - cNDPhraMin)) 
else
aVNUptPhraMaxCr = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
ahNUptPhraS = aVNUptPhraMaxCr / cAffNUptPhra 
else
ahNUptPhraS = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
aVNUptPhraS = aVNUptPhraMaxCr * oNDissSM /(ahNUptPhraS + oNDissSM) 
else
aVNUptPhraS = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tNUptPhraS = aVNUptPhraS * sDRootPhra 
else
tNUptPhraS = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tNUptNH4PhraS = sNH4SM / aNDissSM * tNUptPhraS 
else
tNUptNH4PhraS = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tNUptNO3PhraS = tNUptPhraS - tNUptNH4PhraS 
else
tNUptNO3PhraS = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tNUptShootPhra = afDShootPhra * tNUptPhraS 
else
tNUptShootPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tNUptRootPhra = tNUptPhraS - tNUptShootPhra 
else
tNUptRootPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
aVPUptPhraMaxCr = max(0.0,cVPUptPhraMax * ((cQ10ProdPhra )^ (0.1 *(uTmEpi - cTmRef))) *(cPDPhraMax - rPDRootPhra) /(cPDPhraMax - cPDPhraMin)) 
else
aVPUptPhraMaxCr = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
ahPUptPhraS = aVPUptPhraMaxCr / cAffPUptPhra 
else
ahPUptPhraS = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
aVPUptPhraS = aVPUptPhraMaxCr * oPO4SM /(ahPUptPhraS + oPO4SM) 
else
aVPUptPhraS = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tPUptPhraS = aVPUptPhraS * sDRootPhra 
else
tPUptPhraS = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tPUptShootPhra = afDShootPhra * tPUptPhraS 
else
tPUptShootPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tPUptRootPhra = tPUptPhraS - tPUptShootPhra 
else
tPUptRootPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
uFunTmProdPhra = ((cQ10ProdPhra )^ (0.1 *(uTmEpi - cTmRef))) 
else
uFunTmProdPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
ukDRespTmPhra = kDRespPhra * ((cQ10RespPhra )^ (0.1 *(uTmEpi - cTmRef))) 
else
ukDRespTmPhra = 0.0 
end;
if (false == InclMarsh || fMarsh <= NearZero) 
aMuPhotPhra = 0.0 
elseif (aLengShootPhra >= sDepthWM) 
aMuPhotPhra = cMuPhraMax * uFunTmProdPhra * ufDay 
else
aMuPhotPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
aNLimProdPhra = (1.0 - cNDPhraMin / rNDRootPhra) * cNDPhraMax /(cNDPhraMax - cNDPhraMin) 
else
aNLimProdPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
aPLimProdPhra = (1.0 - cPDPhraMin / rPDRootPhra) * cPDPhraMax /(cPDPhraMax - cPDPhraMin) 
else
aPLimProdPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
aNutLimPhra = min(aNLimProdPhra,aPLimProdPhra) 
else
aNutLimPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
aMuPhra = aMuPhotPhra * aNutLimPhra 
else
aMuPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
akDIncrPhra = aMuPhotPhra - ukDRespTmPhra - kDMortShootPhra 
else
akDIncrPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tDDensPhra = max(0.0,akDIncrPhra / cDShootPhraMax * sDShootPhra * sDShootPhra) 
else
tDDensPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tDDensProdPhra = aMuPhra / cMuPhraMax * tDDensPhra 
else
tDDensProdPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tDProdPhra = aMuPhra * sDShootPhra - tDDensProdPhra 
else
tDProdPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tDProdShootPhra = afDShootPhra * tDProdPhra 
else
tDProdShootPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tDProdRootPhra = tDProdPhra - tDProdShootPhra 
else
tDProdRootPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tDRespShootPhra = ukDRespTmPhra * sDShootPhra 
else
tDRespShootPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tDRespRootPhra = ukDRespTmPhra * sDRootPhra 
else
tDRespRootPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tO2RespRootPhra = molO2molC * cCPerDW * tDRespRootPhra * afOxySedM 
else
tO2RespRootPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tO2FlowPhra = tO2RespRootPhra 
else
tO2FlowPhra = 0.0 
end;
if (Day < 180.0) 
bDayRealPhra = 367 
elseif (ufDay <= fDayWin && bDayRealPhra > 366) 
bDayRealPhra = Day 
else
bDayRealPhra = bDayRealPhra 
end;
if (false == InclMarsh || fMarsh <= NearZero) 
aDRealPhra = 0.0 
elseif (Day < bDayRealPhra) 
aDRealPhra = 0.0 
elseif (Day <= bDayRealPhra + 1.0 / kDRealPhra) 
aDRealPhra = fDRealPhra * sDShootPhra 
else
aDRealPhra = 0.0 
end;
if (false == InclSeason) 
tDRealPhra = 0.0 
elseif (false == InclMarsh || fMarsh <= NearZero) 
tDRealPhra = 0.0 
elseif (Day < bDayRealPhra) 
tDRealPhra = 0.0 
elseif (Day <= bDayRealPhra + 1.0 / kDRealPhra) 
tDRealPhra = kDRealPhra * aDRealPhra 
else
tDRealPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tNRetrPhra = rNDShootPhra * tDRealPhra 
else
tNRetrPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tPRetrPhra = rPDShootPhra * tDRealPhra 
else
tPRetrPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tDMortShootPhra = kDMortShootPhra * sDShootPhra 
else
tDMortShootPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tNMortShootPhra = rNDShootPhra * tDMortShootPhra 
else
tNMortShootPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tPMortShootPhra = rPDShootPhra * tDMortShootPhra 
else
tPMortShootPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tDMortRootPhra = kDMortRootPhra * sDRootPhra 
else
tDMortRootPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tNMortRootPhra = rNDRootPhra * tDMortRootPhra 
else
tNMortRootPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tPMortRootPhra = rPDRootPhra * tDMortRootPhra 
else
tPMortRootPhra = 0.0 
end;
if (false == InclMarsh || fMarsh > NearZero) 
tDManShootPhra = 0.0 
elseif ((Day >= cDayManPhra) && (Day < cDayManPhra + 1.0)) 
tDManShootPhra = fManPhra * sDShootPhra 
else
tDManShootPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tNManShootPhra = tDManShootPhra * rNDShootPhra 
else
tNManShootPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tPManShootPhra = tDManShootPhra * rPDShootPhra 
else
tPManShootPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tDIMSM = tDSetIMM 
else
tDIMSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tDHumSM = fRefrDetS * tDMinDetSM - tDMinHumSM 
else
tDHumSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tDDetSM = tDSetDetM - tDMinDetSM + tDSetPhytM + tDMortRootPhra 
else
tDDetSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
vDeltaSM = (tDIMSM / cRhoIM +(tDHumSM + tDDetSM) / cRhoOM)/(1.0 - bPorS) 
else
vDeltaSM = 0.0 
end;
if (false == InclMarsh || fMarsh <= NearZero) 
tDBurIMM = 0.0 
elseif (vDeltaSM >= 0.0) 
tDBurIMM = ((tDHumSM + tDDetSM) +(cRhoOM / cRhoIM) * tDIMSM) / ((sDHumSM + sDDetSM) / sDIMSM + cRhoOM / cRhoIM) 
else
tDBurIMM = ((tDHumSM + tDDetSM) +(cRhoOM / cRhoIM) * tDIMSM) / (fDOrgSoil /(1.0 - fDOrgSoil) + cRhoOM / cRhoIM) 
end;
if (false == InclMarsh || fMarsh <= NearZero) 
tDBurOMM = 0.0 
elseif (vDeltaSM >= 0.0) 
tDBurOMM = (sDHumSM + sDDetSM) / sDIMSM * tDBurIMM 
else
tDBurOMM = fDOrgSoil /(1.0 - fDOrgSoil) * tDBurIMM 
end;
if (false == InclMarsh || fMarsh <= NearZero) 
tDBurDetM = 0.0 
elseif (vDeltaSM >= 0.0) 
tDBurDetM = sDDetSM /(sDHumSM + sDDetSM) * tDBurOMM 
else
tDBurDetM = 0.0 
end;
if (false == InclMarsh || fMarsh <= NearZero) 
tDBurHumM = 0.0 
elseif (vDeltaSM >= 0.0) 
tDBurHumM = tDBurOMM - tDBurDetM 
else
tDBurHumM = tDBurOMM 
end;
if (false == InclMarsh || fMarsh <= NearZero) 
tDBurTotM = 0.0 
elseif (vDeltaSM >= 0.0) 
tDBurTotM = tDBurIMM + tDBurOMM 
else
tDBurTotM = tDBurIMM + tDBurOMM 
end;
if (false == InclMarsh || fMarsh <= NearZero) 
tPBurHumM = 0.0 
elseif (vDeltaSM >= 0.0) 
tPBurHumM = rPDHumSM * tDBurHumM 
else
tPBurHumM = cPDSoilOM * tDBurHumM 
end;
if (false == InclMarsh || fMarsh <= NearZero) 
tPBurDetM = 0.0 
elseif (vDeltaSM >= 0.0) 
tPBurDetM = rPDDetSM * tDBurDetM 
else
tPBurDetM = 0.0 
end;
if (false == InclMarsh || fMarsh <= NearZero) 
tPBurAIMM = 0.0 
elseif (vDeltaSM >= 0.0) 
tPBurAIMM = sPAIMSM / sDIMSM * tDBurIMM 
else
tPBurAIMM = 0.0 
end;
if (false == InclMarsh || fMarsh <= NearZero) 
tPBurPO4M = 0.0 
elseif (vDeltaSM >= 0.0) 
tPBurPO4M = sPO4SM *(vDeltaSM / cDepthSM) 
else
tPBurPO4M = cPO4Ground *(bPorSM * vDeltaSM) 
end;
if (false == InclMarsh || fMarsh <= NearZero) 
tPBurTotM = 0.0 
elseif (vDeltaSM >= 0.0) 
tPBurTotM = tPBurDetM + tPBurHumM + tPBurAIMM + tPBurPO4M 
else
tPBurTotM = tPBurHumM + tPBurAIMM + tPBurPO4M 
end;
if (false == InclMarsh || fMarsh <= NearZero) 
tNBurHumM = 0.0 
elseif (vDeltaSM >= 0.0) 
tNBurHumM = rNDHumSM * tDBurHumM 
else
tNBurHumM = cNDSoilOM * tDBurHumM 
end;
if (false == InclMarsh || fMarsh <= NearZero) 
tNBurDetM = 0.0 
elseif (vDeltaSM >= 0.0) 
tNBurDetM = rNDDetSM * tDBurDetM 
else
tNBurDetM = 0.0 
end;
if (false == InclMarsh || fMarsh <= NearZero) 
tNBurNH4M = 0.0 
elseif (vDeltaSM >= 0.0) 
tNBurNH4M = sNH4SM *(vDeltaSM / cDepthSM) 
else
tNBurNH4M = cNH4Ground *(bPorSM * vDeltaSM) 
end;
if (false == InclMarsh || fMarsh <= NearZero) 
tNBurNO3M = 0.0 
elseif (vDeltaSM >= 0.0) 
tNBurNO3M = sNO3SM *(vDeltaSM / cDepthSM) 
else
tNBurNO3M = cNO3Ground *(bPorSM * vDeltaSM) 
end;
if (false == InclMarsh || fMarsh <= NearZero) 
tNBurTotM = 0.0 
elseif (vDeltaSM >= 0.0) 
tNBurTotM = tNBurDetM + tNBurHumM + tNBurNH4M + tNBurNO3M 
else
tNBurTotM = tNBurHumM + tNBurNH4M + tNBurNO3M 
end;
if (false == InclMarsh || fMarsh <= NearZero) 
tSiBurDetM = 0.0 
elseif (vDeltaSM >= 0.0) 
tSiBurDetM = rSiDDetSM * tDBurDetM 
else
tSiBurDetM = 0.0 
end;
if (false == InclMarsh || fMarsh <= NearZero) 
tSiBurTotM = 0.0 
elseif (vDeltaSM >= 0.0) 
tSiBurTotM = tSiBurDetM 
else
tSiBurTotM = 0.0 
end;
if (false == InclMarsh || fMarsh <= NearZero) 
vDeltaWM = 0.0 
elseif (ConstDepth == true) 
vDeltaWM = 0.0 
else
vDeltaWM = - vDeltaSM 
end;
if (InclMarsh == true && fMarsh > NearZero) 
aRelDeltaWM = vDeltaWM / sDepthWM 
else
aRelDeltaWM = 0.0 
end;
tDSetTotHyp = tDSetIMHyp + tDSetDetHyp + tDSetPhytHyp;
tPSetTotHyp = tPSetAIMHyp + tPSetDetHyp + tPSetPhytHyp;
tNSetTotHyp = tNSetDetHyp + tNSetPhytHyp;
if (sTime >= cDredStart * DaysPerYear) 
bTimeDred = (floor(TimeYears/cDredInterval) * cDredInterval) * DaysPerYear 
else
bTimeDred = -9999.999 
end;
bRhoSolidSoil = fDOrgSoil * cRhoOM +(1.0 - fDOrgSoil) * cRhoIM;
if (InclMarsh == true && fMarsh > NearZero) 
tDMarsTotT = (- tDBurTotM - wDMinDetWM * sDepthWM -(1.0 - fRefrDetS) * tDMinDetSM - tDMinHumSM + tDProdPhra - tDRespShootPhra - tDRespRootPhra - tDManShootPhra) * fMarsh 
else
tDMarsTotT = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tPMarsTotT = (- tPInfPO4SM - tPDifGroundPO4M - tPBurTotM - tPChemPO4M - tPManShootPhra) * fMarsh 
else
tPMarsTotT = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tNMarsTotT = (- tNInfNH4SM - tNInfNO3SM - tNDifGroundNO3M - tNDifGroundNH4M - tNBurTotM - wNDenitWM * sDepthWM - tNDenitSM - tNManShootPhra) * fMarsh 
else
tNMarsTotT = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
tSiMarsTotT = - tSiBurDetM * fMarsh 
else
tSiMarsTotT = 0.0 
end;
uTauSubstEpi = 1.0 / (ukDilEpi+NearZero);
if (InclMarsh == true && fMarsh > NearZero) 
akExchMEpi = kExchMaxM * hfMarsh /(hfMarsh + fMarsh) + vTranDepthW / sDepthWM 
else
akExchMEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
afVolMarshEpi = fMarsh * sDepthWM / sDepthWEpi 
else
afVolMarshEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
akExchLEpi = akExchMEpi * afVolMarshEpi 
else
akExchLEpi = 0.0 
end;
oPPhytWEpi = oPDiatWEpi + oPGrenWEpi + oPBlueWEpi;
oNPhytWEpi = oNDiatWEpi + oNGrenWEpi + oNBlueWEpi;
oDSestWEpi = oDOMWEpi + oDIMWEpi;
oPOMWEpi = oPPhytWEpi + oPDetWEpi;
oPSestWEpi = oPPhytWEpi + oPDetWEpi + oPAIMWEpi;
oPInorgWEpi = oPO4WEpi + oPAIMWEpi;
oPTotWEpi = oPSestWEpi + oPO4WEpi;
oNOMWEpi = oNPhytWEpi + oNDetWEpi;
oNSestWEpi = oNOMWEpi;
oNkjWEpi = oNSestWEpi + oNH4WEpi;
oNTotWEpi = oNkjWEpi + oNO3WEpi;
rPDIMWEpi = oPAIMWEpi / oDIMWEpi;
rPDDetWEpi = oPDetWEpi / (oDDetWEpi+NearZero);
rNDDetWEpi = oNDetWEpi / (oDDetWEpi+NearZero);
rSiDDetWEpi = oSiDetWEpi / (oDDetWEpi+NearZero);
wDDilIMEpi = ukDilEpi * oDIMWEpi;
wDDilDetEpi = ukDilEpi * oDDetWEpi;
wDDilDiatEpi = ukDilEpi * oDDiatWEpi;
wDDilGrenEpi = ukDilEpi * oDGrenWEpi;
wDDilBlueEpi = ukDilEpi * oDBlueWEpi;
wDDilPhytEpi = wDDilDiatEpi + wDDilGrenEpi + wDDilBlueEpi;
wDDilZooEpi = ukDilEpi * oDZooEpi;
wPDilZooEpi = ukDilEpi * oPZooEpi;
wNDilZooEpi = ukDilEpi * oNZooEpi;
wPDilPO4Epi = ukDilEpi * oPO4WEpi;
wPDilDetEpi = ukDilEpi*oPDetWEpi;
wPDilAIMEpi = ukDilEpi * oPAIMWEpi;
wNDilNH4Epi = ukDilEpi * oNH4WEpi;
wNDilNO3Epi = ukDilEpi * oNO3WEpi;
wNDilDetEpi = ukDilEpi * oNDetWEpi;
wO2InflowEpi = ukDilWatEpi * cO2In;
wO2OutflEpi = ukDilEpi * oO2WEpi;
wPDilDiatEpi = ukDilEpi * oPDiatWEpi;
wNDilDiatEpi = ukDilEpi * oNDiatWEpi;
wPDilGrenEpi = ukDilEpi * oPGrenWEpi;
wNDilGrenEpi = ukDilEpi * oNGrenWEpi;
wPDilBlueEpi = ukDilEpi * oPBlueWEpi;
wNDilBlueEpi = ukDilEpi * oNBlueWEpi;
wPDilPhytEpi = wPDilDiatEpi + wPDilGrenEpi + wPDilBlueEpi;
wNDilPhytEpi = wNDilDiatEpi + wNDilGrenEpi + wNDilBlueEpi;
wDOutflTotEpi = ukOutEpi * oDSestWEpi;
wPOutflTotEpi = ukOutEpi * oPTotWEpi;
wNOutflTotEpi = ukOutEpi * oNTotWEpi;
if (false == InclTran) 
wDTranDiatEpi = 0.0 
else
wDTranDiatEpi = uDLoadDiat / sDepthWEpi - wDDilDiatEpi 
end;
if (false == InclTran) 
wPTranDiatEpi = 0.0 
else
wPTranDiatEpi = uPLoadDiat / sDepthWEpi - wPDilDiatEpi 
end;
if (false == InclTran) 
wNTranDiatEpi = 0.0 
else
wNTranDiatEpi = uNLoadDiat / sDepthWEpi - wNDilDiatEpi 
end;
if (false == InclTran) 
wDTranGrenEpi = 0.0 
else
wDTranGrenEpi = uDLoadGren / sDepthWEpi - wDDilGrenEpi 
end;
if (false == InclTran) 
wPTranGrenEpi = 0.0 
else
wPTranGrenEpi = uPLoadGren / sDepthWEpi - wPDilGrenEpi 
end;
if (false == InclTran) 
wNTranGrenEpi = 0.0 
else
wNTranGrenEpi = uNLoadGren / sDepthWEpi - wNDilGrenEpi 
end;
if (false == InclTran) 
wDTranBlueEpi = 0.0 
else
wDTranBlueEpi = uDLoadBlue / sDepthWEpi - wDDilBlueEpi 
end;
if (false == InclTran) 
wPTranBlueEpi = 0.0 
else
wPTranBlueEpi = uPLoadBlue / sDepthWEpi - wPDilBlueEpi 
end;
if (false == InclTran) 
wNTranBlueEpi = 0.0 
else
wNTranBlueEpi = uNLoadBlue / sDepthWEpi - wNDilBlueEpi 
end;
if (false == InclTran) 
wDTranPhytEpi = 0.0 
else
wDTranPhytEpi = wDTranDiatEpi + wDTranGrenEpi + wDTranBlueEpi 
end;
if (false == InclTran) 
wPTranPhytEpi = 0.0 
else
wPTranPhytEpi = wPTranDiatEpi + wPTranGrenEpi + wPTranBlueEpi 
end;
if (false == InclTran) 
wNTranPhytEpi = 0.0 
else
wNTranPhytEpi = wNTranDiatEpi + wNTranGrenEpi + wNTranBlueEpi 
end;
wSiDilSiO2Epi = ukDilEpi * oSiO2WEpi;
wSiDilDetEpi = ukDilEpi * oSiDetWEpi;
wSiDilDiatEpi = cSiDDiat * wDDilDiatEpi;
wSiOutflTotEpi = ukOutEpi * (oSiO2WEpi + oSiDetWEpi + cSiDDiat * oDDiatWEpi);
if (false == InclTran) 
wSiTranSiO2Epi = 0.0 
else
wSiTranSiO2Epi = uSiLoadSiO2 / sDepthWEpi - wSiDilSiO2Epi 
end;
if (false == InclTran) 
wSiTranDetWEpi = 0.0 
else
wSiTranDetWEpi = uSiLoadDet / sDepthWEpi - wSiDilDetEpi 
end;
if (false == InclTran) 
tSiTranTotTEpi = 0.0 
else
tSiTranTotTEpi = uSiLoadSiO2 + uSiLoadDet + uSiLoadDiat - (wSiDilDetEpi + wSiDilSiO2Epi + wSiDilDiatEpi) * sDepthWEpi 
end;
if (false == InclTran) 
wDTranZooEpi = 0.0 
else
wDTranZooEpi =( ukDilWatEpi * cDZooIn - wDDilZooEpi) 
end;
if (false == InclTran) 
wPTranZooEpi = 0.0 
else
wPTranZooEpi =(ukDilWatEpi * cPDZooRef*cDZooIn - wPDilZooEpi) 
end;
if (false == InclTran) 
wNTranZooEpi = 0.0 
else
wNTranZooEpi =(ukDilWatEpi * cNDZooRef*cDZooIn - wNDilZooEpi) 
end;
if (false == InclTran) 
wDTranIMWEpi = 0.0 
else
wDTranIMWEpi = uDLoadIM / sDepthWEpi - wDDilIMEpi 
end;
if (false == InclTran) 
wDTranDetWEpi = 0.0 
else
wDTranDetWEpi = uDLoadDet / sDepthWEpi - wDDilDetEpi 
end;
if (false == InclTran) 
wO2TranWEpi = 0.0 
else
wO2TranWEpi = wO2InflowEpi - wO2OutflEpi 
end;
if (false == InclTran) 
wPTranPO4WEpi = 0.0 
else
wPTranPO4WEpi = uPLoadPO4 / sDepthWEpi - wPDilPO4Epi 
end;
if (false == InclTran) 
wPTranAIMWEpi = 0.0 
else
wPTranAIMWEpi = uPLoadAIM / sDepthWEpi - wPDilAIMEpi 
end;
if (false == InclTran) 
wPTranDetWEpi = 0.0 
else
wPTranDetWEpi = uPLoadDet / sDepthWEpi - wPDilDetEpi 
end;
if (false == InclTran) 
wNTranNH4WEpi = 0.0 
else
wNTranNH4WEpi = uNLoadNH4 / sDepthWEpi - wNDilNH4Epi 
end;
if (false == InclTran) 
wNTranNO3WEpi = 0.0 
else
wNTranNO3WEpi = uNLoadNO3 / sDepthWEpi - wNDilNO3Epi 
end;
if (false == InclTran) 
wNTranDetWEpi = 0.0 
else
wNTranDetWEpi = uNLoadDet / sDepthWEpi - wNDilDetEpi 
end;
wDDilTotEpi = wDDilIMEpi + wDDilDetEpi + wDDilPhytEpi;
wPDilTotEpi = wPDilDetEpi + wPDilPO4Epi + wPDilAIMEpi + wPDilPhytEpi;
wNDilTotEpi = wNDilDetEpi + wNDilNO3Epi + wNDilNH4Epi + wNDilPhytEpi;
wSiDilTotEpi = wSiDilDetEpi + wSiDilSiO2Epi + wSiDilDiatEpi;
if (false == InclTran) 
tDTranTotTEpi = 0.0 
else
tDTranTotTEpi = uDLoad - wDDilTotEpi * sDepthWEpi 
end;
if (false == InclTran) 
tPTranTotTEpi = 0.0 
else
tPTranTotTEpi = uPLoad - wPDilTotEpi * sDepthWEpi 
end;
if (false == InclTran) 
tNTranTotTEpi = 0.0 
else
tNTranTotTEpi = uNLoad - wNDilTotEpi * sDepthWEpi 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wDExchIMMEpi = akExchMEpi *(oDIMWEpi - oDIMWM) 
else
wDExchIMMEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wPExchPO4MEpi = akExchMEpi *(oPO4WEpi - oPO4WM) 
else
wPExchPO4MEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wPExchAIMMEpi = akExchMEpi *(oPAIMWEpi - oPAIMWM) 
else
wPExchAIMMEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wNExchNH4MEpi = akExchMEpi *(oNH4WEpi - oNH4WM) 
else
wNExchNH4MEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wNExchNO3MEpi = akExchMEpi *(oNO3WEpi - oNO3WM) 
else
wNExchNO3MEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wSiExchSiO2MEpi = akExchMEpi *(oSiO2WEpi - oSiO2WM) 
else
wSiExchSiO2MEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wO2ExchMEpi = akExchMEpi *(oO2WEpi - oO2WM) 
else
wO2ExchMEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wDExchDetMEpi = akExchMEpi *(oDDetWEpi - oDDetWM) 
else
wDExchDetMEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wPExchDetMEpi = akExchMEpi *(oPDetWEpi - oPDetWM) 
else
wPExchDetMEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wNExchDetMEpi = akExchMEpi *(oNDetWEpi - oNDetWM) 
else
wNExchDetMEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wSiExchDetMEpi = akExchMEpi *(oSiDetWEpi - oSiDetWM) 
else
wSiExchDetMEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wDExchDiatMEpi = akExchMEpi *(oDDiatWEpi - oDDiatWM) 
else
wDExchDiatMEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wPExchDiatMEpi = akExchMEpi *(oPDiatWEpi - oPDiatWM) 
else
wPExchDiatMEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wNExchDiatMEpi = akExchMEpi *(oNDiatWEpi - oNDiatWM) 
else
wNExchDiatMEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wSiExchDiatMEpi = cSiDDiat * wDExchDiatMEpi 
else
wSiExchDiatMEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wDExchGrenMEpi = akExchMEpi *(oDGrenWEpi - oDGrenWM) 
else
wDExchGrenMEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wPExchGrenMEpi = akExchMEpi *(oPGrenWEpi - oPGrenWM) 
else
wPExchGrenMEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wNExchGrenMEpi = akExchMEpi *(oNGrenWEpi - oNGrenWM) 
else
wNExchGrenMEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wDExchBlueMEpi = akExchMEpi *(oDBlueWEpi - oDBlueWM) 
else
wDExchBlueMEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wPExchBlueMEpi = akExchMEpi *(oPBlueWEpi - oPBlueWM) 
else
wPExchBlueMEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wNExchBlueMEpi = akExchMEpi *(oNBlueWEpi - oNBlueWM) 
else
wNExchBlueMEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wDExchZooMEpi = akExchMEpi *(oDZooEpi - oDZooM) 
else
wDExchZooMEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wPExchZooMEpi = akExchMEpi *(oPZooEpi - oPZooM) 
else
wPExchZooMEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wNExchZooMEpi = akExchMEpi *(oNZooEpi - oNZooM) 
else
wNExchZooMEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wDExchIMEpi = akExchLEpi *(oDIMWEpi - oDIMWM) 
else
wDExchIMEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wPExchPO4Epi = akExchLEpi *(oPO4WEpi - oPO4WM) 
else
wPExchPO4Epi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wPExchAIMEpi = akExchLEpi *(oPAIMWEpi - oPAIMWM) 
else
wPExchAIMEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wNExchNH4Epi = akExchLEpi *(oNH4WEpi - oNH4WM) 
else
wNExchNH4Epi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wNExchNO3Epi = akExchLEpi *(oNO3WEpi - oNO3WM) 
else
wNExchNO3Epi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wSiExchSiO2Epi = akExchLEpi *(oSiO2WEpi - oSiO2WM) 
else
wSiExchSiO2Epi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wO2ExchEpi = akExchLEpi *(oO2WEpi - oO2WM) 
else
wO2ExchEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wDExchDetEpi = akExchLEpi *(oDDetWEpi - oDDetWM) 
else
wDExchDetEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wPExchDetEpi = akExchLEpi *(oPDetWEpi - oPDetWM) 
else
wPExchDetEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wNExchDetEpi = akExchLEpi *(oNDetWEpi - oNDetWM) 
else
wNExchDetEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wSiExchDetEpi = akExchLEpi *(oSiDetWEpi - oSiDetWM) 
else
wSiExchDetEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wDExchDiatEpi = akExchLEpi *(oDDiatWEpi - oDDiatWM) 
else
wDExchDiatEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wPExchDiatEpi = akExchLEpi *(oPDiatWEpi - oPDiatWM) 
else
wPExchDiatEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wNExchDiatEpi = akExchLEpi *(oNDiatWEpi - oNDiatWM) 
else
wNExchDiatEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wSiExchDiatEpi = cSiDDiat * wDExchDiatEpi 
else
wSiExchDiatEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wDExchGrenEpi = akExchLEpi *(oDGrenWEpi - oDGrenWM) 
else
wDExchGrenEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wPExchGrenEpi = akExchLEpi *(oPGrenWEpi - oPGrenWM) 
else
wPExchGrenEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wNExchGrenEpi = akExchLEpi *(oNGrenWEpi - oNGrenWM) 
else
wNExchGrenEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wDExchBlueEpi = akExchLEpi *(oDBlueWEpi - oDBlueWM) 
else
wDExchBlueEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wPExchBlueEpi = akExchLEpi *(oPBlueWEpi - oPBlueWM) 
else
wPExchBlueEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wNExchBlueEpi = akExchLEpi *(oNBlueWEpi - oNBlueWM) 
else
wNExchBlueEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wDExchZooEpi = akExchLEpi *(oDZooEpi - oDZooM) 
else
wDExchZooEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wPExchZooEpi = akExchLEpi *(oPZooEpi - oPZooM) 
else
wPExchZooEpi = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
wNExchZooEpi = akExchLEpi *(oNZooEpi - oNZooM) 
else
wNExchZooEpi = 0.0 
end;
if (aInclStrat == true ) 
tPInfPO4WEpi = 0.0 
elseif (cQInf >= 0.0) 
tPInfPO4WEpi = cQInf / mmPerm * oPO4WEpi 
else
tPInfPO4WEpi = cQInf / mmPerm * oPO4S 
end;
if (aInclStrat == true ) 
tNInfNH4WEpi = 0.0 
elseif (cQInf >= 0.0) 
tNInfNH4WEpi = cQInf / mmPerm * oNH4WEpi 
else
tNInfNH4WEpi = cQInf / mmPerm * oNH4S 
end;
if (aInclStrat == true ) 
tNInfNO3WEpi = 0.0 
elseif (cQInf >= 0.0) 
tNInfNO3WEpi = cQInf / mmPerm * oNO3WEpi 
else
tNInfNO3WEpi = cQInf / mmPerm * oNO3S 
end;
tO2AerEpi = kAer * uFunTmAerEpi * (uO2SatEpi - oO2WEpi) * aFunLemnAer;
tDTurbFishIM = fLutum * sDIMS / (fLutum * sDIMS + sDDetS) * tDTurbFish;
uCorVSetIMEpi = aFunTauSetIMEpi * (((fLutumRef/fLutum) )^ (0.5)) * uFunTmSetEpi * cVSetIM;
tDSetIMEpi = uCorVSetIMEpi * oDIMWEpi;
tPSetAIMEpi = oPAIMWEpi / oDIMWEpi * tDSetIMEpi;
uCorVSetDetEpi = cVSetDet * aFunTauSetOMEpi * uFunTmSetEpi;
tDSetDetEpi = uCorVSetDetEpi * oDDetWEpi;
tPSetDetEpi = uCorVSetDetEpi * oPDetWEpi;
tNSetDetEpi = uCorVSetDetEpi * oNDetWEpi;
tSiSetDetEpi = uCorVSetDetEpi * oSiDetWEpi;
wDMinDetWEpi = kDMinDetW * uFunTmMinWEpi * oDDetWEpi;
wPMinDetWEpi = kPMinDetW * uFunTmMinWEpi * oPDetWEpi;
wNMinDetWEpi = kNMinDetW * uFunTmMinWEpi * oNDetWEpi;
wSiMinDetWEpi = kSiMinDetW * uFunTmMinWEpi * oSiDetWEpi;
aCorO2BODEpi = oO2WEpi / (hO2BOD + oO2WEpi);
wO2MinDetWEpi = molO2molC * cCPerDW * aCorO2BODEpi * wDMinDetWEpi;
wDDenitWEpi = oNO3WEpi*oNO3WEpi / (hNO3Denit*hNO3Denit + oNO3WEpi*oNO3WEpi) * (1.0 - aCorO2BODEpi) * wDMinDetWEpi;
wNDenitWEpi = NO3PerC * molNmolC * cCPerDW * wDDenitWEpi;
aCorO2NitrWEpi = oO2WEpi*oO2WEpi / (hO2Nitr*hO2Nitr + oO2WEpi*oO2WEpi);
wNNitrWEpi = kNitrW * uFunTmNitrEpi * aCorO2NitrWEpi * oNH4WEpi;
wO2NitrWEpi = O2PerNH4 * molO2molN * wNNitrWEpi;
tDMinOxyDetS = afOxySed * (1.0 - fRefrDetS) * tDMinDetS;
tO2MinDetS = molO2molC * cCPerDW * tDMinOxyDetS;
tDDenitS = oNO3S*oNO3S / (hNO3Denit*hNO3Denit + oNO3S*oNO3S) * (1.0 - afOxySed) * (1.0 - fRefrDetS) * tDMinDetS;
tNDenitS = NO3PerC * molNmolC * cCPerDW * tDDenitS;
tNNitrS = afOxySed * kNitrS * uFunTmNitrS * sNH4S;
tO2NitrS = O2PerNH4 * molO2molN * tNNitrS;
tDMinHumS = kDMinHum * uFunTmMinS * afOxySed * sDHumS;
tPMinHumS = kDMinHum * uFunTmMinS * afOxySed * sPHumS;
tNMinHumS = kDMinHum * uFunTmMinS * afOxySed * sNHumS;
if ( aInclStrat == true ) 
tPDifPO4Epi = 0.0 
else
tPDifPO4Epi = kPDifPO4 * uFunTmDif * cTurbDifNut * bPorCorS * (oPO4S - oPO4WEpi ) / aDepthDif 
end;
if ( aInclStrat == true ) 
tNDifNO3Epi = 0.0 
else
tNDifNO3Epi = kNDifNO3 * uFunTmDif * cTurbDifNut * bPorCorS * (oNO3S - oNO3WEpi ) / aDepthDif 
end;
if ( aInclStrat == true ) 
tNDifNH4Epi = 0.0 
else
tNDifNH4Epi = kNDifNH4 * uFunTmDif * cTurbDifNut * bPorCorS * (oNH4S - oNH4WEpi ) / aDepthDif 
end;
if ( aInclStrat == true ) 
tO2DifEpi = 0.0 
else
tO2DifEpi = kO2Dif / aDepthDif * uFunTmDif * cTurbDifO2 * bPorCorS * oO2WEpi 
end;
aPAdsMaxWEpi = cRelPAdsD + aCorO2BODEpi * cRelPAdsFe * fFeDIM + cRelPAdsAl * fAlDIM;
aKPAdsWEpi = (1.0 - fRedMax * (1.0-aCorO2BODEpi)) * cKPAdsOx;
aPIsoAdsWEpi = aPAdsMaxWEpi * aKPAdsWEpi * oPO4WEpi / (1.0 + aKPAdsWEpi * oPO4WEpi);
aPEqIMWEpi = aPIsoAdsWEpi * oDIMWEpi;
wPSorpIMWEpi = kPSorp * (aPEqIMWEpi - oPAIMWEpi);
aPAdsMaxS = cRelPAdsD + afOxySed * cRelPAdsFe * fFeDIM + cRelPAdsAl * fAlDIM;
aKPAdsS = (1.0 - fRedMax * (1.0-afOxySed)) * cKPAdsOx;
aPIsoAdsS = aPAdsMaxS * aKPAdsS * oPO4S / (1.0 + aKPAdsS * oPO4S);
aPEqIMS = aPIsoAdsS * sDIMS;
tPSorpIMS = kPSorp * (aPEqIMS - sPAIMS);
if (aInclStrat == false) 
wO2AbioWHyp = 0.0 
else
wO2AbioWHyp = tO2BubHyp / sDepthWHyp - wO2MinDetWHyp - wO2NitrWHyp - (tO2MinDetS + tO2NitrS) / sDepthWHyp 
end;
if (aInclStrat == false) 
wPAbioDetWHyp = 0.0 
else
wPAbioDetWHyp = - wPMinDetWHyp - (tPSetDetHyp - tPSetDetEpi - tPResusDet) / sDepthWHyp 
end;
if (aInclStrat == false) 
wPAbioPO4WHyp = 0.0 
else
wPAbioPO4WHyp = wPMinDetWHyp - wPSorpIMWHyp - tPInfPO4WHyp / sDepthWHyp + tPDifPO4Hyp / sDepthWHyp + tPResusPO4 / sDepthWHyp 
end;
if (aInclStrat == false) 
wPAbioAIMWHyp = 0.0 
else
wPAbioAIMWHyp = (- tPSetAIMHyp +tPSetAIMEpi + tPResusAIM) / sDepthWHyp + wPSorpIMWHyp 
end;
tPAbioTotT = uPErosOM - tPChemPO4 - tPInfPO4S - tPDifGroundPO4;
if (aInclStrat == false) 
wNAbioNH4WHyp = 0.0 
else
wNAbioNH4WHyp = wNMinDetWHyp - wNNitrWHyp - tNInfNH4WHyp / sDepthWHyp + (tNDifNH4Hyp + tNResusNH4) / sDepthWHyp 
end;
if (aInclStrat == false) 
wNAbioNO3WHyp = 0.0 
else
wNAbioNO3WHyp = wNNitrWHyp - wNDenitWHyp + (tNDifNO3Hyp + tNResusNO3 - tNInfNO3WHyp) / sDepthWHyp 
end;
if (aInclStrat == false) 
wNAbioDetWHyp = 0.0 
else
wNAbioDetWHyp = - wNMinDetWHyp - (tNSetDetHyp -tNSetDetEpi - tNResusDet ) / sDepthWHyp 
end;
if (aInclStrat == false) 
wSiAbioSiO2WHyp = 0.0 
else
wSiAbioSiO2WHyp = wSiMinDetWHyp + (1.0 - fRefrDetS) * tSiMinDetS / sDepthWHyp 
end;
if (aInclStrat == false) 
wSiAbioDetWHyp = 0.0 
else
wSiAbioDetWHyp = - wSiMinDetWHyp - (tSiSetDetHyp -tSiSetDetEpi - tSiResusDet) / sDepthWHyp 
end;
if (aInclStrat == false) 
wDAbioDetWHyp = 0.0 
else
wDAbioDetWHyp = (- tDSetDetHyp + tDSetDetEpi + tDResusDet ) / sDepthWHyp - wDMinDetWHyp 
end;
if (aInclStrat == false) 
wDAbioIMWHyp = 0.0 
else
wDAbioIMWHyp = (uDErosIMW * fHypErosIM - tDSetIMHyp+ tDSetIMEpi + tDResusIM) / sDepthWHyp 
end;
if ( aInclStrat == true ) 
wDAbioIMWEpi = (uDErosIMW * (1- fHypErosIM) - tDSetIMEpi ) / sDepthWEpi 
else
wDAbioIMWEpi = (uDErosIMW * (1- fHypErosIM) - tDSetIMEpi + tDResusIM) / sDepthWEpi 
end;
if (aInclStrat == true ) 
wDAbioDetWEpi = (- tDSetDetEpi ) / sDepthWEpi - wDMinDetWEpi 
else
wDAbioDetWEpi = (- tDSetDetEpi + tDResusDet ) / sDepthWEpi - wDMinDetWEpi 
end;
if ( aInclStrat == true ) 
tDAbioIMS = uDErosIMS + tDSetIMHyp - tDResusIM 
else
tDAbioIMS = uDErosIMS + tDSetIMEpi - tDResusIM 
end;
if ( aInclStrat == true ) 
tDAbioDetS = tDSetDetHyp - tDResusDet - tDMinDetS 
else
tDAbioDetS = tDSetDetEpi - tDResusDet - tDMinDetS 
end;
tDAbioHumS = uDErosOM + fRefrDetS * tDMinDetS - tDMinHumS;
tDAbioTotT = cDErosTot - wDMinDetWEpi * sDepthWEpi - wDMinDetWHyp * sDepthWHyp - (1.0 - fRefrDetS) * tDMinDetS - tDMinHumS;
if (aInclStrat == false) 
wO2AbioWEpi = tO2AerEpi / sDepthWEpi - wO2MinDetWEpi - wO2NitrWEpi - (tO2MinDetS + tO2NitrS) / sDepthWEpi 
else
wO2AbioWEpi = tO2AerEpi / sDepthWEpi - wO2MinDetWEpi - wO2NitrWEpi 
end;
wO2AbioM = tO2AerM / sDepthWM - wO2MinDetWM - wO2NitrWM - (tO2MinDetSM + tO2NitrSM) / sDepthWM;
if (aInclStrat == true ) 
wPAbioDetWEpi = - wPMinDetWEpi - (tPSetDetEpi ) / sDepthWEpi 
else
wPAbioDetWEpi = - wPMinDetWEpi - (tPSetDetEpi - tPResusDet) / sDepthWEpi 
end;
if (aInclStrat == true ) 
wPAbioPO4WEpi = wPMinDetWEpi - wPSorpIMWEpi - tPInfPO4WEpi / sDepthWEpi + tPDifPO4Epi / sDepthWEpi 
else
wPAbioPO4WEpi = wPMinDetWEpi - wPSorpIMWEpi - tPInfPO4WEpi / sDepthWEpi + tPDifPO4Epi / sDepthWEpi + tPResusPO4 / sDepthWEpi 
end;
if (aInclStrat == true ) 
wPAbioAIMWEpi = (- tPSetAIMEpi ) / sDepthWEpi + wPSorpIMWEpi 
else
wPAbioAIMWEpi = (- tPSetAIMEpi + tPResusAIM ) / sDepthWEpi + wPSorpIMWEpi 
end;
if ( aInclStrat == true ) 
tPAbioDetS = - tPMinDetS + tPSetDetHyp - tPResusDet 
else
tPAbioDetS = - tPMinDetS + tPSetDetEpi - tPResusDet 
end;
tPAbioHumS = uPErosOM + fRefrDetS * tPMinDetS - tPMinHumS;
if ( aInclStrat == true ) 
tPAbioPO4S = tPInfPO4WHyp - tPInfPO4S + (1.0-fRefrDetS) * tPMinDetS + tPMinHumS - tPSorpIMS - tPResusPO4 - tPDifPO4Hyp - tPDifGroundPO4 - tPChemPO4 
else
tPAbioPO4S = tPInfPO4WEpi - tPInfPO4S + (1.0-fRefrDetS) * tPMinDetS + tPMinHumS - tPSorpIMS - tPResusPO4 - tPDifPO4Epi - tPDifGroundPO4 - tPChemPO4 
end;
if ( aInclStrat == true ) 
tPAbioAIMS = tPSetAIMHyp - tPResusAIM + tPSorpIMS 
else
tPAbioAIMS = tPSetAIMEpi - tPResusAIM + tPSorpIMS 
end;
if (aInclStrat == true ) 
wNAbioNH4WEpi = wNMinDetWEpi - wNNitrWEpi - tNInfNH4WEpi / sDepthWEpi + (tNDifNH4Epi ) / sDepthWEpi 
else
wNAbioNH4WEpi = wNMinDetWEpi - wNNitrWEpi - tNInfNH4WEpi / sDepthWEpi + (tNDifNH4Epi + tNResusNH4) / sDepthWEpi 
end;
if (aInclStrat == true ) 
wNAbioNO3WEpi = wNNitrWEpi - wNDenitWEpi + (tNDifNO3Epi - tNInfNO3WEpi) / sDepthWEpi 
else
wNAbioNO3WEpi = wNNitrWEpi - wNDenitWEpi + (tNDifNO3Epi + tNResusNO3 - tNInfNO3WEpi) / sDepthWEpi 
end;
if (aInclStrat == true ) 
wNAbioDetWEpi = - wNMinDetWEpi - (tNSetDetEpi) / sDepthWEpi 
else
wNAbioDetWEpi = - wNMinDetWEpi - (tNSetDetEpi - tNResusDet ) / sDepthWEpi 
end;
if ( aInclStrat == true ) 
tNAbioNH4S = tNInfNH4WHyp - tNInfNH4S + (1.0-fRefrDetS) * tNMinDetS + tNMinHumS - tNResusNH4 - tNDifNH4Hyp - tNDifGroundNH4 - tNNitrS 
else
tNAbioNH4S = tNInfNH4WEpi - tNInfNH4S + (1.0-fRefrDetS) * tNMinDetS + tNMinHumS - tNResusNH4 - tNDifNH4Epi - tNDifGroundNH4 - tNNitrS 
end;
if ( aInclStrat == true ) 
tNAbioNO3S = tNInfNO3WHyp - tNInfNO3S + tNNitrS - tNDenitS - tNResusNO3 - tNDifNO3Hyp - tNDifGroundNO3 
else
tNAbioNO3S = tNInfNO3WEpi - tNInfNO3S + tNNitrS - tNDenitS - tNResusNO3 - tNDifNO3Epi - tNDifGroundNO3 
end;
if ( aInclStrat == true ) 
tNAbioDetS = - tNMinDetS + tNSetDetHyp - tNResusDet 
else
tNAbioDetS = - tNMinDetS + tNSetDetEpi - tNResusDet 
end;
tNAbioHumS = uNErosOM + fRefrDetS * tNMinDetS - tNMinHumS;
tNAbioTotT = uNErosOM - tNDenitS - wNDenitWEpi * sDepthWEpi - wNDenitWHyp * sDepthWHyp - tNInfNH4S - tNInfNO3S - tNDifGroundNO3 - tNDifGroundNH4;
if (aInclStrat == false ) 
wSiAbioSiO2WEpi = wSiMinDetWEpi + (1.0 - fRefrDetS) * tSiMinDetS / sDepthWEpi 
else
wSiAbioSiO2WEpi = wSiMinDetWEpi 
end;
if (aInclStrat == true ) 
wSiAbioDetWEpi = - wSiMinDetWEpi - (tSiSetDetEpi ) / sDepthWEpi 
else
wSiAbioDetWEpi = - wSiMinDetWEpi - (tSiSetDetEpi - tSiResusDet) / sDepthWEpi 
end;
if ( aInclStrat == true ) 
tSiAbioDetS = - tSiMinDetS + tSiSetDetHyp - tSiResusDet 
else
tSiAbioDetS = - tSiMinDetS + tSiSetDetEpi - tSiResusDet 
end;
tDProdSubVegEpi = bfSubVegEpi * tDProdVegEpi;
tDMortVegWEpi = fDetWMortVeg * (1.0 - bfRootVeg) * tDMortVegEpi;
tDMortVegSEpi = tDMortVegEpi - tDMortVegWEpi;
if InclVeg == true 
tDBedVeg = tDMigrVeg + tDProdVegEpi + tDProdVegHyp- tDRespVeg - tDMortVegEpi - tDMortVegHyp - tDGrazVegBird - tDManVeg 
else
tDBedVeg = 0.0 
end;
tO2ProdVegEpi = molO2molC * cCPerDW * tDProdVegEpi;
tO2RespVegWEpi = molO2molC * cCPerDW * bfSubVegEpi * tDRespVeg * aCorO2BODEpi;
tO2ProdVegSEpi = min (tO2RespVegS, tO2ProdVegEpi);
tO2ProdVegWEpi = min ( tO2ProdVegEpi - tO2ProdVegSEpi, bfSubVeg * tO2ProdVegEpi) ;
tO2BedS = tO2ProdVegSHyp + tO2ProdVegSEpi - tO2RespVegS + tO2UptNO3VegS;
tO2UptNO3VegWEpi = O2PerNO3 * molO2molN * bfSubVeg * tNUptNO3VegWEpi;
tPMortVegEpi = rPDVeg * tDMortVegEpi;
tPMortVegPO4Epi = fDissMortVeg * tPMortVegEpi;
tPMortVegPO4SEpi = bfRootVeg * tPMortVegPO4Epi;
tPMortVegPO4WEpi = tPMortVegPO4Epi - tPMortVegPO4SEpi;
tPMortVegDetEpi = tPMortVegEpi - tPMortVegPO4Epi;
tPMortVegDetWEpi = fDetWMortVeg * (1.0 - bfRootVeg) * tPMortVegDetEpi;
tPMortVegDetSEpi = tPMortVegDetEpi - tPMortVegDetWEpi;
if InclVeg == true 
tPBedVeg = tPMigrVeg + tPUptVegEpi + tPUptVegHyp - tPExcrVeg - tPMortVegEpi - tPMortVegHyp - tPGrazVegBird - tPManVeg 
else
tPBedVeg = 0.0 
end;
tNMortVegNH4WEpi = tNMortVegNH4Epi - tNMortVegNH4SEpi;
tNMortVegDetEpi = tNMortVegEpi - tNMortVegNH4Epi;
tNMortVegDetWEpi = fDetWMortVeg * (1.0 - bfRootVeg) * tNMortVegDetEpi;
tNMortVegDetSEpi = tNMortVegDetEpi - tNMortVegDetWEpi;
if InclVeg == true 
tNBedVeg = tNMigrVeg + tNUptVeg - tNExcrVeg - tNMortVegEpi - tNMortVegHyp - tNGrazVegBird - tNManVeg 
else
tNBedVeg = 0.0 
end;
if (InclVeg == true) 
wDBedDetWEpi = (tDMortVegWEpi + tDEgesBird) / sDepthWEpi 
else
wDBedDetWEpi = 0.0 
end;
if ( InclVeg == true) 
tDBedDetSEpi = tDMortVegSEpi 
else
tDBedDetSEpi = 0.0 
end;
if (InclVeg == false) 
wPBedPO4WEpi = 0.0 
else
wPBedPO4WEpi = (- tPUptVegWEpi + tPExcrVegW * uVegHeightEpi / uVegHeight + tPMortVegPO4WEpi + tPEgesBirdPO4) /sDepthWEpi 
end;
if (InclVeg == true) 
wPBedDetWEpi = (tPMortVegDetWEpi + tPEgesBirdDet) / sDepthWEpi 
else
wPBedDetWEpi = 0.0 
end;
if ( InclVeg == true) 
tPBedPO4S = - tPUptVegS + tPExcrVegS + tPMortVegPO4SEpi + tPMortVegPO4SHyp 
else
tPBedPO4S = 0.0 
end;
if (InclVeg == true) 
tPBedDetS = tPMortVegDetSEpi + tPMortVegDetSHyp 
else
tPBedDetS = 0.0 
end;
if ( InclVeg == true ) 
wNBedNH4WEpi = (- tNUptNH4VegWEpi + tNExcrVegW * (uVegHeightEpi /uVegHeight ) + tNMortVegNH4WEpi + tNEgesBirdNH4) / sDepthWEpi 
else
wNBedNH4WEpi = 0.0 
end;
if ( InclVeg == true) 
wNBedNO3WEpi = - tNUptNO3VegWEpi / sDepthWEpi 
else
wNBedNO3WEpi = 0.0 
end;
if (InclVeg == true) 
wNBedDetWEpi = (tNMortVegDetWEpi + tNEgesBirdDet) / sDepthWEpi 
else
wNBedDetWEpi = 0.0 
end;
if ( InclVeg == true) 
tNBedNH4S = - tNUptNH4VegS + tNExcrVegS + tNMortVegNH4SEpi + tNMortVegNH4SHyp 
else
tNBedNH4S = 0.0 
end;
if ( InclVeg == true ) 
tNBedNO3S = - tNUptNO3VegS 
else
tNBedNO3S = 0.0 
end;
if ( InclVeg == false) 
tNBedDetS = 0.0 
elseif (aInclStrat == true) 
tNBedDetS = tNMortVegDetSEpi + tNMortVegDetSHyp 
else
tNBedDetS = tNMortVegDetSEpi 
end;
if ( InclVeg == true ) 
tO2BedWEpi = tO2ProdVegWEpi - tO2RespVegWEpi + tO2UptNO3VegWEpi 
else
tO2BedWEpi = 0.0 
end;
aVPUptMaxCrBlueEpi = max(0.0,cVPUptMaxBlue * uFunTmProdBlueEpi *(cPDBlueMax - rPDBlueWEpi) /(cPDBlueMax - cPDBlueMin));
aVPUptBlueEpi = oPO4WEpi * aVPUptMaxCrBlueEpi /(aVPUptMaxCrBlueEpi / cAffPUptBlue + oPO4WEpi);
wPUptBlueEpi = aVPUptBlueEpi * oDBlueWEpi;
aVNUptMaxCrBlueEpi = max(0.0,cVNUptMaxBlue * uFunTmProdBlueEpi * (cNDBlueMax - rNDBlueWEpi) /(cNDBlueMax - cNDBlueMin));
ahNUptBlueEpi = aVNUptMaxCrBlueEpi / cAffNUptBlue;
aVNUptBlueEpi = oNDissWEpi * aVNUptMaxCrBlueEpi /(ahNUptBlueEpi + oNDissWEpi);
wNUptBlueEpi = aVNUptBlueEpi * oDBlueWEpi;
afNH4UptBlueEpi = oNH4WEpi * oNO3WEpi /((ahNUptBlueEpi + oNH4WEpi) *(ahNUptBlueEpi + oNO3WEpi)) + oNH4WEpi * ahNUptBlueEpi /((oNH4WEpi + oNO3WEpi) *(ahNUptBlueEpi + oNO3WEpi));
wNUptNH4BlueEpi = afNH4UptBlueEpi * wNUptBlueEpi;
wNUptNO3BlueEpi = wNUptBlueEpi - wNUptNH4BlueEpi;
aPLimBlueEpi = max(0.0,(1.0 - cPDBlueMin / rPDBlueWEpi) * cPDBlueMax /(cPDBlueMax - cPDBlueMin));
aNLimBlueEpi = max(0.0,(1.0 - cNDBlueMin / rNDBlueWEpi) * cNDBlueMax /(cNDBlueMax - cNDBlueMin));
aSiLimBlueEpi = oSiO2WEpi /(hSiAssBlue + oSiO2WEpi);
aLLimBlueEpi = UseSteeleBlue *(exp(1.0) /(aExtCoefEpi * sDepthWEpi) *(exp(- aLPARBotEpi /(cLOptRefBlue * uFunTmProdBlueEpi)) - exp(- uLPARSurf /(cLOptRefBlue * uFunTmProdBlueEpi)))) +(1.0 - UseSteeleBlue) *(1.0 /(aExtCoefEpi * sDepthWEpi) * log((1.0 + uLPARSurf / (hLRefBlue * uFunTmProdBlueEpi)) / (1.0 + aLPARBotEpi /(hLRefBlue * uFunTmProdBlueEpi))));
aMuTmLBlueEpi = ufDay *(1.0 - afCovSurfVeg) * aLLimBlueEpi * uMuMaxTmBlueEpi;
aNutLimBlueEpi = min(aPLimBlueEpi , (min(aNLimBlueEpi,aSiLimBlueEpi)));
aMuBlueEpi = aNutLimBlueEpi * aMuTmLBlueEpi;
wDAssBlueEpi = aMuBlueEpi*oDBlueWEpi;
rChDBlueEpi = cChDBlueMax -(cChDBlueMax - cChDBlueMin) * aLLimBlueEpi;
oChlaBlueEpi = mgPerg * rChDBlueEpi * oDBlueWEpi;
aExtChBlueEpi = cExtSpBlue / rChDBlueEpi;
wDRespBlueWEpi = ukDRespTmBlueEpi * oDBlueWEpi;
wDLossBlueEpi = ukLossTmBlueEpi * oDBlueWEpi;
wDMortBlueWEpi = kMortBlueW * oDBlueWEpi;
ukDDecBlueEpi = ukDRespTmBlueEpi + ukLossTmBlueEpi + kMortBlueW +(uCorVSetBlueEpi * uFunTmSetEpi) / sDepthWEpi;
wPExcrBlueWEpi = (rPDBlueWEpi * 2.0 )/(cPDBlueMax + rPDBlueWEpi) * rPDBlueWEpi * wDRespBlueWEpi ;
wPLossBlueEpi = rPDBlueWEpi * wDLossBlueEpi;
wPMortBlueWEpi = kMortBlueW * oPBlueWEpi;
wNExcrBlueWEpi = (rNDBlueWEpi *2.0)/(cNDBlueMax + rNDBlueWEpi) * rNDBlueWEpi * wDRespBlueWEpi ;
wNLossBlueEpi = rNDBlueWEpi * wDLossBlueEpi;
wNMortBlueWEpi = kMortBlueW * oNBlueWEpi;
if (aInclStrat == true ) 
wDPrimBlueWEpi = wDAssBlueEpi - wDRespBlueWEpi - wDLossBlueEpi - wDMortBlueWEpi -(tDSetBlueEpi ) / sDepthWEpi 
else
wDPrimBlueWEpi = wDAssBlueEpi - wDRespBlueWEpi - wDLossBlueEpi - wDMortBlueWEpi -(tDSetBlueEpi - tDResusBlue) / sDepthWEpi 
end;
if (aInclStrat == true ) 
wPPrimBlueWEpi = wPUptBlueEpi - wPExcrBlueWEpi - wPLossBlueEpi - wPMortBlueWEpi -(tPSetBlueEpi ) / sDepthWEpi 
else
wPPrimBlueWEpi = wPUptBlueEpi - wPExcrBlueWEpi - wPLossBlueEpi - wPMortBlueWEpi -(tPSetBlueEpi - tPResusBlue) / sDepthWEpi 
end;
if (aInclStrat == true ) 
wNPrimBlueWEpi = wNUptBlueEpi - wNExcrBlueWEpi - wNLossBlueEpi - wNMortBlueWEpi -(tNSetBlueEpi ) / sDepthWEpi 
else
wNPrimBlueWEpi = wNUptBlueEpi - wNExcrBlueWEpi - wNLossBlueEpi - wNMortBlueWEpi -(tNSetBlueEpi - tNResusBlue) / sDepthWEpi 
end;
if ( aInclStrat == false) 
tDPrimBlueS = tDSetBlueEpi - tDResusBlue - tDMortBlueS - tDRespBlueS 
else
tDPrimBlueS = tDSetBlueHyp - tDResusBlue - tDMortBlueS - tDRespBlueS 
end;
if ( aInclStrat == false) 
tPPrimBlueS = tPSetBlueEpi - tPResusBlue - tPMortBlueS - tPExcrBlueS 
else
tPPrimBlueS = tPSetBlueHyp - tPResusBlue - tPMortBlueS - tPExcrBlueS 
end;
if (aInclStrat == false) 
tNPrimBlueS = tNSetBlueEpi - tNResusBlue - tNMortBlueS - tNExcrBlueS 
else
tNPrimBlueS = tNSetBlueHyp - tNResusBlue - tNMortBlueS - tNExcrBlueS 
end;
aVPUptMaxCrGrenEpi = max(0.0,cVPUptMaxGren * uFunTmProdGrenEpi *(cPDGrenMax - rPDGrenWEpi) /(cPDGrenMax - cPDGrenMin));
aVPUptGrenEpi = oPO4WEpi * aVPUptMaxCrGrenEpi /(aVPUptMaxCrGrenEpi / cAffPUptGren + oPO4WEpi);
wPUptGrenEpi = aVPUptGrenEpi * oDGrenWEpi;
aVNUptMaxCrGrenEpi = max(0.0,cVNUptMaxGren * uFunTmProdGrenEpi * (cNDGrenMax - rNDGrenWEpi) /(cNDGrenMax - cNDGrenMin));
ahNUptGrenEpi = aVNUptMaxCrGrenEpi / cAffNUptGren;
aVNUptGrenEpi = oNDissWEpi * aVNUptMaxCrGrenEpi /(ahNUptGrenEpi + oNDissWEpi);
wNUptGrenEpi = aVNUptGrenEpi * oDGrenWEpi;
afNH4UptGrenEpi = oNH4WEpi * oNO3WEpi /((ahNUptGrenEpi + oNH4WEpi) *(ahNUptGrenEpi + oNO3WEpi)) + oNH4WEpi * ahNUptGrenEpi /((oNH4WEpi + oNO3WEpi) *(ahNUptGrenEpi + oNO3WEpi));
wNUptNH4GrenEpi = afNH4UptGrenEpi * wNUptGrenEpi;
wNUptNO3GrenEpi = wNUptGrenEpi - wNUptNH4GrenEpi;
aPLimGrenEpi = max(0.0,(1.0 - cPDGrenMin / rPDGrenWEpi) * cPDGrenMax /(cPDGrenMax - cPDGrenMin));
aNLimGrenEpi = max(0.0,(1.0 - cNDGrenMin / rNDGrenWEpi) * cNDGrenMax /(cNDGrenMax - cNDGrenMin));
aSiLimGrenEpi = oSiO2WEpi /(hSiAssGren + oSiO2WEpi);
aLLimGrenEpi = UseSteeleGren *(exp(1.0) /(aExtCoefEpi * sDepthWEpi) *(exp(- aLPARBotEpi /(cLOptRefGren * uFunTmProdGrenEpi)) - exp(- uLPARSurf /(cLOptRefGren * uFunTmProdGrenEpi)))) +(1.0 - UseSteeleGren) *(1.0 /(aExtCoefEpi * sDepthWEpi) * log((1.0 + uLPARSurf / (hLRefGren * uFunTmProdGrenEpi)) / (1.0 + aLPARBotEpi /(hLRefGren * uFunTmProdGrenEpi))));
aMuTmLGrenEpi = ufDay *(1.0 - afCovSurfVeg) * aLLimGrenEpi * uMuMaxTmGrenEpi;
aNutLimGrenEpi = min(aPLimGrenEpi , (min(aNLimGrenEpi,aSiLimGrenEpi)));
aMuGrenEpi = aNutLimGrenEpi * aMuTmLGrenEpi;
wDAssGrenEpi = aMuGrenEpi*oDGrenWEpi;
rChDGrenEpi = cChDGrenMax -(cChDGrenMax - cChDGrenMin) * aLLimGrenEpi;
oChlaGrenEpi = mgPerg * rChDGrenEpi * oDGrenWEpi;
aExtChGrenEpi = cExtSpGren / rChDGrenEpi;
wDRespGrenWEpi = ukDRespTmGrenEpi * oDGrenWEpi;
wDLossGrenEpi = ukLossTmGrenEpi * oDGrenWEpi;
wDMortGrenWEpi = kMortGrenW * oDGrenWEpi;
ukDDecGrenEpi = ukDRespTmGrenEpi + ukLossTmGrenEpi + kMortGrenW +(uCorVSetGrenEpi * uFunTmSetEpi) / sDepthWEpi;
wPExcrGrenWEpi = (2.0 *rPDGrenWEpi) /(cPDGrenMax + rPDGrenWEpi) * rPDGrenWEpi * wDRespGrenWEpi ;
wPLossGrenEpi = rPDGrenWEpi * wDLossGrenEpi;
wPMortGrenWEpi = kMortGrenW * oPGrenWEpi;
wNExcrGrenWEpi = (2.0 * rNDGrenWEpi) /(cNDGrenMax + rNDGrenWEpi) * rNDGrenWEpi * wDRespGrenWEpi;
wNLossGrenEpi = rNDGrenWEpi * wDLossGrenEpi;
wNMortGrenWEpi = kMortGrenW * oNGrenWEpi;
if (aInclStrat == true ) 
wDPrimGrenWEpi = wDAssGrenEpi - wDRespGrenWEpi - wDLossGrenEpi - wDMortGrenWEpi -(tDSetGrenEpi ) / sDepthWEpi 
else
wDPrimGrenWEpi = wDAssGrenEpi - wDRespGrenWEpi - wDLossGrenEpi - wDMortGrenWEpi -(tDSetGrenEpi - tDResusGren) / sDepthWEpi 
end;
if (aInclStrat == true ) 
wPPrimGrenWEpi = wPUptGrenEpi - wPExcrGrenWEpi - wPLossGrenEpi - wPMortGrenWEpi -(tPSetGrenEpi ) / sDepthWEpi 
else
wPPrimGrenWEpi = wPUptGrenEpi - wPExcrGrenWEpi - wPLossGrenEpi - wPMortGrenWEpi -(tPSetGrenEpi - tPResusGren) / sDepthWEpi 
end;
if (aInclStrat == true ) 
wNPrimGrenWEpi = wNUptGrenEpi - wNExcrGrenWEpi - wNLossGrenEpi - wNMortGrenWEpi -(tNSetGrenEpi ) / sDepthWEpi 
else
wNPrimGrenWEpi = wNUptGrenEpi - wNExcrGrenWEpi - wNLossGrenEpi - wNMortGrenWEpi -(tNSetGrenEpi - tNResusGren) / sDepthWEpi 
end;
if ( aInclStrat == false) 
tDPrimGrenS = tDSetGrenEpi - tDResusGren - tDMortGrenS - tDRespGrenS 
else
tDPrimGrenS = tDSetGrenHyp - tDResusGren - tDMortGrenS - tDRespGrenS 
end;
if ( aInclStrat == false) 
tPPrimGrenS = tPSetGrenEpi - tPResusGren - tPMortGrenS - tPExcrGrenS 
else
tPPrimGrenS = tPSetGrenHyp - tPResusGren - tPMortGrenS - tPExcrGrenS 
end;
if ( aInclStrat == false) 
tNPrimGrenS = tNSetGrenEpi - tNResusGren - tNMortGrenS - tNExcrGrenS 
else
tNPrimGrenS = tNSetGrenHyp - tNResusGren - tNMortGrenS - tNExcrGrenS 
end;
aVPUptMaxCrDiatEpi = max(0.0,cVPUptMaxDiat * uFunTmProdDiatEpi *(cPDDiatMax - rPDDiatWEpi) /(cPDDiatMax - cPDDiatMin));
aVPUptDiatEpi = oPO4WEpi * aVPUptMaxCrDiatEpi /(aVPUptMaxCrDiatEpi / cAffPUptDiat + oPO4WEpi);
wPUptDiatEpi = aVPUptDiatEpi * oDDiatWEpi;
aVNUptMaxCrDiatEpi = max(0.0,cVNUptMaxDiat * uFunTmProdDiatEpi * (cNDDiatMax - rNDDiatWEpi) /(cNDDiatMax - cNDDiatMin));
ahNUptDiatEpi = aVNUptMaxCrDiatEpi / cAffNUptDiat;
aVNUptDiatEpi = oNDissWEpi * aVNUptMaxCrDiatEpi /(ahNUptDiatEpi + oNDissWEpi);
wNUptDiatEpi = aVNUptDiatEpi * oDDiatWEpi;
afNH4UptDiatEpi = oNH4WEpi * oNO3WEpi /((ahNUptDiatEpi + oNH4WEpi) *(ahNUptDiatEpi + oNO3WEpi)) + oNH4WEpi * ahNUptDiatEpi /((oNH4WEpi + oNO3WEpi) *(ahNUptDiatEpi + oNO3WEpi));
wNUptNH4DiatEpi = afNH4UptDiatEpi * wNUptDiatEpi;
wNUptNO3DiatEpi = wNUptDiatEpi - wNUptNH4DiatEpi;
aPLimDiatEpi = max(0.0,(1.0 - cPDDiatMin / rPDDiatWEpi) * cPDDiatMax /(cPDDiatMax - cPDDiatMin));
aNLimDiatEpi = max(0.0,(1.0 - cNDDiatMin / rNDDiatWEpi) * cNDDiatMax /(cNDDiatMax - cNDDiatMin));
aSiLimDiatEpi = oSiO2WEpi /(hSiAssDiat + oSiO2WEpi);
aLLimDiatEpi = UseSteeleDiat *(exp(1.0) /(aExtCoefEpi * sDepthWEpi) *(exp(- aLPARBotEpi /(cLOptRefDiat * uFunTmProdDiatEpi)) - exp(- uLPARSurf /(cLOptRefDiat * uFunTmProdDiatEpi)))) +(1.0 - UseSteeleDiat) *(1.0 /(aExtCoefEpi * sDepthWEpi) * log((1.0 + uLPARSurf / (hLRefDiat * uFunTmProdDiatEpi)) / (1.0 + aLPARBotEpi /(hLRefDiat * uFunTmProdDiatEpi))));
aMuTmLDiatEpi = ufDay *(1.0 - afCovSurfVeg) * aLLimDiatEpi * uMuMaxTmDiatEpi;
aNutLimDiatEpi = min(aPLimDiatEpi , (min(aNLimDiatEpi,aSiLimDiatEpi)));
aMuDiatEpi = aNutLimDiatEpi * aMuTmLDiatEpi;
wDAssDiatEpi = aMuDiatEpi*oDDiatWEpi;
rChDDiatEpi = cChDDiatMax -(cChDDiatMax - cChDDiatMin) * aLLimDiatEpi;
oChlaDiatEpi = mgPerg * rChDDiatEpi * oDDiatWEpi;
aExtChDiatEpi = cExtSpDiat / rChDDiatEpi;
wDRespDiatWEpi = ukDRespTmDiatEpi * oDDiatWEpi;
wDLossDiatEpi = ukLossTmDiatEpi * oDDiatWEpi;
wDMortDiatWEpi = kMortDiatW * oDDiatWEpi;
ukDDecDiatEpi = ukDRespTmDiatEpi + ukLossTmDiatEpi + kMortDiatW +(uCorVSetDiatEpi * uFunTmSetEpi) / sDepthWEpi;
wPExcrDiatWEpi = (2.0 * rPDDiatWEpi) /(cPDDiatMax + rPDDiatWEpi) * rPDDiatWEpi * wDRespDiatWEpi ;
wPLossDiatEpi = rPDDiatWEpi * wDLossDiatEpi;
wPMortDiatWEpi = kMortDiatW * oPDiatWEpi;
wNExcrDiatWEpi = (2.0 * rNDDiatWEpi) /(cNDDiatMax + rNDDiatWEpi) * rNDDiatWEpi * wDRespDiatWEpi ;
wNLossDiatEpi = rNDDiatWEpi * wDLossDiatEpi;
wNMortDiatWEpi = kMortDiatW * oNDiatWEpi;
if (aInclStrat == true ) 
wDPrimDiatWEpi = wDAssDiatEpi - wDRespDiatWEpi - wDLossDiatEpi - wDMortDiatWEpi -(tDSetDiatEpi ) / sDepthWEpi 
else
wDPrimDiatWEpi = wDAssDiatEpi - wDRespDiatWEpi - wDLossDiatEpi - wDMortDiatWEpi -(tDSetDiatEpi - tDResusDiat) / sDepthWEpi 
end;
if (aInclStrat == true ) 
wPPrimDiatWEpi = wPUptDiatEpi - wPExcrDiatWEpi - wPLossDiatEpi - wPMortDiatWEpi -(tPSetDiatEpi ) / sDepthWEpi 
else
wPPrimDiatWEpi = wPUptDiatEpi - wPExcrDiatWEpi - wPLossDiatEpi - wPMortDiatWEpi -(tPSetDiatEpi - tPResusDiat) / sDepthWEpi 
end;
if (aInclStrat == true ) 
wNPrimDiatWEpi = wNUptDiatEpi - wNExcrDiatWEpi - wNLossDiatEpi - wNMortDiatWEpi -(tNSetDiatEpi ) / sDepthWEpi 
else
wNPrimDiatWEpi = wNUptDiatEpi - wNExcrDiatWEpi - wNLossDiatEpi - wNMortDiatWEpi -(tNSetDiatEpi - tNResusDiat) / sDepthWEpi 
end;
if ( aInclStrat == false) 
tDPrimDiatS = tDSetDiatEpi - tDResusDiat - tDMortDiatS - tDRespDiatS 
else
tDPrimDiatS = tDSetDiatHyp - tDResusDiat - tDMortDiatS - tDRespDiatS 
end;
if ( aInclStrat == false) 
tPPrimDiatS = tPSetDiatEpi - tPResusDiat - tPMortDiatS - tPExcrDiatS 
else
tPPrimDiatS = tPSetDiatHyp - tPResusDiat - tPMortDiatS - tPExcrDiatS 
end;
if ( aInclStrat == false) 
tNPrimDiatS = tNSetDiatEpi - tNResusDiat - tNMortDiatS - tNExcrDiatS 
else
tNPrimDiatS = tNSetDiatHyp - tNResusDiat - tNMortDiatS - tNExcrDiatS 
end;
oChlaEpi = oChlaDiatEpi + oChlaGrenEpi + oChlaBlueEpi;
if ( aInclStrat == true ) 
oChla = (oChlaEpi * sDepthWEpi + oChlaHyp * sDepthWHyp ) / uDepthW 
else
oChla = oChlaEpi 
end;
aLPIEpi =  (uLPARSurf- aLPARBotEpiOpen + uhLVeg* log((1.0 +aLPARBotEpiOpen/ uhLVeg)  /(1.0 + uLPARSurf  / uhLVeg) + NearZero  ) ) / sDepthWEpi;
aLMeasEpi = uLPARSurf * exp(- aExtCoefOpenEpi *cDepthMeasoChl);
oChlaMeasEpi = (aLMeasEpi  )/ aLPIEpi *oChlaEpi;
wDAssPhytEpi = wDAssDiatEpi + wDAssGrenEpi + wDAssBlueEpi;
wDRespPhytWEpi = wDRespDiatWEpi + wDRespGrenWEpi + wDRespBlueWEpi;
wDMortPhytWEpi = wDMortDiatWEpi + wDMortGrenWEpi + wDMortBlueWEpi;
tDSetPhytEpi = tDSetDiatEpi + tDSetGrenEpi + tDSetBlueEpi;
wDLossPhytEpi = wDLossDiatEpi + wDLossGrenEpi + wDLossBlueEpi;
wDPrimPhytWEpi = wDPrimDiatWEpi + wDPrimGrenWEpi + wDPrimBlueWEpi;
wPUptPhytEpi = wPUptDiatEpi + wPUptGrenEpi + wPUptBlueEpi;
wPExcrPhytWEpi = wPExcrDiatWEpi + wPExcrGrenWEpi + wPExcrBlueWEpi;
wPMortPhytWEpi = wPMortDiatWEpi + wPMortGrenWEpi + wPMortBlueWEpi;
tPSetPhytEpi = tPSetDiatEpi + tPSetGrenEpi + tPSetBlueEpi;
wPLossPhytEpi = wPLossDiatEpi + wPLossGrenEpi + wPLossBlueEpi;
wPPrimPhytWEpi = wPPrimDiatWEpi + wPPrimGrenWEpi + wPPrimBlueWEpi;
wNUptPhytEpi = wNUptDiatEpi + wNUptGrenEpi + wNUptBlueEpi;
wNUptNH4PhytEpi = wNUptNH4DiatEpi + wNUptNH4GrenEpi + wNUptNH4BlueEpi;
wNUptNO3PhytEpi = wNUptNO3DiatEpi + wNUptNO3GrenEpi + wNUptNO3BlueEpi;
wNExcrPhytWEpi = wNExcrDiatWEpi + wNExcrGrenWEpi + wNExcrBlueWEpi;
wNMortPhytWEpi = wNMortDiatWEpi + wNMortGrenWEpi + wNMortBlueWEpi;
tNSetPhytEpi = tNSetDiatEpi + tNSetGrenEpi + tNSetBlueEpi;
wNLossPhytEpi = wNLossDiatEpi + wNLossGrenEpi + wNLossBlueEpi;
wNPrimPhytWEpi = wNPrimDiatWEpi + wNPrimGrenWEpi + wNPrimBlueWEpi;
tDPrimPhytS = tDPrimDiatS + tDPrimGrenS + tDPrimBlueS;
tPPrimPhytS = tPPrimDiatS + tPPrimGrenS + tPPrimBlueS;
tNPrimPhytS = tNPrimDiatS + tNPrimGrenS + tNPrimBlueS;
wSiUptDiatEpi = cSiDDiat * wDAssDiatEpi;
wSiExcrDiatWEpi = cSiDDiat * wDRespDiatWEpi ;
wSiLossDiatEpi = cSiDDiat * wDLossDiatEpi;
wSiMortDiatWEpi = cSiDDiat * wDMortDiatWEpi;
tSiSetDiatEpi = cSiDDiat * tDSetDiatEpi;
if (aInclStrat == true ) 
wSiPrimDiatWHyp = wSiUptDiatHyp - tSiSetDiatHyp / sDepthWHyp - wSiExcrDiatWHyp - wSiMortDiatWHyp - wSiLossDiatHyp 
else
wSiPrimDiatWHyp = 0.0 
end;
if (aInclStrat == true ) 
wSiPrimDiatWEpi = wSiUptDiatEpi - tSiSetDiatEpi / sDepthWEpi - wSiExcrDiatWEpi - wSiMortDiatWEpi - wSiLossDiatEpi 
else
wSiPrimDiatWEpi = wSiUptDiatEpi - tSiSetDiatEpi / sDepthWEpi - wSiExcrDiatWEpi - wSiMortDiatWEpi - wSiLossDiatEpi + tSiResusDiat / sDepthWEpi 
end;
rCyDBlueEpi = cCyDBlueMax -(cCyDBlueMax - cCyDBlueMin) * aLLimBlueEpi;
oCyanEpi = rCyDBlueEpi * oDBlueWEpi * mgPerg;
fDDiatEpi = oDDiatWEpi /(oDDiatWEpi + oDGrenWEpi + oDBlueWEpi + NearZero);
wDPrimDetWEpi = wDMortPhytWEpi + wDLossPhytEpi;
tDPrimDetS = tDMortPhytS;
if (aInclStrat == false ) 
tDPrimTotT =(wDAssPhytEpi - wDRespPhytWEpi) * sDepthWEpi - tDRespPhytS 
else
tDPrimTotT = (wDAssPhytEpi - wDRespPhytWEpi) * sDepthWEpi + (wDAssPhytHyp - wDRespPhytWHyp) * sDepthWHyp - tDRespPhytS 
end;
wO2ProdPhytEpi = molO2molC * cCPerDW * wDAssPhytEpi;
wO2RespPhytWEpi = molO2molC * cCPerDW * wDRespPhytWEpi * aCorO2BODEpi;
wO2UptNO3PhytEpi = O2PerNO3 * molO2molN * wNUptNO3PhytEpi;
wO2PrimWEpi = wO2ProdPhytEpi - wO2RespPhytWEpi + wO2UptNO3PhytEpi;
tO2RespPhytS = molO2molC * cCPerDW * tDRespPhytS * afOxySed;
tO2PrimS = tO2RespPhytS;
if aInclStrat == true 
tO2PrimSHyp = tO2PrimS / sDepthWHyp 
else
tO2PrimSHyp = 0.0 
end;
if aInclStrat == false 
tO2PrimSEpi = tO2PrimS / sDepthWEpi 
else
tO2PrimSEpi = 0.0 
end;
wPMortPhytPO4WEpi = fDissMortPhyt * wPMortPhytWEpi;
wPMortPhytDetWEpi = wPMortPhytWEpi - wPMortPhytPO4WEpi;
wPLossPhytPO4Epi = fDissLoss * wPLossPhytEpi;
wPLossPhytDetEpi = wPLossPhytEpi - wPLossPhytPO4Epi;
wPPrimPO4WEpi = - wPUptPhytEpi + wPExcrPhytWEpi + wPLossPhytPO4Epi + wPMortPhytPO4WEpi;
wPPrimDetWEpi = wPLossPhytDetEpi + wPMortPhytDetWEpi;
tPPrimDetS = tPMortPhytDetS ;
wNMortPhytNH4WEpi = fDissMortPhyt * wNMortPhytWEpi;
wNMortPhytDetWEpi = wNMortPhytWEpi - wNMortPhytNH4WEpi;
wNLossPhytNH4Epi = fDissLoss * wNLossPhytEpi;
wNLossPhytDetEpi = wNLossPhytEpi - wNLossPhytNH4Epi;
wNPrimNH4WEpi = - wNUptNH4PhytEpi + wNExcrPhytWEpi + wNLossPhytNH4Epi + wNMortPhytNH4WEpi;
wNPrimNO3WEpi = - wNUptNO3PhytEpi;
wNPrimDetWEpi = wNLossPhytDetEpi + wNMortPhytDetWEpi;
tNPrimDetS = tNMortPhytDetS ;
if (aInclStrat == false) 
wSiPrimSiO2WEpi = wSiExcrDiatWEpi - wSiUptDiatEpi + tSiExcrDiatS / sDepthWEpi 
else
wSiPrimSiO2WEpi = wSiExcrDiatWEpi - wSiUptDiatEpi 
end;
wSiPrimDetWEpi = wSiMortDiatWEpi + wSiLossDiatEpi;
if (aInclStrat == false) 
tSiPrimDiatS = tSiSetDiatEpi - tSiResusDiat - tSiExcrDiatS - tSiMortDiatS 
else
tSiPrimDiatS = tSiSetDiatHyp - tSiResusDiat - tSiExcrDiatS - tSiMortDiatS 
end;
tSiPrimDetS = tSiMortDiatS ;
aDepthEuphEpi = cEuph * aSecchiEpi;
aRelDepthEuphEpi = aDepthEuphEpi / sDepthWEpi;
aChlaHEpi = oChlaEpi * sDepthWEpi;
aCovPhytWEpi = cCovSpPhyt *(oDPhytWEpi * sDepthWEpi);
rExtChPhytEpi = aExtPhytEpi /(oChlaEpi / mgPerg + NearZero);
rPDZooEpi = oPZooEpi /(oDZooEpi+NearZero);
rNDZooEpi = oNZooEpi/(oDZooEpi+NearZero);
oDFoodZooEpi = cPrefDiat * oDDiatWEpi + cPrefGren * oDGrenWEpi + cPrefBlue * oDBlueWEpi + cPrefDet * oDDetWEpi;
aFiltEpi = cFiltMax * uFunTmZooEpi * hFilt /(hFilt + oDOMWEpi);
aDSatZooEpi = oDFoodZooEpi /(hFilt + oDOMWEpi);
wDEnvZooEpi = max(0.0,ukDIncrZooEpi / cDCarrZoo * oDZooEpi*oDZooEpi);
wDAssZooEpi = aDSatZooEpi *(ukDAssTmZooEpi * oDZooEpi - wDEnvZooEpi);
wDConsZooEpi = wDAssZooEpi / fDAssZoo;
wDConsDetZooEpi = cPrefDet*oDDetWEpi / oDFoodZooEpi * wDConsZooEpi;
wDConsDiatZooEpi = cPrefDiat*oDDiatWEpi / oDFoodZooEpi * wDConsZooEpi;
wDConsGrenZooEpi = cPrefGren*oDGrenWEpi / oDFoodZooEpi * wDConsZooEpi;
wDConsBlueZooEpi = cPrefBlue*oDBlueWEpi / oDFoodZooEpi * wDConsZooEpi;
wDConsPhytZooEpi = wDConsDiatZooEpi + wDConsGrenZooEpi + wDConsBlueZooEpi;
wDEgesZooEpi = wDConsZooEpi - wDAssZooEpi;
aCorDRespZooEpi = max(cPDZooRef / rPDZooEpi,cNDZooRef / rNDZooEpi);
wDRespZooEpi = aCorDRespZooEpi * ukDRespTmZooEpi * oDZooEpi;
wDMortZooEpi = kMortZoo * oDZooEpi +(1.0 - aDSatZooEpi) * wDEnvZooEpi;
oPFoodZooEpi = cPrefDiat*oPDiatWEpi + cPrefGren*oPGrenWEpi + cPrefBlue*oPBlueWEpi + cPrefDet * oPDetWEpi;
rPDFoodZooEpi = oPFoodZooEpi /(oDFoodZooEpi+NearZero);
wPConsDiatZooEpi = rPDDiatWEpi * wDConsDiatZooEpi;
wPConsGrenZooEpi = rPDGrenWEpi * wDConsGrenZooEpi;
wPConsBlueZooEpi = rPDBlueWEpi * wDConsBlueZooEpi;
wPConsPhytZooEpi = wPConsDiatZooEpi + wPConsGrenZooEpi + wPConsBlueZooEpi;
wPConsDetZooEpi = rPDDetWEpi * wDConsDetZooEpi;
wPConsZooEpi = wPConsPhytZooEpi + wPConsDetZooEpi;
afPAssZooEpi = min(1.0,cPDZooRef / rPDFoodZooEpi * fDAssZoo);
wPAssZooEpi = afPAssZooEpi * wPConsZooEpi;
wPEgesZooEpi = wPConsZooEpi - wPAssZooEpi;
wPEgesZooPO4Epi = fDissEgesZoo*wPEgesZooEpi;
wPEgesZooDetEpi = wPEgesZooEpi - wPEgesZooPO4Epi;
akPExcrZooEpi = rPDZooEpi / cPDZooRef * kDRespZoo * uFunTmZooEpi;
wPExcrZooEpi = akPExcrZooEpi*oPZooEpi ;
wPMortZooEpi = rPDZooEpi * wDMortZooEpi;
wPMortZooPO4Epi = fDissMortZoo * wPMortZooEpi;
wPMortZooDetEpi = wPMortZooEpi - wPMortZooPO4Epi;
oNFoodZooEpi = cPrefDiat*oNDiatWEpi + cPrefGren*oNGrenWEpi + cPrefBlue*oNBlueWEpi + cPrefDet*oNDetWEpi;
rNDFoodZooEpi = oNFoodZooEpi /(oDFoodZooEpi+NearZero);
wNConsDiatZooEpi = rNDDiatWEpi*wDConsDiatZooEpi;
wNConsGrenZooEpi = rNDGrenWEpi*wDConsGrenZooEpi;
wNConsBlueZooEpi = rNDBlueWEpi*wDConsBlueZooEpi;
wNConsPhytZooEpi = wNConsDiatZooEpi + wNConsGrenZooEpi + wNConsBlueZooEpi;
wNConsDetZooEpi = rNDDetWEpi*wDConsDetZooEpi;
wNConsZooEpi = wNConsPhytZooEpi + wNConsDetZooEpi;
afNAssZooEpi = min(1.0,cNDZooRef / rNDFoodZooEpi * fDAssZoo);
wNAssZooEpi = afNAssZooEpi*wNConsZooEpi;
wNEgesZooEpi = wNConsZooEpi - wNAssZooEpi;
wNEgesZooNH4Epi = fDissEgesZoo*wNEgesZooEpi;
wNEgesZooDetEpi = wNEgesZooEpi - wNEgesZooNH4Epi;
kNExcrZooEpi = rNDZooEpi / cNDZooRef * kDRespZoo * uFunTmZooEpi;
wNExcrZooEpi = kNExcrZooEpi*oNZooEpi ;
wNMortZooEpi = rNDZooEpi*wDMortZooEpi;
wNMortZooNH4Epi = fDissMortZoo*wNMortZooEpi;
wNMortZooDetEpi = wNMortZooEpi - wNMortZooNH4Epi;
wSiConsDiatZooEpi = cSiDDiat * wDConsDiatZooEpi;
rPDFiJv = sPFiJv /(sDFiJv+NearZero);
rPDFiAd = sPFiAd /(sDFiAd+NearZero);
rNDFiJv = sNFiJv /(sDFiJv+NearZero);
rNDFiAd = sNFiAd /(sDFiAd+NearZero);
if (false == InclSeason) 
tDReprFish = ((1/DaysInYear)*fReprFish) * sDFiAd 
elseif (Day >= cDayReprFish && Day < cDayReprFish + 1.0) 
tDReprFish = fReprFish * sDFiAd * PerDay 
else
tDReprFish = 0.0 
end;
if (false == InclSeason) 
tDAgeFish = ((1/DaysInYear)*fAgeFish) * sDFiJv 
elseif (Day >= 364.0) 
tDAgeFish = fAgeFish * sDFiJv *PerDay 
else
tDAgeFish = 0.0 
end;
if (aInclStrat == false) 
aDTotZoo = oDZooEpi * sDepthWEpi 
else
aDTotZoo = oDZooEpi * sDepthWEpi + oDZooHyp * sDepthWHyp 
end;
if (aInclStrat == false) 
aPTotZoo = oPZooEpi * sDepthWEpi 
else
aPTotZoo = oPZooEpi * sDepthWEpi + oPZooHyp * sDepthWHyp 
end;
if (aInclStrat == false) 
aNTotZoo = oNZooEpi * sDepthWEpi 
else
aNTotZoo = oNZooEpi * sDepthWEpi + oNZooHyp * sDepthWHyp 
end;
aDSatFiJv = aDTotZoo * aDTotZoo /(hDZooFiJv * hDZooFiJv + aDTotZoo * aDTotZoo);
tDEnvFiJv = max(0.0,ukDIncrFiJv /(cDCarrFish - sDFiAd) * sDFiJv*sDFiJv);
tDAssFiJv = aDSatFiJv *(kDAssFiJv * uFunTmFish * sDFiJv - tDEnvFiJv);
tDConsFiJv = tDAssFiJv / fDAssFiJv;
tDEgesFiJv = tDConsFiJv - tDAssFiJv;
tDRespFiJv = (cPDFishRef / rPDFiJv) * kDRespFiJv * uFunTmFish * sDFiJv;
tDMortFiJv = kMortFiJv * sDFiJv +(1.0 - aDSatFiJv) * tDEnvFiJv;
tDMigrFiJv = kMigrFish *(cDFiJvIn - sDFiJv);
tDEnvFiAd = max(0.0,ukDIncrFiAd /(cDCarrFish - sDFiJv) * sDFiAd*sDFiAd);
tDAssFiAd = aDSatFiAd *(kDAssFiAd * uFunTmFish * sDFiAd - tDEnvFiAd);
tDConsFiAd = tDAssFiAd / fDAssFiAd;
tDEgesFiAd = tDConsFiAd - tDAssFiAd;
tDRespFiAd = (cPDFishRef / rPDFiAd) * kDRespFiAd * uFunTmFish * sDFiAd;
tDMortFiAd = kMortFiAd * sDFiAd +(1.0 - aDSatFiAd) * tDEnvFiAd;
tDHarvFish = ukHarvFish * sDFiAd;
tDMigrFiAd = kMigrFish *(cDFiAdIn - sDFiAd);
tDMortFiJvBot = fDBone * tDMortFiJv;
tDMortFiJvDet = tDMortFiJv - tDMortFiJvBot;
tDMortFiAdBot = fDBone * tDMortFiAd;
tDMortFiAdDet = tDMortFiAd - tDMortFiAdBot;
tPReprFish = rPDFiAd * tDReprFish;
tPAgeFish = rPDFiJv * tDAgeFish;
tPMigrFiJv = kMigrFish *(cPDFishRef * cDFiJvIn - sPFiJv);
tPConsFiJv = rPDZooEpi * tDConsFiJv;
afPAssFiJv = min(1.0,cPDFishRef / rPDZooEpi * fDAssFiJv);
tPAssFiJv = afPAssFiJv * tPConsFiJv;
tPEgesFiJv = tPConsFiJv - tPAssFiJv;
tPExcrFiJv = (rPDFiJv / cPDFishRef) * kDRespFiJv * uFunTmFish * sPFiJv;
tPMortFiJv = rPDFiJv * tDMortFiJv;
tPMigrFiAd = kMigrFish *(cPDFishRef * cDFiAdIn - sPFiAd);
tPConsFiAd = rPDBent * tDConsFiAd;
tPAssFiAd = afPAssFiAd * tPConsFiAd;
tPEgesFiAd = tPConsFiAd - tPAssFiAd;
tPExcrFiAd = (rPDFiAd / cPDFishRef) * kDRespFiAd * uFunTmFish * sPFiAd;
tPMortFiAd = rPDFiAd * tDMortFiAd;
tPHarvFish = rPDFiAd * tDHarvFish;
tPMortFiJvBot = fPBone * tPMortFiJv;
tPMortFiJvPO4 = fDissMortFish *(tPMortFiJv - tPMortFiJvBot);
tPMortFiJvDet = tPMortFiJv - tPMortFiJvBot - tPMortFiJvPO4;
tPMortFiAdBot = fPBone * tPMortFiAd;
tPMortFiAdPO4 = fDissMortFish *(tPMortFiAd - tPMortFiAdBot);
tPMortFiAdDet = tPMortFiAd - tPMortFiAdBot - tPMortFiAdPO4;
tPEgesFiJvPO4 = fDissEgesFish * tPEgesFiJv;
tPEgesFiJvDet = tPEgesFiJv - tPEgesFiJvPO4;
tPEgesFiAdPO4 = fDissEgesFish * tPEgesFiAd;
tPEgesFiAdDet = tPEgesFiAd - tPEgesFiAdPO4;
tNReprFish = rNDFiAd * tDReprFish;
tNAgeFish = rNDFiJv * tDAgeFish;
tNMigrFiJv = kMigrFish *(cNDFishRef * cDFiJvIn - sNFiJv);
tNConsFiJv = rNDZooEpi * tDConsFiJv;
afNAssFiJv = min(1.0,cNDFishRef / rNDZooEpi * fDAssFiJv);
tNAssFiJv = afNAssFiJv * tNConsFiJv;
tNEgesFiJv = tNConsFiJv - tNAssFiJv;
tNExcrFiJv = (rNDFiJv / cNDFishRef) * kDRespFiJv * uFunTmFish * sNFiJv;
tNMortFiJv = rNDFiJv * tDMortFiJv;
tNMigrFiAd = kMigrFish *(cNDFishRef * cDFiAdIn - sNFiAd);
tNConsFiAd = rNDBent * tDConsFiAd;
tNAssFiAd = afNAssFiAd * tNConsFiAd;
tNEgesFiAd = tNConsFiAd - tNAssFiAd;
tNExcrFiAd = (rNDFiAd / cNDFishRef) * kDRespFiAd * uFunTmFish * sNFiAd;
tNMortFiAd = rNDFiAd * tDMortFiAd;
tNHarvFish = rNDFiAd * tDHarvFish;
tNMortFiAdBot = fDBone * tNMortFiAd;
tNMortFiAdNH4 = fDissMortFish *(tNMortFiAd - tNMortFiAdBot);
tNMortFiAdDet = tNMortFiAd - tNMortFiAdBot - tNMortFiAdNH4;
tNMortFiJvBot = fDBone * tNMortFiJv;
tNMortFiJvNH4 = fDissMortFish *(tNMortFiJv - tNMortFiJvBot);
tNMortFiJvDet = tNMortFiJv - tNMortFiJvBot - tNMortFiJvNH4;
tNEgesFiJvNH4 = fDissEgesFish * tNEgesFiJv;
tNEgesFiJvDet = tNEgesFiJv - tNEgesFiJvNH4;
tDMigrPisc = kMigrPisc *(cDPiscIn - sDPisc);
aDFish = sDFiJv + sDFiAd;
aDSatPisc = aDFish*aDFish /(hDFishPisc*hDFishPisc + aDFish*aDFish);
tDEnvPisc = max(0.0,akDIncrPisc / aDCarrPisc * sDPisc*sDPisc);
tDAssPisc = aDSatPisc *(kDAssPisc * aFunVegPisc * uFunTmPisc * sDPisc - tDEnvPisc);
tDConsPisc = tDAssPisc / fDAssPisc;
tDEgesPisc = tDConsPisc - tDAssPisc;
tDConsFiJvPisc = sDFiJv / aDFish * tDConsPisc;
tDConsFiAdPisc = tDConsPisc - tDConsFiJvPisc;
tDRespPisc = kDRespPisc * uFunTmPisc * sDPisc;
tDMortPisc = kMortPisc * sDPisc +(1.0 - aDSatPisc) * tDEnvPisc;
tDMortPiscBot = fDBone * tDMortPisc;
tDMortPiscDet = tDMortPisc - tDMortPiscBot;
tDHarvPisc = ukHarvPisc * sDPisc;
aPPisc = cPDPisc * sDPisc;
tPConsFiJvPisc = rPDFiJv * tDConsFiJvPisc;
tPConsFiAdPisc = rPDFiAd * tDConsFiAdPisc;
tPConsPisc = tPConsFiJvPisc + tPConsFiAdPisc;
rPDFoodPisc = tPConsPisc / tDConsPisc;
afPAssPisc = min(1.0,cPDPisc / rPDFoodPisc * fDAssPisc);
tPAssPisc = afPAssPisc * tPConsPisc;
tPEgesPisc = tPConsPisc - tPAssPisc;
tPEgesPiscPO4 = fDissEgesPisc * tPEgesPisc;
tPEgesPiscDet = tPEgesPisc - tPEgesPiscPO4;
tPExcrPisc = cPDPisc * tDRespPisc;
tPMortPisc = cPDPisc * tDMortPisc;
tPMortPiscBot = fPBone * tPMortPisc;
tPMortPiscPO4 = fDissMortPisc *(tPMortPisc - tPMortPiscBot);
tPMortPiscDet = tPMortPisc - tPMortPiscBot - tPMortPiscPO4;
tPMigrPisc = kMigrPisc *(cPDPisc * cDPiscIn - aPPisc);
tPHarvPisc = cPDPisc * tDHarvPisc;
aNPisc = cNDPisc * sDPisc;
tNConsFiJvPisc = rNDFiJv * tDConsFiJvPisc;
tNConsFiAdPisc = rNDFiAd * tDConsFiAdPisc;
tNConsPisc = tNConsFiJvPisc + tNConsFiAdPisc;
rNDFoodPisc = tNConsPisc / tDConsPisc;
afNAssPisc = min(1.0,cNDPisc / rNDFoodPisc * fDAssPisc);
tNAssPisc = afNAssPisc * tNConsPisc;
tNEgesPisc = tNConsPisc - tNAssPisc;
tNEgesPiscNH4 = fDissEgesPisc * tNEgesPisc;
tNEgesPiscDet = tNEgesPisc - tNEgesPiscNH4;
tNExcrPisc = cNDPisc * tDRespPisc;
tNMortPisc = cNDPisc * tDMortPisc;
tNMortPiscBot = fDBone * tNMortPisc;
tNMortPiscNH4 = fDissMortPisc *(tNMortPisc - tNMortPiscBot);
tNMortPiscDet = tNMortPisc - tNMortPiscBot - tNMortPiscNH4;
tNMigrPisc = kMigrPisc *(cNDPisc * cDPiscIn - aNPisc);
tNHarvPisc = cNDPisc * tDHarvPisc;
if (false == InclWeb) 
tDWebBent = 0.0 
else
tDWebBent = tDMigrBent + tDAssBent - tDConsFiAd - tDRespBent - tDMortBent 
end;
if (false == InclWeb) 
tPWebBent = 0.0 
else
tPWebBent = tPMigrBent + tPAssBent - tPConsFiAd - tPExcrBent - tPMortBent 
end;
if (false == InclWeb) 
tNWebBent = 0.0 
else
tNWebBent = tNMigrBent + tNAssBent - tNConsFiAd - tNExcrBent - tNMortBent 
end;
if (false == InclWeb) 
tDWebFiJv = 0.0 
else
tDWebFiJv = tDMigrFiJv + tDReprFish - tDAgeFish + tDAssFiJv - tDRespFiJv - tDMortFiJv - tDConsFiJvPisc 
end;
if (false == InclWeb) 
tPWebFiJv = 0.0 
else
tPWebFiJv = tPMigrFiJv + tPReprFish - tPAgeFish + tPAssFiJv - tPExcrFiJv - tPMortFiJv - tPConsFiJvPisc 
end;
if (false == InclWeb) 
tNWebFiJv = 0.0 
else
tNWebFiJv = tNMigrFiJv + tNReprFish - tNAgeFish + tNAssFiJv - tNExcrFiJv - tNMortFiJv - tNConsFiJvPisc 
end;
if (false == InclWeb) 
tDWebFiAd = 0.0 
else
tDWebFiAd = tDMigrFiAd + tDAssFiAd - tDRespFiAd - tDMortFiAd - tDReprFish + tDAgeFish - tDConsFiAdPisc - tDHarvFish 
end;
if (false == InclWeb) 
tPWebFiAd = 0.0 
else
tPWebFiAd = tPMigrFiAd + tPAssFiAd - tPExcrFiAd - tPMortFiAd - tPReprFish + tPAgeFish - tPConsFiAdPisc - tPHarvFish 
end;
if (false == InclWeb) 
tNWebFiAd = 0.0 
else
tNWebFiAd = tNMigrFiAd + tNAssFiAd - tNExcrFiAd - tNMortFiAd - tNReprFish + tNAgeFish - tNConsFiAdPisc - tNHarvFish 
end;
if (false == InclWeb) 
tDWebPisc = 0.0 
else
tDWebPisc = tDMigrPisc + tDAssPisc - tDRespPisc - tDMortPisc - tDHarvPisc 
end;
if (false == InclWeb || aInclStrat == false) 
wDWebZooHyp = 0.0 
else
wDWebZooHyp = wDAssZooHyp - wDRespZooHyp - wDMortZooHyp - tDConsFiJv * (( aDTotZoo - oDZooEpi * sDepthWEpi) / (aDTotZoo + NearZero)) / sDepthWHyp 
end;
if (false == InclWeb) 
wDWebDetWHyp = 0.0 
else
wDWebDetWHyp = - wDConsDetZooHyp + wDEgesZooHyp + wDMortZooHyp +(tDEgesFiJv * uFiJvEgesHyp + tDEgesFiAd * uFiAdEgesHyp + tDMortFiJvDet * uFiJvMortHyp + tDMortFiAdDet * uFiAdMortHyp + tDEgesPisc * uPiscEgesHyp + tDMortPiscDet * uPiscMortHyp) / sDepthWHyp 
end;
if (false == InclWeb) 
wDWebDiatWHyp = 0.0 
else
wDWebDiatWHyp = - wDConsDiatZooHyp 
end;
if (false == InclWeb) 
wDWebGrenWHyp = 0.0 
else
wDWebGrenWHyp = - wDConsGrenZooHyp 
end;
if (false == InclWeb) 
wDWebBlueWHyp = 0.0 
else
wDWebBlueWHyp = - wDConsBlueZooHyp 
end;
if (false == InclWeb) 
wDWebZooEpi = 0.0 
else
wDWebZooEpi = wDAssZooEpi - wDRespZooEpi - wDMortZooEpi - tDConsFiJv * (oDZooEpi * sDepthWEpi / (aDTotZoo + NearZero) ) / sDepthWEpi 
end;
if (false == InclWeb) 
wDWebDetWEpi = 0.0 
else
wDWebDetWEpi = - wDConsDetZooEpi + wDEgesZooEpi + wDMortZooEpi +(tDEgesFiJv * ( 1.0 - uFiJvEgesHyp ) + tDEgesFiAd * ( 1.0 - uFiAdEgesHyp ) + tDMortFiJvDet * ( 1.0 - uFiJvMortHyp ) + tDMortFiAdDet * ( 1.0 - uFiAdMortHyp ) + tDEgesPisc * ( 1.0 - uPiscEgesHyp ) + tDMortPiscDet * ( 1.0 - uPiscMortHyp)) / sDepthWEpi 
end;
if (false == InclWeb) 
wDWebDiatWEpi = 0.0 
else
wDWebDiatWEpi = - wDConsDiatZooEpi 
end;
if (false == InclWeb) 
wDWebGrenWEpi = 0.0 
else
wDWebGrenWEpi = - wDConsGrenZooEpi 
end;
if (false == InclWeb) 
wDWebBlueWEpi = 0.0 
else
wDWebBlueWEpi = - wDConsBlueZooEpi 
end;
if (false == InclWeb) 
tDWebTotT = 0.0 
else
tDWebTotT = - wDRespZooEpi * sDepthWEpi + - wDRespZooHyp * sDepthWHyp + tDMigrFiJv + tDMigrFiAd + tDMigrPisc + tDMigrBent - tDRespFiJv - tDRespFiAd - tDRespPisc - tDRespBent - tDMortFiJvBot - tDMortFiAdBot- tDMortPiscBot - tDHarvFish - tDHarvPisc 
end;
if (false == InclWeb || aInclStrat == false) 
wPWebZooHyp = 0.0 
else
wPWebZooHyp = wPAssZooHyp - wPExcrZooHyp - wPMortZooHyp - tPConsFiJv * (( aPTotZoo - oPZooEpi * sDepthWEpi ) / (aPTotZoo + NearZero) ) / sDepthWHyp 
end;
if (false == InclWeb) 
wPWebPO4WHyp = 0.0 
else
wPWebPO4WHyp = wPExcrZooHyp + wPEgesZooPO4Hyp + wPMortZooPO4Hyp +(tPExcrFiJv *uFiJvExcrHyp + tPExcrFiAd * uFiAdExcrHyp + tPEgesFiJvPO4 * uFiJvEgesHyp + tPEgesFiAdPO4 * uFiAdEgesHyp + tPMortFiJvPO4 * uFiJvMortHyp + tPMortFiAdPO4 * uFiAdMortHyp+ tPExcrPisc * uPiscExcrHyp + tPEgesPiscPO4 * uPiscEgesHyp + tPMortPiscPO4 * uPiscMortHyp ) / sDepthWHyp 
end;
if (false == InclWeb) 
wPWebDetWHyp = 0.0 
else
wPWebDetWHyp = - wPConsDetZooHyp + wPEgesZooDetHyp + wPMortZooDetHyp +(tPEgesFiJvDet * uFiJvEgesHyp + tPEgesFiAdDet * uFiAdEgesHyp+ tPMortFiJvDet * uFiJvMortHyp + tPMortFiAdDet * uFiAdMortHyp+ tPEgesPiscDet * uPiscEgesHyp+ tPMortPiscDet * uPiscMortHyp) / sDepthWHyp 
end;
if (false == InclWeb) 
wPWebDiatWHyp = 0.0 
else
wPWebDiatWHyp = - wPConsDiatZooHyp 
end;
if (false == InclWeb) 
wPWebGrenWHyp = 0.0 
else
wPWebGrenWHyp = - wPConsGrenZooHyp 
end;
if (false == InclWeb) 
wPWebBlueWHyp = 0.0 
else
wPWebBlueWHyp = - wPConsBlueZooHyp 
end;
if (false == InclWeb) 
wPWebZooEpi = 0.0 
else
wPWebZooEpi = wPAssZooEpi - wPExcrZooEpi - wPMortZooEpi - tPConsFiJv * (oPZooEpi * sDepthWEpi / (aPTotZoo + NearZero)) / sDepthWEpi 
end;
if (false == InclWeb) 
wPWebPO4WEpi = 0.0 
else
wPWebPO4WEpi = wPExcrZooEpi + wPEgesZooPO4Epi + wPMortZooPO4Epi +(tPExcrFiJv * ( 1.0 -uFiJvExcrHyp ) + tPExcrFiAd * ( 1.0 - uFiAdExcrHyp )+ tPEgesFiJvPO4 * ( 1.0 - uFiJvEgesHyp ) + tPEgesFiAdPO4 * ( 1.0 - uFiAdEgesHyp ) + tPMortFiJvPO4 * ( 1.0 - uFiJvMortHyp ) + tPMortFiAdPO4 * ( 1.0 - uFiAdMortHyp )+ tPExcrPisc * ( 1.0 - uPiscExcrHyp ) + tPEgesPiscPO4 * ( 1.0 - uPiscEgesHyp ) + tPMortPiscPO4 * ( 1.0 - uPiscMortHyp)) / sDepthWEpi 
end;
if (false == InclWeb) 
wPWebDetWEpi = 0.0 
else
wPWebDetWEpi = - wPConsDetZooEpi + wPEgesZooDetEpi + wPMortZooDetEpi +(tPEgesFiJvDet * ( 1.0 - uFiJvEgesHyp ) + tPEgesFiAdDet * ( 1.0 - uFiAdEgesHyp )+ tPMortFiJvDet * ( 1.0 - uFiJvMortHyp ) + tPMortFiAdDet * ( 1.0 - uFiAdMortHyp )+ tPEgesPiscDet * ( 1.0 - uPiscEgesHyp )+ tPMortPiscDet * ( 1.0 - uPiscMortHyp )) / sDepthWEpi 
end;
if (false == InclWeb) 
wPWebDiatWEpi = 0.0 
else
wPWebDiatWEpi = - wPConsDiatZooEpi 
end;
if (false == InclWeb) 
wPWebGrenWEpi = 0.0 
else
wPWebGrenWEpi = - wPConsGrenZooEpi 
end;
if (false == InclWeb) 
wPWebBlueWEpi = 0.0 
else
wPWebBlueWEpi = - wPConsBlueZooEpi 
end;
if (false == InclWeb) 
tPWebTotT = 0.0 
else
tPWebTotT = tPMigrFiJv + tPMigrFiAd + tPMigrPisc + tPMigrBent - tPMortFiJvBot - tPMortFiAdBot- tPMortPiscBot - tPHarvFish - tPHarvPisc 
end;
tNEgesFiAdNH4 = fDissEgesFish * tNEgesFiAd;
tNEgesFiAdDet = tNEgesFiAd - tNEgesFiAdNH4;
if (false == InclWeb) 
wNWebNO3WHyp = 0.0 
else
wNWebNO3WHyp = 0.0 
end;
if (false == InclWeb) 
wNWebNO3WEpi = 0.0 
else
wNWebNO3WEpi = 0.0 
end;
if (false == InclWeb || aInclStrat == false) 
wNWebZooHyp = 0.0 
else
wNWebZooHyp = wNAssZooHyp - wNExcrZooHyp - wNMortZooHyp - tNConsFiJv * (( aNTotZoo -oNZooEpi * sDepthWEpi ) / (aNTotZoo + NearZero) ) / sDepthWHyp 
end;
if (false == InclWeb) 
wNWebNH4WHyp = 0.0 
else
wNWebNH4WHyp = wNExcrZooHyp + wNEgesZooNH4Hyp + wNMortZooNH4Hyp +(tNExcrFiJv * uFiJvExcrHyp + tNExcrFiAd * uFiAdExcrHyp + tNEgesFiJvNH4 * uFiJvEgesHyp+ tNEgesFiAdNH4 * uFiAdEgesHyp + tNMortFiAdNH4 *uFiAdMortHyp+ tNMortFiJvNH4*uFiJvMortHyp + tNExcrPisc *uPiscExcrHyp + tNEgesPiscNH4 *uPiscEgesHyp + tNMortPiscNH4 *uPiscMortHyp) / sDepthWHyp 
end;
if (false == InclWeb) 
wNWebDetWHyp = 0.0 
else
wNWebDetWHyp = - wNConsDetZooHyp + wNEgesZooDetHyp + wNMortZooDetHyp +(tNEgesFiJvDet * uFiJvEgesHyp +tNEgesFiAdDet * uFiAdEgesHyp+ tNMortFiJvDet * uFiJvMortHyp + tNMortFiAdDet * uFiAdMortHyp + tNEgesPiscDet * uPiscEgesHyp + tNMortPiscDet * uPiscMortHyp) / sDepthWHyp 
end;
if (false == InclWeb) 
wNWebDiatWHyp = 0.0 
else
wNWebDiatWHyp = - wNConsDiatZooHyp 
end;
if (false == InclWeb) 
wNWebGrenWHyp = 0.0 
else
wNWebGrenWHyp = - wNConsGrenZooHyp 
end;
if (false == InclWeb) 
wNWebBlueWHyp = 0.0 
else
wNWebBlueWHyp = - wNConsBlueZooHyp 
end;
if (false == InclWeb) 
wNWebZooEpi = 0.0 
else
wNWebZooEpi = wNAssZooEpi - wNExcrZooEpi - wNMortZooEpi - tNConsFiJv * (oNZooEpi * sDepthWEpi / (aNTotZoo + NearZero) ) / sDepthWEpi 
end;
if (false == InclWeb) 
wNWebNH4WEpi = 0.0 
else
wNWebNH4WEpi = wNExcrZooEpi + wNEgesZooNH4Epi + wNMortZooNH4Epi +(tNExcrFiJv * ( 1.0 - uFiJvExcrHyp) + tNExcrFiAd * ( 1.0 - uFiAdExcrHyp) + tNEgesFiJvNH4 * ( 1.0 - uFiJvEgesHyp ) + tNEgesFiAdNH4 * ( 1.0 - uFiAdEgesHyp ) + tNMortFiAdNH4 * ( 1.0 -uFiAdMortHyp ) + tNMortFiJvNH4* ( 1.0 -uFiJvMortHyp) + tNExcrPisc * ( 1.0 -uPiscExcrHyp ) + tNEgesPiscNH4 * ( 1.0 -uPiscEgesHyp ) + tNMortPiscNH4 * ( 1.0 -uPiscMortHyp)) / sDepthWEpi 
end;
if (false == InclWeb) 
wNWebDetWEpi = 0.0 
else
wNWebDetWEpi = - wNConsDetZooEpi + wNEgesZooDetEpi + wNMortZooDetEpi +(tNEgesFiJvDet * ( 1.0 - uFiJvEgesHyp ) +tNEgesFiAdDet * ( 1.0 - uFiAdEgesHyp ) + tNMortFiJvDet * ( 1.0 - uFiJvMortHyp ) + tNMortFiAdDet * ( 1.0 - uFiAdMortHyp ) + tNEgesPiscDet * ( 1.0 - uPiscEgesHyp ) + tNMortPiscDet * ( 1.0 - uPiscMortHyp )) / sDepthWEpi 
end;
if (false == InclWeb) 
wNWebDiatWEpi = 0.0 
else
wNWebDiatWEpi = - wNConsDiatZooEpi 
end;
if (false == InclWeb) 
wNWebGrenWEpi = 0.0 
else
wNWebGrenWEpi = - wNConsGrenZooEpi 
end;
if (false == InclWeb) 
wNWebBlueWEpi = 0.0 
else
wNWebBlueWEpi = - wNConsBlueZooEpi 
end;
if (false == InclWeb) 
tNWebTotT = 0.0 
else
tNWebTotT = tNMigrFiJv + tNMigrFiAd + tNMigrPisc + tNMigrBent - tNMortFiJvBot- tNMortFiAdBot - tNMortPiscBot - tNHarvFish - tNHarvPisc 
end;
if (false == InclWeb) 
wSiWebDetWEpi = 0.0 
else
wSiWebDetWEpi = wSiConsDiatZooEpi 
end;
aPrefAveEpi = (cPrefDiat * oDDiatWEpi + cPrefGren * oDGrenWEpi + cPrefBlue * oDBlueWEpi + cPrefDet * oDDetWEpi) / oDOMWEpi;
wDConsZoo2Epi = aFiltEpi * aPrefAveEpi * oDOMWEpi * oDZooEpi;
aDConsZooSpEpi = wDConsZooEpi / oDZooEpi;
aDAssZooSpEpi = wDAssZooEpi / oDZooEpi;
aDGrazSpEpi = wDConsZooEpi / oDOMWEpi;
aPConsZooSpEpi = wPConsZooEpi / oPZooEpi;
aPGrazSpEpi = wPConsZooEpi / oPOMWEpi;
aNConsZooSpEpi = wNConsZooEpi / oNZooEpi;
aNGrazSpEpi = wNConsZooEpi / oNOMWEpi;
tDSetTotEpi = tDSetIMEpi + tDSetDetEpi + tDSetPhytEpi;
tPSetTotEpi = tPSetAIMEpi + tPSetDetEpi + tPSetPhytEpi;
tNSetTotEpi = tNSetDetEpi + tNSetPhytEpi;
tDResusTot = tDResusDead + tDResusPhytTot;
tPResusTot = tPResusDet + tPResusAIM + tPResusPhyt + tPResusPO4;
tNResusTot = tNResusDet + tNResusNH4 + tNResusNO3 + tNResusPhyt;
if (sTime == bTimeDred) 
aDepthStart = uDepthW 
else
aDepthStart = aDepthStart 
end;
if ((sTime >= bTimeDred) && (sTime < bTimeDred + cLengDred) && (aDepthStart <= cDepthRef - cDepthS)) 
akDredDepth = (log(cDepthRef / aDepthStart)) / cLengDred 
else
akDredDepth = 0.0 
end;
if ((sTime >= bTimeDred) && (sTime < bTimeDred + cLengDred) && (aDepthStart <= cDepthRef - cDepthS)) 
akDred = (- log(1.0 - fEffDred)) / cLengDred 
else
akDred = 0.0 
end;
if ((sTime >= bTimeDred) && (sTime < bTimeDred + cLengDred) && (aDepthStart <= cDepthRef - cDepthS)) 
akDredBent = (- log(1.0 - fEffDredBent)) / cLengDred 
else
akDredBent = 0.0 
end;
if (aInclStrat == true) 
vDredDepthW = 0.0 
else
vDredDepthW = akDredDepth * uDepthW 
end;
tDDredDetS = akDred * sDDetS;
tPDredDetS = akDred * sPDetS;
tNDredDetS = akDred * sNDetS;
tSiDredDetS = akDred * sSiDetS;
tPDredAIMS = akDred * sPAIMS;
tDDredNetSoil = -(tDDredDetS / cRhoOM) * bRhoSolidSoil;
tDDredNetIMS = (1.0 - fDOrgSoil) * tDDredNetSoil;
tDDredNetHumS = fDOrgSoil * tDDredNetSoil;
tPDredNetHumS = cPDSoilOM * tDDredNetHumS;
tNDredNetHumS = cNDSoilOM * tDDredNetHumS;
tDDredDiatS = akDred * sDDiatS;
tPDredDiatS = akDred * sPDiatS;
tNDredDiatS = akDred * sNDiatS;
tDDredGrenS = akDred * sDGrenS;
tPDredGrenS = akDred * sPGrenS;
tNDredGrenS = akDred * sNGrenS;
tDDredBlueS = akDred * sDBlueS;
tPDredBlueS = akDred * sPBlueS;
tNDredBlueS = akDred * sNBlueS;
tDDredPhytS = tDDredDiatS+tDDredGrenS+tDDredBlueS;
tPDredPhytS = tPDredDiatS+tPDredGrenS+tPDredBlueS;
tNDredPhytS = tNDredDiatS+tNDredGrenS+tNDredBlueS;
if (InclWeb == true) 
tDDredBent = akDredBent * sDBent 
else
tDDredBent = 0.0 
end;
if (InclWeb == true) 
tPDredBent = akDredBent * sPBent 
else
tPDredBent = 0.0 
end;
if (InclWeb == true) 
tNDredBent = akDredBent * sNBent 
else
tNDredBent = 0.0 
end;
tDDredVeg = akDred * sDVeg;
tPDredVeg = akDred * sPVeg;
tNDredVeg = akDred * sNVeg;
tDDredNetTot = tDDredDetS - tDDredNetSoil + tDDredPhytS + tDDredBent + tDDredVeg;
tPDredNetTot = tPDredDetS - tPDredNetHumS + tPDredAIMS + tPDredPhytS + tPDredBent + tPDredVeg;
tNDredNetTot = tNDredDetS - tNDredNetHumS + tNDredPhytS + tNDredBent + tNDredVeg;
tSiDredTot = tSiDredDetS + cSiDDiat * tDDredDiatS;
tDIMS = tDAbioIMS;
tDHumS = tDAbioHumS;
tDDetS = tDAbioDetS + tDPrimDetS + tDWebDetS + tDBedDetSEpi + tDBedDetSHyp;
vDeltaS = (tDIMS / cRhoIM +(tDHumS + tDDetS) / cRhoOM)/(1.0 - bPorS);
if (ConstDepth == true ) 
vDeltaW = 0.0 
else
vDeltaW = - vDeltaS 
end;
if (InclBur == false) 
tDBurIM = 0.0 
elseif (vDeltaS >= 0.0) 
tDBurIM = ((tDHumS + tDDetS) +(cRhoOM / cRhoIM) * tDIMS) / ((sDHumS + sDDetS) / sDIMS + cRhoOM / cRhoIM) 
else
tDBurIM = ((tDHumS + tDDetS) +(cRhoOM / cRhoIM) * tDIMS) / (fDOrgSoil /(1.0 - fDOrgSoil) + cRhoOM / cRhoIM) 
end;
if (InclBur == false) 
tDBurOM = 0.0 
elseif (vDeltaS >= 0.0) 
tDBurOM = (sDHumS + sDDetS) / sDIMS * tDBurIM 
else
tDBurOM = fDOrgSoil /(1.0 - fDOrgSoil) * tDBurIM 
end;
if (InclBur == false) 
tDBurDet = 0.0 
elseif (vDeltaS >= 0.0) 
tDBurDet = sDDetS /(sDHumS + sDDetS) * tDBurOM 
else
tDBurDet = 0.0 
end;
if (InclBur == false) 
tDBurHum = 0.0 
elseif (vDeltaS >= 0.0) 
tDBurHum = tDBurOM - tDBurDet 
else
tDBurHum = tDBurOM 
end;
if (InclBur == false) 
tDBurTot = 0.0 
elseif(vDeltaS >= 0.0) 
tDBurTot = tDBurIM + tDBurOM 
else
tDBurTot = tDBurIM + tDBurOM 
end;
if (InclBur == false) 
tPBurHum = 0.0 
elseif (vDeltaS >= 0.0) 
tPBurHum = rPDHumS * tDBurHum 
else
tPBurHum = cPDSoilOM * tDBurHum 
end;
if (InclBur == false) 
tPBurDet = 0.0 
elseif(vDeltaS >= 0.0) 
tPBurDet = rPDDetS * tDBurDet 
else
tPBurDet = 0.0 
end;
if (InclBur == false) 
tPBurAIM = 0.0 
elseif (vDeltaS >= 0.0) 
tPBurAIM = sPAIMS / sDIMS * tDBurIM 
else
tPBurAIM = 0.0 
end;
if (InclBur == false) 
tPBurPO4 = 0.0 
elseif (vDeltaS >= 0.0) 
tPBurPO4 = sPO4S *(vDeltaS / cDepthS) 
else
tPBurPO4 = cPO4Ground *(bPorS * vDeltaS) 
end;
if (InclBur == false) 
tPBurTot = 0.0 
elseif (vDeltaS >= 0.0) 
tPBurTot = tPBurDet + tPBurHum + tPBurAIM + tPBurPO4 
else
tPBurTot = tPBurHum + tPBurAIM + tPBurPO4 
end;
if (InclBur == false) 
tNBurHum = 0.0 
elseif (vDeltaS >= 0.0) 
tNBurHum = rNDHumS * tDBurHum 
else
tNBurHum = cNDSoilOM * tDBurHum 
end;
if (InclBur == false) 
tNBurDet = 0.0 
elseif (vDeltaS >= 0.0) 
tNBurDet = rNDDetS * tDBurDet 
else
tNBurDet = 0.0 
end;
if (InclBur == false) 
tNBurNH4 = 0.0 
elseif (vDeltaS >= 0.0) 
tNBurNH4 = sNH4S *(vDeltaS / cDepthS) 
else
tNBurNH4 = cNH4Ground *(bPorS * vDeltaS) 
end;
if (InclBur == false) 
tNBurNO3 = 0.0 
elseif (vDeltaS >= 0.0) 
tNBurNO3 = sNO3S *(vDeltaS / cDepthS) 
else
tNBurNO3 = cNO3Ground *(bPorS * vDeltaS) 
end;
if (InclBur == false) 
tNBurTot = 0.0 
elseif (vDeltaS >= 0.0) 
tNBurTot = tNBurDet + tNBurHum + tNBurNH4 + tNBurNO3 
else
tNBurTot = tNBurHum + tNBurNH4 + tNBurNO3 
end;
if (InclBur == false) 
tSiBurDet = 0.0 
elseif (vDeltaS >= 0.0) 
tSiBurDet = rSiDDetS * tDBurDet 
else
tSiBurDet = 0.0 
end;
if (InclBur == false) 
tSiBurTot = 0.0 
elseif (vDeltaS >= 0.0) 
tSiBurTot = tSiBurDet 
else
tSiBurTot = 0.0 
end;
if ( aInclStrat == true ) 
aRelDeltaWEpi = (vDeltaW ) / sDepthWEpi 
else
aRelDeltaWEpi = (vDeltaW + vDredDepthW) / sDepthWEpi 
end;
if ( aInclStrat == false ) 
aRelDeltaWHyp = 0.0 
else
aRelDeltaWHyp = (vDredDepthW) / sDepthWHyp 
end;
aPFish = sPFiJv + sPFiAd;
aNFish = sNFiJv + sNFiAd;
aDRelTotT = sDepthWHyp * aRelDeltaWHyp * ( oDDetWHyp + oDIMWHyp + oDDiatWHyp + oDGrenWHyp + oDBlueWHyp + oDZooHyp ) + fMarsh * sDepthWM * aRelDeltaWM * ( oDDetWM + oDIMWM + oDDiatWM + oDGrenWM + oDBlueWM + oDZooM) + sDepthWEpi * aRelDeltaWEpi * (oDDetWEpi + oDIMWEpi + oDDiatWEpi + oDGrenWEpi + oDBlueWEpi + oDZooEpi );
aNRelTotT = sDepthWHyp * aRelDeltaWHyp * ( oNH4WHyp + oNO3WHyp + oNDetWHyp + oNDiatWHyp + oNGrenWHyp + oNBlueWHyp + oNZooHyp ) + fMarsh * sDepthWM * aRelDeltaWM * ( oNH4WM + oNO3WM + oNDetWM + oNDiatWM + oNGrenWM + oNBlueWM + oNZooM ) + sDepthWEpi * aRelDeltaWEpi * ( oNH4WEpi + oNO3WEpi + oNDetWEpi + oNDiatWEpi + oNGrenWEpi + oNBlueWEpi + oNZooEpi );
aPRelTotT = sDepthWHyp * aRelDeltaWHyp * ( oPO4WHyp + oPAIMWHyp + oPDetWHyp + oPDiatWHyp + oPGrenWHyp + oPBlueWHyp + oPZooHyp ) + fMarsh * sDepthWM * aRelDeltaWM * (oPO4WM + oPAIMWM + oPDetWM + oPDiatWM + oPGrenWM + oPBlueWM + oPZooM ) + sDepthWEpi * aRelDeltaWEpi * (oPO4WEpi + oPAIMWEpi + oPDetWEpi + oPDiatWEpi + oPGrenWEpi + oPBlueWEpi + oPZooEpi );
aSiRelTotT = sDepthWHyp * aRelDeltaWHyp * ( oSiO2WHyp + oSiDetWHyp + cSiDDiat*oDDiatWHyp) + fMarsh * sDepthWM * aRelDeltaWM * ( oSiO2WM + oSiDetWM + cSiDDiat*oDDiatWM) + sDepthWEpi * aRelDeltaWEpi * ( oSiO2WEpi + oSiDetWEpi + cSiDDiat*oDDiatWEpi);
aO2RelTotT = sDepthWHyp * aRelDeltaWHyp* oO2WHyp + fMarsh * sDepthWM * aRelDeltaWM * oO2WM + sDepthWEpi * aRelDeltaWEpi * oO2WEpi ;
if (aInclStrat == true) 
aDTotTHyp = (oDIMWHyp+oDDetWHyp+oDDiatWHyp+oDGrenWHyp+oDBlueWHyp+oDZooHyp) * sDepthWHyp 
else
aDTotTHyp = 0.0 
end;
if (aInclStrat == true) 
aNTotTHyp = (oNH4WHyp+oNO3WHyp+oNDetWHyp+oNDiatWHyp+oNGrenWHyp+oNBlueWHyp +oNZooHyp)*sDepthWHyp 
else
aNTotTHyp = 0.0 
end;
if (aInclStrat == true) 
aPTotTHyp = (oPO4WHyp+oPDetWHyp+oPDiatWHyp+oPGrenWHyp+oPBlueWHyp +oPZooHyp+oPAIMWHyp) * sDepthWHyp 
else
aPTotTHyp = 0.0 
end;
if (aInclStrat == true) 
aSiTotTHyp = (oSiO2WHyp + oSiDetWHyp + cSiDDiat*oDDiatWHyp) *sDepthWHyp 
else
aSiTotTHyp = 0.0 
end;
if (aInclStrat == true) 
aO2TotTHyp = (oO2WHyp ) *sDepthWHyp 
else
aO2TotTHyp = 0.0 
end;
aDTotT = aDTotTHyp + (oDIMWEpi+oDDetWEpi+oDDiatWEpi+oDGrenWEpi+oDBlueWEpi+oDZooEpi) * sDepthWEpi +aDFish+sDPisc+aDVeg +sDIMS+sDHumS+sDDetS+sDDiatS+sDGrenS+sDBlueS+sDBent + aDTotM;
aNTotT = aNTotTHyp+ (oNH4WEpi+oNO3WEpi+oNDetWEpi+oNDiatWEpi+oNGrenWEpi+oNBlueWEpi +oNZooEpi)*sDepthWEpi +aNFish+aNPisc+aNVeg +sNH4S+sNO3S+sNDetS+sNHumS+sNDiatS+sNGrenS+sNBlueS +sNBent + aNTotM;
aPTotT = aPTotTHyp + (oPO4WEpi+oPDetWEpi+oPDiatWEpi+oPGrenWEpi+oPBlueWEpi +oPZooEpi+oPAIMWEpi) * sDepthWEpi +aPFish+aPPisc+aPVeg +sPO4S+sPDetS+sPHumS+sPDiatS+sPGrenS+sPBlueS +sPAIMS+sPBent + aPTotM;
aSiTotT = aSiTotTHyp + (oSiO2WEpi + oSiDetWEpi + cSiDDiat*oDDiatWEpi) *sDepthWEpi + sSiDetS + cSiDDiat*sDDiatS + aSiTotM;
aO2TotT = aO2TotTHyp + ( oO2WEpi) *sDepthWEpi + aO2TotM;
if InclVeg == true 
tDBedTotT = tDMigrVeg + tDProdVegHyp+ tDProdVegEpi - tDRespVeg - tDManVeg - tDAssVegBird 
else
tDBedTotT = 0.0 
end;
if InclVeg == true 
tPBedTotT = tPMigrVeg - tPManVeg - tPAssVegBird 
else
tPBedTotT = 0.0 
end;
if InclVeg == true 
tNBedTotT = tNMigrVeg - tNManVeg - tNAssVegBird 
else
tNBedTotT = 0.0 
end;
aDError = aDTotT - sDExtTotT;
aNError = aNTotT - sNExtTotT;
aPError = aPTotT - sPExtTotT;
aSiError = aSiTotT - sSiExtTotT;
aO2Error = aO2TotT - sO2ExtTotT;
if (aInclStrat == true) 
dDepthWHyp = vDeltaWHyp + vDredDepthW - vTranHypEpiW 
else
dDepthWHyp = 0.0 
end;
dNH4WHyp = ( wNTranNH4WHyp + wNAbioNH4WHyp + wNPrimNH4WHyp + wNBedNH4WHyp + wNWebNH4WHyp + uNBackLoadHyp / sDepthWHyp - aRelDeltaWHyp * oNH4WHyp - wNExchNH4Hyp - wNExchNH4WHyp ) * MassHyp;
dNO3WHyp = ( wNTranNO3WHyp + wNAbioNO3WHyp + wNPrimNO3WHyp + wNBedNO3WHyp + wNWebNO3WHyp - aRelDeltaWHyp * oNO3WHyp - wNExchNO3Hyp - wNExchNO3WHyp ) * MassHyp;
dPO4WHyp = ( wPTranPO4WHyp + wPAbioPO4WHyp + wPPrimPO4WHyp + wPBedPO4WHyp + wPWebPO4WHyp + uPBackLoadHyp / sDepthWHyp - aRelDeltaWHyp * oPO4WHyp - wPExchPO4Hyp - wPExchPO4WHyp ) * MassHyp;
dPAIMWHyp = ( wPTranAIMWHyp + wPAbioAIMWHyp - aRelDeltaWHyp * oPAIMWHyp - wPExchAIMHyp - wPExchAIMWHyp ) * MassHyp;
dSiO2WHyp = ( wSiTranSiO2Hyp + wSiAbioSiO2WHyp + wSiPrimSiO2WHyp - aRelDeltaWHyp * oSiO2WHyp - wSiExchSiO2Hyp - wSiExchSiO2WHyp ) * MassHyp;
dO2WHyp = ( wO2TranWHyp + wO2AbioWHyp + wO2PrimWHyp - tO2PrimSHyp + tO2BedWHyp / sDepthWHyp - aRelDeltaWHyp* oO2WHyp - wO2ExchHyp - wO2ExchWHyp ) * MassHyp;
dDDetWHyp = ( wDTranDetWHyp + wDAbioDetWHyp + wDPrimDetWHyp + wDBedDetWHyp + wDWebDetWHyp - aRelDeltaWHyp * oDDetWHyp - wDExchDetHyp - wDExchDetWHyp ) * MassHyp;
dNDetWHyp = ( wNTranDetWHyp + wNAbioDetWHyp + wNPrimDetWHyp + wNBedDetWHyp + wNWebDetWHyp -aRelDeltaWHyp * oNDetWHyp - wNExchDetHyp - wNExchDetWHyp ) * MassHyp;
dPDetWHyp = ( wPTranDetWHyp + wPAbioDetWHyp + wPPrimDetWHyp + wPBedDetWHyp + wPWebDetWHyp - aRelDeltaWHyp * oPDetWHyp - wPExchDetHyp - wPExchDetWHyp ) * MassHyp;
dSiDetWHyp = ( wSiTranDetWHyp + wSiAbioDetWHyp + wSiPrimDetWHyp + wSiWebDetWHyp - aRelDeltaWHyp * oSiDetWHyp - wSiExchDetHyp - wSiExchDetWHyp ) * MassHyp;
dDIMWHyp = ( wDTranIMWHyp + wDAbioIMWHyp - aRelDeltaWHyp * oDIMWHyp - wDExchIMHyp - wDExchIMWHyp ) * MassHyp;
dDDiatWHyp = ( wDTranDiatHyp + wDPrimDiatWHyp + wDWebDiatWHyp - aRelDeltaWHyp * oDDiatWHyp - wDExchDiatHyp - wDExchDiatWHyp ) * MassHyp;
dNDiatWHyp = ( wNTranDiatHyp + wNPrimDiatWHyp + wNWebDiatWHyp -aRelDeltaWHyp * oNDiatWHyp - wNExchDiatHyp - wNExchDiatWHyp ) * MassHyp;
dPDiatWHyp = ( wPTranDiatHyp + wPPrimDiatWHyp + wPWebDiatWHyp -aRelDeltaWHyp * oPDiatWHyp - wPExchDiatHyp - wPExchDiatWHyp ) * MassHyp;
dDGrenWHyp = ( wDTranGrenHyp + wDPrimGrenWHyp + wDWebGrenWHyp - aRelDeltaWHyp* oDGrenWHyp - wDExchGrenHyp - wDExchGrenWHyp ) * MassHyp;
dNGrenWHyp = ( wNTranGrenHyp + wNPrimGrenWHyp + wNWebGrenWHyp - aRelDeltaWHyp * oNGrenWHyp - wNExchGrenHyp - wNExchGrenWHyp ) * MassHyp;
dPGrenWHyp = ( wPTranGrenHyp + wPPrimGrenWHyp + wPWebGrenWHyp - aRelDeltaWHyp * oPGrenWHyp - wPExchGrenHyp - wPExchGrenWHyp ) * MassHyp;
dDBlueWHyp = ( wDTranBlueHyp + wDPrimBlueWHyp + wDWebBlueWHyp - aRelDeltaWHyp* oDBlueWHyp - wDExchBlueHyp - wDExchBlueWHyp ) * MassHyp;
dNBlueWHyp = ( wNTranBlueHyp + wNPrimBlueWHyp + wNWebBlueWHyp - aRelDeltaWHyp * oNBlueWHyp - wNExchBlueHyp - wNExchBlueWHyp ) * MassHyp;
dPBlueWHyp = ( wPTranBlueHyp + wPPrimBlueWHyp + wPWebBlueWHyp -aRelDeltaWHyp * oPBlueWHyp - wPExchBlueHyp - wPExchBlueWHyp ) * MassHyp;
dDZooHyp = ( wDTranZooHyp + wDWebZooHyp - aRelDeltaWHyp * oDZooHyp - wDExchZooHyp - wDExchZooWHyp ) * MassHyp;
dNZooHyp = ( wNTranZooHyp + wNWebZooHyp -aRelDeltaWHyp * oNZooHyp - wNExchZooHyp - wNExchZooWHyp ) * MassHyp;
dPZooHyp = ( wPTranZooHyp + wPWebZooHyp - aRelDeltaWHyp * oPZooHyp - wPExchZooHyp - wPExchZooWHyp ) * MassHyp;
dDFiAd = tDWebFiAd;
dDFiJv = tDWebFiJv;
dNFiAd = tNWebFiAd;
dNFiJv = tNWebFiJv;
dPFiAd = tPWebFiAd;
dPFiJv = tPWebFiJv;
dDPisc = tDWebPisc;
dNH4S = tNAbioNH4S - tNBurNH4 + tNPrimNH4S + tNBedNH4S + tNWebNH4S;
dNO3S = tNAbioNO3S - tNBurNO3 + tNPrimNO3S + tNBedNO3S + tNWebNO3S;
dPO4S = tPAbioPO4S - tPBurPO4 + tPPrimPO4S + tPBedPO4S + tPWebPO4S;
dPAIMS = tPAbioAIMS - tPBurAIM - tPDredAIMS;
dDDetS = tDAbioDetS - tDBurDet + tDPrimDetS + tDBedDetSEpi + tDBedDetSHyp + tDWebDetS - tDDredDetS;
dNDetS = tNAbioDetS - tNBurDet + tNPrimDetS + tNBedDetS + tNWebDetS - tNDredDetS;
dPDetS = tPAbioDetS - tPBurDet + tPPrimDetS + tPBedDetS + tPWebDetS - tPDredDetS;
dSiDetS = tSiAbioDetS - tSiBurDet + tSiPrimDetS + tSiWebDetS - tSiDredDetS;
dDHumS = tDAbioHumS - tDBurHum - tDDredNetHumS;
dNHumS = tNAbioHumS - tNBurHum - tNDredNetHumS;
dPHumS = tPAbioHumS - tPBurHum - tPDredNetHumS;
dDIMS = tDAbioIMS - tDBurIM - tDDredNetIMS;
dDDiatS= tDPrimDiatS + tDWebDiatS - tDDredDiatS;
dNDiatS= tNPrimDiatS + tNWebDiatS - tNDredDiatS;
dPDiatS= tPPrimDiatS + tPWebDiatS - tPDredDiatS;
dDGrenS= tDPrimGrenS + tDWebGrenS - tDDredGrenS;
dNGrenS= tNPrimGrenS + tNWebGrenS - tPDredGrenS;
dPGrenS= tPPrimGrenS + tPWebGrenS - tPDredGrenS;
dDBlueS= tDPrimBlueS + tDWebBlueS - tDDredBlueS;
dNBlueS= tNPrimBlueS + tNWebBlueS - tNDredBlueS;
dPBlueS=tPPrimBlueS + tPWebBlueS - tPDredBlueS;
dDVeg = tDBedVeg - tDDredVeg;
dNVeg = tNBedVeg - tNDredVeg;
dPVeg = tPBedVeg - tPDredVeg;
dDBent = tDWebBent - tDDredBent;
dNBent = tNWebBent - tNDredBent;
dPBent = tPWebBent - tPDredBent;
if (InclMarsh == true && fMarsh > NearZero) 
dDepthWM = vTranDepthW + vDeltaWM 
else
dDepthWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
dNH4WM = ( tNDifNH4M/sDepthWM - wNNitrWM + wNMinDetWM - tNEvNH4WM/sDepthWM - tNInfNH4WM/sDepthWM + wNExchNH4MEpi + wNExchNH4MHyp - aRelDeltaWM * oNH4WM) * MassWM 
else
dNH4WM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
dNO3WM = ( tNDifNO3M/sDepthWM + wNNitrWM - wNDenitWM - tNEvNO3WM/sDepthWM - tNInfNO3WM/sDepthWM + wNExchNO3MEpi + wNExchNO3MHyp- aRelDeltaWM * oNO3WM) * MassWM 
else
dNO3WM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
dPO4WM = ( - tPInfPO4WM / sDepthWM + tPDifPO4M / sDepthWM + wPMinDetWM - tPEvPO4WM / sDepthWM - wPSorpIMWM + wPExchPO4MEpi + wPExchPO4MHyp - aRelDeltaWM * oPO4WM) * MassWM 
else
dPO4WM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
dPAIMWM = ( - tPSetAIMM / sDepthWM + wPSorpIMWM + wPExchAIMMEpi+ wPExchAIMMHyp - aRelDeltaWM * oPAIMWM) * MassWM 
else
dPAIMWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
dSiO2WM = ( wSiMinDetWM + tSiMinDetSM / sDepthWM + wSiExchSiO2MEpi + wSiExchSiO2MHyp- aRelDeltaWM * oSiO2WM) * MassWM 
else
dSiO2WM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
dO2WM = ( wO2AbioM + wO2ExchMEpi + wO2ExchMHyp - aRelDeltaWM * oO2WM - tO2FlowPhra / sDepthWM) * MassWM 
else
dO2WM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
dDDetWM = ( tDMortShootPhra/sDepthWM - tDSetDetM/sDepthWM - wDMinDetWM + wDExchDetMEpi + wDExchDetMHyp- aRelDeltaWM * oDDetWM) * MassWM 
else
dDDetWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
dNDetWM = ( tNMortShootPhra / sDepthWM - tNSetDetM / sDepthWM - wNMinDetWM + wNExchDetMEpi + wNExchDetMHyp - aRelDeltaWM * oNDetWM) * MassWM 
else
dNDetWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
dPDetWM = ( tPMortShootPhra / sDepthWM - tPSetDetM / sDepthWM - wPMinDetWM + wPExchDetMEpi + wPExchDetMHyp - aRelDeltaWM * oPDetWM) * MassWM 
else
dPDetWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
dSiDetWM = ( - tSiSetDetM / sDepthWM - wSiMinDetWM + wSiExchDetMEpi + wSiExchDetMHyp - aRelDeltaWM * oSiDetWM) * MassWM 
else
dSiDetWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
dDIMWM = ( - tDSetIMM/sDepthWM + wDExchIMMEpi + wDExchIMMHyp - aRelDeltaWM * oDIMWM) * MassWM 
else
dDIMWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
dDDiatWM = ( wDExchDiatMEpi +wDExchDiatMHyp - tDSetDiatM / sDepthWM - aRelDeltaWM * oDDiatWM) * MassWM 
else
dDDiatWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
dNDiatWM = ( wNExchDiatMEpi + wNExchDiatMHyp - tNSetDiatM / sDepthWM - aRelDeltaWM * oNDiatWM) * MassWM 
else
dNDiatWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
dPDiatWM = ( wPExchDiatMEpi +wPExchDiatMHyp - tPSetDiatM / sDepthWM - aRelDeltaWM * oPDiatWM) * MassWM 
else
dPDiatWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
dDGrenWM = ( wDExchGrenMEpi + wDExchGrenMHyp- tDSetGrenM / sDepthWM - aRelDeltaWM * oDGrenWM) * MassWM 
else
dDGrenWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
dNGrenWM = ( wNExchGrenMEpi + wNExchGrenMHyp - tNSetGrenM / sDepthWM - aRelDeltaWM * oNGrenWM) * MassWM 
else
dNGrenWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
dPGrenWM = ( wPExchGrenMEpi + wPExchGrenMHyp - tPSetGrenM / sDepthWM - aRelDeltaWM * oPGrenWM) * MassWM 
else
dPGrenWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
dDBlueWM = ( wDExchBlueMEpi + wDExchBlueMHyp- tDSetBlueM / sDepthWM - aRelDeltaWM * oDBlueWM) * MassWM 
else
dDBlueWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
dNBlueWM = ( wNExchBlueMEpi + wNExchBlueMHyp - tNSetBlueM / sDepthWM - aRelDeltaWM * oNBlueWM) * MassWM 
else
dNBlueWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
dPBlueWM = ( wPExchBlueMEpi + wPExchBlueMHyp - tPSetBlueM / sDepthWM - aRelDeltaWM * oPBlueWM) * MassWM 
else
dPBlueWM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
dDZooM = ( wDExchZooMEpi + wDExchZooMHyp - aRelDeltaWM * oDZooM) * MassWM 
else
dDZooM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
dNZooM = ( wNExchZooMEpi + wNExchZooMHyp - aRelDeltaWM * oNZooM) * MassWM 
else
dNZooM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
dPZooM = ( wPExchZooMEpi + wPExchZooMHyp - aRelDeltaWM * oPZooM) * MassWM 
else
dPZooM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
dNH4SM = tNInfNH4WM - tNInfNH4SM +(1.0-fRefrDetS) * tNMinDetSM + tNMinHumSM - tNDifNH4M - tNDifGroundNH4M - tNNitrSM - tNBurNH4M - tNUptNH4PhraS + tNEvNH4WM 
else
dNH4SM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
dNO3SM = tNInfNO3WM - tNInfNO3SM + tNNitrSM - tNDenitSM - tNDifNO3M - tNDifGroundNO3M - tNBurNO3M - tNUptNO3PhraS + tNEvNO3WM 
else
dNO3SM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
dPO4SM = tPInfPO4WM - tPInfPO4SM + tPEvPO4WM +(1.0-fRefrDetS) * tPMinDetSM + tPMinHumSM - tPSorpIMSM - tPDifPO4M - tPDifGroundPO4M - tPChemPO4M - tPUptPhraS - tPBurPO4M 
else
dPO4SM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
dPAIMSM = tPSetAIMM - tPBurAIMM + tPSorpIMSM 
else
dPAIMSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
dDDetSM = tDMortRootPhra + tDSetDetM - tDMinDetSM + tDSetPhytM - tDBurDetM 
else
dDDetSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
dNDetSM = tNMortRootPhra + tNSetDetM - tNMinDetSM + tNSetPhytM - tNBurDetM 
else
dNDetSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
dPDetSM = tPMortRootPhra + tPSetDetM - tPMinDetSM + tPSetPhytM - tPBurDetM 
else
dPDetSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
dSiDetSM = tSiSetDetM - tSiMinDetSM + cSiDDiat * tDSetDiatM - tSiBurDetM 
else
dSiDetSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
dDHumSM = fRefrDetS * tDMinDetSM - tDMinHumSM - tDBurHumM 
else
dDHumSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
dNHumSM = fRefrDetS * tNMinDetSM - tNMinHumSM - tNBurHumM 
else
dNHumSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
dPHumSM = fRefrDetS * tPMinDetSM - tPMinHumSM - tPBurHumM 
else
dPHumSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
dDIMSM = tDSetIMM - tDBurIMM 
else
dDIMSM = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
dDRootPhra = tDProdRootPhra - tDRespRootPhra - tDMortRootPhra - tDAllPhra + tDRealPhra 
else
dDRootPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
dDShootPhra = tDProdShootPhra - tDRespShootPhra - tDMortShootPhra + tDAllPhra - tDRealPhra - tDManShootPhra 
else
dDShootPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
dNRootPhra = tNUptRootPhra - tNMortRootPhra - tNTransPhra + tNRetrPhra 
else
dNRootPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
dNShootPhra = tNUptShootPhra - tNMortShootPhra + tNTransPhra - tNRetrPhra - tNManShootPhra 
else
dNShootPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
dPRootPhra = tPUptRootPhra - tPMortRootPhra - tPTransPhra + tPRetrPhra 
else
dPRootPhra = 0.0 
end;
if (InclMarsh == true && fMarsh > NearZero) 
dPShootPhra = tPUptShootPhra - tPMortShootPhra + tPTransPhra - tPRetrPhra - tPManShootPhra 
else
dPShootPhra = 0.0 
end;
if (aInclStrat == true) 
dDepthWEpi = vDeltaWEpi + vDeltaW + vTranHypEpiW 
else
dDepthWEpi = vDeltaWEpi + vDeltaW + vDredDepthW 
end;
dNH4WEpi = ( wNTranNH4WEpi + wNAbioNH4WEpi + wNPrimNH4WEpi + wNBedNH4WEpi + wNWebNH4WEpi + cNBackLoad / sDepthWEpi - aRelDeltaWEpi * oNH4WEpi - wNExchNH4Epi + wNExchNH4WEpi ) * MassEpi;
dNO3WEpi = ( wNTranNO3WEpi + wNAbioNO3WEpi + wNPrimNO3WEpi + wNBedNO3WEpi + wNWebNO3WEpi - aRelDeltaWEpi * oNO3WEpi - wNExchNO3Epi + wNExchNO3WEpi ) * MassEpi;
dPO4WEpi = ( wPTranPO4WEpi + wPAbioPO4WEpi + wPPrimPO4WEpi + wPBedPO4WEpi + wPWebPO4WEpi + cPBackLoad / sDepthWEpi - aRelDeltaWEpi * oPO4WEpi - wPExchPO4Epi + wPExchPO4WEpi ) * MassEpi;
dPAIMWEpi = ( wPTranAIMWEpi + wPAbioAIMWEpi - aRelDeltaWEpi * oPAIMWEpi - wPExchAIMEpi + wPExchAIMWEpi ) * MassEpi;
dSiO2WEpi = ( wSiTranSiO2Epi + wSiAbioSiO2WEpi + wSiPrimSiO2WEpi - aRelDeltaWEpi * oSiO2WEpi - wSiExchSiO2Epi + wSiExchSiO2WEpi ) * MassEpi;
dO2WEpi = ( wO2TranWEpi + wO2AbioWEpi + wO2PrimWEpi -tO2PrimSEpi + tO2BedWEpi / sDepthWEpi - aRelDeltaWEpi * oO2WEpi - wO2ExchEpi + wO2ExchWEpi ) * MassEpi;
dDDetWEpi = ( wDTranDetWEpi + wDAbioDetWEpi + wDPrimDetWEpi + wDBedDetWEpi + wDWebDetWEpi - aRelDeltaWEpi * oDDetWEpi - wDExchDetEpi + wDExchDetWEpi ) * MassEpi;
dNDetWEpi = ( wNTranDetWEpi + wNAbioDetWEpi + wNPrimDetWEpi + wNBedDetWEpi + wNWebDetWEpi - aRelDeltaWEpi * oNDetWEpi - wNExchDetEpi + wNExchDetWEpi ) * MassEpi;
dPDetWEpi = ( wPTranDetWEpi + wPAbioDetWEpi + wPPrimDetWEpi + wPBedDetWEpi + wPWebDetWEpi - aRelDeltaWEpi * oPDetWEpi - wPExchDetEpi + wPExchDetWEpi ) * MassEpi;
dSiDetWEpi = ( wSiTranDetWEpi + wSiAbioDetWEpi + wSiPrimDetWEpi + wSiWebDetWEpi - aRelDeltaWEpi * oSiDetWEpi - wSiExchDetEpi + wSiExchDetWEpi ) * MassEpi;
dDIMWEpi = ( wDTranIMWEpi + wDAbioIMWEpi - aRelDeltaWEpi * oDIMWEpi - wDExchIMEpi + wDExchIMWEpi ) * MassEpi;
dDDiatWEpi = ( wDTranDiatEpi + wDPrimDiatWEpi + wDWebDiatWEpi - aRelDeltaWEpi * oDDiatWEpi - wDExchDiatEpi + wDExchDiatWEpi ) * MassEpi;
dNDiatWEpi = ( wNTranDiatEpi + wNPrimDiatWEpi + wNWebDiatWEpi - aRelDeltaWEpi * oNDiatWEpi - wNExchDiatEpi + wNExchDiatWEpi ) * MassEpi;
dPDiatWEpi = ( wPTranDiatEpi + wPPrimDiatWEpi + wPWebDiatWEpi - aRelDeltaWEpi * oPDiatWEpi - wPExchDiatEpi + wPExchDiatWEpi ) * MassEpi;
dDGrenWEpi = ( wDTranGrenEpi + wDPrimGrenWEpi + wDWebGrenWEpi - aRelDeltaWEpi * oDGrenWEpi - wDExchGrenEpi + wDExchGrenWEpi ) * MassEpi;
dNGrenWEpi = ( wNTranGrenEpi + wNPrimGrenWEpi + wNWebGrenWEpi - aRelDeltaWEpi * oNGrenWEpi - wNExchGrenEpi + wNExchGrenWEpi ) * MassEpi;
dPGrenWEpi = ( wPTranGrenEpi + wPPrimGrenWEpi + wPWebGrenWEpi - aRelDeltaWEpi * oPGrenWEpi - wPExchGrenEpi + wPExchGrenWEpi ) * MassEpi;
dDBlueWEpi = ( wDTranBlueEpi + wDPrimBlueWEpi + wDWebBlueWEpi - aRelDeltaWEpi * oDBlueWEpi - wDExchBlueEpi + wDExchBlueWEpi ) * MassEpi;
dNBlueWEpi = ( wNTranBlueEpi + wNPrimBlueWEpi + wNWebBlueWEpi - aRelDeltaWEpi * oNBlueWEpi - wNExchBlueEpi + wNExchBlueWEpi ) * MassEpi;
dPBlueWEpi = ( wPTranBlueEpi + wPPrimBlueWEpi + wPWebBlueWEpi - aRelDeltaWEpi * oPBlueWEpi - wPExchBlueEpi + wPExchBlueWEpi ) * MassEpi;
if (InclWeb == true) 
dDZooEpi = ( wDTranZooEpi + wDWebZooEpi - aRelDeltaWEpi * oDZooEpi - wDExchZooEpi + wDExchZooWEpi ) * MassEpi 
else
dDZooEpi = 0.0 
end;
if (InclWeb == true) 
dNZooEpi = ( wNTranZooEpi + wNWebZooEpi - aRelDeltaWEpi * oNZooEpi - wNExchZooEpi + wNExchZooWEpi ) * MassEpi 
else
dNZooEpi = 0.0 
end;
if (InclWeb == true) 
dPZooEpi = ( wPTranZooEpi + wPWebZooEpi - aRelDeltaWEpi * oPZooEpi - wPExchZooEpi + wPExchZooWEpi ) * MassEpi 
else
dPZooEpi = 0.0 
end;
dDExtTotT = uDLoad - wDOutflTotEpi*sDepthWEpi - wDOutflTotHyp*sDepthWHyp + wDTranZooEpi * sDepthWEpi + wDTranZooHyp * sDepthWHyp - tDBurTot + tDAbioTotT + tDPrimTotT + tDBedTotT + tDWebTotT+ tDMarsTotT - tDDredNetTot - aDRelTotT;
dNExtTotT = uNLoad - wNOutflTotEpi * sDepthWEpi - wNOutflTotHyp * sDepthWHyp+ wNTranZooHyp * sDepthWHyp + wNTranZooEpi * sDepthWEpi + cNBackLoad - tNBurTot + tNAbioTotT + tNPrimTotT + tNBedTotT + tNWebTotT + tNMarsTotT - tNDredNetTot - aNRelTotT;
dPExtTotT = uPLoad - wPOutflTotHyp * sDepthWHyp - wPOutflTotEpi * sDepthWEpi + wPTranZooHyp * sDepthWHyp + wPTranZooEpi * sDepthWEpi + cPBackLoad - tPBurTot + tPAbioTotT + tPPrimTotT + tPBedTotT + tPWebTotT + tPMarsTotT- tPDredNetTot - aPRelTotT;
dSiExtTotT = uSiLoad - wSiDilTotHyp*sDepthWHyp - wSiDilTotEpi*sDepthWEpi + tSiAbioTotT - tSiBurTot + tSiPrimTotT + tSiMarsTotT - tSiDredTot +tSiWebTotT - aSiRelTotT;
dO2ExtTotT = wO2TranWHyp * sDepthWHyp + wO2TranWEpi * sDepthWEpi + tO2BedWHyp + tO2BedWEpi + wO2PrimWHyp * sDepthWHyp + wO2PrimWEpi * sDepthWEpi + wO2AbioWHyp * sDepthWHyp + wO2AbioWEpi * sDepthWEpi + wO2AbioM* sDepthWM * fMarsh - tO2PrimS - tO2FlowPhra * fMarsh - aO2RelTotT;
sDepthWHyp' = dDepthWHyp;
sNH4WHyp' = dNH4WHyp;
sNO3WHyp' = dNO3WHyp;
sPO4WHyp' = dPO4WHyp;
sPAIMWHyp' = dPAIMWHyp;
sSiO2WHyp' = dSiO2WHyp;
sO2WHyp' = dO2WHyp;
sDDetWHyp' = dDDetWHyp;
sNDetWHyp' = dNDetWHyp;
sPDetWHyp' = dPDetWHyp;
sSiDetWHyp' = dSiDetWHyp;
sDIMWHyp' = dDIMWHyp;
sDDiatWHyp' = dDDiatWHyp;
sNDiatWHyp' = dNDiatWHyp;
sPDiatWHyp' = dPDiatWHyp;
sDGrenWHyp' = dDGrenWHyp;
sNGrenWHyp' = dNGrenWHyp;
sPGrenWHyp' = dPGrenWHyp;
sDBlueWHyp' = dDBlueWHyp;
sNBlueWHyp' = dNBlueWHyp;
sPBlueWHyp' = dPBlueWHyp;
sDZooHyp' = dDZooHyp;
sNZooHyp' = dNZooHyp;
sPZooHyp' = dPZooHyp;
sDFiAd' = dDFiAd;
sDFiJv' = dDFiJv;
sNFiAd' = dNFiAd;
sNFiJv' = dNFiJv;
sPFiAd' = dPFiAd;
sPFiJv' = dPFiJv;
sDPisc' = dDPisc;
sNH4S' = dNH4S;
sNO3S' = dNO3S;
sPO4S' = dPO4S;
sPAIMS' = dPAIMS;
sDDetS' = dDDetS;
sNDetS' = dNDetS;
sPDetS' = dPDetS;
sSiDetS' = dSiDetS;
sDHumS' = dDHumS;
sNHumS' = dNHumS;
sPHumS' = dPHumS;
sDIMS' = dDIMS;
sDDiatS' = dDDiatS;
sNDiatS' = dNDiatS;
sPDiatS' = dPDiatS;
sDGrenS' = dDGrenS;
sNGrenS' = dNGrenS;
sPGrenS' = dPGrenS;
sDBlueS' = dDBlueS;
sNBlueS' = dNBlueS;
sPBlueS' = dPBlueS;
sDVeg' = dDVeg;
sNVeg' = dNVeg;
sPVeg' = dPVeg;
sDBent' = dDBent;
sNBent' = dNBent;
sPBent' = dPBent;
sDepthWM' = dDepthWM;
sNH4WM' = dNH4WM;
sNO3WM' = dNO3WM;
sPO4WM' = dPO4WM;
sPAIMWM' = dPAIMWM;
sSiO2WM' = dSiO2WM;
sO2WM' = dO2WM;
sDDetWM' = dDDetWM;
sNDetWM' = dNDetWM;
sPDetWM' = dPDetWM;
sSiDetWM' = dSiDetWM;
sDIMWM' = dDIMWM;
sDDiatWM' = dDDiatWM;
sNDiatWM' = dNDiatWM;
sPDiatWM' = dPDiatWM;
sDGrenWM' = dDGrenWM;
sNGrenWM' = dNGrenWM;
sPGrenWM' = dPGrenWM;
sDBlueWM' = dDBlueWM;
sNBlueWM' = dNBlueWM;
sPBlueWM' = dPBlueWM;
sDZooM' = dDZooM;
sNZooM' = dNZooM;
sPZooM' = dPZooM;
sNH4SM' = dNH4SM;
sNO3SM' = dNO3SM;
sPO4SM' = dPO4SM;
sPAIMSM' = dPAIMSM;
sDDetSM' = dDDetSM;
sNDetSM' = dNDetSM;
sPDetSM' = dPDetSM;
sSiDetSM' = dSiDetSM;
sDHumSM' = dDHumSM;
sNHumSM' = dNHumSM;
sPHumSM' = dPHumSM;
sDIMSM' = dDIMSM;
sDRootPhra' = dDRootPhra;
sDShootPhra' = dDShootPhra;
sNRootPhra' = dNRootPhra;
sNShootPhra' = dNShootPhra;
sPRootPhra' = dPRootPhra;
sPShootPhra' = dPShootPhra;
sDepthWEpi' = dDepthWEpi;
sNH4WEpi' = dNH4WEpi;
sNO3WEpi' = dNO3WEpi;
sPO4WEpi' = dPO4WEpi;
sPAIMWEpi' = dPAIMWEpi;
sSiO2WEpi' = dSiO2WEpi;
sO2WEpi' = dO2WEpi;
sDDetWEpi' = dDDetWEpi;
sNDetWEpi' = dNDetWEpi;
sPDetWEpi' = dPDetWEpi;
sSiDetWEpi' = dSiDetWEpi;
sDIMWEpi' = dDIMWEpi;
sDDiatWEpi' = dDDiatWEpi;
sNDiatWEpi' = dNDiatWEpi;
sPDiatWEpi' = dPDiatWEpi;
sDGrenWEpi' = dDGrenWEpi;
sNGrenWEpi' = dNGrenWEpi;
sPGrenWEpi' = dPGrenWEpi;
sDBlueWEpi' = dDBlueWEpi;
sNBlueWEpi' = dNBlueWEpi;
sPBlueWEpi' = dPBlueWEpi;
sDZooEpi' = dDZooEpi;
sNZooEpi' = dNZooEpi;
sPZooEpi' = dPZooEpi;
sDExtTotT' = dDExtTotT;
sNExtTotT' = dNExtTotT;
sPExtTotT' = dPExtTotT;
sSiExtTotT' = dSiExtTotT;
sO2ExtTotT' = dO2ExtTotT;
%commands
sDepthWHyp = 9.20422;
sNH4WHyp = 0.366024;
sNO3WHyp = 4.10222;
sPO4WHyp = 0.848485;
sPAIMWHyp = 0.000690958;
sSiO2WHyp = 6.6665;
sO2WHyp = 6.91704;
sDDetWHyp = 6.16687;
sNDetWHyp = 0.419992;
sPDetWHyp = 0.0613011;
sSiDetWHyp = 0.336682;
sDIMWHyp = 2.02593;
sDDiatWHyp = 0.00618313;
sNDiatWHyp = 0.000308909;
sPDiatWHyp = 0.0000360854;
sDGrenWHyp = 0.01658;
sNGrenWHyp = 0.00164675;
sPGrenWHyp = 0.000246188;
sDBlueWHyp = 0.419656;
sNBlueWHyp = 0.0622182;
sPBlueWHyp = 0.010485;
sDZooHyp = 0.0438986;
sNZooHyp = 0.0030729;
sPZooHyp = 0.000438986;
sDFiAd = 2.22476;
sDFiJv = 0.902286;
sNFiAd = 0.222476;
sNFiJv = 0.0902286;
sPFiAd = 0.0489448;
sPFiJv = 0.0198503;
sDPisc = 0.000247524;
sNH4S = 0.20993;
sNO3S = 0.0951569;
sPO4S = 0.0518355;
sPAIMS = 2.72036;
sDDetS = 481.77;
sNDetS = 28.6447;
sPDetS = 4.05956;
sSiDetS = 32.8693;
sDHumS = 6811.77;
sNHumS = 340.739;
sPHumS = 45.916;
sDIMS = 26171.9;
sDDiatS = 0.00846761;
sNDiatS = 0.00042315;
sPDiatS = 0.0000487493;
sDGrenS = 0.0108474;
sNGrenS = 0.00106509;
sPGrenS = 0.000158797;
sDBlueS = 0.0429925;
sNBlueS = 0.00633354;
sPBlueS = 0.00107212;
sDVeg = 0.0469937;
sNVeg = 0.00164117;
sPVeg = 0.000164088;
sDBent = 2.91398;
sNBent = 0.203978;
sPBent = 0.0291398;
sDepthWM = 0.5;
sNH4WM = 0.1;
sNO3WM = 0.1;
sPO4WM = 0.01;
sPAIMWM = 0;
sSiO2WM = 3;
sO2WM = 10;
sDDetWM = 2;
sNDetWM = 0.05;
sPDetWM = 0.005;
sSiDetWM = 0.02;
sDIMWM = 5;
sDDiatWM = 0.5;
sNDiatWM = 0.05;
sPDiatWM = 0.005;
sDGrenWM = 0.5;
sNGrenWM = 0.05;
sPGrenWM = 0.005;
sDBlueWM = 3;
sNBlueWM = 0.3;
sPBlueWM = 0.03;
sDZooM = 0.05;
sNZooM = 0.0035;
sPZooM = 0.0005;
sNH4SM = 1;
sNO3SM = 0.01;
sPO4SM = 0.181703;
sPAIMSM = 17.9886;
sDDetSM = 181.703;
sNDetSM = 4.54258;
sPDetSM = 0.454258;
sSiDetSM = 1.81703;
sDHumSM = 3452.36;
sNHumSM = 172.618;
sPHumSM = 17.2618;
sDIMSM = 32706.5;
sDRootPhra = 5000;
sDShootPhra = 1000;
sNRootPhra = 100;
sNShootPhra = 20;
sPRootPhra = 10;
sPShootPhra = 2;
sDepthWEpi = 5.79578;
sNH4WEpi = 0.42609;
sNO3WEpi = 4.10144;
sPO4WEpi = 0.839063;
sPAIMWEpi = 0.000257388;
sSiO2WEpi = 6.54808;
sO2WEpi = 9.94226;
sDDetWEpi = 6.15446;
sNDetWEpi = 0.422563;
sPDetWEpi = 0.0614683;
sSiDetWEpi = 0.328126;
sDIMWEpi = 0.665416;
sDDiatWEpi = 0.0153058;
sNDiatWEpi = 0.000749939;
sPDiatWEpi = 0.0000911694;
sDGrenWEpi = 0.0282398;
sNGrenWEpi = 0.00251493;
sPGrenWEpi = 0.00036937;
sDBlueWEpi = 0.439664;
sNBlueWEpi = 0.0611171;
sPBlueWEpi = 0.0106432;
sDZooEpi = 0.0448336;
sNZooEpi = 0.00313835;
sPZooEpi = 0.000448336;
sDExtTotT = 33594;
sNExtTotT = 444.908;
sPExtTotT = 66.6182;
sSiExtTotT = 137.204;
sO2ExtTotT = 121.292;
InitCalc = 0
CalcMass = 1
ConstDepth = 1
InitDepth = 1
ConstTrans = 1
InclTran = 1
InclVeg = 1
InclBur = 1
InclWeb = 1
InclMarsh = 0
InclSeason = 1
InclStrat = 1
calcMixDepth = 1
InclLat = 1
calcQEv = 0
DayStart = 0
ReadTemp = 0
ReadStrat = 0
ReadLOut = 0
ReadVWind = 0
ReadQIn = 0
ReadQOut = 0
ReadQEv = 0
ReadPLoad = 1
ReadNLoad = 0
ReadNutFrac = 0
ReadPLoadPhyt = 0
ReadDLoadDet = 0
ReadVegShade = 0
UsePowerVeg = 0
UseLWinVeg = 1
ReadDLoadIM = 0
UseSeasonLoad = 0
UsePulseLoad = 0
mTempEpi = 0
mTempHyp = 0
mStrat = 0
mLOut = 0
mVegShade = 0
mVWind = 0
mQIn = 0
mQOut = 0
mQEv = 0
mPLoad = 0.0001
mPLoadPO4 = 0
mPLoadOrg = 0
mPLoadPhytTot = 0
mNLoad = 0
mNLoadNH4 = 0
mNLoadNO3 = 0
mNLoadOrg = 0
mDLoadDet = 0
mDLoadIM = 0
BeginTime = 0
EndTime = 365
YearZero = 0
cDepthW0 = 15
cMinDepthHyp = 0.5
cFetch = 1000
fMarsh = 0.1
fLutum = 0.1
kExchW = 0.1
kExchMaxW = 0.0001728
cDepthMix = 5.8
cAMix = 0.569
cBMix = 0.336
cfHyp = 1
fFeDIM = 0.01
fAlDIM = 0.01
fVegShade = 0
cTmAveEpi = 21
cTmVarEpi = 10
cTmAveHyp = 5
cTmVarHyp = 11
cStratTm = 1
cTimeLag = 40
cVWind = 5
cQInf = 0
cPBackLoad = 0
cNBackLoad = 0
cLDayAve = 10000000
cLDayVar = 8000000
cfDayAve = 0.5
cfDayVar = 0.2
fRefl = 0.2
cExtWat = 0.5
cDredInterval = 9999000
cDredStart = 9999000
cDepthRef = 1E-28
cLengDred = 10
fEffDred = 0.95
fEffDredBent = 0.5
fPAR = 0.48
cLAlloVeg = 50.1
cExtSpDet = 0.15
cExtSpIM = 0.05
fDTotS0 = 0.3
fDOrgS0 = 0.1
fDDetS0 = 0.05
fSedPhyt0 = 0.01
fPInorgS0 = 0.0005
fPAdsS0 = 0.99
cPDDet0 = 0.0025
cNDDet0 = 0.025
cSiDDet0 = 0.01
cPDHum0 = 0.005
cNDHum0 = 0.05
cPDPhyt0 = 0.01
cNDPhyt0 = 0.1
cPDDiat0 = 0.01
cNDDiat0 = 0.1
cPDGren0 = 0.01
cNDGren0 = 0.1
cPDBlue0 = 0.01
cNDBlue0 = 0.1
cPDVeg0 = 0.002
cNDVeg0 = 0.02
cSiDDiat = 0.15
cPDZooRef = 0.01
cNDZooRef = 0.07
cPDBentRef = 0.01
cNDBentRef = 0.07
cPDFishRef = 0.022
cNDFishRef = 0.1
cPDPisc = 0.022
cNDPisc = 0.1
cQIn = 20
cQInSum = 20
cQInWin = 20
cMaxWOut = 1
cDepthWMax = 5
cQInExtraApril1 = 0
cQInExtraOct1 = 0
cQOutExtraApril1 = 0
cQOutExtraOct1 = 0
cQEvAve = 1.5
cQEvVar = 1.3
cPLoad = 0.005
cPLoadSum = 0.005
cPLoadWin = 0.005
fPO4In = 0.5
fPhytInWin = 0.02
fPhytInSum = 0.1
fDiatPhytIn = 0.33
fGrenPhytIn = 0.34
fBluePhytIn = 0.33
cNLoad = 0.05
cNLoadSum = 0.05
cNLoadWin = 0.05
cNPLoadMeas = 10
cNPPhytIn = 7
cNPDetIn = 7
fNH4DissIn = 0.5
cNDPhytIn = 0.07
cNDDetIn = 0.07
cDIMIn = 5
cO2In = 5
cSiO2In = 3
cSiDDetIn = 0.05
cDZooIn = 0.1
cDayApril1 = 91
cDayOct1 = 273
cLengChange = 10
cNLoadS = 0
fNH4LoadS = 0.5
cDErosTot = 0.1
fSedErosIM = 0.95
fHypErosIM = 0
fDOrgSoil = 0.1
cPDSoilOM = 0.001
cNDSoilOM = 0.01
cPO4Ground = 0.1
cNH4Ground = 1
cNO3Ground = 0.1
cDepthS = 0.1
cCPerDW = 0.4
cRhoIM = 2500000
cRhoOM = 1400000
cTmRef = 20
cAerRoot = 0.727
cAerLin = -0.371
cAerSquare = 0.0376
cThetaAer = 1.024
cVSetIM = 1
cVSetDet = 0.25
cThetaSet = 1.01
cSuspMin = 6.1
cSuspMax = 25.2
cSuspSlope = 2.1
hDepthSusp = 2
cFetchRef = 1000
fLutumRef = 0.2
cSuspRef = 0.5
kVegResus = 0.01
kTurbFish = 1
kResusPhytMax = 0.25
cResusPhytExp = -0.379
cThetaMinW = 1.07
kDMinDetW = 0.01
hO2BOD = 1
O2PerNO3 = 1.5
cThetaMinS = 1.07
kDMinDetS = 0.002
fRefrDetS = 0.15
hNO3Denit = 2
NO3PerC = 0.8
kDMinHum = 0.00001
kNitrW = 0.1
kNitrS = 1
cThetaNitr = 1.08
O2PerNH4 = 2
hO2Nitr = 2
kPDifPO4 = 0.000072
kNDifNO3 = 0.000086
kNDifNH4 = 0.000112
kO2Dif = 0.000026
cThetaDif = 1.02
fDepthDifS = 0.5
cTurbDifNut = 5
cTurbDifO2 = 5
kPSorp = 0.05
cRelPAdsD = 0.00003
cRelPAdsFe = 0.065
cRelPAdsAl = 0.134
cKPAdsOx = 0.6
fRedMax = 0.9
coPO4Max = 1
kPChemPO4 = 0.03
cDayManVeg1 = -9999000
cDayManVeg2 = -9999000
fManVeg = 0
cLengMan = 10
cYearStartBirds = 0
cDayStartBirds = 46
cDayEndBirds = 288
cBirdsPerha = 0
cDGrazPerBird = 45
hDVegBird = 5
fDAssBird = 0.5
fDissEgesBird = 0.25
fDissMortVeg = 0.25
cLengAllo = 15
cLengMort = 15
UseEmpUpt = 0
fSedUptVegMax = 0.998
fSedUptVegCoef = 2.66
fSedUptVegExp = -0.83
fRootVegSum = 0.1
fRootVegWin = 0.6
fFloatVeg = 0
fEmergVeg = 0
cVegHeight = 5
fDepth1Veg = 0
fDepth2Veg = 1
cDLayerVeg = 0
cCovSpVeg = 0.5
kMigrVeg = 0.001
cDVegIn = 1
cTmInitVeg = 9
cDCarrVeg = 400
cMuMaxVeg = 0.2
cQ10ProdVeg = 1.2
hLRefVeg = 13
cExtSpVeg = 0.01
kDRespVeg = 0.016
cQ10RespVeg = 2
kMortVegSum = 0.005
fWinVeg = 0.3
cDayWinVeg = 259
fDetWMortVeg = 0.1
cPrefVegBird = 1
cVPUptMaxVeg = 0.01
cAffPUptVeg = 0.2
cPDVegMin = 0.0008
cPDVegMax = 0.0035
cVNUptMaxVeg = 0.1
cAffNUptVeg = 0.2
cNDVegMin = 0.01
cNDVegMax = 0.035
cPACoefMin = 1.5
cPACoefMax = 2.5
hPACoef = 3
cSecchiPlus = 0
cEuph = 1.7
cCovSpPhyt = 2
cTmOptLoss = 25
cSigTmLoss = 13
fDissMortPhyt = 0.2
fDissLoss = 0.25
cMuMaxDiat = 2
cTmOptDiat = 18
cSigTmDiat = 20
cExtSpDiat = 0.25
UseSteeleDiat = 1
cLOptRefDiat = 54
hLRefDiat = 1000
cChDDiatMin = 0.004
cChDDiatMax = 0.012
kDRespDiat = 0.1
kLossDiat = 0.25
kMortDiatW = 0.01
kMortDiatS = 0.05
cVSetDiat = 0.5
cVPUptMaxDiat = 0.01
cAffPUptDiat = 0.2
cPDDiatMin = 0.0005
cPDDiatMax = 0.005
cVNUptMaxDiat = 0.07
cAffNUptDiat = 0.2
cNDDiatMin = 0.01
cNDDiatMax = 0.05
hSiAssDiat = 0.09
cMuMaxGren = 1.5
cTmOptGren = 25
cSigTmGren = 15
cExtSpGren = 0.25
UseSteeleGren = 0
hLRefGren = 17
cLOptRefGren = 1000
cChDGrenMin = 0.01
cChDGrenMax = 0.02
kDRespGren = 0.075
kLossGren = 0.25
kMortGrenW = 0.01
kMortGrenS = 0.05
cVSetGren = 0.2
cVPUptMaxGren = 0.01
cAffPUptGren = 0.2
cPDGrenMin = 0.0015
cPDGrenMax = 0.015
cVNUptMaxGren = 0.07
cAffNUptGren = 0.2
cNDGrenMin = 0.02
cNDGrenMax = 0.1
hSiAssGren = 0
cMuMaxBlue = 0.6
cTmOptBlue = 25
cSigTmBlue = 12
cExtSpBlue = 0.35
UseSteeleBlue = 1
cLOptRefBlue = 13.6
hLRefBlue = 1000
cChDBlueMin = 0.005
cChDBlueMax = 0.015
cCyDBlueMin = 0.004
cCyDBlueMax = 0.06
kDRespBlue = 0.03
kLossBlue = 0.03
kMortBlueW = 0.01
kMortBlueS = 0.2
cVSetBlue = 0.06
cVPUptMaxBlue = 0.04
cAffPUptBlue = 0.8
cPDBlueMin = 0.0025
cPDBlueMax = 0.025
cVNUptMaxBlue = 0.07
cAffNUptBlue = 0.2
cNDBlueMin = 0.03
cNDBlueMax = 0.15
fFiJvMortHyp = 0
fFiJvEgesHyp = 0.1
fFiJvExcrHyp = 0.1
fFiAdMortHyp = 0
fFiAdEgesHyp = 0.9
fFiAdExcrHyp = 0.9
fPiscMortHyp = 0
fPiscEgesHyp = 0.5
fPiscExcrHyp = 0.5
hSiAssBlue = 0
cDBentIn = 0.01
kMigrBent = 0.001
kMigrFish = 0.001
cDFiJvIn = 0.005
cDFiAdIn = 0.005
kHarvFishWin = 0
kHarvFishSum = 0
cDPiscIn = 0.001
kMigrPisc = 0.001
kHarvPiscWin = 0
kHarvPiscSum = 0
cFiltMax = 4.5
hFilt = 1
cDCarrZoo = 25
cPrefDiat = 0.75
cPrefGren = 0.75
cPrefBlue = 0.125
cPrefDet = 0.25
fDAssZoo = 0.35
fDissEgesZoo = 0.25
kDRespZoo = 0.15
kMortZoo = 0.04
fDissMortZoo = 0.1
cTmOptZoo = 25
cSigTmZoo = 13
cDCarrBent = 10
kDAssBent = 0.1
hDFoodBent = 200
fDAssBent = 0.3
fDissEgesBent = 0.25
kDRespBent = 0.005
kMortBent = 0.005
fDissMortBent = 0.1
cTmOptBent = 25
cSigTmBent = 16
fDBone = 0.35
fPBone = 0.5
cDCarrFish = 15
fDissEgesFish = 0.25
fDissMortFish = 0.1
cTmOptFish = 25
cSigTmFish = 10
cDayReprFish = 120
fReprFish = 0.02
fAgeFish = 0.5
cRelVegFish = 0.009
kDAssFiJv = 0.12
hDZooFiJv = 1.25
fDAssFiJv = 0.4
kDRespFiJv = 0.01
kMortFiJv = 0.00137
kDAssFiAd = 0.06
hDBentFiAd = 2.5
fDAssFiAd = 0.4
kDRespFiAd = 0.004
kMortFiAd = 0.00027
cDCarrPiscMax = 1.2
cDCarrPiscMin = 0.1
cDCarrPiscBare = 0.1
cDPhraMinPisc = 50
cCovVegMin = 40
cTmOptVeg = 20
cSigTmVeg = 20
cRelPhraPisc = 0.075
cRelVegPisc = 0.03
kDAssPisc = 0.025
hDVegPisc = 5
hDFishPisc = 1
fDAssPisc = 0.4
fDissEgesPisc = 0.25
kDRespPisc = 0.005
kMortPisc = 0.00027
fDissMortPisc = 0.1
cTmOptPisc = 25
cSigTmPisc = 10
cDepthSM = 0.1
kExchMaxM = 1
hfMarsh = 0.1
fDTotSM0 = 0.3
fDOrgSM0 = 0.1
fDDetSM0 = 0.05
fPInorgSM0 = 0.0005
cPDPhra0 = 0.002
cNDPhra0 = 0.02
cDensStemPhra = 61.5
cTmInitPhra = 8
fDAllPhra = 0.3
kDAllPhra = 0.05
cDStemPhra = 6
cQ10ProdPhra = 2
cMuPhraMax = 0.03
cDShootPhraMax = 3500
cCovSpPhra = 0.1
cPDPhraMin = 0.0008
cPDPhraMax = 0.003
cNDPhraMin = 0.008
cNDPhraMax = 0.03
cAffNUptPhra = 0.0002
cAffPUptPhra = 0.0002
cVNUptPhraMax = 0.1
cVPUptPhraMax = 0.01
kDRespPhra = 0.001
cQ10RespPhra = 2.5
fDayWin = 0.52
fDRealPhra = 0.85
kDRealPhra = 0.05
kDMortShootPhra = 0
kDMortRootPhra = 0.000391
cDayWinPhra = 259
cDayManPhra = 255
fManPhra = 0
kDManShootPhra = 1
DaysPerYear = 365
DaysInYear = 365
TenDays = 10
HoursInDay = 24
HoursPerDay = 24
SecsPerDay = 86400
mmPerm = 1000
m2Perha = 10000
mgPerg = 1000
gPerkg = 1000
gPerton = 1000000
PerDay = 1
PerCent = 0.01
NearZero = 1E-28
molO2molC = 2.6667
molO2molN = 2.2857
molNmolC = 1.1667
cRhoWat = 1000000
cSolar = 1368
cLAT = 52
cPhiR = 0.409
cDayR = 173
fCloudH = 0.15
fCloudM = 0.15
fCloudL = 0.15
cTrans = 0.41
Pi = 3.14159265358979
cHeath = 100
cAlpha = 2
cDepthMeasoChl = 0.3
cPMax = 1.3
cDepthMetaMin = 0.0001
fMeta = 0.13
kBub = 0.4
cVegL = 1
