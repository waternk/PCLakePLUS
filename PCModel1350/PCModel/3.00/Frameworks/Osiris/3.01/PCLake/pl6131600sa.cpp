_sTime_ = time;
_TimeYears_ = _sTime_ / _DaysPerYear_;
_Day_ = _sTime_ - _FLOOR_(_TimeYears_) * _DaysPerYear_;
_Years_ = _YearZero_ + _TimeYears_;
_uTm_ = _IF_ (_FALSE_ _EQ_ _InclSeason_) _THEN_ _cTmAve_ _ELSEIF_ (_ReadTemp_ _EQ_ _TRUE_) _THEN_ _mTemp_ _ELSE_ _cTmAve_ - _cTmVar_ * _COS_(2.0*_Pi_*(_sTime_ + _TenDays_ - _cTimeLag_) / _DaysPerYear_) _ENDIF_;
_uVWind_ = _IF_ (_ReadVWind_ _EQ_ _TRUE_)_THEN_ _mVWind_ _ELSE_ _cVWind_ _ENDIF_;
_ufDay_ = _IF_ (_FALSE_ _EQ_ _InclSeason_) _THEN_ _cfDayAve_ _ELSE_ _cfDayAve_ - _cfDayVar_ * _COS_(2.0*_Pi_*(_sTime_+_TenDays_) / _DaysPerYear_) _ENDIF_;
_uLDay_ = _IF_ (_FALSE_ _EQ_ _InclSeason_) _THEN_ _cLDayAve_ _ELSEIF_ (_ReadLOut_ _EQ_ _TRUE_) _THEN_ 0.0 _ELSE_ _cLDayAve_ - _cLDayVar_ * _COS_(2.0*_Pi_*(_sTime_+_TenDays_) / _DaysPerYear_) _ENDIF_;
_uLOut_ = _IF_ (_FALSE_ _EQ_ _InclSeason_) _THEN_ _uLDay_ / _SecsPerDay_ / _ufDay_ _ELSEIF_ (_ReadLOut_ _EQ_ _TRUE_) _THEN_ _mLOut_ / _ufDay_ _ELSE_ _uLDay_ / _SecsPerDay_ / _ufDay_ _ENDIF_;
_uLPARSurf_ = _fPAR_ * (1.0 - _fRefl_) * _uLOut_;
_aExtPhyt_ = _cExtSpDiat_ * _sDDiatW_ + _cExtSpGren_ * _sDGrenW_ + _cExtSpBlue_ * _sDBlueW_;
_aExtDet_ = _cExtSpDet_ * _sDDetW_;
_aExtIM_ = _cExtSpIM_ * _sDIMW_;
_aExtCoefOpen_ = _cExtWat_ + _aExtIM_ + _aExtDet_ + _aExtPhyt_;
_uQInSeason_ = _IF_ (_FALSE_ _EQ_ _UseSeasonLoad_) _THEN_ 0.0 _ELSEIF_ (_Day_ _LT_ _cDayApril1_ - 0.5*_cLengChange_) _THEN_ _cQInWin_ _ELSEIF_ (_Day_ _LT_ _cDayApril1_ + 0.5*_cLengChange_) _THEN_ 0.5*(_cQInWin_ + _cQInSum_) + 0.5*(_cQInWin_ - _cQInSum_) * _COS_(_Pi_/_cLengChange_ * (_Day_ - _cDayApril1_)) _ELSEIF_ (_Day_ _LT_ _cDayOct1_ - 0.5*_cLengChange_) _THEN_ _cQInSum_ _ELSEIF_ (_Day_ _LT_ _cDayOct1_ + 0.5*_cLengChange_) _THEN_ 0.5*(_cQInWin_ + _cQInSum_) - 0.5*(_cQInWin_ - _cQInSum_) * _COS_(_Pi_/_cLengChange_ * (_Day_ - _cDayOct1_)) _ELSE_ _cQInWin_ _ENDIF_;
_uQEvSinus_ = _cQEvAve_ - _cQEvVar_ * _COS_(2.0*_Pi_ * (_sTime_ + _TenDays_ - _cTimeLag_) / _DaysPerYear_);
_uQEv_ = _IF_ (_FALSE_ _EQ_ _InclSeason_) _THEN_ _cQEvAve_ _ELSEIF_ (_ReadQEv_ _EQ_ _TRUE_) _THEN_ _mQEv_ _ELSE_ _uQEvSinus_ _ENDIF_;
_uQInExtra_ = _IF_ ((_Day_ _GE_ _cDayApril1_ - 0.5*_cLengChange_) _AND_ (_Day_ _LT_ _cDayApril1_ + 0.5*_cLengChange_)) _THEN_ _cQInExtraApril1_ _ELSEIF_ ( (_Day_ _GE_ _cDayOct1_ - 0.5*_cLengChange_) _AND_ (_Day_ _LT_ _cDayOct1_ + 0.5*_cLengChange_) ) _THEN_ _cQInExtraOct1_ _ELSE_ 0.0 _ENDIF_;
_uQOutExtra_ = _IF_ ((_Day_ _GE_ _cDayApril1_ - 0.5*_cLengChange_) _AND_ (_Day_ _LT_ _cDayApril1_ + 0.5*_cLengChange_)) _THEN_ _cQOutExtraApril1_ _ELSEIF_ ( (_Day_ _GE_ _cDayOct1_ - 0.5*_cLengChange_) _AND_ (_Day_ _LT_ _cDayOct1_ + 0.5*_cLengChange_) ) _THEN_ _cQOutExtraOct1_ _ELSE_ 0.0 _ENDIF_;
_uQIn_ = _IF_ (_ReadQIn_ _EQ_ _TRUE_) _THEN_ _mQIn_ _ELSEIF_ (_UseSeasonLoad_ _EQ_ _TRUE_) _THEN_ _uQInSeason_ + _uQInExtra_ _ELSE_ _cQIn_ + _uQInExtra_ _ENDIF_;
_uQOut_ = _IF_ (_ReadQOut_ _EQ_ _TRUE_) _THEN_ _MAX_(_mQOut_, (_sDepthW_ - _cDepthWMax_) * _mmPerm_) _ELSE_ _MAX_(0.0, (_uQIn_ - _uQInExtra_) - _uQEv_ - _cQInf_) + _uQOutExtra_ _ENDIF_;
_uQDil_ = _uQIn_ - _uQEv_ - _cQInf_;
_ukDil_ = _uQDil_ / _mmPerm_ / _sDepthW_;
_ukDilWat_ = _uQIn_ / _mmPerm_ / _sDepthW_;
_ukOut_ = _uQOut_ / _mmPerm_ / _sDepthW_;
_uTauWat_ = 1.0 / (_ukDilWat_+_NearZero_);
_uTauSubst_ = 1.0 / (_ukDil_+_NearZero_);
_vTranDepthW_ = _IF_ (_FALSE_ _EQ_ _InclTran_) _THEN_ 0.0 _ELSEIF_ (_FALSE_ _EQ_ _InclMarsh_ _OR_ _fMarsh_ _LE_ _NearZero_) _THEN_ (_uQIn_ - _uQEv_ - _cQInf_ - _uQOut_) / _mmPerm_ _ELSE_ ((_uQIn_ - _uQEv_ - _cQInf_ - _uQOut_) / _mmPerm_) / (1.0 + _fMarsh_) _ENDIF_;
_akExchM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _kExchMaxM_ * _hfMarsh_ /(_hfMarsh_ + _fMarsh_) + _vTranDepthW_ / _sDepthWM_ _ELSE_ 0.0 _ENDIF_;
_afVolMarsh_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _fMarsh_ * _sDepthWM_ / _sDepthW_ _ELSE_ 0.0 _ENDIF_;
_akExchL_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchM_ * _afVolMarsh_ _ELSE_ 0.0 _ENDIF_;
_oDPhytW_ = _sDDiatW_ + _sDGrenW_ + _sDBlueW_;
_oPPhytW_ = _sPDiatW_ + _sPGrenW_ + _sPBlueW_;
_oNPhytW_ = _sNDiatW_ + _sNGrenW_ + _sNBlueW_;
_aDPhytS_ = _IF_ (_InclPhytS_ _EQ_ _TRUE_) _THEN_ _sDDiatS_ + _sDGrenS_ + _sDBlueS_ _ELSE_ _NearZero_ _ENDIF_;
_aPPhytS_ = _IF_ (_InclPhytS_ _EQ_ _TRUE_) _THEN_ _sPDiatS_ + _sPGrenS_ + _sPBlueS_ _ELSE_ _NearZero_ _ENDIF_;
_aNPhytS_ = _IF_ (_InclPhytS_ _EQ_ _TRUE_) _THEN_ _sNDiatS_ + _sNGrenS_ + _sNBlueS_ _ELSE_ _NearZero_ _ENDIF_;
_oDOMW_ = _sDDetW_ + _oDPhytW_;
_oDSestW_ = _oDOMW_ + _sDIMW_;
_oPOMW_ = _oPPhytW_ + _sPDetW_;
_oPSestW_ = _oPPhytW_ + _sPDetW_ + _sPAIMW_;
_oPInorgW_ = _sPO4W_ + _sPAIMW_;
_oPTotW_ = _oPSestW_ + _sPO4W_;
_oNDissW_ = _sNO3W_ + _sNH4W_;
_oNOMW_ = _oNPhytW_ + _sNDetW_;
_oNSestW_ = _oNOMW_;
_oNkjW_ = _oNSestW_ + _sNH4W_;
_oNTotW_ = _oNkjW_ + _sNO3W_;
_bPorS_ = (1.0 - _fDTotS0_) * (_fDOrgS0_ * _cRhoOM_ + (1 - _fDOrgS0_) * _cRhoIM_) / _cRhoWat_ / ( _fDTotS0_ + (1.0 - _fDTotS0_) * (_fDOrgS0_ * _cRhoOM_ + (1 - _fDOrgS0_) * _cRhoIM_) / _cRhoWat_ );
_bPorCorS_ = _POW_(_bPorS_ , (_bPorS_ + 1.0));
_aDTotS_ = _sDIMS_ + _sDHumS_ + _sDDetS_;
_aRhoTotS_ = _aDTotS_ / _cDepthS_;
_aRhoSolidS_ = (_sDIMS_ * _cRhoIM_ + (_sDHumS_ + _sDDetS_) * _cRhoOM_) / _aDTotS_;
_afDTotS_ = 1.0 / (1.0 + _bPorS_/(1.0-_bPorS_) * _cRhoWat_ / _aRhoSolidS_);
_afDOrgS_ = (_sDHumS_ + _sDDetS_) / _aDTotS_;
_afDetS_ = _sDDetS_ / (_sDHumS_ + _sDDetS_);
_afDetTotS_ = _sDDetS_ / (_sDIMS_ + _sDHumS_ + _sDDetS_);
_aPInorgS_ = _sPO4S_ + _sPAIMS_;
_aPTotAvailS_ = _sPDetS_ + _aPInorgS_ + _aPPhytS_;
_aPTotS_ = _aPTotAvailS_ + _sPHumS_;
_afPInorgS_ = _aPInorgS_ / _aDTotS_;
_afPTotS_ = _aPTotS_ / _aDTotS_;
_afPO4S_ = _sPO4S_ / (_aPTotAvailS_ + _NearZero_);
_oPO4S_ = _sPO4S_ / _cDepthS_ / _bPorS_;
_aNDissS_ = _sNH4S_ + _sNO3S_;
_aNkjAvailS_ = _sNDetS_ + _aNPhytS_ + _sNH4S_;
_aNkjS_ = _aNkjAvailS_ + _sNHumS_;
_aNTotAvailS_ = _aNkjAvailS_ + _sNO3S_;
_aNTotS_ = _aNkjS_ + _sNO3S_;
_afNInorgS_ = _aNDissS_ / _aDTotS_;
_afNTotS_ = _aNTotS_ / _aDTotS_;
_oNO3S_ = _sNO3S_ / _cDepthS_ / _bPorS_;
_oNH4S_ = _sNH4S_ / _cDepthS_ / _bPorS_;
_oNDissS_ = _aNDissS_ / _cDepthS_ / _bPorS_;
_rPDIMW_ = _sPAIMW_ / _sDIMW_;
_rPDIMS_ = _sPAIMS_ / _sDIMS_;
_rPDDetW_ = _sPDetW_ / (_sDDetW_+_NearZero_);
_rNDDetW_ = _sNDetW_ / (_sDDetW_+_NearZero_);
_rSiDDetW_ = _sSiDetW_ / (_sDDetW_+_NearZero_);
_rPDHumS_ = _sPHumS_ / (_sDHumS_+_NearZero_);
_rNDHumS_ = _sNHumS_ / (_sDHumS_+_NearZero_);
_rPDDetS_ = _sPDetS_ / (_sDDetS_+_NearZero_);
_rNDDetS_ = _sNDetS_ / (_sDDetS_+_NearZero_);
_rSiDDetS_ = _sSiDetS_ / (_sDDetS_+_NearZero_);
_oDPhytWM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _sDDiatWM_ + _sDGrenWM_ + _sDBlueWM_ _ELSE_ 0.0 _ENDIF_;
_oPPhytWM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _sPDiatWM_ + _sPGrenWM_ + _sPBlueWM_ _ELSE_ 0.0 _ENDIF_;
_oNPhytWM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _sNDiatWM_ + _sNGrenWM_ + _sNBlueWM_ _ELSE_ 0.0 _ENDIF_;
_oSiDiatWM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _cSiDDiat_ * _sDDiatWM_ _ELSE_ 0.0 _ENDIF_;
_oDOMWM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _sDDetWM_ + _oDPhytWM_ _ELSE_ 0.0 _ENDIF_;
_oDSestWM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _oDOMWM_ + _sDIMWM_ _ELSE_ 0.0 _ENDIF_;
_oPOMWM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _oPPhytWM_ + _sPDetWM_ _ELSE_ 0.0 _ENDIF_;
_oPSestWM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _oPPhytWM_ + _sPDetWM_ + _sPAIMWM_ _ELSE_ 0.0 _ENDIF_;
_oPInorgWM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _sPO4WM_ + _sPAIMWM_ _ELSE_ 0.0 _ENDIF_;
_oPTotWM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _oPSestWM_ + _sPO4WM_ _ELSE_ 0.0 _ENDIF_;
_oNDissWM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _sNO3WM_ + _sNH4WM_ _ELSE_ 0.0 _ENDIF_;
_oNOMWM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _oNPhytWM_ + _sNDetWM_ _ELSE_ 0.0 _ENDIF_;
_oNSestWM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _oNOMWM_ _ELSE_ 0.0 _ENDIF_;
_oNkjWM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _oNSestWM_ + _sNH4WM_ _ELSE_ 0.0 _ENDIF_;
_oNTotWM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _oNkjWM_ + _sNO3WM_ _ELSE_ 0.0 _ENDIF_;
_bPorSM_ = (1.0 - _fDTotSM0_) * (_fDOrgSM0_ * _cRhoOM_ +(1 - _fDOrgSM0_) * _cRhoIM_) / _cRhoWat_ /(_fDTotSM0_ + (1.0 - _fDTotSM0_) * (_fDOrgSM0_ * _cRhoOM_ +(1 - _fDOrgSM0_) * _cRhoIM_) / _cRhoWat_);
_bPorCorSM_ = _POW_(_bPorSM_ , (_bPorSM_ + 1.0));
_aDTotSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _sDIMSM_ + _sDHumSM_ + _sDDetSM_ _ELSE_ 0.0 _ENDIF_;
_aRhoTotSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _aDTotSM_ / _cDepthSM_ _ELSE_ 0.0 _ENDIF_;
_aRhoSolidSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ (_sDIMSM_ * _cRhoIM_ +(_sDHumSM_ + _sDDetSM_) * _cRhoOM_) / _aDTotSM_ _ELSE_ 0.0 _ENDIF_;
_afDTotSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ 1.0 /(1.0 + _bPorSM_/(1.0-_bPorSM_) * _cRhoWat_ / _aRhoSolidSM_) _ELSE_ 0.0 _ENDIF_;
_afDOrgSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ (_sDHumSM_ + _sDDetSM_) / _aDTotSM_ _ELSE_ 0.0 _ENDIF_;
_afDetSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _sDDetSM_ /(_sDHumSM_ + _sDDetSM_) _ELSE_ 0.0 _ENDIF_;
_afDetTotSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _sDDetSM_ /(_sDIMSM_ + _sDHumSM_ + _sDDetSM_) _ELSE_ 0.0 _ENDIF_;
_aPInorgSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _sPO4SM_ + _sPAIMSM_ _ELSE_ 0.0 _ENDIF_;
_aPTotAvailSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _sPDetSM_ + _aPInorgSM_ _ELSE_ 0.0 _ENDIF_;
_aPTotSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _aPTotAvailSM_ + _sPHumSM_ _ELSE_ 0.0 _ENDIF_;
_afPInorgSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _aPInorgSM_ / _aDTotSM_ _ELSE_ 0.0 _ENDIF_;
_afPTotSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _aPTotSM_ / _aDTotSM_ _ELSE_ 0.0 _ENDIF_;
_afPO4SM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _sPO4SM_ /(_aPTotAvailSM_ + _NearZero_) _ELSE_ 0.0 _ENDIF_;
_oPO4SM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _sPO4SM_ / _cDepthSM_ / _bPorSM_ _ELSE_ 0.0 _ENDIF_;
_aNDissSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _sNH4SM_ + _sNO3SM_ _ELSE_ 0.0 _ENDIF_;
_aNkjAvailSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _sNDetSM_ + _sNH4SM_ _ELSE_ 0.0 _ENDIF_;
_aNkjSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _aNkjAvailSM_ + _sNHumSM_ _ELSE_ 0.0 _ENDIF_;
_aNTotAvailSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _aNkjAvailSM_ + _sNO3SM_ _ELSE_ 0.0 _ENDIF_;
_aNTotSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _aNkjSM_ + _sNO3SM_ _ELSE_ 0.0 _ENDIF_;
_afNInorgSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _aNDissSM_ / _aDTotSM_ _ELSE_ 0.0 _ENDIF_;
_afNTotSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _aNTotSM_ / _aDTotSM_ _ELSE_ 0.0 _ENDIF_;
_oNO3SM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _sNO3SM_ / _cDepthSM_ / _bPorSM_ _ELSE_ 0.0 _ENDIF_;
_oNH4SM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _sNH4SM_ / _cDepthSM_ / _bPorSM_ _ELSE_ 0.0 _ENDIF_;
_oNDissSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _aNDissSM_ / _cDepthSM_ / _bPorSM_ _ELSE_ 0.0 _ENDIF_;
_rPDIMWM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _sPAIMWM_ / _sDIMWM_ _ELSE_ 0.0 _ENDIF_;
_rPDIMSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _sPAIMSM_ / _sDIMSM_ _ELSE_ 0.0 _ENDIF_;
_rPDDetWM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _sPDetWM_ /(_sDDetWM_+_NearZero_) _ELSE_ 0.0 _ENDIF_;
_rNDDetWM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _sNDetWM_ /(_sDDetWM_+_NearZero_) _ELSE_ 0.0 _ENDIF_;
_rSiDDetWM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _sSiDetWM_ /(_sDDetWM_+_NearZero_) _ELSE_ 0.0 _ENDIF_;
_rPDHumSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _sPHumSM_ /(_sDHumSM_+_NearZero_) _ELSE_ 0.0 _ENDIF_;
_rNDHumSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _sNHumSM_ /(_sDHumSM_+_NearZero_) _ELSE_ 0.0 _ENDIF_;
_rPDDetSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _sPDetSM_ /(_sDDetSM_+_NearZero_) _ELSE_ 0.0 _ENDIF_;
_rNDDetSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _sNDetSM_ /(_sDDetSM_+_NearZero_) _ELSE_ 0.0 _ENDIF_;
_rSiDDetSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _sSiDetSM_ /(_sDDetSM_+_NearZero_) _ELSE_ 0.0 _ENDIF_;
_aDTotM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ ((_sDIMWM_ + _sDDetWM_ + _oDPhytWM_ + _sDZooM_) * _sDepthWM_ + _sDIMSM_ + _sDHumSM_ + _sDDetSM_ + _sDShootPhra_ + _sDRootPhra_) * _fMarsh_ _ELSE_ 0.0 _ENDIF_;
_aPTotM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ ((_sPO4WM_ + _sPDetWM_ + _sPAIMWM_ + _oPPhytWM_ + _sPZooM_) * _sDepthWM_ + _sPO4SM_ + _sPHumSM_ + _sPDetSM_ + _sPAIMSM_ + _sPShootPhra_ + _sPRootPhra_) * _fMarsh_ _ELSE_ 0.0 _ENDIF_;
_aNTotM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ ((_sNH4WM_ + _sNO3WM_ + _sNDetWM_ + _oNPhytWM_ + _sNZooM_) * _sDepthWM_ + _sNH4SM_ + _sNO3SM_ + _sNHumSM_ + _sNDetSM_ + _sNShootPhra_ + _sNRootPhra_) * _fMarsh_ _ELSE_ 0.0 _ENDIF_;
_aSiTotM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ ((_sSiO2WM_ + _sSiDetWM_ + _oSiDiatWM_) * _sDepthWM_ + _sSiDetSM_) * _fMarsh_ _ELSE_ 0.0 _ENDIF_;
_iPPulse_ = 1;
_uPLoadSeason_ = _IF_ (_FALSE_ _EQ_ _UseSeasonLoad_) _THEN_ 0.0 _ELSEIF_ (_Day_ _LT_ _cDayApril1_ - 0.5*_cLengChange_) _THEN_ _cPLoadWin_ _ELSEIF_ (_Day_ _LT_ _cDayApril1_ + 0.5*_cLengChange_) _THEN_ 0.5*(_cPLoadWin_ + _cPLoadSum_) + 0.5*(_cPLoadWin_ - _cPLoadSum_) * _COS_(_Pi_/_cLengChange_ * (_Day_ - _cDayApril1_)) _ELSEIF_ (_Day_ _LT_ _cDayOct1_ - 0.5*_cLengChange_) _THEN_ _cPLoadSum_ _ELSEIF_ (_Day_ _LT_ _cDayOct1_ + 0.5*_cLengChange_) _THEN_ 0.5*(_cPLoadWin_ + _cPLoadSum_) - 0.5*(_cPLoadWin_ - _cPLoadSum_) * _COS_(_Pi_/_cLengChange_ * (_Day_ - _cDayOct1_)) _ELSE_ _cPLoadWin_ _ENDIF_;
_uPLoad_ = _IF_ (_ReadPLoad_ _EQ_ _TRUE_ _AND_ _ReadNutFrac_ _EQ_ _TRUE_) _THEN_ _mPLoadPO4_ + _mPLoadOrg_ _ELSEIF_ (_ReadPLoad_ _EQ_ _TRUE_ _AND_ _FALSE_ _EQ_ _ReadNutFrac_) _THEN_ _mPLoad_ _ELSEIF_ (_UsePulseLoad_ _EQ_ _TRUE_) _THEN_ 0.0 _ELSEIF_ (_UseSeasonLoad_ _EQ_ _TRUE_) _THEN_ _uPLoadSeason_ _ELSE_ _cPLoad_ _ENDIF_;
_uPLoadPO4_ = _IF_ (_FALSE_ _EQ_ _ReadPLoad_) _THEN_ _fPO4In_ * _uPLoad_ _ELSEIF_ (_ReadNutFrac_ _EQ_ _TRUE_) _THEN_ _mPLoadPO4_ _ELSE_ _fPO4In_ * _mPLoad_ _ENDIF_;
_uPLoadOrg_ = _IF_ (_FALSE_ _EQ_ _ReadPLoad_) _THEN_ (1.0 - _fPO4In_) * _uPLoad_ _ELSEIF_ (_ReadNutFrac_ _EQ_ _TRUE_) _THEN_ _mPLoadOrg_ _ELSE_ (1.0 - _fPO4In_) * _mPLoad_ _ENDIF_;
_uPLoadPhytTot_ = _IF_ (_FALSE_ _EQ_ _InclSeason_) _THEN_ (((_fPhytInSum_ + _fPhytInWin_)/2)*_uPLoadOrg_) _ELSEIF_ (_ReadPLoadPhyt_ _EQ_ _TRUE_) _THEN_ _mPLoadPhytTot_ _ELSE_ ((_fPhytInSum_+_fPhytInWin_)/2.0 - (_fPhytInSum_-_fPhytInWin_)/2.0 * _COS_(2.0*_Pi_ * (_sTime_ + _TenDays_ - _cTimeLag_) / _DaysPerYear_)) * _uPLoadOrg_ _ENDIF_;
_uPLoadDet_ = _uPLoadOrg_ - _uPLoadPhytTot_;
_uPLoadAIM_ = 0.0;
_iNPulse_ = 1;
_uNLoadSeason_ = _IF_ (_FALSE_ _EQ_ _UseSeasonLoad_) _THEN_ 0.0 _ELSEIF_ (_Day_ _LT_ _cDayApril1_ - 0.5*_cLengChange_) _THEN_ _cNLoadWin_ _ELSEIF_ (_Day_ _LT_ _cDayApril1_ + 0.5*_cLengChange_) _THEN_ 0.5*(_cNLoadWin_ + _cNLoadSum_) + 0.5*(_cNLoadWin_ - _cNLoadSum_) * _COS_(_Pi_/_cLengChange_ * (_Day_ - _cDayApril1_)) _ELSEIF_ (_Day_ _LT_ _cDayOct1_ - 0.5*_cLengChange_) _THEN_ _cNLoadSum_ _ELSEIF_ (_Day_ _LT_ _cDayOct1_ + 0.5*_cLengChange_) _THEN_ 0.5*(_cNLoadWin_ + _cNLoadSum_) - 0.5*(_cNLoadWin_ - _cNLoadSum_) * _COS_(_Pi_/_cLengChange_ * (_Day_ - _cDayOct1_)) _ELSE_ _cNLoadWin_ _ENDIF_;
_uNLoadPhytTot_ = _cNPPhytIn_ * _uPLoadPhytTot_;
_uNLoad_ = _IF_ (_ReadNLoad_ _EQ_ _TRUE_ _AND_ _ReadNutFrac_ _EQ_ _TRUE_) _THEN_ _mNLoadNH4_ + _mNLoadNO3_ + _mNLoadOrg_ _ELSEIF_ (_ReadNLoad_ _EQ_ _TRUE_ _AND_ _FALSE_ _EQ_ _ReadNutFrac_) _THEN_ _mNLoad_ _ELSEIF_ (_UsePulseLoad_ _EQ_ _TRUE_) _THEN_ 0.0 _ELSEIF_ (_ReadPLoad_ _EQ_ _TRUE_) _THEN_ _cNPLoadMeas_ * _uPLoad_ _ELSEIF_ (_UseSeasonLoad_ _EQ_ _TRUE_) _THEN_ _uNLoadSeason_ _ELSE_ _cNLoad_ _ENDIF_;
_uNLoadDet_ = _IF_ (_FALSE_ _EQ_ _ReadNLoad_) _THEN_ _MIN_(_cNPDetIn_ * _uPLoadDet_, _uNLoad_ - _uNLoadPhytTot_) _ELSEIF_ (_ReadNutFrac_ _EQ_ _TRUE_) _THEN_ _mNLoadOrg_ - _uNLoadPhytTot_ _ELSE_ _MIN_(_cNPDetIn_ * _uPLoadDet_, _uNLoad_ - _uNLoadPhytTot_) _ENDIF_;
_uNLoadOrg_ = _IF_ (_FALSE_ _EQ_ _ReadNLoad_) _THEN_ _uNLoadPhytTot_ + _uNLoadDet_ _ELSEIF_ (_ReadNutFrac_ _EQ_ _TRUE_) _THEN_ _mNLoadOrg_ _ELSE_ _uNLoadPhytTot_ + _uNLoadDet_ _ENDIF_;
_uNLoadDiss_ = _IF_ (_FALSE_ _EQ_ _ReadNLoad_) _THEN_ _uNLoad_ - _uNLoadOrg_ _ELSEIF_ (_ReadNutFrac_ _EQ_ _TRUE_) _THEN_ 0.0 _ELSE_ _uNLoad_ - _uNLoadOrg_ _ENDIF_;
_uNLoadNH4_ = _IF_ (_FALSE_ _EQ_ _ReadNLoad_) _THEN_ _fNH4DissIn_ * _uNLoadDiss_ _ELSEIF_ (_ReadNutFrac_ _EQ_ _TRUE_) _THEN_ _mNLoadNH4_ _ELSE_ _fNH4DissIn_ * _uNLoadDiss_ _ENDIF_;
_uNLoadNO3_ = _IF_ (_FALSE_ _EQ_ _ReadNLoad_) _THEN_ (1.0 - _fNH4DissIn_) * _uNLoadDiss_ _ELSEIF_ (_ReadNutFrac_ _EQ_ _TRUE_) _THEN_ _mNLoadNO3_ _ELSE_ (1.0 - _fNH4DissIn_) * _uNLoadDiss_ _ENDIF_;
_uNTotIn_ = _uNLoad_ / (_uQIn_ / _mmPerm_ + _NearZero_);
_uDLoadDet_ = _IF_ (_ReadDLoadDet_ _EQ_ _TRUE_) _THEN_ _mDLoadDet_ _ELSE_ _uNLoadDet_ / _cNDDetIn_ _ENDIF_;
_uDLoadPhytTot_ = _uNLoadPhytTot_ / _cNDPhytIn_;
_uDLoadIM_ = _IF_ (_ReadDLoadIM_ _EQ_ _TRUE_) _THEN_ _mDLoadIM_ _ELSE_ _cDIMIn_ * _uQIn_ / _mmPerm_ _ENDIF_;
_uDLoad_ = _uDLoadIM_ + _uDLoadDet_ + _uDLoadPhytTot_;
_uPTotIn_ = _uPLoad_ / (_uQIn_ / _mmPerm_ + _NearZero_);
_uDLoadDiat_ = _fDiatPhytIn_ * _uDLoadPhytTot_;
_uPLoadDiat_ = _fDiatPhytIn_ * _uPLoadPhytTot_;
_uNLoadDiat_ = _fDiatPhytIn_ * _uNLoadPhytTot_;
_uDLoadGren_ = _fGrenPhytIn_ * _uDLoadPhytTot_;
_uPLoadGren_ = _fGrenPhytIn_ * _uPLoadPhytTot_;
_uNLoadGren_ = _fGrenPhytIn_ * _uNLoadPhytTot_;
_uDLoadBlue_ = _fBluePhytIn_ * _uDLoadPhytTot_;
_uPLoadBlue_ = _fBluePhytIn_ * _uPLoadPhytTot_;
_uNLoadBlue_ = _fBluePhytIn_ * _uNLoadPhytTot_;
_wDDilIM_ = _ukDil_ * _sDIMW_;
_wDDilDet_ = _ukDil_ * _sDDetW_;
_wPDilPO4_ = _ukDil_ * _sPO4W_;
_wPDilDet_ = _ukDil_*_sPDetW_;
_wPDilAIM_ = _ukDil_ * _sPAIMW_;
_wNDilNH4_ = _ukDil_ * _sNH4W_;
_wNDilNO3_ = _ukDil_ * _sNO3W_;
_wNDilDet_ = _ukDil_ * _sNDetW_;
_wO2Inflow_ = _ukDilWat_ * _cO2In_;
_wO2Outfl_ = _ukDil_ * _sO2W_;
_wDDilDiat_ = _ukDil_ * _sDDiatW_;
_wPDilDiat_ = _ukDil_ * _sPDiatW_;
_wNDilDiat_ = _ukDil_ * _sNDiatW_;
_wDDilGren_ = _ukDil_ * _sDGrenW_;
_wPDilGren_ = _ukDil_ * _sPGrenW_;
_wNDilGren_ = _ukDil_ * _sNGrenW_;
_wDDilBlue_ = _ukDil_ * _sDBlueW_;
_wPDilBlue_ = _ukDil_ * _sPBlueW_;
_wNDilBlue_ = _ukDil_ * _sNBlueW_;
_wDDilPhyt_ = _wDDilDiat_ + _wDDilGren_ + _wDDilBlue_;
_wPDilPhyt_ = _wPDilDiat_ + _wPDilGren_ + _wPDilBlue_;
_wNDilPhyt_ = _wNDilDiat_ + _wNDilGren_ + _wNDilBlue_;
_wDOutflTot_ = _ukOut_ * _oDSestW_;
_wPOutflTot_ = _ukOut_ * _oPTotW_;
_wNOutflTot_ = _ukOut_ * _oNTotW_;
_wDTranDiat_ = _IF_ (_FALSE_ _EQ_ _InclTran_) _THEN_ 0.0 _ELSE_ _uDLoadDiat_ / _sDepthW_ - _wDDilDiat_ _ENDIF_;
_wPTranDiat_ = _IF_ (_FALSE_ _EQ_ _InclTran_) _THEN_ 0.0 _ELSE_ _uPLoadDiat_ / _sDepthW_ - _wPDilDiat_ _ENDIF_;
_wNTranDiat_ = _IF_ (_FALSE_ _EQ_ _InclTran_) _THEN_ 0.0 _ELSE_ _uNLoadDiat_ / _sDepthW_ - _wNDilDiat_ _ENDIF_;
_wDTranGren_ = _IF_ (_FALSE_ _EQ_ _InclTran_) _THEN_ 0.0 _ELSE_ _uDLoadGren_ / _sDepthW_ - _wDDilGren_ _ENDIF_;
_wPTranGren_ = _IF_ (_FALSE_ _EQ_ _InclTran_) _THEN_ 0.0 _ELSE_ _uPLoadGren_ / _sDepthW_ - _wPDilGren_ _ENDIF_;
_wNTranGren_ = _IF_ (_FALSE_ _EQ_ _InclTran_) _THEN_ 0.0 _ELSE_ _uNLoadGren_ / _sDepthW_ - _wNDilGren_ _ENDIF_;
_wDTranBlue_ = _IF_ (_FALSE_ _EQ_ _InclTran_) _THEN_ 0.0 _ELSE_ _uDLoadBlue_ / _sDepthW_ - _wDDilBlue_ _ENDIF_;
_wPTranBlue_ = _IF_ (_FALSE_ _EQ_ _InclTran_) _THEN_ 0.0 _ELSE_ _uPLoadBlue_ / _sDepthW_ - _wPDilBlue_ _ENDIF_;
_wNTranBlue_ = _IF_ (_FALSE_ _EQ_ _InclTran_) _THEN_ 0.0 _ELSE_ _uNLoadBlue_ / _sDepthW_ - _wNDilBlue_ _ENDIF_;
_wDTranPhyt_ = _IF_ (_FALSE_ _EQ_ _InclTran_) _THEN_ 0.0 _ELSE_ _wDTranDiat_ + _wDTranGren_ + _wDTranBlue_ _ENDIF_;
_wPTranPhyt_ = _IF_ (_FALSE_ _EQ_ _InclTran_) _THEN_ 0.0 _ELSE_ _wPTranDiat_ + _wPTranGren_ + _wPTranBlue_ _ENDIF_;
_wNTranPhyt_ = _IF_ (_FALSE_ _EQ_ _InclTran_) _THEN_ 0.0 _ELSE_ _wNTranDiat_ + _wNTranGren_ + _wNTranBlue_ _ENDIF_;
_uSiLoadSiO2_ = _cSiO2In_ * _uQIn_ / _mmPerm_;
_uSiLoadDet_ = _cSiDDetIn_ * _uDLoadDet_;
_uSiLoadDiat_ = _cSiDDiat_ * _uDLoadDiat_;
_uSiLoad_ = _uSiLoadSiO2_ + _uSiLoadDet_ + _uSiLoadDiat_;
_wSiDilSiO2_ = _ukDil_ * _sSiO2W_;
_wSiDilDet_ = _ukDil_ * _sSiDetW_;
_wSiDilDiat_ = _cSiDDiat_ * _wDDilDiat_;
_wSiOutflTot_ = _ukOut_ * (_sSiO2W_ + _sSiDetW_ + _cSiDDiat_ * _sDDiatW_);
_wSiTranSiO2_ = _IF_ (_FALSE_ _EQ_ _InclTran_) _THEN_ 0.0 _ELSE_ _uSiLoadSiO2_ / _sDepthW_ - _wSiDilSiO2_ _ENDIF_;
_wSiTranDetW_ = _IF_ (_FALSE_ _EQ_ _InclTran_) _THEN_ 0.0 _ELSE_ _uSiLoadDet_ / _sDepthW_ - _wSiDilDet_ _ENDIF_;
_tSiTranTotT_ = _IF_ (_FALSE_ _EQ_ _InclTran_) _THEN_ 0.0 _ELSE_ _uSiLoadSiO2_ + _uSiLoadDet_ + _uSiLoadDiat_ - (_wSiDilDet_ + _wSiDilSiO2_ + _wSiDilDiat_) * _sDepthW_ _ENDIF_;
_wDTranZoo_ = _IF_ (_FALSE_ _EQ_ _InclTran_) _THEN_ 0.0 _ELSE_( _ukDilWat_ * _cDZooIn_ - _ukDil_*_sDZoo_) _ENDIF_;
_wPTranZoo_ = _IF_ (_FALSE_ _EQ_ _InclTran_) _THEN_ 0.0 _ELSE_(_ukDilWat_ * _cPDZooRef_*_cDZooIn_ - _ukDil_*_sPZoo_) _ENDIF_;
_wNTranZoo_ = _IF_ (_FALSE_ _EQ_ _InclTran_) _THEN_ 0.0 _ELSE_(_ukDilWat_ * _cNDZooRef_*_cDZooIn_ - _ukDil_ * _sNZoo_) _ENDIF_;
_wDTranIMW_ = _IF_ (_FALSE_ _EQ_ _InclTran_) _THEN_ 0.0 _ELSE_ _uDLoadIM_ / _sDepthW_ - _wDDilIM_ _ENDIF_;
_wDTranDetW_ = _IF_ (_FALSE_ _EQ_ _InclTran_) _THEN_ 0.0 _ELSE_ _uDLoadDet_ / _sDepthW_ - _wDDilDet_ _ENDIF_;
_wO2TranW_ = _IF_ (_FALSE_ _EQ_ _InclTran_) _THEN_ 0.0 _ELSE_ _wO2Inflow_ - _wO2Outfl_ _ENDIF_;
_wPTranPO4W_ = _IF_ (_FALSE_ _EQ_ _InclTran_) _THEN_ 0.0 _ELSE_ _uPLoadPO4_ / _sDepthW_ - _wPDilPO4_ _ENDIF_;
_wPTranAIMW_ = _IF_ (_FALSE_ _EQ_ _InclTran_) _THEN_ 0.0 _ELSE_ _uPLoadAIM_ / _sDepthW_ - _wPDilAIM_ _ENDIF_;
_wPTranDetW_ = _IF_ (_FALSE_ _EQ_ _InclTran_) _THEN_ 0.0 _ELSE_ _uPLoadDet_ / _sDepthW_ - _wPDilDet_ _ENDIF_;
_wNTranNH4W_ = _IF_ (_FALSE_ _EQ_ _InclTran_) _THEN_ 0.0 _ELSE_ _uNLoadNH4_ / _sDepthW_ - _wNDilNH4_ _ENDIF_;
_wNTranNO3W_ = _IF_ (_FALSE_ _EQ_ _InclTran_) _THEN_ 0.0 _ELSE_ _uNLoadNO3_ / _sDepthW_ - _wNDilNO3_ _ENDIF_;
_wNTranDetW_ = _IF_ (_FALSE_ _EQ_ _InclTran_) _THEN_ 0.0 _ELSE_ _uNLoadDet_ / _sDepthW_ - _wNDilDet_ _ENDIF_;
_wDDilTot_ = _wDDilIM_ + _wDDilDet_ + _wDDilPhyt_;
_wPDilTot_ = _wPDilDet_ + _wPDilPO4_ + _wPDilAIM_ + _wPDilPhyt_;
_wNDilTot_ = _wNDilDet_ + _wNDilNO3_ + _wNDilNH4_ + _wNDilPhyt_;
_wSiDilTot_ = _wSiDilDet_ + _wSiDilSiO2_ + _wSiDilDiat_;
_tDTranTotT_ = _IF_ (_FALSE_ _EQ_ _InclTran_) _THEN_ 0.0 _ELSE_ _uDLoad_ - _wDDilTot_ * _sDepthW_ _ENDIF_;
_tPTranTotT_ = _IF_ (_FALSE_ _EQ_ _InclTran_) _THEN_ 0.0 _ELSE_ _uPLoad_ - _wPDilTot_ * _sDepthW_ _ENDIF_;
_tNTranTotT_ = _IF_ (_FALSE_ _EQ_ _InclTran_) _THEN_ 0.0 _ELSE_ _uNLoad_ - _wNDilTot_ * _sDepthW_ _ENDIF_;
_wDExchIMM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchM_ *(_sDIMW_ - _sDIMWM_) _ELSE_ 0.0 _ENDIF_;
_wPExchPO4M_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchM_ *(_sPO4W_ - _sPO4WM_) _ELSE_ 0.0 _ENDIF_;
_wPExchAIMM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchM_ *(_sPAIMW_ - _sPAIMWM_) _ELSE_ 0.0 _ENDIF_;
_wNExchNH4M_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchM_ *(_sNH4W_ - _sNH4WM_) _ELSE_ 0.0 _ENDIF_;
_wNExchNO3M_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchM_ *(_sNO3W_ - _sNO3WM_) _ELSE_ 0.0 _ENDIF_;
_wSiExchSiO2M_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchM_ *(_sSiO2W_ - _sSiO2WM_) _ELSE_ 0.0 _ENDIF_;
_wO2ExchM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchM_ *(_sO2W_ - _sO2WM_) _ELSE_ 0.0 _ENDIF_;
_wDExchDetM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchM_ *(_sDDetW_ - _sDDetWM_) _ELSE_ 0.0 _ENDIF_;
_wPExchDetM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchM_ *(_sPDetW_ - _sPDetWM_) _ELSE_ 0.0 _ENDIF_;
_wNExchDetM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchM_ *(_sNDetW_ - _sNDetWM_) _ELSE_ 0.0 _ENDIF_;
_wSiExchDetM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchM_ *(_sSiDetW_ - _sSiDetWM_) _ELSE_ 0.0 _ENDIF_;
_wDExchDiatM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchM_ *(_sDDiatW_ - _sDDiatWM_) _ELSE_ 0.0 _ENDIF_;
_wPExchDiatM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchM_ *(_sPDiatW_ - _sPDiatWM_) _ELSE_ 0.0 _ENDIF_;
_wNExchDiatM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchM_ *(_sNDiatW_ - _sNDiatWM_) _ELSE_ 0.0 _ENDIF_;
_wSiExchDiatM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _cSiDDiat_ * _wDExchDiatM_ _ELSE_ 0.0 _ENDIF_;
_wDExchGrenM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchM_ *(_sDGrenW_ - _sDGrenWM_) _ELSE_ 0.0 _ENDIF_;
_wPExchGrenM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchM_ *(_sPGrenW_ - _sPGrenWM_) _ELSE_ 0.0 _ENDIF_;
_wNExchGrenM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchM_ *(_sNGrenW_ - _sNGrenWM_) _ELSE_ 0.0 _ENDIF_;
_wDExchBlueM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchM_ *(_sDBlueW_ - _sDBlueWM_) _ELSE_ 0.0 _ENDIF_;
_wPExchBlueM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchM_ *(_sPBlueW_ - _sPBlueWM_) _ELSE_ 0.0 _ENDIF_;
_wNExchBlueM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchM_ *(_sNBlueW_ - _sNBlueWM_) _ELSE_ 0.0 _ENDIF_;
_wDExchZooM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchM_ *(_sDZoo_ - _sDZooM_) _ELSE_ 0.0 _ENDIF_;
_wPExchZooM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchM_ *(_sPZoo_ - _sPZooM_) _ELSE_ 0.0 _ENDIF_;
_wNExchZooM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchM_ *(_sNZoo_ - _sNZooM_) _ELSE_ 0.0 _ENDIF_;
_wDExchIM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchL_ *(_sDIMW_ - _sDIMWM_) _ELSE_ 0.0 _ENDIF_;
_wPExchPO4_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchL_ *(_sPO4W_ - _sPO4WM_) _ELSE_ 0.0 _ENDIF_;
_wPExchAIM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchL_ *(_sPAIMW_ - _sPAIMWM_) _ELSE_ 0.0 _ENDIF_;
_wNExchNH4_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchL_ *(_sNH4W_ - _sNH4WM_) _ELSE_ 0.0 _ENDIF_;
_wNExchNO3_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchL_ *(_sNO3W_ - _sNO3WM_) _ELSE_ 0.0 _ENDIF_;
_wSiExchSiO2_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchL_ *(_sSiO2W_ - _sSiO2WM_) _ELSE_ 0.0 _ENDIF_;
_wO2Exch_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchL_ *(_sO2W_ - _sO2WM_) _ELSE_ 0.0 _ENDIF_;
_wDExchDet_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchL_ *(_sDDetW_ - _sDDetWM_) _ELSE_ 0.0 _ENDIF_;
_wPExchDet_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchL_ *(_sPDetW_ - _sPDetWM_) _ELSE_ 0.0 _ENDIF_;
_wNExchDet_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchL_ *(_sNDetW_ - _sNDetWM_) _ELSE_ 0.0 _ENDIF_;
_wSiExchDet_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchL_ *(_sSiDetW_ - _sSiDetWM_) _ELSE_ 0.0 _ENDIF_;
_wDExchDiat_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchL_ *(_sDDiatW_ - _sDDiatWM_) _ELSE_ 0.0 _ENDIF_;
_wPExchDiat_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchL_ *(_sPDiatW_ - _sPDiatWM_) _ELSE_ 0.0 _ENDIF_;
_wNExchDiat_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchL_ *(_sNDiatW_ - _sNDiatWM_) _ELSE_ 0.0 _ENDIF_;
_wSiExchDiat_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _cSiDDiat_ * _wDExchDiat_ _ELSE_ 0.0 _ENDIF_;
_wDExchGren_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchL_ *(_sDGrenW_ - _sDGrenWM_) _ELSE_ 0.0 _ENDIF_;
_wPExchGren_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchL_ *(_sPGrenW_ - _sPGrenWM_) _ELSE_ 0.0 _ENDIF_;
_wNExchGren_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchL_ *(_sNGrenW_ - _sNGrenWM_) _ELSE_ 0.0 _ENDIF_;
_wDExchBlue_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchL_ *(_sDBlueW_ - _sDBlueWM_) _ELSE_ 0.0 _ENDIF_;
_wPExchBlue_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchL_ *(_sPBlueW_ - _sPBlueWM_) _ELSE_ 0.0 _ENDIF_;
_wNExchBlue_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchL_ *(_sNBlueW_ - _sNBlueWM_) _ELSE_ 0.0 _ENDIF_;
_wDExchZoo_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchL_ *(_sDZoo_ - _sDZooM_) _ELSE_ 0.0 _ENDIF_;
_wPExchZoo_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchL_ *(_sPZoo_ - _sPZooM_) _ELSE_ 0.0 _ENDIF_;
_wNExchZoo_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _akExchL_ *(_sNZoo_ - _sNZooM_) _ELSE_ 0.0 _ENDIF_;
_tPInfPO4W_ = _IF_ (_cQInf_ _GE_ 0.0) _THEN_ _cQInf_ / _mmPerm_ * _sPO4W_ _ELSE_ _cQInf_ / _mmPerm_ * _oPO4S_ _ENDIF_;
_tNInfNH4W_ = _IF_ (_cQInf_ _GE_ 0.0) _THEN_ _cQInf_ / _mmPerm_ * _sNH4W_ _ELSE_ _cQInf_ / _mmPerm_ * _oNH4S_ _ENDIF_;
_tNInfNO3W_ = _IF_ (_cQInf_ _GE_ 0.0) _THEN_ _cQInf_ / _mmPerm_ * _sNO3W_ _ELSE_ _cQInf_ / _mmPerm_ * _oNO3S_ _ENDIF_;
_tPInfPO4S_ = _IF_ (_cQInf_ _GE_ 0.0) _THEN_ _cQInf_ / _mmPerm_ * _oPO4S_ _ELSE_ _cQInf_ / _mmPerm_ * _cPO4Ground_ _ENDIF_;
_tNInfNH4S_ = _IF_ (_cQInf_ _GE_ 0.0) _THEN_ _cQInf_ / _mmPerm_ * _oNH4S_ _ELSE_ _cQInf_ / _mmPerm_ * _cNH4Ground_ _ENDIF_;
_tNInfNO3S_ = _IF_ (_cQInf_ _GE_ 0.0) _THEN_ _cQInf_ / _mmPerm_ * _oNO3S_ _ELSE_ _cQInf_ / _mmPerm_ * _cNO3Ground_  _ENDIF_;
_tNH4LoadS_ = _fNH4LoadS_ * _cNLoadS_;
_tNO3LoadS_ = _cNLoadS_ - _tNH4LoadS_;
_uDErosIM_ = (1.0 - _fDOrgSoil_) * _cDErosTot_;
_uDErosIMS_ = _fSedErosIM_ * _uDErosIM_;
_uDErosIMW_ = _uDErosIM_ - _uDErosIMS_;
_uDErosOM_ = _fDOrgSoil_ * _cDErosTot_;
_uPErosOM_ = _cPDSoilOM_ * _uDErosOM_;
_uNErosOM_ = _cNDSoilOM_ * _uDErosOM_;
_uO2Sat_ = 14.652 - 0.41022 * _uTm_ + 0.007991 * _uTm_*_uTm_ - 0.000077774 * _uTm_*_uTm_*_uTm_;
_kAer_ = _cAerRoot_ * _POW_(_uVWind_ , (0.5)) + _cAerLin_ * _uVWind_ + _cAerSquare_ * _uVWind_*_uVWind_;
_uFunTmAer_ = _POW_(_cThetaAer_ , (_uTm_-_cTmRef_));
_aFunLemnAer_ = 1.0;
_tO2Aer_ = _kAer_ * _uFunTmAer_ * (_uO2Sat_ - _sO2W_) * _aFunLemnAer_;
_uFunTmFish_ = _IF_ (_InclWeb_ _EQ_ _TRUE_) _THEN_ _EXP_( -0.5/(_cSigTmFish_*_cSigTmFish_) * ((_uTm_ - _cTmOptFish_)*(_uTm_ - _cTmOptFish_) - (_cTmRef_ - _cTmOptFish_)*(_cTmRef_ - _cTmOptFish_))) _ELSE_ 0.0 _ENDIF_;
_tDTurbFish_ = _IF_ (_InclWeb_ _EQ_ _TRUE_) _THEN_ (_kTurbFish_ * _uFunTmFish_ * _sDFiAd_) _ELSE_ 0.0 _ENDIF_;
_tDTurbFishIM_ = _fLutum_ * _sDIMS_ / (_fLutum_ * _sDIMS_ + _sDDetS_) * _tDTurbFish_;
_aFunVegResus_ = _MAX_(1.0 - _kVegResus_ * _sDVeg_, 0.0);
_aFunDimSusp_ = _IF_ (_uTm_ _GE_ 0.1) _THEN_ _cSuspRef_ * ((_cSuspMin_ + _cSuspMax_ / (1.0 + _EXP_(_cSuspSlope_ * (_sDepthW_ - _hDepthSusp_)))) * _POW_(((_cFetch_ +_NearZero_)/ _cFetchRef_) , (0.5))) _ELSE_ 0.0 _ENDIF_;
_tDResusTauDead_ = _MIN_(_aFunDimSusp_, _POW_(_aFunDimSusp_ +_NearZero_ , (0.5))) * _POW_(_fLutum_ / _fLutumRef_ , (0.5)) * _bPorS_;
_tDResusBareDead_ = _tDResusTauDead_ + _tDTurbFish_;
_tDResusDead_ = _tDResusBareDead_ * _aFunVegResus_;
_tDResusIM_ = _fLutum_ * _sDIMS_ / (_fLutum_ * _sDIMS_ + _sDDetS_) * _tDResusDead_;
_tDResusDet_ = _sDDetS_ / (_fLutum_ * _sDIMS_ + _sDDetS_) * _tDResusDead_;
_akResusPhytRef_ = _kResusPhytMax_ * (1.0 - _EXP_(_cResusPhytExp_ * _tDResusDead_));
_tDResusPhytTot_ = _akResusPhytRef_ * _aDPhytS_;
_tPResusDet_ = _rPDDetS_ * _tDResusDet_;
_tPResusPO4_ = _sPO4S_ / _sDDetS_ * _tDResusDet_;
_tPResusAIM_ = _sPAIMS_ / _sDIMS_ * _tDResusIM_;
_tNResusNO3_ = _sNO3S_ / _sDDetS_ * _tDResusDet_;
_tNResusNH4_ = _sNH4S_ / _sDDetS_ * _tDResusDet_;
_tNResusDet_ = _rNDDetS_ * _tDResusDet_;
_tSiResusDet_ = _rSiDDetS_ * _tDResusDet_;
_aFunTauSetOM_ = _MIN_(1.0 / _POW_(_aFunDimSusp_ +_NearZero_ , (0.5)), 1.0);
_aFunTauSetIM_ = _aFunTauSetOM_;
_uFunTmSet_ = _POW_(_cThetaSet_ , (_uTm_-_cTmRef_));
_uCorVSetIM_ = _aFunTauSetIM_ * _POW_((_fLutumRef_/_fLutum_) , (0.5)) * _uFunTmSet_ * _cVSetIM_;
_tDSetIM_ = _uCorVSetIM_ * _sDIMW_;
_tPSetAIM_ = _sPAIMW_ / _sDIMW_ * _tDSetIM_;
_uCorVSetDet_ = _cVSetDet_ * _aFunTauSetOM_ * _uFunTmSet_;
_tDSetDet_ = _uCorVSetDet_ * _sDDetW_;
_tPSetDet_ = _uCorVSetDet_ * _sPDetW_;
_tNSetDet_ = _uCorVSetDet_ * _sNDetW_;
_tSiSetDet_ = _uCorVSetDet_ * _sSiDetW_;
_kPMinDetW_ = _kDMinDetW_;
_kNMinDetW_ = _kDMinDetW_;
_kSiMinDetW_ = _kDMinDetW_;
_uFunTmMinW_ = _POW_(_cThetaMinW_ , (_uTm_-_cTmRef_));
_wDMinDetW_ = _kDMinDetW_ * _uFunTmMinW_ * _sDDetW_;
_wPMinDetW_ = _kPMinDetW_ * _uFunTmMinW_ * _sPDetW_;
_wNMinDetW_ = _kNMinDetW_ * _uFunTmMinW_ * _sNDetW_;
_wSiMinDetW_ = _kSiMinDetW_ * _uFunTmMinW_ * _sSiDetW_;
_aCorO2BOD_ = _sO2W_ / (_hO2BOD_ + _sO2W_);
_wO2MinDetW_ = _molO2molC_ * _cCPerDW_ * _aCorO2BOD_ * _wDMinDetW_;
_wDDenitW_ = _sNO3W_*_sNO3W_ / (_hNO3Denit_*_hNO3Denit_ + _sNO3W_*_sNO3W_) * (1.0 - _aCorO2BOD_) * _wDMinDetW_;
_wNDenitW_ = _NO3PerC_ * _molNmolC_ * _cCPerDW_ * _wDDenitW_;
_uFunTmNitr_ = _POW_(_cThetaNitr_ , (_uTm_-_cTmRef_));
_aCorO2NitrW_ = _sO2W_*_sO2W_ / (_hO2Nitr_*_hO2Nitr_ + _sO2W_*_sO2W_);
_wNNitrW_ = _kNitrW_ * _uFunTmNitr_ * _aCorO2NitrW_ * _sNH4W_;
_wO2NitrW_ = _O2PerNH4_ * _molO2molN_ * _wNNitrW_;
_kPMinDetS_ = _kDMinDetS_;
_kNMinDetS_ = _kDMinDetS_;
_kSiMinDetS_ = _kDMinDetS_;
_uFunTmMinS_ = _POW_(_cThetaMinS_ , (_uTm_-_cTmRef_));
_tDMinDetS_ = _kDMinDetS_ * _uFunTmMinS_ * _sDDetS_;
_tPMinDetS_ = _kPMinDetS_ * _uFunTmMinS_ * _sPDetS_;
_tNMinDetS_ = _kNMinDetS_ * _uFunTmMinS_ * _sNDetS_;
_tSiMinDetS_ = _kSiMinDetS_ * _uFunTmMinS_ * _sSiDetS_;
_uFunTmDif_ = _POW_(_cThetaDif_ , (_uTm_-_cTmRef_));
_akO2DifCor_ = _kO2Dif_ * _uFunTmDif_ * _cTurbDifO2_ * _bPorCorS_;
_tSOD_ = (_molO2molC_ * _cCPerDW_ * (1.0 - _fRefrDetS_) * _tDMinDetS_ + _O2PerNH4_ * _molO2molN_ * _kNitrS_ * _uFunTmNitr_ * _sNH4S_) / _cDepthS_;
_aDepthOxySed_ = _POW_((2.0 * _sO2W_ * _akO2DifCor_ / _tSOD_) , (0.5));
_afOxySed_ = _aDepthOxySed_ / _cDepthS_;
_tDMinOxyDetS_ = _afOxySed_ * (1.0 - _fRefrDetS_) * _tDMinDetS_;
_tO2MinDetS_ = _molO2molC_ * _cCPerDW_ * _tDMinOxyDetS_;
_tDDenitS_ = _oNO3S_*_oNO3S_ / (_hNO3Denit_*_hNO3Denit_ + _oNO3S_*_oNO3S_) * (1.0 - _afOxySed_) * (1.0 - _fRefrDetS_) * _tDMinDetS_;
_tNDenitS_ = _NO3PerC_ * _molNmolC_ * _cCPerDW_ * _tDDenitS_;
_tNNitrS_ = _afOxySed_ * _kNitrS_ * _uFunTmNitr_ * _sNH4S_;
_tO2NitrS_ = _O2PerNH4_ * _molO2molN_ * _tNNitrS_;
_tDMinHumS_ = _kDMinHum_ * _uFunTmMinS_ * _afOxySed_ * _sDHumS_;
_tPMinHumS_ = _kDMinHum_ * _uFunTmMinS_ * _afOxySed_ * _sPHumS_;
_tNMinHumS_ = _kDMinHum_ * _uFunTmMinS_ * _afOxySed_ * _sNHumS_;
_aDepthDif_ = _fDepthDifS_ * _cDepthS_;
_tPDifPO4_ = _kPDifPO4_ * _uFunTmDif_ * _cTurbDifNut_ * _bPorCorS_ * (_oPO4S_ - _sPO4W_ ) / _aDepthDif_;
_tNDifNO3_ = _kNDifNO3_ * _uFunTmDif_ * _cTurbDifNut_ * _bPorCorS_ * (_oNO3S_ - _sNO3W_ ) / _aDepthDif_;
_tNDifNH4_ = _kNDifNH4_ * _uFunTmDif_ * _cTurbDifNut_ * _bPorCorS_ * (_oNH4S_ - _sNH4W_ ) / _aDepthDif_;
_tO2Dif_ = _kO2Dif_ / _aDepthDif_ * _uFunTmDif_ * _cTurbDifO2_ * _bPorCorS_ * _sO2W_;
_tPDifGroundPO4_ = 0.0;
_tNDifGroundNO3_ = 0.0;
_tNDifGroundNH4_ = 0.0;
_aPAdsMaxW_ = _cRelPAdsD_ + _aCorO2BOD_ * _cRelPAdsFe_ * _fFeDIM_ + _cRelPAdsAl_ * _fAlDIM_;
_aKPAdsW_ = (1.0 - _fRedMax_ * (1.0-_aCorO2BOD_)) * _cKPAdsOx_;
_aPIsoAdsW_ = _aPAdsMaxW_ * _aKPAdsW_ * _sPO4W_ / (1.0 + _aKPAdsW_ * _sPO4W_);
_aPEqIMW_ = _aPIsoAdsW_ * _sDIMW_;
_wPSorpIMW_ = _kPSorp_ * (_aPEqIMW_ - _sPAIMW_);
_aPAdsMaxS_ = _cRelPAdsD_ + _afOxySed_ * _cRelPAdsFe_ * _fFeDIM_ + _cRelPAdsAl_ * _fAlDIM_;
_aKPAdsS_ = (1.0 - _fRedMax_ * (1.0-_afOxySed_)) * _cKPAdsOx_;
_aPIsoAdsS_ = _aPAdsMaxS_ * _aKPAdsS_ * _oPO4S_ / (1.0 + _aKPAdsS_ * _oPO4S_);
_aPEqIMS_ = _aPIsoAdsS_ * _sDIMS_;
_tPSorpIMS_ = _kPSorp_ * (_aPEqIMS_ - _sPAIMS_);
_tPChemPO4_ = _MAX_( 0.0, _kPChemPO4_ * (_oPO4S_ - _coPO4Max_) );
_wDAbioIMW_ = (_uDErosIMW_ - _tDSetIM_ + _tDResusIM_) / _sDepthW_;
_wDAbioDetW_ = (- _tDSetDet_ + _tDResusDet_ ) / _sDepthW_ - _wDMinDetW_;
_tDAbioIMS_ = _uDErosIMS_ + _tDSetIM_ - _tDResusIM_;
_tDAbioDetS_ = _tDSetDet_ - _tDResusDet_ - _tDMinDetS_;
_tDAbioHumS_ = _uDErosOM_ + _fRefrDetS_ * _tDMinDetS_ - _tDMinHumS_;
_tDAbioTotT_ = _cDErosTot_ - _wDMinDetW_ * _sDepthW_ - (1.0 - _fRefrDetS_) * _tDMinDetS_ - _tDMinHumS_;
_wO2AbioW_ = _tO2Aer_ / _sDepthW_ - _wO2MinDetW_ - _wO2NitrW_ - (_tO2MinDetS_ + _tO2NitrS_) / _sDepthW_;
_wPAbioDetW_ = - _wPMinDetW_ - (_tPSetDet_ - _tPResusDet_) / _sDepthW_;
_wPAbioPO4W_ = _wPMinDetW_ - _wPSorpIMW_ - _tPInfPO4W_ / _sDepthW_ + _tPDifPO4_ / _sDepthW_ + _tPResusPO4_ / _sDepthW_;
_wPAbioAIMW_ = (- _tPSetAIM_ + _tPResusAIM_) / _sDepthW_ + _wPSorpIMW_;
_tPAbioDetS_ = - _tPMinDetS_ + _tPSetDet_ - _tPResusDet_;
_tPAbioHumS_ = _uPErosOM_ + _fRefrDetS_ * _tPMinDetS_ - _tPMinHumS_;
_tPAbioPO4S_ = _tPInfPO4W_ - _tPInfPO4S_ + (1.0-_fRefrDetS_) * _tPMinDetS_ + _tPMinHumS_ - _tPSorpIMS_ - _tPResusPO4_ - _tPDifPO4_ - _tPDifGroundPO4_ - _tPChemPO4_;
_tPAbioAIMS_ = _tPSetAIM_ - _tPResusAIM_ + _tPSorpIMS_;
_tPAbioTotT_ = _uPErosOM_ - _tPChemPO4_ - _tPInfPO4S_ - _tPDifGroundPO4_;
_wNAbioNH4W_ = _wNMinDetW_ - _wNNitrW_ - _tNInfNH4W_ / _sDepthW_ + (_tNDifNH4_ + _tNResusNH4_) / _sDepthW_;
_wNAbioNO3W_ = _wNNitrW_ - _wNDenitW_ + (_tNDifNO3_ + _tNResusNO3_ - _tNInfNO3W_) / _sDepthW_;
_wNAbioDetW_ = - _wNMinDetW_ - (_tNSetDet_ - _tNResusDet_ ) / _sDepthW_;
_tNAbioNH4S_ = _tNInfNH4W_ - _tNInfNH4S_ + (1.0-_fRefrDetS_) * _tNMinDetS_ + _tNMinHumS_ - _tNResusNH4_ - _tNDifNH4_ - _tNDifGroundNH4_ - _tNNitrS_;
_tNAbioNO3S_ = _tNInfNO3W_ - _tNInfNO3S_ + _tNNitrS_ - _tNDenitS_ - _tNResusNO3_ - _tNDifNO3_ - _tNDifGroundNO3_;
_tNAbioDetS_ = - _tNMinDetS_ + _tNSetDet_ - _tNResusDet_;
_tNAbioHumS_ = _uNErosOM_ + _fRefrDetS_ * _tNMinDetS_ - _tNMinHumS_;
_tNAbioTotT_ = _uNErosOM_ - _tNDenitS_ - _wNDenitW_ * _sDepthW_ - _tNInfNH4S_ - _tNInfNO3S_ - _tNDifGroundNO3_ - _tNDifGroundNH4_;
_wSiAbioSiO2W_ = _wSiMinDetW_ + (1.0 - _fRefrDetS_) * _tSiMinDetS_ / _sDepthW_;
_wSiAbioDetW_ = - _wSiMinDetW_ - (_tSiSetDet_ - _tSiResusDet_) / _sDepthW_;
_tSiAbioDetS_ = - _tSiMinDetS_ + _tSiSetDet_ - _tSiResusDet_;
_tSiAbioTotT_ = - _fRefrDetS_ * _tSiMinDetS_;
_uQEvPhra_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _uQEv_ _ELSE_ 0.0 _ENDIF_;
_tPEvPO4WM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _uQEvPhra_ / _mmPerm_ * _sPO4WM_ _ELSE_ 0.0 _ENDIF_;
_tNEvNH4WM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _uQEvPhra_ / _mmPerm_ * _sNH4WM_ _ELSE_ 0.0 _ENDIF_;
_tNEvNO3WM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _uQEvPhra_ / _mmPerm_ * _sNO3WM_ _ELSE_ 0.0 _ENDIF_;
_tPInfPO4WM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ 0.0 _ELSEIF_ (_cQInf_ _GE_ 0.0) _THEN_ _cQInf_ / _mmPerm_ * _sPO4WM_ _ELSE_ _cQInf_ / _mmPerm_ * _oPO4SM_ _ENDIF_;
_tNInfNH4WM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ 0.0 _ELSEIF_ (_cQInf_ _GE_ 0.0) _THEN_ _cQInf_ / _mmPerm_ * _sNH4WM_ _ELSE_ _cQInf_ / _mmPerm_ * _oNH4SM_ _ENDIF_;
_tNInfNO3WM_ = _IF_ (_FALSE_ _EQ_ _InclMarsh_ _OR_ _fMarsh_ _LE_ _NearZero_) _THEN_ 0.0 _ELSEIF_ (_cQInf_ _GE_ 0.0) _THEN_ _cQInf_ / _mmPerm_ * _sNO3WM_ _ELSE_ _cQInf_ / _mmPerm_ * _oNO3SM_ _ENDIF_;
_tPInfPO4SM_ = _IF_ (_FALSE_ _EQ_ _InclMarsh_ _OR_ _fMarsh_ _LE_ _NearZero_) _THEN_ 0.0 _ELSEIF_ (_cQInf_ _GE_ 0.0) _THEN_ _cQInf_ / _mmPerm_ * _oPO4SM_ _ELSE_ _cQInf_ / _mmPerm_ * _cPO4Ground_ _ENDIF_;
_tNInfNH4SM_ = _IF_ (_FALSE_ _EQ_ _InclMarsh_ _OR_ _fMarsh_ _LE_ _NearZero_) _THEN_ 0.0 _ELSEIF_ (_cQInf_ _GE_ 0.0) _THEN_ _cQInf_ / _mmPerm_ * _oNH4SM_ _ELSE_ _cQInf_ / _mmPerm_ * _oNH4SM_ _ENDIF_;
_tNInfNO3SM_ = _IF_ (_FALSE_ _EQ_ _InclMarsh_ _OR_ _fMarsh_ _LE_ _NearZero_) _THEN_ 0.0 _ELSEIF_ (_cQInf_ _GE_ 0.0) _THEN_ _cQInf_ / _mmPerm_ * _oNO3SM_ _ELSE_ _cQInf_ / _mmPerm_ * _oNO3SM_ _ENDIF_;
_tO2AerM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _kAer_ * _uFunTmAer_ *(_uO2Sat_ - _sO2WM_) _ELSE_ 0.0 _ENDIF_;
_tDSetIMM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _cVSetIM_ * _uFunTmSet_ * _sDIMWM_ _ELSE_ 0.0 _ENDIF_;
_tPSetAIMM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _cVSetIM_ * _uFunTmSet_ * _sPAIMWM_ _ELSE_ 0.0 _ENDIF_;
_tDSetDetM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _cVSetDet_ * _uFunTmSet_ * _sDDetWM_ _ELSE_ 0.0 _ENDIF_;
_tPSetDetM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _cVSetDet_ * _uFunTmSet_* _sPDetWM_ _ELSE_ 0.0 _ENDIF_;
_tNSetDetM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _cVSetDet_ * _uFunTmSet_* _sNDetWM_ _ELSE_ 0.0 _ENDIF_;
_tSiSetDetM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _cVSetDet_ * _uFunTmSet_ * _sSiDetWM_ _ELSE_ 0.0 _ENDIF_;
_tDSetDiatM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _cVSetDiat_ * _uFunTmSet_ * _sDDiatWM_ _ELSE_ 0.0 _ENDIF_;
_tPSetDiatM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _cVSetDiat_ * _uFunTmSet_* _sPDiatWM_ _ELSE_ 0.0 _ENDIF_;
_tNSetDiatM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _cVSetDiat_ * _uFunTmSet_* _sNDiatWM_ _ELSE_ 0.0 _ENDIF_;
_tSiSetDiatM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _cVSetDiat_ * _uFunTmSet_ * _oSiDiatWM_ _ELSE_ 0.0 _ENDIF_;
_tDSetGrenM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _cVSetGren_ * _uFunTmSet_ * _sDGrenWM_ _ELSE_ 0.0 _ENDIF_;
_tPSetGrenM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _cVSetGren_ * _uFunTmSet_* _sPGrenWM_ _ELSE_ 0.0 _ENDIF_;
_tNSetGrenM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _cVSetGren_ * _uFunTmSet_* _sNGrenWM_ _ELSE_ 0.0 _ENDIF_;
_tDSetBlueM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _cVSetBlue_ * _uFunTmSet_ * _sDBlueWM_ _ELSE_ 0.0 _ENDIF_;
_tPSetBlueM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _cVSetBlue_ * _uFunTmSet_* _sPBlueWM_ _ELSE_ 0.0 _ENDIF_;
_tNSetBlueM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _cVSetBlue_ * _uFunTmSet_* _sNBlueWM_ _ELSE_ 0.0 _ENDIF_;
_tDSetPhytM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _tDSetDiatM_ + _tDSetGrenM_ + _tDSetBlueM_ _ELSE_ 0.0 _ENDIF_;
_tPSetPhytM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _tPSetDiatM_ + _tPSetGrenM_ + _tPSetBlueM_ _ELSE_ 0.0 _ENDIF_;
_tNSetPhytM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _tNSetDiatM_ + _tNSetGrenM_ + _tNSetBlueM_ _ELSE_ 0.0 _ENDIF_;
_tDSetTotM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _tDSetIMM_ + _tDSetDetM_ + _tDSetPhytM_ _ELSE_ 0.0 _ENDIF_;
_wDMinDetWM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _kDMinDetW_ * _uFunTmMinW_ * _sDDetWM_ _ELSE_ 0.0 _ENDIF_;
_wPMinDetWM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _kPMinDetW_ * _uFunTmMinW_ * _sPDetWM_ _ELSE_ 0.0 _ENDIF_;
_wNMinDetWM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _kNMinDetW_ * _uFunTmMinW_ * _sNDetWM_ _ELSE_ 0.0 _ENDIF_;
_wSiMinDetWM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _kSiMinDetW_ * _uFunTmMinW_ * _sSiDetWM_ _ELSE_ 0.0 _ENDIF_;
_aCorO2BODM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _sO2WM_ /(_hO2BOD_ + _sO2WM_) _ELSE_ 0.0 _ENDIF_;
_wO2MinDetWM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _molO2molC_ * _cCPerDW_ * _aCorO2BODM_ * _wDMinDetWM_ _ELSE_ 0.0 _ENDIF_;
_wDDenitWM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _sNO3WM_*_sNO3WM_ /(_hNO3Denit_*_hNO3Denit_ + _sNO3WM_*_sNO3WM_) *(1.0 - _aCorO2BODM_) * _wDMinDetWM_ _ELSE_ 0.0 _ENDIF_;
_wNDenitWM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _NO3PerC_ * _molNmolC_ * _cCPerDW_ * _wDDenitWM_ _ELSE_ 0.0 _ENDIF_;
_aCorO2NitrWM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _sO2WM_ * _sO2WM_ /(_hO2Nitr_ * _hO2Nitr_ + _sO2WM_ * _sO2WM_) _ELSE_ 0.0 _ENDIF_;
_wNNitrWM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _kNitrW_ * _uFunTmNitr_ * _aCorO2NitrWM_ * _sNH4WM_ _ELSE_ 0.0 _ENDIF_;
_wO2NitrWM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _O2PerNH4_ * _molO2molN_ * _wNNitrWM_ _ELSE_ 0.0 _ENDIF_;
_tDMinDetSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _kDMinDetS_ * _uFunTmMinS_ * _sDDetSM_ _ELSE_ 0.0 _ENDIF_;
_tPMinDetSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _kPMinDetS_ * _uFunTmMinS_ * _sPDetSM_ _ELSE_ 0.0 _ENDIF_;
_tNMinDetSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _kNMinDetS_ * _uFunTmMinS_ * _sNDetSM_ _ELSE_ 0.0 _ENDIF_;
_tSiMinDetSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _kSiMinDetS_ * _uFunTmMinS_ * _sSiDetSM_ _ELSE_ 0.0 _ENDIF_;
_akO2DifCorM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _kO2Dif_ * _uFunTmDif_ * _cTurbDifO2_ * _bPorCorSM_ _ELSE_ 0.0 _ENDIF_;
_tSODM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_(_molO2molC_ * _cCPerDW_ *(1.0 - _fRefrDetS_) * _tDMinDetSM_ + _O2PerNH4_ * _molO2molN_ * _kNitrS_ * _uFunTmNitr_ * _sNH4SM_) / _cDepthSM_ _ELSE_ 0.0 _ENDIF_;
_aDepthOxySedM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _POW_((2.0 * _sO2WM_ * _akO2DifCorM_ / _tSODM_) , (0.5)) _ELSE_ 0.0 _ENDIF_;
_afOxySedM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _aDepthOxySedM_ / _cDepthSM_ _ELSE_ 0.0 _ENDIF_;
_tDMinOxyDetSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _afOxySedM_ *(1.0 - _fRefrDetS_) * _tDMinDetSM_ _ELSE_ 0.0 _ENDIF_;
_tO2MinDetSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _molO2molC_ * _cCPerDW_ * _tDMinOxyDetSM_ _ELSE_ 0.0 _ENDIF_;
_tDDenitSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _oNO3SM_*_oNO3SM_ /(_hNO3Denit_*_hNO3Denit_ + _oNO3SM_*_oNO3SM_) *(1.0 - _afOxySedM_) *(1.0 - _fRefrDetS_) * _tDMinDetSM_ _ELSE_ 0.0 _ENDIF_;
_tNDenitSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _NO3PerC_ * _molNmolC_ * _cCPerDW_ * _tDDenitSM_ _ELSE_ 0.0 _ENDIF_;
_tNNitrSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _afOxySedM_ * _kNitrS_ * _uFunTmNitr_ * _sNH4SM_ _ELSE_ 0.0 _ENDIF_;
_tO2NitrSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _O2PerNH4_ * _molO2molN_ * _tNNitrSM_ _ELSE_ 0.0 _ENDIF_;
_tDMinHumSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _kDMinHum_ * _uFunTmMinS_ * _afOxySedM_ * _sDHumSM_ _ELSE_ 0.0 _ENDIF_;
_tPMinHumSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _kDMinHum_ * _uFunTmMinS_ * _afOxySedM_ * _sPHumSM_ _ELSE_ 0.0 _ENDIF_;
_tNMinHumSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _kDMinHum_ * _uFunTmMinS_ * _afOxySedM_ * _sNHumSM_ _ELSE_ 0.0 _ENDIF_;
_aDepthDifM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _fDepthDifS_ * _cDepthSM_ _ELSE_ 0.0 _ENDIF_;
_tPDifPO4M_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _kPDifPO4_ * _uFunTmDif_ * _cTurbDifNut_ * _bPorCorSM_ * (_oPO4SM_ - _sPO4WM_) / _aDepthDifM_ _ELSE_ 0.0 _ENDIF_;
_tNDifNO3M_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _kNDifNO3_ * _uFunTmDif_ * _cTurbDifNut_ * _bPorCorSM_ * (_oNO3SM_ - _sNO3WM_) / _aDepthDifM_ _ELSE_ 0.0 _ENDIF_;
_tNDifNH4M_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _kNDifNH4_ * _uFunTmDif_ * _cTurbDifNut_ * _bPorCorSM_ * (_oNH4SM_ - _sNH4WM_) / _aDepthDifM_ _ELSE_ 0.0 _ENDIF_;
_tO2DifM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _kO2Dif_ / _aDepthDifM_ * _uFunTmDif_ * _cTurbDifO2_ * _bPorCorSM_ * _sO2WM_ _ELSE_ 0.0 _ENDIF_;
_tPDifGroundPO4M_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ 0.0 _ELSE_ 0.0 _ENDIF_;
_tNDifGroundNO3M_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ 0.0 _ELSE_ 0.0 _ENDIF_;
_tNDifGroundNH4M_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ 0.0 _ELSE_ 0.0 _ENDIF_;
_aPAdsMaxWM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _cRelPAdsD_ + _aCorO2BODM_ * _cRelPAdsFe_ * _fFeDIM_ + _cRelPAdsAl_ * _fAlDIM_ _ELSE_ 0.0 _ENDIF_;
_aKPAdsWM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_(1.0 - _fRedMax_ *(1.0-_aCorO2BODM_)) * _cKPAdsOx_ _ELSE_ 0.0 _ENDIF_;
_aPIsoAdsWM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _aPAdsMaxWM_ * _aKPAdsWM_ * _sPO4WM_ /(1.0 + _aKPAdsWM_ * _sPO4WM_) _ELSE_ 0.0 _ENDIF_;
_aPEqIMWM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _aPIsoAdsWM_ * _sDIMWM_ _ELSE_ 0.0 _ENDIF_;
_wPSorpIMWM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _kPSorp_ *(_aPEqIMWM_ - _sPAIMWM_) _ELSE_ 0.0 _ENDIF_;
_aPAdsMaxSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _cRelPAdsD_ + _afOxySedM_ * _cRelPAdsFe_ * _fFeDIM_ + _cRelPAdsAl_ * _fAlDIM_ _ELSE_ 0.0 _ENDIF_;
_aKPAdsSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_(1.0 - _fRedMax_ *(1.0-_afOxySedM_)) * _cKPAdsOx_ _ELSE_ 0.0 _ENDIF_;
_aPIsoAdsSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _aPAdsMaxSM_ * _aKPAdsSM_ * _oPO4SM_ /(1.0 + _aKPAdsSM_ * _oPO4SM_) _ELSE_ 0.0 _ENDIF_;
_aPEqIMSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _aPIsoAdsSM_ * _sDIMSM_ _ELSE_ 0.0 _ENDIF_;
_tPSorpIMSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _kPSorp_ *(_aPEqIMSM_ - _sPAIMSM_) _ELSE_ 0.0 _ENDIF_;
_tPChemPO4M_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _MAX_(0.0,_kPChemPO4_ *(_oPO4SM_ - _coPO4Max_)) _ELSE_ 0.0 _ENDIF_;
_aDayInitVeg_ = _IF_ (_Day_ _LT_ 1.0 _OR_ _sTime_ _LT_ _BeginTime_ + 1.0) _THEN_ 367 _ELSEIF_ (_uTm_ _GE_ _cTmInitVeg_ _AND_ _aDayInitVeg_ _GT_ 366) _THEN_ _Day_ _ELSE_ _aDayInitVeg_ _ENDIF_;
_bfRootVeg_ = _IF_ (_FALSE_ _EQ_ _InclSeason_) _THEN_ _fRootVegSum_ _ELSEIF_ (_Day_ _LT_ _aDayInitVeg_) _THEN_ _fRootVegWin_ _ELSEIF_ (_Day_ _LT_ _aDayInitVeg_ + _cLengAllo_) _THEN_ 0.5*(_fRootVegWin_ + _fRootVegSum_) + 0.5*(_fRootVegWin_ - _fRootVegSum_) * _COS_(_Pi_/_cLengAllo_ * (_Day_ - _aDayInitVeg_)) _ELSEIF_ (_Day_ _LT_ _cDayWinVeg_) _THEN_ _fRootVegSum_ _ELSEIF_ (_Day_ _LT_ _cDayWinVeg_ + _cLengAllo_) _THEN_ 0.5*(_fRootVegWin_ + _fRootVegSum_) - 0.5*(_fRootVegWin_ - _fRootVegSum_) * _COS_(_Pi_/_cLengAllo_ * (_Day_ - _cDayWinVeg_)) _ELSE_ _fRootVegWin_ _ENDIF_;
_bfShootVeg_ = 1.0 - _bfRootVeg_;
_aDRootVeg_ = _bfRootVeg_ * _sDVeg_;
_aDShootVeg_ = _bfShootVeg_ * _sDVeg_;
_aDEmergVeg_ = _fEmergVeg_ * _aDShootVeg_;
_aDFloatVeg_ = _fFloatVeg_ * _aDShootVeg_;
_bfSubVeg_ = 1.0 - _fFloatVeg_ - _fEmergVeg_;
_aDSubVeg_ = _bfSubVeg_ * _aDShootVeg_;
_aExtVeg_ = _IF_ (_FALSE_ _EQ_ _InclBed_) _THEN_ 0.0 _ELSE_ _cExtSpVeg_ * _aDSubVeg_ / _sDepthW_ _ENDIF_;
_aDepth1Veg_ = _fDepth1Veg_ * _sDepthW_;
_aDepth2Veg_ = _fDepth2Veg_ * _sDepthW_;
_afCovSurfVeg_ = _IF_ (_FALSE_ _EQ_ _InclBed_) _THEN_ 0.0 _ELSE_ _MIN_(1.0, _MAX_(_aDFloatVeg_ / (_cDLayerVeg_ + _NearZero_), _aDEmergVeg_ / (_fEmergVeg_ * _cDCarrVeg_ + _NearZero_) ) ) _ENDIF_;
_afCovEmergVeg_ = _MIN_(1.0, _PerCent_ * _cCovSpVeg_ * _aDEmergVeg_);
_aCovVeg_ = _MIN_(100.0, _cCovSpVeg_ * _aDShootVeg_);
_aDVeg_ = _sDVeg_;
_aPVeg_ = _sPVeg_;
_aNVeg_ = _sNVeg_;
_aExtCoef_ = _aExtCoefOpen_ + _aExtVeg_;
_aLPARBot_ = _uLPARSurf_ * _EXP_(- _aExtCoef_ * _sDepthW_);
_rPDVeg_ = _sPVeg_ / (_sDVeg_+_NearZero_);
_rNDVeg_ = _sNVeg_ / (_sDVeg_+_NearZero_);
_tDMigrVeg_ = _kMigrVeg_ * (_cDVegIn_ - _sDVeg_);
_tPMigrVeg_ = _kMigrVeg_ * (_cPDVeg0_* _cDVegIn_ - _sPVeg_);
_tNMigrVeg_ = _kMigrVeg_ * (_cNDVeg0_* _cDVegIn_ - _sNVeg_);
_uFunTmProdVeg_ = _POW_(_cQ10ProdVeg_ , (0.1 * (_uTm_ - _cTmRef_)));
_uFunTmRespVeg_ = _POW_(_cQ10RespVeg_ , (0.1 * (_uTm_ - _cTmRef_)));
_afPUptVegS_ = _IF_ (_FALSE_ _EQ_ _UseEmpUpt_) _THEN_ 0.0 _ELSEIF_ (_bfRootVeg_ _LE_ _NearZero_) _THEN_ 0.0 _ELSEIF_ (_fFloatVeg_ + _bfSubVeg_ _LE_ _NearZero_) _THEN_ 1.0 _ELSE_ _fSedUptVegMax_ / (1.0 + _fSedUptVegCoef_ * _POW_(((_oPO4S_+_NearZero_) / (_sPO4W_+_NearZero_)) , _fSedUptVegExp_)) _ENDIF_;
_afNUptVegS_ = _IF_ (_FALSE_ _EQ_ _UseEmpUpt_) _THEN_ 0.0 _ELSEIF_ (_bfRootVeg_ _LE_ _NearZero_) _THEN_ 0.0 _ELSEIF_ (_fFloatVeg_ + _bfSubVeg_ _LE_ _NearZero_) _THEN_ 1.0 _ELSE_ _fSedUptVegMax_ / (1.0 + _fSedUptVegCoef_ * _POW_(((_oNDissS_+_NearZero_) / (_oNDissW_+_NearZero_)) , _fSedUptVegExp_)) _ENDIF_;
_aVPUptMaxCrVeg_ = _IF_ (_FALSE_ _EQ_ _UseEmpUpt_) _THEN_ _MAX_( 0.0, _cVPUptMaxVeg_ * _uFunTmProdVeg_ * (_cPDVegMax_-_rPDVeg_) / (_cPDVegMax_-_cPDVegMin_) ) _ELSE_ _MAX_( 0.0, _cVPUptMaxVeg_ * _uFunTmProdVeg_ * (_cPDVegMax_-_rPDVeg_) / (_cPDVegMax_-_cPDVegMin_) ) _ENDIF_;
_aVPUptVegW_ = _IF_ (_FALSE_ _EQ_ _UseEmpUpt_) _THEN_ _sPO4W_ * _aVPUptMaxCrVeg_ / (_aVPUptMaxCrVeg_ / _cAffPUptVeg_ + _sPO4W_) _ELSE_ 0.0 _ENDIF_;
_aVPUptVegS_ = _IF_ (_FALSE_ _EQ_ _UseEmpUpt_) _THEN_ _oPO4S_ * _aVPUptMaxCrVeg_ / (_aVPUptMaxCrVeg_ / _cAffPUptVeg_ + _oPO4S_) _ELSE_ 0.0 _ENDIF_;
_tPUptVegW_ = _IF_ (_FALSE_ _EQ_ _UseEmpUpt_) _THEN_ _aVPUptVegW_ * (_aDSubVeg_ + _aDFloatVeg_) _ELSE_ (1.0 - _afPUptVegS_) * _aVPUptMaxCrVeg_ * _sPO4W_ / (_aVPUptMaxCrVeg_ / _cAffPUptVeg_ + _sPO4W_) * _sDVeg_ _ENDIF_;
_tPUptVegS_ = _IF_ (_FALSE_ _EQ_ _UseEmpUpt_) _THEN_ _aVPUptVegS_ * _aDRootVeg_ _ELSE_ _afPUptVegS_ * _aVPUptMaxCrVeg_ * _oPO4S_ / (_aVPUptMaxCrVeg_ / _cAffPUptVeg_ + _oPO4S_) * _sDVeg_ _ENDIF_;
_tPUptVeg_ = _IF_ (_FALSE_ _EQ_ _UseEmpUpt_) _THEN_ _tPUptVegW_ + _tPUptVegS_ _ELSE_ _tPUptVegW_ + _tPUptVegS_ _ENDIF_;
_aVNUptMaxCrVeg_ = _IF_ (_FALSE_ _EQ_ _UseEmpUpt_) _THEN_ _MAX_( 0.0, _cVNUptMaxVeg_ * _uFunTmProdVeg_ * (_cNDVegMax_ - _rNDVeg_) / (_cNDVegMax_ - _cNDVegMin_)) _ELSE_ _MAX_( 0.0, _cVNUptMaxVeg_ * _uFunTmProdVeg_ * (_cNDVegMax_ - _rNDVeg_) / (_cNDVegMax_ - _cNDVegMin_)) _ENDIF_;
_ahNUptVeg_ = _IF_ (_FALSE_ _EQ_ _UseEmpUpt_) _THEN_ _aVNUptMaxCrVeg_ / _cAffNUptVeg_ _ELSE_ _aVNUptMaxCrVeg_ / _cAffNUptVeg_ _ENDIF_;
_aVNUptVegW_ = _IF_ (_FALSE_ _EQ_ _UseEmpUpt_) _THEN_ _oNDissW_ * _aVNUptMaxCrVeg_ / (_ahNUptVeg_ + _oNDissW_) _ELSE_ 0.0 _ENDIF_;
_afNH4UptVegW_ = _IF_ (_FALSE_ _EQ_ _UseEmpUpt_) _THEN_ _sNH4W_ * _sNO3W_ / ((_ahNUptVeg_ + _sNH4W_) * (_ahNUptVeg_ + _sNO3W_ + _NearZero_)) + _sNH4W_ * _ahNUptVeg_ / ((_sNH4W_ + _sNO3W_ + _NearZero_) * (_ahNUptVeg_ + _sNO3W_ + _NearZero_)) _ELSE_ _sNH4W_ * _sNO3W_ / ((_ahNUptVeg_ + _sNH4W_) * (_ahNUptVeg_ + _sNO3W_ + _NearZero_)) + _sNH4W_ * _ahNUptVeg_ / ((_sNH4W_ + _sNO3W_ + _NearZero_) * (_ahNUptVeg_ + _sNO3W_ + _NearZero_)) _ENDIF_;
_tNUptVegW_ = _IF_ (_FALSE_ _EQ_ _UseEmpUpt_) _THEN_ _aVNUptVegW_ * (_aDSubVeg_ + _aDFloatVeg_) _ELSE_ (1.0 - _afNUptVegS_) * _aVNUptMaxCrVeg_ * _oNDissW_ / (_aVNUptMaxCrVeg_ / _cAffNUptVeg_ + _oNDissW_) * _sDVeg_ _ENDIF_;
_tNUptNH4VegW_ = _IF_ (_FALSE_ _EQ_ _UseEmpUpt_) _THEN_ _afNH4UptVegW_ * _tNUptVegW_ _ELSE_ _afNH4UptVegW_ * _tNUptVegW_ _ENDIF_;
_tNUptNO3VegW_ = _IF_ (_FALSE_ _EQ_ _UseEmpUpt_) _THEN_ _tNUptVegW_ - _tNUptNH4VegW_ _ELSE_ _tNUptVegW_ - _tNUptNH4VegW_ _ENDIF_;
_aVNUptVegS_ = _IF_ (_FALSE_ _EQ_ _UseEmpUpt_) _THEN_ _oNDissS_ * _aVNUptMaxCrVeg_ / (_ahNUptVeg_ + _oNDissS_) _ELSE_ 0.0 _ENDIF_;
_tNUptVegS_ = _IF_ (_FALSE_ _EQ_ _UseEmpUpt_) _THEN_ _aVNUptVegS_ * _aDRootVeg_ _ELSE_ _afNUptVegS_ * _aVNUptMaxCrVeg_ * _oNDissS_ / (_aVNUptMaxCrVeg_ / _cAffNUptVeg_ + _oNDissS_) * _sDVeg_ _ENDIF_;
_afNH4UptVegS_ = _IF_ (_FALSE_ _EQ_ _UseEmpUpt_) _THEN_ _oNH4S_ * _oNO3S_ / ((_ahNUptVeg_ + _oNH4S_ +_NearZero_) * (_ahNUptVeg_ + _oNO3S_ +_NearZero_)) + _oNH4S_ * _ahNUptVeg_ / ((_oNH4S_ + _oNO3S_+_NearZero_) * (_ahNUptVeg_ + _oNO3S_+_NearZero_)) _ELSE_ _oNH4S_ * _oNO3S_ / ((_ahNUptVeg_ + _oNH4S_ +_NearZero_) * (_ahNUptVeg_ + _oNO3S_ +_NearZero_)) + _oNH4S_ * _ahNUptVeg_ / ((_oNH4S_ + _oNO3S_+_NearZero_) * (_ahNUptVeg_ + _oNO3S_+_NearZero_)) _ENDIF_;
_tNUptNH4VegS_ = _IF_ (_FALSE_ _EQ_ _UseEmpUpt_) _THEN_ _afNH4UptVegS_ * _tNUptVegS_ _ELSE_ _afNH4UptVegS_ * _tNUptVegS_ _ENDIF_;
_tNUptNO3VegS_ = _IF_ (_FALSE_ _EQ_ _UseEmpUpt_) _THEN_ _tNUptVegS_ - _tNUptNH4VegS_ _ELSE_ _tNUptVegS_ - _tNUptNH4VegS_ _ENDIF_;
_tNUptVeg_ = _IF_ (_FALSE_ _EQ_ _UseEmpUpt_) _THEN_ _tNUptVegW_ + _tNUptVegS_ _ELSE_ _tNUptVegW_ + _tNUptVegS_ _ENDIF_;
_aLPAR1Veg_ = _uLPARSurf_ * _EXP_(- _aExtCoefOpen_ * _aDepth1Veg_);
_aLPAR2Veg_ = _aLPAR1Veg_ * _EXP_(- _aExtCoef_ * (_aDepth2Veg_ - _aDepth1Veg_));
_uhLVeg_ = _hLRefVeg_ * _uFunTmProdVeg_;
_aLLimShootVeg_ = _fEmergVeg_ + _fFloatVeg_ * (1.0 - _afCovEmergVeg_) + _bfSubVeg_ * (1.0 - _afCovSurfVeg_) * 1.0 / (_aExtCoef_ * _sDepthW_) * _LN_( (1.0 + _aLPAR1Veg_ / _uhLVeg_) / (1.0 + _aLPAR2Veg_ / _uhLVeg_));
_aMuTmLVeg_ = _ufDay_ * _bfShootVeg_ * _aLLimShootVeg_ * _uFunTmProdVeg_ * _cMuMaxVeg_;
_aPLimVeg_ = _MAX_(0.0, (1.0 - _cPDVegMin_ / _rPDVeg_) * _cPDVegMax_ / (_cPDVegMax_ - _cPDVegMin_) );
_aNLimVeg_ = _MAX_(0.0, (1.0 - _cNDVegMin_ / _rNDVeg_) * _cNDVegMax_ / (_cNDVegMax_ - _cNDVegMin_) );
_aNutLimVeg_ = _MIN_( _aPLimVeg_, _aNLimVeg_);
_aMuVeg_ = _aMuTmLVeg_ * _aNutLimVeg_;
_bkMortVeg_ = _IF_ (_FALSE_ _EQ_ _InclSeason_) _THEN_ _kMortVegSum_ _ELSEIF_ (_Day_ _LT_ _cDayWinVeg_) _THEN_ _kMortVegSum_ _ELSEIF_ (_Day_ _LT_ _cDayWinVeg_ + _cLengMort_) _THEN_ - _LN_(_fWinVeg_) / _cLengMort_ _ELSE_ _kMortVegSum_ _ENDIF_;
_akDIncrVeg_ = _aMuTmLVeg_ - _kDRespVeg_ * _uFunTmRespVeg_ - _bkMortVeg_;
_tDEnvVeg_ = _MAX_(0.0, _akDIncrVeg_ / (_cDCarrVeg_+_NearZero_) * _sDVeg_*_sDVeg_);
_tDEnvProdVeg_ = _aMuVeg_ / _cMuMaxVeg_ * _tDEnvVeg_;
_tDProdVeg_ = _MAX_(0.0, _aMuVeg_ * _sDVeg_ - _tDEnvProdVeg_);
_tDProdSubVeg_ = _bfSubVeg_ * _tDProdVeg_;
_tDRespVeg_ = _kDRespVeg_ * _uFunTmRespVeg_ * _sDVeg_;
_tDEnvMortVeg_ = _tDEnvVeg_ - _tDEnvProdVeg_;
_tDMortVeg_ = _bkMortVeg_ * _sDVeg_ + _tDEnvMortVeg_;
_tDMortVegW_ = _fDetWMortVeg_ * (1.0 - _bfRootVeg_) * _tDMortVeg_;
_tDMortVegS_ = _tDMortVeg_ - _tDMortVegW_;
_tDGrazVegBird_ = _IF_ ( (_sTime_ _GE_ _cYearStartBirds_ * _DaysPerYear_) _AND_ (_Day_ _GE_ _cDayStartBirds_) _AND_ (_Day_ _LE_ _cDayEndBirds_) ) _THEN_ _cPrefVegBird_ * _sDVeg_ / (_hDVegBird_ + _sDVeg_) * _cBirdsPerha_ / _m2Perha_ * _cDGrazPerBird_ _ELSE_ 0.0 _ENDIF_;
_bkManVeg_ = _IF_ ((_Day_ _GE_ _cDayManVeg1_ _AND_ _Day_ _LT_ _cDayManVeg1_ + _cLengMan_) _OR_ (_Day_ _GE_ _cDayManVeg2_ _AND_ _Day_ _LT_ _cDayManVeg2_ + _cLengMan_)) _THEN_ -_LN_(1.0 - _fManVeg_) / _cLengMan_ _ELSE_ 0.0 _ENDIF_;
_tDManVeg_ = _bkManVeg_ * _sDVeg_;
_tPManVeg_ = _rPDVeg_ * _tDManVeg_;
_tNManVeg_ = _rNDVeg_ * _tDManVeg_;
_tDBedVeg_ = _tDMigrVeg_ + _tDProdVeg_ - _tDRespVeg_ - _tDMortVeg_ - _tDGrazVegBird_ - _tDManVeg_;
_tO2ProdVeg_ = _molO2molC_ * _cCPerDW_ * _tDProdVeg_;
_tO2RespVegW_ = _molO2molC_ * _cCPerDW_ * _bfSubVeg_ * _tDRespVeg_ * _aCorO2BOD_;
_tO2RespVegS_ = _molO2molC_ * _cCPerDW_ * _bfRootVeg_ * _tDRespVeg_ * _afOxySed_;
_tO2ProdVegS_ = _MIN_ (_tO2RespVegS_, _tO2ProdVeg_);
_tO2ProdVegW_ = _MIN_( _tO2ProdVeg_ - _tO2ProdVegS_, _bfSubVeg_ * _tO2ProdVeg_);
_tO2UptNO3VegW_ = _O2PerNO3_ * _molO2molN_ * _bfSubVeg_ * _tNUptNO3VegW_;
_tO2UptNO3VegS_ = _O2PerNO3_ * _molO2molN_ * _tNUptNO3VegS_;
_tPExcrVeg_ = (_rPDVeg_ *2.0)/ (_cPDVegMax_ + _rPDVeg_) * _rPDVeg_ * _tDRespVeg_;
_tPExcrVegS_ = _bfRootVeg_ * _tPExcrVeg_;
_tPExcrVegW_ = _tPExcrVeg_ - _tPExcrVegS_;
_tPMortVeg_ = _rPDVeg_ * _tDMortVeg_;
_tPMortVegPO4_ = _fDissMortVeg_ * _tPMortVeg_;
_tPMortVegPO4S_ = _bfRootVeg_ * _tPMortVegPO4_;
_tPMortVegPO4W_ = _tPMortVegPO4_ - _tPMortVegPO4S_;
_tPMortVegDet_ = _tPMortVeg_ - _tPMortVegPO4_;
_tPMortVegDetW_ = _fDetWMortVeg_ * (1.0 - _bfRootVeg_) * _tPMortVegDet_;
_tPMortVegDetS_ = _tPMortVegDet_ - _tPMortVegDetW_;
_tPGrazVegBird_ = _rPDVeg_ * _tDGrazVegBird_;
_tPBedVeg_ = _tPMigrVeg_ + _tPUptVeg_ - _tPExcrVeg_ - _tPMortVeg_ - _tPGrazVegBird_ - _tPManVeg_;
_tNExcrVeg_ = (2.0 * _rNDVeg_) / (_cNDVegMax_ + _rNDVeg_) * _rNDVeg_ * _tDRespVeg_;
_tNExcrVegS_ = _bfRootVeg_ * _tNExcrVeg_;
_tNExcrVegW_ = _tNExcrVeg_ - _tNExcrVegS_;
_tNMortVeg_ = _rNDVeg_ * _tDMortVeg_;
_tNMortVegNH4_ = _fDissMortVeg_ * _tNMortVeg_;
_tNMortVegNH4S_ = _bfRootVeg_ * _tNMortVegNH4_;
_tNMortVegNH4W_ = _tNMortVegNH4_ - _tNMortVegNH4S_;
_tNMortVegDet_ = _tNMortVeg_ - _tNMortVegNH4_;
_tNMortVegDetW_ = _fDetWMortVeg_ * (1.0 - _bfRootVeg_) * _tNMortVegDet_;
_tNMortVegDetS_ = _tNMortVegDet_ - _tNMortVegDetW_;
_tNGrazVegBird_ = _rNDVeg_ * _tDGrazVegBird_;
_tNBedVeg_ = _tNMigrVeg_ + _tNUptVeg_ - _tNExcrVeg_ - _tNMortVeg_ - _tNGrazVegBird_ - _tNManVeg_;
_tDAssVegBird_ = _fDAssBird_ * _tDGrazVegBird_;
_tDEgesBird_ = _tDGrazVegBird_ - _tDAssVegBird_;
_tPAssVegBird_ = _fDAssBird_ * _tPGrazVegBird_;
_tPEgesBird_ = _tPGrazVegBird_ - _tPAssVegBird_;
_tPEgesBirdPO4_ = _fDissEgesBird_ * _tPEgesBird_;
_tPEgesBirdDet_ = _tPEgesBird_ - _tPEgesBirdPO4_;
_tNAssVegBird_ = _fDAssBird_ * _tNGrazVegBird_;
_tNEgesBird_ = _tNGrazVegBird_ - _tNAssVegBird_;
_tNEgesBirdNH4_ = _fDissEgesBird_ * _tNEgesBird_;
_tNEgesBirdDet_ = _tNEgesBird_ - _tNEgesBirdNH4_;
_wDBedDetW_ = (_tDMortVegW_ + _tDEgesBird_) / _sDepthW_;
_tDBedDetS_ = _tDMortVegS_;
_tDBedTotT_ = _tDMigrVeg_ + _tDProdVeg_ - _tDRespVeg_ - _tDManVeg_ - _tDAssVegBird_;
_wPBedPO4W_ = (- _tPUptVegW_ + _tPExcrVegW_ + _tPMortVegPO4W_ + _tPEgesBirdPO4_) /_sDepthW_;
_wPBedDetW_ = (_tPMortVegDetW_ + _tPEgesBirdDet_) / _sDepthW_;
_tPBedPO4S_ = - _tPUptVegS_ + _tPExcrVegS_ + _tPMortVegPO4S_;
_tPBedDetS_ = _tPMortVegDetS_;
_tPBedTotT_ = _tPMigrVeg_ - _tPManVeg_ - _tPAssVegBird_;
_wNBedNH4W_ = (- _tNUptNH4VegW_ + _tNExcrVegW_ + _tNMortVegNH4W_ + _tNEgesBirdNH4_) / _sDepthW_;
_wNBedNO3W_ = - _tNUptNO3VegW_ / _sDepthW_;
_wNBedDetW_ = (_tNMortVegDetW_ + _tNEgesBirdDet_) / _sDepthW_;
_tNBedNH4S_ = - _tNUptNH4VegS_ + _tNExcrVegS_ + _tNMortVegNH4S_;
_tNBedNO3S_ = - _tNUptNO3VegS_;
_tNBedDetS_ = _tNMortVegDetS_;
_tNBedTotT_ = _tNMigrVeg_ - _tNManVeg_ - _tNAssVegBird_;
_tO2BedW_ = _tO2ProdVegW_ - _tO2RespVegW_ + _tO2UptNO3VegW_;
_tO2BedS_ = _tO2ProdVegS_ - _tO2RespVegS_ + _tO2UptNO3VegS_;
_UseLoss_ = _IF_ (_InclWeb_ _EQ_ _TRUE_) _THEN_ 0.0 _ELSE_ 1.0 _ENDIF_;
_uFunTmLoss_ = _EXP_(-0.5/(_cSigTmLoss_*_cSigTmLoss_) *((_uTm_-_cTmOptLoss_)*(_uTm_-_cTmOptLoss_) -(_cTmRef_-_cTmOptLoss_)*(_cTmRef_-_cTmOptLoss_)));
_rPDBlueW_ = _sPBlueW_ /(_sDBlueW_+_NearZero_);
_rNDBlueW_ = _sNBlueW_ /(_sDBlueW_+_NearZero_);
_rPDBlueS_ = _sPBlueS_ /(_sDBlueS_+_NearZero_);
_rNDBlueS_ = _sNBlueS_ /(_sDBlueS_+_NearZero_);
_uFunTmBlue_ = _EXP_(-0.5/(_cSigTmBlue_*_cSigTmBlue_) *((_uTm_-_cTmOptBlue_)*(_uTm_-_cTmOptBlue_) - (_cTmRef_-_cTmOptBlue_)*(_cTmRef_-_cTmOptBlue_)));
_uFunTmProdBlue_ = _uFunTmBlue_;
_uFunTmRespBlue_ = _uFunTmBlue_;
_aVPUptMaxCrBlue_ = _MAX_(0.0,_cVPUptMaxBlue_ * _uFunTmProdBlue_ *(_cPDBlueMax_ - _rPDBlueW_) /(_cPDBlueMax_ - _cPDBlueMin_));
_aVPUptBlue_ = _sPO4W_ * _aVPUptMaxCrBlue_ /(_aVPUptMaxCrBlue_ / _cAffPUptBlue_ + _sPO4W_);
_wPUptBlue_ = _aVPUptBlue_ * _sDBlueW_;
_aVNUptMaxCrBlue_ = _MAX_(0.0,_cVNUptMaxBlue_ * _uFunTmProdBlue_ * (_cNDBlueMax_ - _rNDBlueW_) /(_cNDBlueMax_ - _cNDBlueMin_));
_ahNUptBlue_ = _aVNUptMaxCrBlue_ / _cAffNUptBlue_;
_aVNUptBlue_ = _oNDissW_ * _aVNUptMaxCrBlue_ /(_ahNUptBlue_ + _oNDissW_);
_wNUptBlue_ = _aVNUptBlue_ * _sDBlueW_;
_afNH4UptBlue_ = _sNH4W_ * _sNO3W_ /((_ahNUptBlue_ + _sNH4W_) *(_ahNUptBlue_ + _sNO3W_)) + _sNH4W_ * _ahNUptBlue_ /((_sNH4W_ + _sNO3W_) *(_ahNUptBlue_ + _sNO3W_));
_wNUptNH4Blue_ = _afNH4UptBlue_ * _wNUptBlue_;
_wNUptNO3Blue_ = _wNUptBlue_ - _wNUptNH4Blue_;
_uMuMaxTmBlue_ = _cMuMaxBlue_ * _uFunTmProdBlue_;
_aPLimBlue_ = _MAX_(0.0,(1.0 - _cPDBlueMin_ / _rPDBlueW_) * _cPDBlueMax_ /(_cPDBlueMax_ - _cPDBlueMin_));
_aNLimBlue_ = _MAX_(0.0,(1.0 - _cNDBlueMin_ / _rNDBlueW_) * _cNDBlueMax_ /(_cNDBlueMax_ - _cNDBlueMin_));
_aSiLimBlue_ = _sSiO2W_ /(_hSiAssBlue_ + _sSiO2W_);
_aLLimBlue_ = _UseSteeleBlue_ *(_EXP_(1.0) /(_aExtCoef_ * _sDepthW_) *(_EXP_(- _aLPARBot_ /(_cLOptRefBlue_ * _uFunTmProdBlue_)) - _EXP_(- _uLPARSurf_ /(_cLOptRefBlue_ * _uFunTmProdBlue_)))) +(1.0 - _UseSteeleBlue_) *(1.0 /(_aExtCoef_ * _sDepthW_) * _LN_((1.0 + _uLPARSurf_ / (_hLRefBlue_ * _uFunTmProdBlue_)) / (1.0 + _aLPARBot_ /(_hLRefBlue_ * _uFunTmProdBlue_))));
_aMuTmLBlue_ = _ufDay_ *(1.0 - _afCovSurfVeg_) * _aLLimBlue_ * _uMuMaxTmBlue_;
_aNutLimBlue_ = _MIN_(_aPLimBlue_,(_MIN_(_aNLimBlue_,_aSiLimBlue_)));
_aMuBlue_ = _aNutLimBlue_ * _aMuTmLBlue_;
_wDAssBlue_ = _aMuBlue_*_sDBlueW_;
_rChDBlue_ = _cChDBlueMax_ -(_cChDBlueMax_ - _cChDBlueMin_) * _aLLimBlue_;
_oChlaBlue_ = _mgPerg_ * _rChDBlue_ * _sDBlueW_;
_aExtChBlue_ = _cExtSpBlue_ / _rChDBlue_;
_ukDRespTmBlue_ = _kDRespBlue_ * _uFunTmRespBlue_;
_wDRespBlueW_ = _ukDRespTmBlue_ * _sDBlueW_;
_ukLossTmBlue_ = _UseLoss_ * _kLossBlue_ * _uFunTmLoss_;
_wDLossBlue_ = _ukLossTmBlue_ * _sDBlueW_;
_wDMortBlueW_ = _kMortBlueW_ * _sDBlueW_;
_uCorVSetBlue_ = _cVSetBlue_ * _aFunTauSetOM_ * _uFunTmSet_;
_tDSetBlue_ = _uCorVSetBlue_ * _sDBlueW_;
_tDResusBlue_ = _sDBlueS_ /(_aDPhytS_+_NearZero_) * _tDResusPhytTot_;
_tDRespBlueS_ = _ukDRespTmBlue_ * _sDBlueS_;
_tDMortBlueS_ = _kMortBlueS_ * _sDBlueS_;
_ukDDecBlue_ = _ukDRespTmBlue_ + _ukLossTmBlue_ + _kMortBlueW_ +(_uCorVSetBlue_ * _uFunTmSet_) / _sDepthW_;
_wPExcrBlueW_ = (_rPDBlueW_ * 2.0 )/(_cPDBlueMax_ + _rPDBlueW_) * _rPDBlueW_ * _wDRespBlueW_;
_wPLossBlue_ = _rPDBlueW_ * _wDLossBlue_;
_wPMortBlueW_ = _kMortBlueW_ * _sPBlueW_;
_tPSetBlue_ = _rPDBlueW_ * _tDSetBlue_;
_tPResusBlue_ = _rPDBlueS_ * _tDResusBlue_;
_tPExcrBlueS_ = (_rPDBlueS_ *2.0)/(_cPDBlueMax_ + _rPDBlueS_) * _rPDBlueS_ * _tDRespBlueS_;
_tPMortBlueS_ = _kMortBlueS_ * _sPBlueS_;
_wNExcrBlueW_ = (_rNDBlueW_ *2.0)/(_cNDBlueMax_ + _rNDBlueW_) * _rNDBlueW_ * _wDRespBlueW_;
_wNLossBlue_ = _rNDBlueW_ * _wDLossBlue_;
_wNMortBlueW_ = _kMortBlueW_ * _sNBlueW_;
_tNSetBlue_ = _rNDBlueW_ * _tDSetBlue_;
_tNResusBlue_ = _rNDBlueS_ * _tDResusBlue_;
_tNExcrBlueS_ = (2.0 * _rNDBlueS_) /(_cNDBlueMax_ + _rNDBlueS_) * _rNDBlueS_ * _tDRespBlueS_;
_tNMortBlueS_ = _kMortBlueS_ * _sNBlueS_;
_wDPrimBlueW_ = _wDAssBlue_ - _wDRespBlueW_ - _wDLossBlue_ - _wDMortBlueW_ -(_tDSetBlue_ - _tDResusBlue_) / _sDepthW_;
_wPPrimBlueW_ = _wPUptBlue_ - _wPExcrBlueW_ - _wPLossBlue_ - _wPMortBlueW_ -(_tPSetBlue_ - _tPResusBlue_) / _sDepthW_;
_wNPrimBlueW_ = _wNUptBlue_ - _wNExcrBlueW_ - _wNLossBlue_ - _wNMortBlueW_ -(_tNSetBlue_ - _tNResusBlue_) / _sDepthW_;
_tDPrimBlueS_ = _IF_ (_InclPhytS_ _EQ_ _TRUE_) _THEN_ _tDSetBlue_ - _tDResusBlue_ - _tDMortBlueS_ - _tDRespBlueS_ _ELSE_ 0.0 _ENDIF_;
_tPPrimBlueS_ = _IF_ (_InclPhytS_ _EQ_ _TRUE_) _THEN_ _tPSetBlue_ - _tPResusBlue_ - _tPMortBlueS_ - _tPExcrBlueS_ _ELSE_ 0.0 _ENDIF_;
_tNPrimBlueS_ = _IF_ (_InclPhytS_ _EQ_ _TRUE_) _THEN_ _tNSetBlue_ - _tNResusBlue_ - _tNMortBlueS_ - _tNExcrBlueS_ _ELSE_ 0.0 _ENDIF_;
_rPDGrenW_ = _sPGrenW_ /(_sDGrenW_+_NearZero_);
_rNDGrenW_ = _sNGrenW_ /(_sDGrenW_+_NearZero_);
_rPDGrenS_ = _sPGrenS_ /(_sDGrenS_+_NearZero_);
_rNDGrenS_ = _sNGrenS_ /(_sDGrenS_+_NearZero_);
_uFunTmGren_ = _EXP_(-0.5/(_cSigTmGren_*_cSigTmGren_) *((_uTm_-_cTmOptGren_)*(_uTm_-_cTmOptGren_) - (_cTmRef_-_cTmOptGren_)*(_cTmRef_-_cTmOptGren_)));
_uFunTmProdGren_ = _uFunTmGren_;
_uFunTmRespGren_ = _uFunTmGren_;
_aVPUptMaxCrGren_ = _MAX_(0.0,_cVPUptMaxGren_ * _uFunTmProdGren_ *(_cPDGrenMax_ - _rPDGrenW_) /(_cPDGrenMax_ - _cPDGrenMin_));
_aVPUptGren_ = _sPO4W_ * _aVPUptMaxCrGren_ /(_aVPUptMaxCrGren_ / _cAffPUptGren_ + _sPO4W_);
_wPUptGren_ = _aVPUptGren_ * _sDGrenW_;
_aVNUptMaxCrGren_ = _MAX_(0.0,_cVNUptMaxGren_ * _uFunTmProdGren_ * (_cNDGrenMax_ - _rNDGrenW_) /(_cNDGrenMax_ - _cNDGrenMin_));
_ahNUptGren_ = _aVNUptMaxCrGren_ / _cAffNUptGren_;
_aVNUptGren_ = _oNDissW_ * _aVNUptMaxCrGren_ /(_ahNUptGren_ + _oNDissW_);
_wNUptGren_ = _aVNUptGren_ * _sDGrenW_;
_afNH4UptGren_ = _sNH4W_ * _sNO3W_ /((_ahNUptGren_ + _sNH4W_) *(_ahNUptGren_ + _sNO3W_)) + _sNH4W_ * _ahNUptGren_ /((_sNH4W_ + _sNO3W_) *(_ahNUptGren_ + _sNO3W_));
_wNUptNH4Gren_ = _afNH4UptGren_ * _wNUptGren_;
_wNUptNO3Gren_ = _wNUptGren_ - _wNUptNH4Gren_;
_uMuMaxTmGren_ = _cMuMaxGren_ * _uFunTmProdGren_;
_aPLimGren_ = _MAX_(0.0,(1.0 - _cPDGrenMin_ / _rPDGrenW_) * _cPDGrenMax_ /(_cPDGrenMax_ - _cPDGrenMin_));
_aNLimGren_ = _MAX_(0.0,(1.0 - _cNDGrenMin_ / _rNDGrenW_) * _cNDGrenMax_ /(_cNDGrenMax_ - _cNDGrenMin_));
_aSiLimGren_ = _sSiO2W_ /(_hSiAssGren_ + _sSiO2W_);
_aLLimGren_ = _UseSteeleGren_ *(_EXP_(1.0) /(_aExtCoef_ * _sDepthW_) *(_EXP_(- _aLPARBot_ /(_cLOptRefGren_ * _uFunTmProdGren_)) - _EXP_(- _uLPARSurf_ /(_cLOptRefGren_ * _uFunTmProdGren_)))) +(1.0 - _UseSteeleGren_) *(1.0 /(_aExtCoef_ * _sDepthW_) * _LN_((1.0 + _uLPARSurf_ / (_hLRefGren_ * _uFunTmProdGren_)) / (1.0 + _aLPARBot_ /(_hLRefGren_ * _uFunTmProdGren_))));
_aMuTmLGren_ = _ufDay_ *(1.0 - _afCovSurfVeg_) * _aLLimGren_ * _uMuMaxTmGren_;
_aNutLimGren_ = _MIN_(_aPLimGren_,(_MIN_(_aNLimGren_,_aSiLimGren_)));
_aMuGren_ = _aNutLimGren_ * _aMuTmLGren_;
_wDAssGren_ = _aMuGren_*_sDGrenW_;
_rChDGren_ = _cChDGrenMax_ -(_cChDGrenMax_ - _cChDGrenMin_) * _aLLimGren_;
_oChlaGren_ = _mgPerg_ * _rChDGren_ * _sDGrenW_;
_aExtChGren_ = _cExtSpGren_ / _rChDGren_;
_ukDRespTmGren_ = _kDRespGren_ * _uFunTmRespGren_;
_wDRespGrenW_ = _ukDRespTmGren_ * _sDGrenW_;
_ukLossTmGren_ = _UseLoss_ * _kLossGren_ * _uFunTmLoss_;
_wDLossGren_ = _ukLossTmGren_ * _sDGrenW_;
_wDMortGrenW_ = _kMortGrenW_ * _sDGrenW_;
_uCorVSetGren_ = _cVSetGren_ * _aFunTauSetOM_ * _uFunTmSet_;
_tDSetGren_ = _uCorVSetGren_ * _sDGrenW_;
_tDResusGren_ = _sDGrenS_ /(_aDPhytS_+_NearZero_) * _tDResusPhytTot_;
_tDRespGrenS_ = _ukDRespTmGren_ * _sDGrenS_;
_tDMortGrenS_ = _kMortGrenS_ * _sDGrenS_;
_ukDDecGren_ = _ukDRespTmGren_ + _ukLossTmGren_ + _kMortGrenW_ +(_uCorVSetGren_ * _uFunTmSet_) / _sDepthW_;
_wPExcrGrenW_ = (2.0 *_rPDGrenW_) /(_cPDGrenMax_ + _rPDGrenW_) * _rPDGrenW_ * _wDRespGrenW_;
_wPLossGren_ = _rPDGrenW_ * _wDLossGren_;
_wPMortGrenW_ = _kMortGrenW_ * _sPGrenW_;
_tPSetGren_ = _rPDGrenW_ * _tDSetGren_;
_tPResusGren_ = _rPDGrenS_ * _tDResusGren_;
_tPExcrGrenS_ = (2.0 * _rPDGrenS_) /(_cPDGrenMax_ + _rPDGrenS_) * _rPDGrenS_ * _tDRespGrenS_;
_tPMortGrenS_ = _kMortGrenS_ * _sPGrenS_;
_wNExcrGrenW_ = (2.0 * _rNDGrenW_) /(_cNDGrenMax_ + _rNDGrenW_) * _rNDGrenW_ * _wDRespGrenW_;
_wNLossGren_ = _rNDGrenW_ * _wDLossGren_;
_wNMortGrenW_ = _kMortGrenW_ * _sNGrenW_;
_tNSetGren_ = _rNDGrenW_ * _tDSetGren_;
_tNResusGren_ = _rNDGrenS_ * _tDResusGren_;
_tNExcrGrenS_ = (2.0 * _rNDGrenS_) /(_cNDGrenMax_ + _rNDGrenS_) * _rNDGrenS_ * _tDRespGrenS_;
_tNMortGrenS_ = _kMortGrenS_ * _sNGrenS_;
_wDPrimGrenW_ = _wDAssGren_ - _wDRespGrenW_ - _wDLossGren_ - _wDMortGrenW_ -(_tDSetGren_ - _tDResusGren_) / _sDepthW_;
_wPPrimGrenW_ = _wPUptGren_ - _wPExcrGrenW_ - _wPLossGren_ - _wPMortGrenW_ -(_tPSetGren_ - _tPResusGren_) / _sDepthW_;
_wNPrimGrenW_ = _wNUptGren_ - _wNExcrGrenW_ - _wNLossGren_ - _wNMortGrenW_ -(_tNSetGren_ - _tNResusGren_) / _sDepthW_;
_tDPrimGrenS_ = _IF_ (_InclPhytS_ _EQ_ _TRUE_) _THEN_ _tDSetGren_ - _tDResusGren_ - _tDMortGrenS_ - _tDRespGrenS_ _ELSE_ 0.0 _ENDIF_;
_tPPrimGrenS_ = _IF_ (_InclPhytS_ _EQ_ _TRUE_) _THEN_ _tPSetGren_ - _tPResusGren_ - _tPMortGrenS_ - _tPExcrGrenS_ _ELSE_ 0.0 _ENDIF_;
_tNPrimGrenS_ = _IF_ (_InclPhytS_ _EQ_ _TRUE_) _THEN_ _tNSetGren_ - _tNResusGren_ - _tNMortGrenS_ - _tNExcrGrenS_ _ELSE_ 0.0 _ENDIF_;
_rPDDiatW_ = _sPDiatW_ /(_sDDiatW_+_NearZero_);
_rNDDiatW_ = _sNDiatW_ /(_sDDiatW_+_NearZero_);
_rPDDiatS_ = _sPDiatS_ /(_sDDiatS_+_NearZero_);
_rNDDiatS_ = _sNDiatS_ /(_sDDiatS_+_NearZero_);
_uFunTmDiat_ = _EXP_(-0.5/(_cSigTmDiat_*_cSigTmDiat_) *((_uTm_-_cTmOptDiat_)*(_uTm_-_cTmOptDiat_) - (_cTmRef_-_cTmOptDiat_)*(_cTmRef_-_cTmOptDiat_)));
_uFunTmProdDiat_ = _uFunTmDiat_;
_uFunTmRespDiat_ = _uFunTmDiat_;
_aVPUptMaxCrDiat_ = _MAX_(0.0,_cVPUptMaxDiat_ * _uFunTmProdDiat_ *(_cPDDiatMax_ - _rPDDiatW_) /(_cPDDiatMax_ - _cPDDiatMin_));
_aVPUptDiat_ = _sPO4W_ * _aVPUptMaxCrDiat_ /(_aVPUptMaxCrDiat_ / _cAffPUptDiat_ + _sPO4W_);
_wPUptDiat_ = _aVPUptDiat_ * _sDDiatW_;
_aVNUptMaxCrDiat_ = _MAX_(0.0,_cVNUptMaxDiat_ * _uFunTmProdDiat_ * (_cNDDiatMax_ - _rNDDiatW_) /(_cNDDiatMax_ - _cNDDiatMin_));
_ahNUptDiat_ = _aVNUptMaxCrDiat_ / _cAffNUptDiat_;
_aVNUptDiat_ = _oNDissW_ * _aVNUptMaxCrDiat_ /(_ahNUptDiat_ + _oNDissW_);
_wNUptDiat_ = _aVNUptDiat_ * _sDDiatW_;
_afNH4UptDiat_ = _sNH4W_ * _sNO3W_ /((_ahNUptDiat_ + _sNH4W_) *(_ahNUptDiat_ + _sNO3W_)) + _sNH4W_ * _ahNUptDiat_ /((_sNH4W_ + _sNO3W_) *(_ahNUptDiat_ + _sNO3W_));
_wNUptNH4Diat_ = _afNH4UptDiat_ * _wNUptDiat_;
_wNUptNO3Diat_ = _wNUptDiat_ - _wNUptNH4Diat_;
_uMuMaxTmDiat_ = _cMuMaxDiat_ * _uFunTmProdDiat_;
_aPLimDiat_ = _MAX_(0.0,(1.0 - _cPDDiatMin_ / _rPDDiatW_) * _cPDDiatMax_ /(_cPDDiatMax_ - _cPDDiatMin_));
_aNLimDiat_ = _MAX_(0.0,(1.0 - _cNDDiatMin_ / _rNDDiatW_) * _cNDDiatMax_ /(_cNDDiatMax_ - _cNDDiatMin_));
_aSiLimDiat_ = _sSiO2W_ /(_hSiAssDiat_ + _sSiO2W_);
_aLLimDiat_ = _UseSteeleDiat_ *(_EXP_(1.0) /(_aExtCoef_ * _sDepthW_) *(_EXP_(- _aLPARBot_ /(_cLOptRefDiat_ * _uFunTmProdDiat_)) - _EXP_(- _uLPARSurf_ /(_cLOptRefDiat_ * _uFunTmProdDiat_)))) +(1.0 - _UseSteeleDiat_) *(1.0 /(_aExtCoef_ * _sDepthW_) * _LN_((1.0 + _uLPARSurf_ / (_hLRefDiat_ * _uFunTmProdDiat_)) / (1.0 + _aLPARBot_ /(_hLRefDiat_ * _uFunTmProdDiat_))));
_aMuTmLDiat_ = _ufDay_ *(1.0 - _afCovSurfVeg_) * _aLLimDiat_ * _uMuMaxTmDiat_;
_aNutLimDiat_ = _MIN_(_aPLimDiat_,(_MIN_(_aNLimDiat_,_aSiLimDiat_)));
_aMuDiat_ = _aNutLimDiat_ * _aMuTmLDiat_;
_wDAssDiat_ = _aMuDiat_*_sDDiatW_;
_rChDDiat_ = _cChDDiatMax_ -(_cChDDiatMax_ - _cChDDiatMin_) * _aLLimDiat_;
_oChlaDiat_ = _mgPerg_ * _rChDDiat_ * _sDDiatW_;
_aExtChDiat_ = _cExtSpDiat_ / _rChDDiat_;
_ukDRespTmDiat_ = _kDRespDiat_ * _uFunTmRespDiat_;
_wDRespDiatW_ = _ukDRespTmDiat_ * _sDDiatW_;
_ukLossTmDiat_ = _UseLoss_ * _kLossDiat_ * _uFunTmLoss_;
_wDLossDiat_ = _ukLossTmDiat_ * _sDDiatW_;
_wDMortDiatW_ = _kMortDiatW_ * _sDDiatW_;
_uCorVSetDiat_ = _cVSetDiat_ * _aFunTauSetOM_ * _uFunTmSet_;
_tDSetDiat_ = _uCorVSetDiat_ * _sDDiatW_;
_tDResusDiat_ = _sDDiatS_ /(_aDPhytS_+_NearZero_) * _tDResusPhytTot_;
_tDRespDiatS_ = _ukDRespTmDiat_ * _sDDiatS_;
_tDMortDiatS_ = _kMortDiatS_ * _sDDiatS_;
_ukDDecDiat_ = _ukDRespTmDiat_ + _ukLossTmDiat_ + _kMortDiatW_ +(_uCorVSetDiat_ * _uFunTmSet_) / _sDepthW_;
_wPExcrDiatW_ = (2.0 * _rPDDiatW_) /(_cPDDiatMax_ + _rPDDiatW_) * _rPDDiatW_ * _wDRespDiatW_;
_wPLossDiat_ = _rPDDiatW_ * _wDLossDiat_;
_wPMortDiatW_ = _kMortDiatW_ * _sPDiatW_;
_tPSetDiat_ = _rPDDiatW_ * _tDSetDiat_;
_tPResusDiat_ = _rPDDiatS_ * _tDResusDiat_;
_tPExcrDiatS_ = (2.0 * _rPDDiatS_) /(_cPDDiatMax_ + _rPDDiatS_) * _rPDDiatS_ * _tDRespDiatS_;
_tPMortDiatS_ = _kMortDiatS_ * _sPDiatS_;
_wNExcrDiatW_ = (2.0 * _rNDDiatW_) /(_cNDDiatMax_ + _rNDDiatW_) * _rNDDiatW_ * _wDRespDiatW_;
_wNLossDiat_ = _rNDDiatW_ * _wDLossDiat_;
_wNMortDiatW_ = _kMortDiatW_ * _sNDiatW_;
_tNSetDiat_ = _rNDDiatW_ * _tDSetDiat_;
_tNResusDiat_ = _rNDDiatS_ * _tDResusDiat_;
_tNExcrDiatS_ = (2.0 * _rNDDiatS_) /(_cNDDiatMax_ + _rNDDiatS_) * _rNDDiatS_ * _tDRespDiatS_;
_tNMortDiatS_ = _kMortDiatS_ * _sNDiatS_;
_wDPrimDiatW_ = _wDAssDiat_ - _wDRespDiatW_ - _wDLossDiat_ - _wDMortDiatW_ -(_tDSetDiat_ - _tDResusDiat_) / _sDepthW_;
_wPPrimDiatW_ = _wPUptDiat_ - _wPExcrDiatW_ - _wPLossDiat_ - _wPMortDiatW_ -(_tPSetDiat_ - _tPResusDiat_) / _sDepthW_;
_wNPrimDiatW_ = _wNUptDiat_ - _wNExcrDiatW_ - _wNLossDiat_ - _wNMortDiatW_ -(_tNSetDiat_ - _tNResusDiat_) / _sDepthW_;
_tDPrimDiatS_ = _IF_ (_InclPhytS_ _EQ_ _TRUE_) _THEN_ _tDSetDiat_ - _tDResusDiat_ - _tDMortDiatS_ - _tDRespDiatS_ _ELSE_ 0.0 _ENDIF_;
_tPPrimDiatS_ = _IF_ (_InclPhytS_ _EQ_ _TRUE_) _THEN_ _tPSetDiat_ - _tPResusDiat_ - _tPMortDiatS_ - _tPExcrDiatS_ _ELSE_ 0.0 _ENDIF_;
_tNPrimDiatS_ = _IF_ (_InclPhytS_ _EQ_ _TRUE_) _THEN_ _tNSetDiat_ - _tNResusDiat_ - _tNMortDiatS_ - _tNExcrDiatS_ _ELSE_ 0.0 _ENDIF_;
_oChla_ = _oChlaDiat_ + _oChlaGren_ + _oChlaBlue_;
_wDAssPhyt_ = _wDAssDiat_ + _wDAssGren_ + _wDAssBlue_;
_wDRespPhytW_ = _wDRespDiatW_ + _wDRespGrenW_ + _wDRespBlueW_;
_wDMortPhytW_ = _wDMortDiatW_ + _wDMortGrenW_ + _wDMortBlueW_;
_tDSetPhyt_ = _tDSetDiat_ + _tDSetGren_ + _tDSetBlue_;
_wDLossPhyt_ = _wDLossDiat_ + _wDLossGren_ + _wDLossBlue_;
_wDPrimPhytW_ = _wDPrimDiatW_ + _wDPrimGrenW_ + _wDPrimBlueW_;
_wPUptPhyt_ = _wPUptDiat_ + _wPUptGren_ + _wPUptBlue_;
_wPExcrPhytW_ = _wPExcrDiatW_ + _wPExcrGrenW_ + _wPExcrBlueW_;
_wPMortPhytW_ = _wPMortDiatW_ + _wPMortGrenW_ + _wPMortBlueW_;
_tPSetPhyt_ = _tPSetDiat_ + _tPSetGren_ + _tPSetBlue_;
_tPResusPhyt_ = _tPResusDiat_ + _tPResusGren_ + _tPResusBlue_;
_wPLossPhyt_ = _wPLossDiat_ + _wPLossGren_ + _wPLossBlue_;
_wPPrimPhytW_ = _wPPrimDiatW_ + _wPPrimGrenW_ + _wPPrimBlueW_;
_wNUptPhyt_ = _wNUptDiat_ + _wNUptGren_ + _wNUptBlue_;
_wNUptNH4Phyt_ = _wNUptNH4Diat_ + _wNUptNH4Gren_ + _wNUptNH4Blue_;
_wNUptNO3Phyt_ = _wNUptNO3Diat_ + _wNUptNO3Gren_ + _wNUptNO3Blue_;
_wNExcrPhytW_ = _wNExcrDiatW_ + _wNExcrGrenW_ + _wNExcrBlueW_;
_wNMortPhytW_ = _wNMortDiatW_ + _wNMortGrenW_ + _wNMortBlueW_;
_tNSetPhyt_ = _tNSetDiat_ + _tNSetGren_ + _tNSetBlue_;
_tNResusPhyt_ = _tNResusDiat_ + _tNResusGren_ + _tNResusBlue_;
_wNLossPhyt_ = _wNLossDiat_ + _wNLossGren_ + _wNLossBlue_;
_wNPrimPhytW_ = _wNPrimDiatW_ + _wNPrimGrenW_ + _wNPrimBlueW_;
_tDRespPhytS_ = _tDRespDiatS_ + _tDRespGrenS_ + _tDRespBlueS_;
_tDMortPhytS_ = _tDMortDiatS_ + _tDMortGrenS_ + _tDMortBlueS_;
_tDPrimPhytS_ = _tDPrimDiatS_ + _tDPrimGrenS_ + _tDPrimBlueS_;
_tPExcrPhytS_ = _tPExcrDiatS_ + _tPExcrGrenS_ + _tPExcrBlueS_;
_tPMortPhytS_ = _tPMortDiatS_ + _tPMortGrenS_ + _tPMortBlueS_;
_tPPrimPhytS_ = _tPPrimDiatS_ + _tPPrimGrenS_ + _tPPrimBlueS_;
_tNExcrPhytS_ = _tNExcrDiatS_ + _tNExcrGrenS_ + _tNExcrBlueS_;
_tNMortPhytS_ = _tNMortDiatS_ + _tNMortGrenS_ + _tNMortBlueS_;
_tNPrimPhytS_ = _tNPrimDiatS_ + _tNPrimGrenS_ + _tNPrimBlueS_;
_wSiUptDiat_ = _cSiDDiat_ * _wDAssDiat_;
_wSiExcrDiatW_ = _cSiDDiat_ * _wDRespDiatW_;
_wSiLossDiat_ = _cSiDDiat_ * _wDLossDiat_;
_wSiMortDiatW_ = _cSiDDiat_ * _wDMortDiatW_;
_tSiSetDiat_ = _cSiDDiat_ * _tDSetDiat_;
_tSiResusDiat_ = _cSiDDiat_ * _tDResusDiat_;
_wSiPrimDiatW_ = _wSiUptDiat_ - _tSiSetDiat_ / _sDepthW_ - _wSiExcrDiatW_ - _wSiMortDiatW_ - _wSiLossDiat_ + _tSiResusDiat_ / _sDepthW_;
_rCyDBlue_ = _cCyDBlueMax_ -(_cCyDBlueMax_ - _cCyDBlueMin_) * _aLLimBlue_;
_oCyan_ = _rCyDBlue_ * _sDBlueW_ * _mgPerg_;
_fDDiat_ = _sDDiatW_ /(_sDDiatW_ + _sDGrenW_ + _sDBlueW_ + _NearZero_);
_wDPrimDetW_ = _wDMortPhytW_ + _wDLossPhyt_;
_tDPrimDetS_ = _IF_ (_InclPhytS_ _EQ_ _TRUE_) _THEN_ _tDMortPhytS_ _ELSE_ _tDSetPhyt_ _ENDIF_;
_tDPrimTotT_ = (_wDAssPhyt_ - _wDRespPhytW_) * _sDepthW_ - _tDRespPhytS_;
_wO2ProdPhyt_ = _molO2molC_ * _cCPerDW_ * _wDAssPhyt_;
_wO2RespPhytW_ = _molO2molC_ * _cCPerDW_ * _wDRespPhytW_ * _aCorO2BOD_;
_wO2UptNO3Phyt_ = _O2PerNO3_ * _molO2molN_ * _wNUptNO3Phyt_;
_wO2PrimW_ = _wO2ProdPhyt_ - _wO2RespPhytW_ + _wO2UptNO3Phyt_;
_tO2RespPhytS_ = _molO2molC_ * _cCPerDW_ * _tDRespPhytS_ * _afOxySed_;
_tO2PrimS_ = _tO2RespPhytS_;
_wPMortPhytPO4W_ = _fDissMortPhyt_ * _wPMortPhytW_;
_wPMortPhytDetW_ = _wPMortPhytW_ - _wPMortPhytPO4W_;
_wPLossPhytPO4_ = _fDissLoss_ * _wPLossPhyt_;
_wPLossPhytDet_ = _wPLossPhyt_ - _wPLossPhytPO4_;
_wPPrimPO4W_ = - _wPUptPhyt_ + _wPExcrPhytW_ + _wPLossPhytPO4_ + _wPMortPhytPO4W_;
_wPPrimDetW_ = _wPLossPhytDet_ + _wPMortPhytDetW_;
_tPMortPhytPO4S_ = _fDissMortPhyt_ * _tPMortPhytS_;
_tPMortPhytDetS_ = _tPMortPhytS_ - _tPMortPhytPO4S_;
_tPPrimDetS_ = _IF_ (_InclPhytS_ _EQ_ _TRUE_) _THEN_ _tPMortPhytDetS_ _ELSE_ _tPSetPhyt_ _ENDIF_;
_tPPrimPO4S_ = _tPExcrPhytS_ + _tPMortPhytPO4S_;
_tPPrimTotT_ = 0.0;
_wNMortPhytNH4W_ = _fDissMortPhyt_ * _wNMortPhytW_;
_wNMortPhytDetW_ = _wNMortPhytW_ - _wNMortPhytNH4W_;
_wNLossPhytNH4_ = _fDissLoss_ * _wNLossPhyt_;
_wNLossPhytDet_ = _wNLossPhyt_ - _wNLossPhytNH4_;
_wNPrimNH4W_ = - _wNUptNH4Phyt_ + _wNExcrPhytW_ + _wNLossPhytNH4_ + _wNMortPhytNH4W_;
_wNPrimNO3W_ = - _wNUptNO3Phyt_;
_wNPrimDetW_ = _wNLossPhytDet_ + _wNMortPhytDetW_;
_tNMortPhytNH4S_ = _fDissMortPhyt_ * _tNMortPhytS_;
_tNMortPhytDetS_ = _tNMortPhytS_ - _tNMortPhytNH4S_;
_tNPrimNH4S_ = _tNExcrPhytS_ + _tNMortPhytNH4S_;
_tNPrimNO3S_ = 0.0;
_tNPrimDetS_ = _IF_ (_InclPhytS_ _EQ_ _TRUE_) _THEN_ _tNMortPhytDetS_ _ELSE_ _tNSetPhyt_ _ENDIF_;
_tNPrimTotT_ = 0.0;
_tSiExcrDiatS_ = _cSiDDiat_ * _tDRespDiatS_;
_tSiMortDiatS_ = _cSiDDiat_ * _tDMortDiatS_;
_wSiPrimSiO2W_ = _wSiExcrDiatW_ - _wSiUptDiat_ + _tSiExcrDiatS_ / _sDepthW_;
_wSiPrimDetW_ = _wSiMortDiatW_ + _wSiLossDiat_;
_tSiPrimDiatS_ = _IF_ (_InclPhytS_ _EQ_ _TRUE_) _THEN_ _tSiSetDiat_ - _tSiResusDiat_ - _tSiExcrDiatS_ - _tSiMortDiatS_ _ELSE_ 0.0 _ENDIF_;
_tSiPrimDetS_ = _IF_ (_InclPhytS_ _EQ_ _TRUE_) _THEN_ _tSiMortDiatS_ _ELSE_ _tSiSetDiat_ _ENDIF_;
_tSiPrimTotT_ = 0.0;
_aPACoef_ = _cPACoefMin_ +(_cPACoefMax_ - _cPACoefMin_) * _hPACoef_ / (_hPACoef_ + _oDOMW_);
_bSecchiMax_ = _sDepthW_ + _cSecchiPlus_;
_aSecchi_ = _MIN_(_bSecchiMax_,_aPACoef_ / _aExtCoefOpen_);
_aTransparency_ = _aSecchi_ / _sDepthW_;
_aDepthEuph_ = _cEuph_ * _aSecchi_;
_aRelDepthEuph_ = _aDepthEuph_ / _sDepthW_;
_aChlaH_ = _oChla_ * _sDepthW_;
_aCovPhytW_ = _cCovSpPhyt_ *(_oDPhytW_ * _sDepthW_);
_rExtChPhyt_ = _aExtPhyt_ /(_oChla_ / _mgPerg_ + _NearZero_);
_uFunTmZoo_ = _EXP_(-0.5/(_cSigTmZoo_*_cSigTmZoo_) *((_uTm_-_cTmOptZoo_)*(_uTm_-_cTmOptZoo_) -(_cTmRef_-_cTmOptZoo_)*(_cTmRef_-_cTmOptZoo_)));
_rPDZoo_ = _sPZoo_ /(_sDZoo_+_NearZero_);
_rNDZoo_ = _sNZoo_/(_sDZoo_+_NearZero_);
_oDFoodZoo_ = _cPrefDiat_ * _sDDiatW_ + _cPrefGren_ * _sDGrenW_ + _cPrefBlue_ * _sDBlueW_ + _cPrefDet_ * _sDDetW_;
_aFilt_ = _cFiltMax_ * _uFunTmZoo_ * _hFilt_ /(_hFilt_ + _oDOMW_);
_ukDAssTmZoo_ = _fDAssZoo_ * _cFiltMax_ * _uFunTmZoo_ * _hFilt_;
_aDSatZoo_ = _oDFoodZoo_ /(_hFilt_ + _oDOMW_);
_ukDRespTmZoo_ = _kDRespZoo_ * _uFunTmZoo_;
_ukDIncrZoo_ = _ukDAssTmZoo_ - _ukDRespTmZoo_ - _kMortZoo_;
_wDEnvZoo_ = _MAX_(0.0,_ukDIncrZoo_ / _cDCarrZoo_ * _sDZoo_*_sDZoo_);
_wDAssZoo_ = _aDSatZoo_ *(_ukDAssTmZoo_ * _sDZoo_ - _wDEnvZoo_);
_wDConsZoo_ = _wDAssZoo_ / _fDAssZoo_;
_wDConsDetZoo_ = _cPrefDet_*_sDDetW_ / _oDFoodZoo_ * _wDConsZoo_;
_wDConsDiatZoo_ = _cPrefDiat_*_sDDiatW_ / _oDFoodZoo_ * _wDConsZoo_;
_wDConsGrenZoo_ = _cPrefGren_*_sDGrenW_ / _oDFoodZoo_ * _wDConsZoo_;
_wDConsBlueZoo_ = _cPrefBlue_*_sDBlueW_ / _oDFoodZoo_ * _wDConsZoo_;
_wDConsPhytZoo_ = _wDConsDiatZoo_ + _wDConsGrenZoo_ + _wDConsBlueZoo_;
_wDEgesZoo_ = _wDConsZoo_ - _wDAssZoo_;
_aCorDRespZoo_ = _MAX_(_cPDZooRef_ / _rPDZoo_,_cNDZooRef_ / _rNDZoo_);
_wDRespZoo_ = _aCorDRespZoo_ * _ukDRespTmZoo_ * _sDZoo_;
_wDMortZoo_ = _kMortZoo_ * _sDZoo_ +(1.0 - _aDSatZoo_) * _wDEnvZoo_;
_oPFoodZoo_ = _cPrefDiat_*_sPDiatW_ + _cPrefGren_*_sPGrenW_ + _cPrefBlue_*_sPBlueW_ + _cPrefDet_ * _sPDetW_;
_rPDFoodZoo_ = _oPFoodZoo_ /(_oDFoodZoo_+_NearZero_);
_wPConsDiatZoo_ = _rPDDiatW_ * _wDConsDiatZoo_;
_wPConsGrenZoo_ = _rPDGrenW_ * _wDConsGrenZoo_;
_wPConsBlueZoo_ = _rPDBlueW_ * _wDConsBlueZoo_;
_wPConsPhytZoo_ = _wPConsDiatZoo_ + _wPConsGrenZoo_ + _wPConsBlueZoo_;
_wPConsDetZoo_ = _rPDDetW_ * _wDConsDetZoo_;
_wPConsZoo_ = _wPConsPhytZoo_ + _wPConsDetZoo_;
_afPAssZoo_ = _MIN_(1.0,_cPDZooRef_ / _rPDFoodZoo_ * _fDAssZoo_);
_wPAssZoo_ = _afPAssZoo_ * _wPConsZoo_;
_wPEgesZoo_ = _wPConsZoo_ - _wPAssZoo_;
_wPEgesZooPO4_ = _fDissEgesZoo_*_wPEgesZoo_;
_wPEgesZooDet_ = _wPEgesZoo_ - _wPEgesZooPO4_;
_akPExcrZoo_ = _rPDZoo_ / _cPDZooRef_ * _kDRespZoo_ * _uFunTmZoo_;
_wPExcrZoo_ = _akPExcrZoo_*_sPZoo_;
_wPMortZoo_ = _rPDZoo_ * _wDMortZoo_;
_wPMortZooPO4_ = _fDissMortZoo_ * _wPMortZoo_;
_wPMortZooDet_ = _wPMortZoo_ - _wPMortZooPO4_;
_oNFoodZoo_ = _cPrefDiat_*_sNDiatW_ + _cPrefGren_*_sNGrenW_ + _cPrefBlue_*_sNBlueW_ + _cPrefDet_*_sNDetW_;
_rNDFoodZoo_ = _oNFoodZoo_ /(_oDFoodZoo_+_NearZero_);
_wNConsDiatZoo_ = _rNDDiatW_*_wDConsDiatZoo_;
_wNConsGrenZoo_ = _rNDGrenW_*_wDConsGrenZoo_;
_wNConsBlueZoo_ = _rNDBlueW_*_wDConsBlueZoo_;
_wNConsPhytZoo_ = _wNConsDiatZoo_ + _wNConsGrenZoo_ + _wNConsBlueZoo_;
_wNConsDetZoo_ = _rNDDetW_*_wDConsDetZoo_;
_wNConsZoo_ = _wNConsPhytZoo_ + _wNConsDetZoo_;
_afNAssZoo_ = _MIN_(1.0,_cNDZooRef_ / _rNDFoodZoo_ * _fDAssZoo_);
_wNAssZoo_ = _afNAssZoo_*_wNConsZoo_;
_wNEgesZoo_ = _wNConsZoo_ - _wNAssZoo_;
_wNEgesZooNH4_ = _fDissEgesZoo_*_wNEgesZoo_;
_wNEgesZooDet_ = _wNEgesZoo_ - _wNEgesZooNH4_;
_kNExcrZoo_ = _rNDZoo_ / _cNDZooRef_ * _kDRespZoo_ * _uFunTmZoo_;
_wNExcrZoo_ = _kNExcrZoo_*_sNZoo_;
_wNMortZoo_ = _rNDZoo_*_wDMortZoo_;
_wNMortZooNH4_ = _fDissMortZoo_*_wNMortZoo_;
_wNMortZooDet_ = _wNMortZoo_ - _wNMortZooNH4_;
_wSiConsDiatZoo_ = _cSiDDiat_ * _wDConsDiatZoo_;
_uFunTmBent_ = _EXP_(-0.5/(_cSigTmBent_*_cSigTmBent_) *((_uTm_-_cTmOptBent_)*(_uTm_-_cTmOptBent_) - (_cTmRef_-_cTmOptBent_)*(_cTmRef_-_cTmOptBent_)));
_aDFoodBent_ = _sDDetS_ + _aDPhytS_;
_rPDBent_ = _sPBent_ /(_sDBent_+_NearZero_);
_rNDBent_ = _sNBent_ /(_sDBent_+_NearZero_);
_tDMigrBent_ = _kMigrBent_ *(_cDBentIn_ - _sDBent_);
_aDSatBent_ = _aDFoodBent_ /(_hDFoodBent_ + _aDFoodBent_);
_ukDIncrBent_ = (_kDAssBent_ - _kDRespBent_) * _uFunTmBent_ - _kMortBent_;
_tDEnvBent_ = _MAX_(0.0,_ukDIncrBent_ / _cDCarrBent_ * _sDBent_*_sDBent_);
_tDAssBent_ = _aDSatBent_ *(_kDAssBent_ * _uFunTmBent_ * _sDBent_ - _tDEnvBent_);
_aDAssBentSp_ = _tDAssBent_ / _sDBent_;
_tDConsBent_ = _tDAssBent_ / _fDAssBent_;
_tDConsDetBent_ = _sDDetS_ / _aDFoodBent_ * _tDConsBent_;
_tDConsDiatBent_ = _sDDiatS_ / _aDFoodBent_ * _tDConsBent_;
_tDConsGrenBent_ = _sDGrenS_ / _aDFoodBent_ * _tDConsBent_;
_tDConsBlueBent_ = _sDBlueS_ / _aDFoodBent_ * _tDConsBent_;
_tDConsPhytBent_ = _tDConsDiatBent_ + _tDConsGrenBent_ + _tDConsBlueBent_;
_tDEgesBent_ = _tDConsBent_ - _tDAssBent_;
_tDRespBent_ = (_cPDBentRef_ / _rPDBent_) * _kDRespBent_ * _uFunTmBent_ * _sDBent_;
_tDMortBent_ = _kMortBent_*_sDBent_ +(1.0 - _aDSatBent_) * _tDEnvBent_;
_aPFoodBent_ = _sPDetS_ + _aPPhytS_;
_rPDFoodBent_ = _aPFoodBent_ /(_aDFoodBent_+_NearZero_);
_tPConsDetBent_ = _rPDDetS_ * _tDConsDetBent_;
_tPConsDiatBent_ = _rPDDiatS_ * _tDConsDiatBent_;
_tPConsGrenBent_ = _rPDGrenS_ * _tDConsGrenBent_;
_tPConsBlueBent_ = _rPDBlueS_ * _tDConsBlueBent_;
_tPConsPhytBent_ = _tPConsDiatBent_ + _tPConsGrenBent_ + _tPConsBlueBent_;
_tPConsBent_ = _tPConsDetBent_ + _tPConsPhytBent_;
_afPAssBent_ = _MIN_(1.0,_cPDBentRef_ / _rPDFoodBent_ * _fDAssBent_);
_tPAssBent_ = _afPAssBent_ * _tPConsBent_;
_tPEgesBent_ = _tPConsBent_ - _tPAssBent_;
_tPEgesBentPO4_ = _fDissEgesBent_ * _tPEgesBent_;
_tPEgesBentDet_ = (1.0 - _fDissEgesBent_) * _tPEgesBent_;
_tPExcrBent_ = (_rPDBent_ / _cPDBentRef_) * _kDRespBent_ * _uFunTmBent_ * _sPBent_;
_tPMortBent_ = _rPDBent_ * _tDMortBent_;
_tPMortBentPO4_ = _fDissMortBent_ * _tPMortBent_;
_tPMortBentDet_ = (1.0-_fDissMortBent_)*_tPMortBent_;
_tPMigrBent_ = _kMigrBent_ *(_cPDBentRef_*_cDBentIn_ - _sPBent_);
_aNFoodBent_ = _sNDetS_ + _aNPhytS_;
_rNDFoodBent_ = _aNFoodBent_ /(_aDFoodBent_+_NearZero_);
_tNMigrBent_ = _kMigrBent_ *(_cNDBentRef_*_cDBentIn_ - _sNBent_);
_tNConsDetBent_ = _rNDDetS_ * _tDConsDetBent_;
_tNConsDiatBent_ = _rNDDiatS_ * _tDConsDiatBent_;
_tNConsGrenBent_ = _rNDGrenS_ * _tDConsGrenBent_;
_tNConsBlueBent_ = _rNDBlueS_ * _tDConsBlueBent_;
_tNConsPhytBent_ = _tNConsDiatBent_ + _tNConsGrenBent_ + _tNConsBlueBent_;
_tNConsBent_ = _tNConsDetBent_ + _tNConsPhytBent_;
_afNAssBent_ = _MIN_(1.0,_cNDBentRef_ / _rNDFoodBent_ * _fDAssBent_);
_tNAssBent_ = _afNAssBent_ * _tNConsBent_;
_tNEgesBent_ = _tNConsBent_ - _tNAssBent_;
_tNEgesBentNH4_ = _fDissEgesBent_ * _tNEgesBent_;
_tNEgesBentDet_ = (1.0 - _fDissEgesBent_) * _tNEgesBent_;
_tNExcrBent_ = (_rNDBent_ / _cNDBentRef_) * _kDRespBent_ * _uFunTmBent_ * _sNBent_;
_tNMortBent_ = _rNDBent_ * _tDMortBent_;
_tNMortBentNH4_ = _fDissMortBent_*_tNMortBent_;
_tNMortBentDet_ = (1.0-_fDissMortBent_)*_tNMortBent_;
_tSiConsDiatBent_ = _cSiDDiat_ * _tDConsDiatBent_;
_aDFish_ = _sDFiJv_ + _sDFiAd_;
_aPFish_ = _sPFiJv_ + _sPFiAd_;
_aNFish_ = _sNFiJv_ + _sNFiAd_;
_rPDFiJv_ = _sPFiJv_ /(_sDFiJv_+_NearZero_);
_rPDFiAd_ = _sPFiAd_ /(_sDFiAd_+_NearZero_);
_rNDFiJv_ = _sNFiJv_ /(_sDFiJv_+_NearZero_);
_rNDFiAd_ = _sNFiAd_ /(_sDFiAd_+_NearZero_);
_tDReprFish_ = _IF_ (_FALSE_ _EQ_ _InclSeason_) _THEN_ ((1/_DaysPerYear_)*_fReprFish_) * _sDFiAd_ _ELSEIF_ (_Day_ _GE_ _cDayReprFish_ _AND_ _Day_ _LT_ _cDayReprFish_ + 1.0) _THEN_ _fReprFish_ * _sDFiAd_ _ELSE_ 0.0 _ENDIF_;
_tDAgeFish_ = _IF_ (_FALSE_ _EQ_ _InclSeason_) _THEN_ ((1/_DaysPerYear_)*_fAgeFish_) * _sDFiJv_ _ELSEIF_ (_Day_ _GE_ 364.0) _THEN_ _fAgeFish_ * _sDFiJv_ _ELSE_ 0.0 _ENDIF_;
_aFunVegFish_ = _MAX_(0.0,1.0 - _cRelVegFish_ * _aCovVeg_);
_aDSatFiJv_ = (_sDZoo_ * _sDepthW_) *(_sDZoo_ * _sDepthW_) /(_hDZooFiJv_ * _hDZooFiJv_ + (_sDZoo_ * _sDepthW_) *(_sDZoo_ * _sDepthW_));
_ukDIncrFiJv_ = (_kDAssFiJv_ - _kDRespFiJv_) * _uFunTmFish_ - _kMortFiJv_;
_tDEnvFiJv_ = _MAX_(0.0,_ukDIncrFiJv_ /(_cDCarrFish_ - _sDFiAd_) * _sDFiJv_*_sDFiJv_);
_tDAssFiJv_ = _aDSatFiJv_ *(_kDAssFiJv_ * _uFunTmFish_ * _sDFiJv_ - _tDEnvFiJv_);
_tDConsFiJv_ = _tDAssFiJv_ / _fDAssFiJv_;
_tDEgesFiJv_ = _tDConsFiJv_ - _tDAssFiJv_;
_tDRespFiJv_ = (_cPDFishRef_ / _rPDFiJv_) * _kDRespFiJv_ * _uFunTmFish_ * _sDFiJv_;
_tDMortFiJv_ = _kMortFiJv_ * _sDFiJv_ +(1.0 - _aDSatFiJv_) * _tDEnvFiJv_;
_tDMigrFiJv_ = _kMigrFish_ *(_cDFiJvIn_ - _sDFiJv_);
_aDSatFiAd_ = (_aFunVegFish_ * _sDBent_) *(_aFunVegFish_ * _sDBent_) /(_hDBentFiAd_ * _hDBentFiAd_ + (_aFunVegFish_ * _sDBent_) *(_aFunVegFish_ * _sDBent_));
_ukDIncrFiAd_ = (_kDAssFiAd_ - _kDRespFiAd_) * _uFunTmFish_ - _kMortFiAd_;
_tDEnvFiAd_ = _MAX_(0.0,_ukDIncrFiAd_ /(_cDCarrFish_ - _sDFiJv_) * _sDFiAd_*_sDFiAd_);
_tDAssFiAd_ = _aDSatFiAd_ *(_kDAssFiAd_ * _uFunTmFish_ * _sDFiAd_ - _tDEnvFiAd_);
_tDConsFiAd_ = _tDAssFiAd_ / _fDAssFiAd_;
_tDEgesFiAd_ = _tDConsFiAd_ - _tDAssFiAd_;
_tDRespFiAd_ = (_cPDFishRef_ / _rPDFiAd_) * _kDRespFiAd_ * _uFunTmFish_ * _sDFiAd_;
_tDMortFiAd_ = _kMortFiAd_ * _sDFiAd_ +(1.0 - _aDSatFiAd_) * _tDEnvFiAd_;
_ukHarvFish_ = _IF_ (_COS_(2.0 * _Pi_ * _sTime_ / _DaysPerYear_) _GT_ 0.1) _THEN_ _kHarvFishWin_ _ELSE_ _kHarvFishSum_ _ENDIF_;
_tDHarvFish_ = _ukHarvFish_ * _sDFiAd_;
_tDMigrFiAd_ = _kMigrFish_ *(_cDFiAdIn_ - _sDFiAd_);
_tDMortFish_ = _tDMortFiJv_ + _tDMortFiAd_;
_tDMortFishBot_ = _fDBone_ * _tDMortFish_;
_tDMortFishDet_ = _tDMortFish_ - _tDMortFishBot_;
_tPReprFish_ = _rPDFiAd_ * _tDReprFish_;
_tPAgeFish_ = _rPDFiJv_ * _tDAgeFish_;
_tPMigrFiJv_ = _kMigrFish_ *(_cPDFishRef_ * _cDFiJvIn_ - _sPFiJv_);
_tPConsFiJv_ = _rPDZoo_ * _tDConsFiJv_;
_afPAssFiJv_ = _MIN_(1.0,_cPDFishRef_ / _rPDZoo_ * _fDAssFiJv_);
_tPAssFiJv_ = _afPAssFiJv_ * _tPConsFiJv_;
_tPEgesFiJv_ = _tPConsFiJv_ - _tPAssFiJv_;
_tPExcrFiJv_ = (_rPDFiJv_ / _cPDFishRef_) * _kDRespFiJv_ * _uFunTmFish_ * _sPFiJv_;
_tPMortFiJv_ = _rPDFiJv_ * _tDMortFiJv_;
_tPMigrFiAd_ = _kMigrFish_ *(_cPDFishRef_ * _cDFiAdIn_ - _sPFiAd_);
_tPConsFiAd_ = _rPDBent_ * _tDConsFiAd_;
_afPAssFiAd_ = _MIN_(1.0,_cPDFishRef_ / _rPDBent_ * _fDAssFiAd_);
_tPAssFiAd_ = _afPAssFiAd_ * _tPConsFiAd_;
_tPEgesFiAd_ = _tPConsFiAd_ - _tPAssFiAd_;
_tPExcrFiAd_ = (_rPDFiAd_ / _cPDFishRef_) * _kDRespFiAd_ * _uFunTmFish_ * _sPFiAd_;
_tPMortFiAd_ = _rPDFiAd_ * _tDMortFiAd_;
_tPHarvFish_ = _rPDFiAd_ * _tDHarvFish_;
_tPMortFish_ = _tPMortFiJv_ + _tPMortFiAd_;
_tPMortFishBot_ = _fPBone_ * _tPMortFish_;
_tPMortFishPO4_ = _fDissMortFish_ *(_tPMortFish_ - _tPMortFishBot_);
_tPMortFishDet_ = _tPMortFish_ - _tPMortFishBot_ - _tPMortFishPO4_;
_tPEgesFish_ = _tPEgesFiJv_ + _tPEgesFiAd_;
_tPEgesFishPO4_ = _fDissEgesFish_ * _tPEgesFish_;
_tPEgesFishDet_ = _tPEgesFish_ - _tPEgesFishPO4_;
_tNReprFish_ = _rNDFiAd_ * _tDReprFish_;
_tNAgeFish_ = _rNDFiJv_ * _tDAgeFish_;
_tNMigrFiJv_ = _kMigrFish_ *(_cNDFishRef_ * _cDFiJvIn_ - _sNFiJv_);
_tNConsFiJv_ = _rNDZoo_ * _tDConsFiJv_;
_afNAssFiJv_ = _MIN_(1.0,_cNDFishRef_ / _rNDZoo_ * _fDAssFiJv_);
_tNAssFiJv_ = _afNAssFiJv_ * _tNConsFiJv_;
_tNEgesFiJv_ = _tNConsFiJv_ - _tNAssFiJv_;
_tNExcrFiJv_ = (_rNDFiJv_ / _cNDFishRef_) * _kDRespFiJv_ * _uFunTmFish_ * _sNFiJv_;
_tNMortFiJv_ = _rNDFiJv_ * _tDMortFiJv_;
_tNMigrFiAd_ = _kMigrFish_ *(_cNDFishRef_ * _cDFiAdIn_ - _sNFiAd_);
_tNConsFiAd_ = _rNDBent_ * _tDConsFiAd_;
_afNAssFiAd_ = _MIN_(1.0,_cNDFishRef_ / _rNDBent_ * _fDAssFiAd_);
_tNAssFiAd_ = _afNAssFiAd_ * _tNConsFiAd_;
_tNEgesFiAd_ = _tNConsFiAd_ - _tNAssFiAd_;
_tNExcrFiAd_ = (_rNDFiAd_ / _cNDFishRef_) * _kDRespFiAd_ * _uFunTmFish_ * _sNFiAd_;
_tNMortFiAd_ = _rNDFiAd_ * _tDMortFiAd_;
_tNHarvFish_ = _rNDFiAd_ * _tDHarvFish_;
_tNMortFish_ = _tNMortFiJv_ + _tNMortFiAd_;
_tNMortFishBot_ = _fDBone_ * _tNMortFish_;
_tNMortFishNH4_ = _fDissMortFish_ *(_tNMortFish_ - _tNMortFishBot_);
_tNMortFishDet_ = _tNMortFish_ - _tNMortFishBot_ - _tNMortFishNH4_;
_tNEgesFish_ = _tNEgesFiJv_ + _tNEgesFiAd_;
_tNEgesFishNH4_ = _fDissEgesFish_ * _tNEgesFish_;
_tNEgesFishDet_ = _tNEgesFish_ - _tNEgesFishNH4_;
_uFunTmPisc_ = _EXP_(-0.5 /(_cSigTmPisc_*_cSigTmPisc_) *((_uTm_ - _cTmOptPisc_)*(_uTm_ - _cTmOptPisc_) - (_cTmRef_ - _cTmOptPisc_)*(_cTmRef_ - _cTmOptPisc_)));
_tDMigrPisc_ = _kMigrPisc_ *(_cDPiscIn_ - _sDPisc_);
_aDCarrPisc_ = _IF_ (_FALSE_ _EQ_ _InclMarsh_ _OR_ _fMarsh_ _LE_ _NearZero_) _THEN_ _MAX_(_cDCarrPiscMin_,_MIN_(_cDCarrPiscMax_,_cDCarrPiscBare_)) _ELSEIF_ (_sDShootPhra_ _LT_ _cDPhraMinPisc_) _THEN_ _cDCarrPiscMin_ _ELSEIF_ (_aCovVeg_ _LT_ _cCovVegMin_) _THEN_ _MAX_(_cDCarrPiscMin_,_MIN_(_cDCarrPiscMax_,_fMarsh_ *(1.0/_PerCent_) * _cRelPhraPisc_)) _ELSE_ _MAX_(_cDCarrPiscMin_,_MIN_(_cDCarrPiscMax_,_fMarsh_ *(1.0/_PerCent_) *(_cRelPhraPisc_ + _cRelVegPisc_))) _ENDIF_;
_aFunVegPisc_ = _aDSubVeg_ /(_hDVegPisc_ + _aDSubVeg_ + _NearZero_);
_aDSatPisc_ = _aDFish_*_aDFish_ /(_hDFishPisc_*_hDFishPisc_ + _aDFish_*_aDFish_);
_akDIncrPisc_ = (_kDAssPisc_ * _aFunVegPisc_ - _kDRespPisc_) * _uFunTmPisc_ - _kMortPisc_;
_tDEnvPisc_ = _MAX_(0.0,_akDIncrPisc_ / _aDCarrPisc_ * _sDPisc_*_sDPisc_);
_tDAssPisc_ = _aDSatPisc_ *(_kDAssPisc_ * _aFunVegPisc_ * _uFunTmPisc_ * _sDPisc_ - _tDEnvPisc_);
_tDConsPisc_ = _tDAssPisc_ / _fDAssPisc_;
_tDEgesPisc_ = _tDConsPisc_ - _tDAssPisc_;
_tDConsFiJvPisc_ = _sDFiJv_ / _aDFish_ * _tDConsPisc_;
_tDConsFiAdPisc_ = _tDConsPisc_ - _tDConsFiJvPisc_;
_tDRespPisc_ = _kDRespPisc_ * _uFunTmPisc_ * _sDPisc_;
_tDMortPisc_ = _kMortPisc_ * _sDPisc_ +(1.0 - _aDSatPisc_) * _tDEnvPisc_;
_tDMortPiscBot_ = _fDBone_ * _tDMortPisc_;
_tDMortPiscDet_ = _tDMortPisc_ - _tDMortPiscBot_;
_ukHarvPisc_ = _IF_ (_COS_(2.0*_Pi_ * _sTime_ / _DaysPerYear_) _GT_ 0.1) _THEN_ _kHarvPiscWin_ _ELSE_ _kHarvPiscSum_ _ENDIF_;
_tDHarvPisc_ = _ukHarvPisc_ * _sDPisc_;
_aPPisc_ = _cPDPisc_ * _sDPisc_;
_tPConsFiJvPisc_ = _rPDFiJv_ * _tDConsFiJvPisc_;
_tPConsFiAdPisc_ = _rPDFiAd_ * _tDConsFiAdPisc_;
_tPConsPisc_ = _tPConsFiJvPisc_ + _tPConsFiAdPisc_;
_rPDFoodPisc_ = _tPConsPisc_ / _tDConsPisc_;
_afPAssPisc_ = _MIN_(1.0,_cPDPisc_ / _rPDFoodPisc_ * _fDAssPisc_);
_tPAssPisc_ = _afPAssPisc_ * _tPConsPisc_;
_tPEgesPisc_ = _tPConsPisc_ - _tPAssPisc_;
_tPEgesPiscPO4_ = _fDissEgesPisc_ * _tPEgesPisc_;
_tPEgesPiscDet_ = _tPEgesPisc_ - _tPEgesPiscPO4_;
_tPExcrPisc_ = _cPDPisc_ * _tDRespPisc_;
_tPMortPisc_ = _cPDPisc_ * _tDMortPisc_;
_tPMortPiscBot_ = _fPBone_ * _tPMortPisc_;
_tPMortPiscPO4_ = _fDissMortPisc_ *(_tPMortPisc_ - _tPMortPiscBot_);
_tPMortPiscDet_ = _tPMortPisc_ - _tPMortPiscBot_ - _tPMortPiscPO4_;
_tPMigrPisc_ = _kMigrPisc_ *(_cPDPisc_ * _cDPiscIn_ - _aPPisc_);
_tPHarvPisc_ = _cPDPisc_ * _tDHarvPisc_;
_aNPisc_ = _cNDPisc_ * _sDPisc_;
_tNConsFiJvPisc_ = _rNDFiJv_ * _tDConsFiJvPisc_;
_tNConsFiAdPisc_ = _rNDFiAd_ * _tDConsFiAdPisc_;
_tNConsPisc_ = _tNConsFiJvPisc_ + _tNConsFiAdPisc_;
_rNDFoodPisc_ = _tNConsPisc_ / _tDConsPisc_;
_afNAssPisc_ = _MIN_(1.0,_cNDPisc_ / _rNDFoodPisc_ * _fDAssPisc_);
_tNAssPisc_ = _afNAssPisc_ * _tNConsPisc_;
_tNEgesPisc_ = _tNConsPisc_ - _tNAssPisc_;
_tNEgesPiscNH4_ = _fDissEgesPisc_ * _tNEgesPisc_;
_tNEgesPiscDet_ = _tNEgesPisc_ - _tNEgesPiscNH4_;
_tNExcrPisc_ = _cNDPisc_ * _tDRespPisc_;
_tNMortPisc_ = _cNDPisc_ * _tDMortPisc_;
_tNMortPiscBot_ = _fDBone_ * _tNMortPisc_;
_tNMortPiscNH4_ = _fDissMortPisc_ *(_tNMortPisc_ - _tNMortPiscBot_);
_tNMortPiscDet_ = _tNMortPisc_ - _tNMortPiscBot_ - _tNMortPiscNH4_;
_tNMigrPisc_ = _kMigrPisc_ *(_cNDPisc_ * _cDPiscIn_ - _aNPisc_);
_tNHarvPisc_ = _cNDPisc_ * _tDHarvPisc_;
_wDWebZoo_ = _wDAssZoo_ - _wDRespZoo_ - _wDMortZoo_ - _tDConsFiJv_ / _sDepthW_;
_wPWebZoo_ = _wPAssZoo_ - _wPExcrZoo_ - _wPMortZoo_ - _tPConsFiJv_ / _sDepthW_;
_wNWebZoo_ = _wNAssZoo_ - _wNExcrZoo_ - _wNMortZoo_ - _tNConsFiJv_ / _sDepthW_;
_tDWebBent_ = _tDMigrBent_ + _tDAssBent_ - _tDConsFiAd_ - _tDRespBent_ - _tDMortBent_;
_tPWebBent_ = _tPMigrBent_ + _tPAssBent_ - _tPConsFiAd_ - _tPExcrBent_ - _tPMortBent_;
_tNWebBent_ = _tNMigrBent_ + _tNAssBent_ - _tNConsFiAd_ - _tNExcrBent_ - _tNMortBent_;
_tDWebFiJv_ = _tDMigrFiJv_ + _tDReprFish_ - _tDAgeFish_ + _tDAssFiJv_ - _tDRespFiJv_ - _tDMortFiJv_ - _tDConsFiJvPisc_;
_tPWebFiJv_ = _tPMigrFiJv_ + _tPReprFish_ - _tPAgeFish_ + _tPAssFiJv_ - _tPExcrFiJv_ - _tPMortFiJv_ - _tPConsFiJvPisc_;
_tNWebFiJv_ = _tNMigrFiJv_ + _tNReprFish_ - _tNAgeFish_ + _tNAssFiJv_ - _tNExcrFiJv_ - _tNMortFiJv_ - _tNConsFiJvPisc_;
_tDWebFiAd_ = _tDMigrFiAd_ + _tDAssFiAd_ - _tDRespFiAd_ - _tDMortFiAd_ - _tDReprFish_ + _tDAgeFish_ - _tDConsFiAdPisc_ - _tDHarvFish_;
_tPWebFiAd_ = _tPMigrFiAd_ + _tPAssFiAd_ - _tPExcrFiAd_ - _tPMortFiAd_ - _tPReprFish_ + _tPAgeFish_ - _tPConsFiAdPisc_ - _tPHarvFish_;
_tNWebFiAd_ = _tNMigrFiAd_ + _tNAssFiAd_ - _tNExcrFiAd_ - _tNMortFiAd_ - _tNReprFish_ + _tNAgeFish_ - _tNConsFiAdPisc_ - _tNHarvFish_;
_tDWebPisc_ = _tDMigrPisc_ + _tDAssPisc_ - _tDRespPisc_ - _tDMortPisc_ - _tDHarvPisc_;
_wDWebDetW_ = _IF_ (_FALSE_ _EQ_ _InclWeb_) _THEN_ 0.0 _ELSE_ - _wDConsDetZoo_ + _wDEgesZoo_ + _wDMortZoo_ +(_tDEgesFiJv_ + _tDEgesFiAd_ + _tDMortFishDet_ + _tDEgesPisc_ + _tDMortPiscDet_) / _sDepthW_ _ENDIF_;
_wDWebDiatW_ = _IF_ (_FALSE_ _EQ_ _InclWeb_) _THEN_ 0.0 _ELSE_ - _wDConsDiatZoo_ _ENDIF_;
_wDWebGrenW_ = _IF_ (_FALSE_ _EQ_ _InclWeb_) _THEN_ 0.0 _ELSE_ - _wDConsGrenZoo_ _ENDIF_;
_wDWebBlueW_ = _IF_ (_FALSE_ _EQ_ _InclWeb_) _THEN_ 0.0 _ELSE_ - _wDConsBlueZoo_ _ENDIF_;
_tDWebDetS_ = _IF_ (_FALSE_ _EQ_ _InclWeb_) _THEN_ 0.0 _ELSE_ - _tDConsDetBent_ + _tDEgesBent_ + _tDMortBent_ _ENDIF_;
_tDWebDiatS_ = _IF_ (_FALSE_ _EQ_ _InclWeb_) _THEN_ 0.0 _ELSE_ - _tDConsDiatBent_ _ENDIF_;
_tDWebGrenS_ = _IF_ (_FALSE_ _EQ_ _InclWeb_) _THEN_ 0.0 _ELSE_ - _tDConsGrenBent_ _ENDIF_;
_tDWebBlueS_ = _IF_ (_FALSE_ _EQ_ _InclWeb_) _THEN_ 0.0 _ELSE_ - _tDConsBlueBent_ _ENDIF_;
_tDWebPhytS_ = _tDWebDiatS_ + _tDWebGrenS_ + _tDWebBlueS_;
_tDWebTotT_ = _IF_ (_FALSE_ _EQ_ _InclWeb_) _THEN_ 0.0 _ELSE_ - _wDRespZoo_ * _sDepthW_ + _tDMigrFiJv_ + _tDMigrFiAd_ + _tDMigrPisc_ + _tDMigrBent_ - _tDRespFiJv_ - _tDRespFiAd_ - _tDRespPisc_ - _tDRespBent_ - _tDMortFishBot_ - _tDMortPiscBot_ - _tDHarvFish_ - _tDHarvPisc_ _ENDIF_;
_wPWebPO4W_ = _IF_ (_FALSE_ _EQ_ _InclWeb_) _THEN_ 0.0 _ELSE_ _wPExcrZoo_ + _wPEgesZooPO4_ + _wPMortZooPO4_ +(_tPExcrFiJv_ + _tPExcrFiAd_ + _tPEgesFishPO4_ + _tPMortFishPO4_ + _tPExcrPisc_ + _tPEgesPiscPO4_ + _tPMortPiscPO4_) / _sDepthW_ _ENDIF_;
_wPWebDetW_ = _IF_ (_FALSE_ _EQ_ _InclWeb_) _THEN_ 0.0 _ELSE_ - _wPConsDetZoo_ + _wPEgesZooDet_ + _wPMortZooDet_ +(_tPEgesFishDet_ + _tPMortFishDet_ + _tPEgesPiscDet_ + _tPMortPiscDet_) / _sDepthW_ _ENDIF_;
_wPWebDiatW_ = _IF_ (_FALSE_ _EQ_ _InclWeb_) _THEN_ 0.0 _ELSE_ - _wPConsDiatZoo_ _ENDIF_;
_wPWebGrenW_ = _IF_ (_FALSE_ _EQ_ _InclWeb_) _THEN_ 0.0 _ELSE_ - _wPConsGrenZoo_ _ENDIF_;
_wPWebBlueW_ = _IF_ (_FALSE_ _EQ_ _InclWeb_) _THEN_ 0.0 _ELSE_ - _wPConsBlueZoo_ _ENDIF_;
_tPWebPO4S_ = _IF_ (_FALSE_ _EQ_ _InclWeb_) _THEN_ 0.0 _ELSE_ _tPExcrBent_ + _tPEgesBentPO4_ + _tPMortBentPO4_ _ENDIF_;
_tPWebDetS_ = _IF_ (_FALSE_ _EQ_ _InclWeb_) _THEN_ 0.0 _ELSE_ - _tPConsDetBent_ + _tPEgesBentDet_ + _tPMortBentDet_ _ENDIF_;
_tPWebDiatS_ = _IF_ (_FALSE_ _EQ_ _InclWeb_) _THEN_ 0.0 _ELSE_ - _tPConsDiatBent_ _ENDIF_;
_tPWebGrenS_ = _IF_ (_FALSE_ _EQ_ _InclWeb_) _THEN_ 0.0 _ELSE_ - _tPConsGrenBent_ _ENDIF_;
_tPWebBlueS_ = _IF_ (_FALSE_ _EQ_ _InclWeb_) _THEN_ 0.0 _ELSE_ - _tPConsBlueBent_ _ENDIF_;
_tPWebPhytS_ = _tPWebDiatS_ + _tPWebGrenS_ + _tPWebBlueS_;
_tPWebTotT_ = _IF_ (_FALSE_ _EQ_ _InclWeb_) _THEN_ 0.0 _ELSE_ _tPMigrFiJv_ + _tPMigrFiAd_ + _tPMigrPisc_ + _tPMigrBent_ - _tPMortFishBot_ - _tPMortPiscBot_ - _tPHarvFish_ - _tPHarvPisc_ _ENDIF_;
_wNWebNH4W_ = _IF_ (_FALSE_ _EQ_ _InclWeb_) _THEN_ 0.0 _ELSE_ _wNExcrZoo_ + _wNEgesZooNH4_ + _wNMortZooNH4_ +(_tNExcrFiJv_ + _tNExcrFiAd_ + _tNEgesFishNH4_ + _tNMortFishNH4_ + _tNExcrPisc_ + _tNEgesPiscNH4_ + _tNMortPiscNH4_) / _sDepthW_ _ENDIF_;
_wNWebNO3W_ = _IF_ (_FALSE_ _EQ_ _InclWeb_) _THEN_ 0.0 _ELSE_ 0.0 _ENDIF_;
_wNWebDetW_ = _IF_ (_FALSE_ _EQ_ _InclWeb_) _THEN_ 0.0 _ELSE_ - _wNConsDetZoo_ + _wNEgesZooDet_ + _wNMortZooDet_ +(_tNEgesFishDet_ + _tNMortFishDet_ + _tNEgesPiscDet_ + _tNMortPiscDet_) / _sDepthW_ _ENDIF_;
_wNWebDiatW_ = _IF_ (_FALSE_ _EQ_ _InclWeb_) _THEN_ 0.0 _ELSE_ - _wNConsDiatZoo_ _ENDIF_;
_wNWebGrenW_ = _IF_ (_FALSE_ _EQ_ _InclWeb_) _THEN_ 0.0 _ELSE_ - _wNConsGrenZoo_ _ENDIF_;
_wNWebBlueW_ = _IF_ (_FALSE_ _EQ_ _InclWeb_) _THEN_ 0.0 _ELSE_ - _wNConsBlueZoo_ _ENDIF_;
_tNWebNH4S_ = _IF_ (_FALSE_ _EQ_ _InclWeb_) _THEN_ 0.0 _ELSE_ _tNExcrBent_ + _tNEgesBentNH4_ + _tNMortBentNH4_ _ENDIF_;
_tNWebNO3S_ = _IF_ (_FALSE_ _EQ_ _InclWeb_) _THEN_ 0.0 _ELSE_ 0.0 _ENDIF_;
_tNWebDetS_ = _IF_ (_FALSE_ _EQ_ _InclWeb_) _THEN_ 0.0 _ELSE_ - _tNConsDetBent_ + _tNEgesBentDet_ + _tNMortBentDet_ _ENDIF_;
_tNWebDiatS_ = _IF_ (_FALSE_ _EQ_ _InclWeb_) _THEN_ 0.0 _ELSE_ - _tNConsDiatBent_ _ENDIF_;
_tNWebGrenS_ = _IF_ (_FALSE_ _EQ_ _InclWeb_) _THEN_ 0.0 _ELSE_ - _tNConsGrenBent_ _ENDIF_;
_tNWebBlueS_ = _IF_ (_FALSE_ _EQ_ _InclWeb_) _THEN_ 0.0 _ELSE_ - _tNConsBlueBent_ _ENDIF_;
_tNWebPhytS_ = _tNWebDiatS_ + _tNWebGrenS_ + _tNWebBlueS_;
_tNWebTotT_ = _IF_ (_FALSE_ _EQ_ _InclWeb_) _THEN_ 0.0 _ELSE_ _tNMigrFiJv_ + _tNMigrFiAd_ + _tNMigrPisc_ + _tNMigrBent_ - _tNMortFishBot_ - _tNMortPiscBot_ - _tNHarvFish_ - _tNHarvPisc_ _ENDIF_;
_wSiWebSiO2W_ = 0.0;
_wSiWebDetW_ = _IF_ (_FALSE_ _EQ_ _InclWeb_) _THEN_ 0.0 _ELSE_ _wSiConsDiatZoo_ _ENDIF_;
_tSiWebDetS_ = _IF_ (_FALSE_ _EQ_ _InclWeb_) _THEN_ 0.0 _ELSE_ _tSiConsDiatBent_ _ENDIF_;
_tSiWebTotT_ = _IF_ (_FALSE_ _EQ_ _InclWeb_) _THEN_ 0.0 _ELSE_ 0.0 _ENDIF_;
_aPrefAve_ = (_cPrefDiat_ * _sDDiatW_ + _cPrefGren_ * _sDGrenW_ + _cPrefBlue_ * _sDBlueW_ + _cPrefDet_ * _sDDetW_) / _oDOMW_;
_wDConsZoo2_ = _aFilt_ * _aPrefAve_ * _oDOMW_ * _sDZoo_;
_aDConsZooSp_ = _wDConsZoo_ / _sDZoo_;
_aDAssZooSp_ = _wDAssZoo_ / _sDZoo_;
_aDGrazSp_ = _wDConsZoo_ / _oDOMW_;
_aPConsZooSp_ = _wPConsZoo_ / _sPZoo_;
_aPGrazSp_ = _wPConsZoo_ / _oPOMW_;
_aNConsZooSp_ = _wNConsZoo_ / _sNZoo_;
_aNGrazSp_ = _wNConsZoo_ / _oNOMW_;
_afDShootPhra_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _sDShootPhra_ /(_sDRootPhra_ + _sDShootPhra_) _ELSE_ 0.0 _ENDIF_;
_rDSRPhra_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _sDShootPhra_/_sDRootPhra_ _ELSE_ 0.0 _ENDIF_;
_rPDShootPhra_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _sPShootPhra_/_sDShootPhra_ _ELSE_ 0.0 _ENDIF_;
_rNDShootPhra_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _sNShootPhra_/_sDShootPhra_ _ELSE_ 0.0 _ENDIF_;
_rPDRootPhra_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _sPRootPhra_/_sDRootPhra_ _ELSE_ 0.0 _ENDIF_;
_rNDRootPhra_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _sNRootPhra_/_sDRootPhra_ _ELSE_ 0.0 _ENDIF_;
_aLengShootPhra_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _sDShootPhra_ / _cDStemPhra_ / _cDensStemPhra_ _ELSE_ 0.0 _ENDIF_;
_bDayInitPhra_ = _IF_ (_Day_ _LT_ 1.0 _OR_ _sTime_ _LT_ _BeginTime_ + 1.0) _THEN_ 367 _ELSEIF_ (_uTm_ _GE_ _cTmInitPhra_ _AND_ _bDayInitPhra_ _GT_ 366) _THEN_ _Day_ _ELSE_ _bDayInitPhra_ _ENDIF_;
_aDAllPhra_ = _IF_ (_FALSE_ _EQ_ _InclMarsh_ _OR_ _fMarsh_ _LE_ _NearZero_) _THEN_ 0.0 _ELSEIF_ (_Day_ _LT_ _bDayInitPhra_) _THEN_ 0.0 _ELSEIF_ (_Day_ _LE_ _bDayInitPhra_ + 1.0 / _kDAllPhra_) _THEN_ _fDAllPhra_ * _sDRootPhra_ _ELSE_ 0.0 _ENDIF_;
_tDAllPhra_ = _IF_ (_FALSE_ _EQ_ _InclSeason_) _THEN_ 0.0 _ELSEIF_ (_FALSE_ _EQ_ _InclMarsh_ _OR_ _fMarsh_ _LE_ _NearZero_) _THEN_ 0.0 _ELSEIF_ (_Day_ _LT_ _bDayInitPhra_) _THEN_ 0.0 _ELSEIF_ (_Day_ _LE_ _bDayInitPhra_ + 1.0 / _kDAllPhra_) _THEN_ _kDAllPhra_ * _aDAllPhra_ _ELSE_ 0.0 _ENDIF_;
_tNTransPhra_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _rNDRootPhra_ * _tDAllPhra_ _ELSE_ 0.0 _ENDIF_;
_tPTransPhra_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _rPDRootPhra_ * _tDAllPhra_ _ELSE_ 0.0 _ENDIF_;
_aVNUptPhraMaxCr_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _MAX_(0.0,_cVNUptPhraMax_ * _POW_(_cQ10ProdPhra_ , (0.1 *(_uTm_ - _cTmRef_))) *(_cNDPhraMax_ - _rNDRootPhra_) /(_cNDPhraMax_ - _cNDPhraMin_)) _ELSE_ 0.0 _ENDIF_;
_ahNUptPhraS_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _aVNUptPhraMaxCr_ / _cAffNUptPhra_ _ELSE_ 0.0 _ENDIF_;
_aVNUptPhraS_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _aVNUptPhraMaxCr_ * _oNDissSM_ /(_ahNUptPhraS_ + _oNDissSM_) _ELSE_ 0.0 _ENDIF_;
_tNUptPhraS_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _aVNUptPhraS_ * _sDRootPhra_ _ELSE_ 0.0 _ENDIF_;
_tNUptNH4PhraS_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _sNH4SM_ / _aNDissSM_ * _tNUptPhraS_ _ELSE_ 0.0 _ENDIF_;
_tNUptNO3PhraS_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _tNUptPhraS_ - _tNUptNH4PhraS_ _ELSE_ 0.0 _ENDIF_;
_tNUptShootPhra_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _afDShootPhra_ * _tNUptPhraS_ _ELSE_ 0.0 _ENDIF_;
_tNUptRootPhra_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _tNUptPhraS_ - _tNUptShootPhra_ _ELSE_ 0.0 _ENDIF_;
_aVPUptPhraMaxCr_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _MAX_(0.0,_cVPUptPhraMax_ * _POW_(_cQ10ProdPhra_ , (0.1 *(_uTm_ - _cTmRef_))) *(_cPDPhraMax_ - _rPDRootPhra_) /(_cPDPhraMax_ - _cPDPhraMin_)) _ELSE_ 0.0 _ENDIF_;
_ahPUptPhraS_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _aVPUptPhraMaxCr_ / _cAffPUptPhra_ _ELSE_ 0.0 _ENDIF_;
_aVPUptPhraS_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _aVPUptPhraMaxCr_ * _oPO4SM_ /(_ahPUptPhraS_ + _oPO4SM_) _ELSE_ 0.0 _ENDIF_;
_tPUptPhraS_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _aVPUptPhraS_ * _sDRootPhra_ _ELSE_ 0.0 _ENDIF_;
_tPUptShootPhra_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _afDShootPhra_ * _tPUptPhraS_ _ELSE_ 0.0 _ENDIF_;
_tPUptRootPhra_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _tPUptPhraS_ - _tPUptShootPhra_ _ELSE_ 0.0 _ENDIF_;
_uFunTmProdPhra_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _POW_(_cQ10ProdPhra_ , (0.1 *(_uTm_ - _cTmRef_))) _ELSE_ 0.0 _ENDIF_;
_ukDRespTmPhra_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _kDRespPhra_ * _POW_(_cQ10RespPhra_ , (0.1 *(_uTm_ - _cTmRef_))) _ELSE_ 0.0 _ENDIF_;
_aMuPhotPhra_ = _IF_ (_FALSE_ _EQ_ _InclMarsh_ _OR_ _fMarsh_ _LE_ _NearZero_) _THEN_ 0.0 _ELSEIF_ (_aLengShootPhra_ _GE_ _sDepthWM_) _THEN_ _cMuPhraMax_ * _uFunTmProdPhra_ * _ufDay_ _ELSE_ 0.0 _ENDIF_;
_aNLimProdPhra_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ (1.0 - _cNDPhraMin_ / _rNDRootPhra_) * _cNDPhraMax_ /(_cNDPhraMax_ - _cNDPhraMin_) _ELSE_ 0.0 _ENDIF_;
_aPLimProdPhra_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ (1.0 - _cPDPhraMin_ / _rPDRootPhra_) * _cPDPhraMax_ /(_cPDPhraMax_ - _cPDPhraMin_) _ELSE_ 0.0 _ENDIF_;
_aNutLimPhra_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _MIN_(_aNLimProdPhra_,_aPLimProdPhra_) _ELSE_ 0.0 _ENDIF_;
_aMuPhra_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _aMuPhotPhra_ * _aNutLimPhra_ _ELSE_ 0.0 _ENDIF_;
_akDIncrPhra_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _aMuPhotPhra_ - _ukDRespTmPhra_ - _kDMortShootPhra_ _ELSE_ 0.0 _ENDIF_;
_tDDensPhra_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _MAX_(0.0,_akDIncrPhra_ / _cDShootPhraMax_ * _sDShootPhra_ * _sDShootPhra_) _ELSE_ 0.0 _ENDIF_;
_tDDensProdPhra_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _aMuPhra_ / _cMuPhraMax_ * _tDDensPhra_ _ELSE_ 0.0 _ENDIF_;
_tDProdPhra_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _aMuPhra_ * _sDShootPhra_ - _tDDensProdPhra_ _ELSE_ 0.0 _ENDIF_;
_tDProdShootPhra_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _afDShootPhra_ * _tDProdPhra_ _ELSE_ 0.0 _ENDIF_;
_tDProdRootPhra_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _tDProdPhra_ - _tDProdShootPhra_ _ELSE_ 0.0 _ENDIF_;
_tDRespShootPhra_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _ukDRespTmPhra_ * _sDShootPhra_ _ELSE_ 0.0 _ENDIF_;
_tDRespRootPhra_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _ukDRespTmPhra_ * _sDRootPhra_ _ELSE_ 0.0 _ENDIF_;
_tO2RespRootPhra_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _molO2molC_ * _cCPerDW_ * _tDRespRootPhra_ * _afOxySedM_ _ELSE_ 0.0 _ENDIF_;
_tO2FlowPhra_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _tO2RespRootPhra_ _ELSE_ 0.0 _ENDIF_;
_bDayRealPhra_ = _IF_ (_Day_ _LT_ 180.0) _THEN_ 367 _ELSEIF_ (_ufDay_ _LE_ _fDayWin_ _AND_ _bDayRealPhra_ _GT_ 366) _THEN_ _Day_ _ELSE_ _bDayRealPhra_ _ENDIF_;
_aDRealPhra_ = _IF_ (_FALSE_ _EQ_ _InclMarsh_ _OR_ _fMarsh_ _LE_ _NearZero_) _THEN_ 0.0 _ELSEIF_ (_Day_ _LT_ _bDayRealPhra_) _THEN_ 0.0 _ELSEIF_ (_Day_ _LE_ _bDayRealPhra_ + 1.0 / _kDRealPhra_) _THEN_ _fDRealPhra_ * _sDShootPhra_ _ELSE_ 0.0 _ENDIF_;
_tDRealPhra_ = _IF_ (_FALSE_ _EQ_ _InclSeason_) _THEN_ 0.0 _ELSEIF_ (_FALSE_ _EQ_ _InclMarsh_ _OR_ _fMarsh_ _LE_ _NearZero_) _THEN_ 0.0 _ELSEIF_ (_Day_ _LT_ _bDayRealPhra_) _THEN_ 0.0 _ELSEIF_ (_Day_ _LE_ _bDayRealPhra_ + 1.0 / _kDRealPhra_) _THEN_ _kDRealPhra_ * _aDRealPhra_ _ELSE_ 0.0 _ENDIF_;
_tNRetrPhra_ = _IF_  (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _rNDShootPhra_ * _tDRealPhra_ _ELSE_ 0.0 _ENDIF_;
_tPRetrPhra_ = _IF_  (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _rPDShootPhra_ * _tDRealPhra_ _ELSE_ 0.0 _ENDIF_;
_tDMortShootPhra_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _kDMortShootPhra_ * _sDShootPhra_ _ELSE_ 0.0 _ENDIF_;
_tNMortShootPhra_ = _IF_  (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _rNDShootPhra_ * _tDMortShootPhra_ _ELSE_ 0.0 _ENDIF_;
_tPMortShootPhra_ = _IF_  (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _rPDShootPhra_ * _tDMortShootPhra_ _ELSE_ 0.0 _ENDIF_;
_tDMortRootPhra_ = _IF_  (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _kDMortRootPhra_ * _sDRootPhra_ _ELSE_ 0.0 _ENDIF_;
_tNMortRootPhra_ = _IF_  (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _rNDRootPhra_ * _tDMortRootPhra_ _ELSE_ 0.0 _ENDIF_;
_tPMortRootPhra_ = _IF_  (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _rPDRootPhra_ * _tDMortRootPhra_ _ELSE_ 0.0 _ENDIF_;
_tDManShootPhra_ = _IF_ (_FALSE_ _EQ_ _InclMarsh_ _OR_ _fMarsh_ _GT_ _NearZero_) _THEN_ 0.0 _ELSEIF_ ((_Day_ _GE_ _cDayManPhra_) _AND_ (_Day_ _LT_ _cDayManPhra_ + 1.0)) _THEN_ _fManPhra_ * _sDShootPhra_ _ELSE_ 0.0 _ENDIF_;
_tNManShootPhra_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _tDManShootPhra_ * _rNDShootPhra_ _ELSE_ 0.0 _ENDIF_;
_tPManShootPhra_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _tDManShootPhra_ * _rPDShootPhra_ _ELSE_ 0.0 _ENDIF_;
_tDIMSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _tDSetIMM_ _ELSE_ 0.0 _ENDIF_;
_tDHumSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _fRefrDetS_ * _tDMinDetSM_ - _tDMinHumSM_ _ELSE_ 0.0 _ENDIF_;
_tDDetSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _tDSetDetM_ - _tDMinDetSM_ + _tDSetPhytM_ + _tDMortRootPhra_ _ELSE_ 0.0 _ENDIF_;
_vDeltaSM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ (_tDIMSM_ / _cRhoIM_ +(_tDHumSM_ + _tDDetSM_) / _cRhoOM_)/(1.0 - _bPorS_) _ELSE_ 0.0 _ENDIF_;
_tDBurIMM_ = _IF_ (_FALSE_ _EQ_ _InclMarsh_ _OR_ _fMarsh_ _LE_ _NearZero_) _THEN_ 0.0 _ELSEIF_ (_vDeltaSM_ _GE_ 0.0) _THEN_ ((_tDHumSM_ + _tDDetSM_) +(_cRhoOM_ / _cRhoIM_) * _tDIMSM_) / ((_sDHumSM_ + _sDDetSM_) / _sDIMSM_ + _cRhoOM_ / _cRhoIM_) _ELSE_ ((_tDHumSM_ + _tDDetSM_) +(_cRhoOM_ / _cRhoIM_) * _tDIMSM_) / (_fDOrgSoil_ /(1.0 - _fDOrgSoil_) + _cRhoOM_ / _cRhoIM_) _ENDIF_;
_tDBurOMM_ = _IF_ (_FALSE_ _EQ_ _InclMarsh_ _OR_ _fMarsh_ _LE_ _NearZero_) _THEN_ 0.0 _ELSEIF_ (_vDeltaSM_ _GE_ 0.0) _THEN_ (_sDHumSM_ + _sDDetSM_) / _sDIMSM_ * _tDBurIMM_ _ELSE_ _fDOrgSoil_ /(1.0 - _fDOrgSoil_) * _tDBurIMM_ _ENDIF_;
_tDBurDetM_ = _IF_ (_FALSE_ _EQ_ _InclMarsh_ _OR_ _fMarsh_ _LE_ _NearZero_) _THEN_ 0.0 _ELSEIF_ (_vDeltaSM_ _GE_ 0.0) _THEN_ _sDDetSM_ /(_sDHumSM_ + _sDDetSM_) * _tDBurOMM_ _ELSE_ 0.0 _ENDIF_;
_tDBurHumM_ = _IF_ (_FALSE_ _EQ_ _InclMarsh_ _OR_ _fMarsh_ _LE_ _NearZero_) _THEN_ 0.0 _ELSEIF_ (_vDeltaSM_ _GE_ 0.0) _THEN_ _tDBurOMM_ - _tDBurDetM_ _ELSE_ _tDBurOMM_ _ENDIF_;
_tDBurTotM_ = _IF_ (_FALSE_ _EQ_ _InclMarsh_ _OR_ _fMarsh_ _LE_ _NearZero_) _THEN_ 0.0 _ELSEIF_ (_vDeltaSM_ _GE_ 0.0) _THEN_ _tDBurIMM_ + _tDBurOMM_ _ELSE_ _tDBurIMM_ + _tDBurOMM_ _ENDIF_;
_tPBurHumM_ = _IF_ (_FALSE_ _EQ_ _InclMarsh_ _OR_ _fMarsh_ _LE_ _NearZero_) _THEN_ 0.0 _ELSEIF_ (_vDeltaSM_ _GE_ 0.0) _THEN_ _rPDHumSM_ * _tDBurHumM_ _ELSE_ _cPDSoilOM_ * _tDBurHumM_ _ENDIF_;
_tPBurDetM_ = _IF_ (_FALSE_ _EQ_ _InclMarsh_ _OR_ _fMarsh_ _LE_ _NearZero_) _THEN_ 0.0 _ELSEIF_ (_vDeltaSM_ _GE_ 0.0) _THEN_ _rPDDetSM_ * _tDBurDetM_ _ELSE_ 0.0 _ENDIF_;
_tPBurAIMM_ = _IF_ (_FALSE_ _EQ_ _InclMarsh_ _OR_ _fMarsh_ _LE_ _NearZero_) _THEN_ 0.0 _ELSEIF_ (_vDeltaSM_ _GE_ 0.0) _THEN_ _sPAIMSM_ / _sDIMSM_ * _tDBurIMM_ _ELSE_ 0.0 _ENDIF_;
_tPBurPO4M_ = _IF_ (_FALSE_ _EQ_ _InclMarsh_ _OR_ _fMarsh_ _LE_ _NearZero_) _THEN_ 0.0 _ELSEIF_ (_vDeltaSM_ _GE_ 0.0) _THEN_ _sPO4SM_ *(_vDeltaSM_ / _cDepthSM_) _ELSE_ _cPO4Ground_ *(_bPorSM_ * _vDeltaSM_) _ENDIF_;
_tPBurTotM_ = _IF_ (_FALSE_ _EQ_ _InclMarsh_ _OR_ _fMarsh_ _LE_ _NearZero_) _THEN_ 0.0 _ELSEIF_ (_vDeltaSM_ _GE_ 0.0) _THEN_ _tPBurDetM_ + _tPBurHumM_ + _tPBurAIMM_ + _tPBurPO4M_ _ELSE_ _tPBurHumM_ + _tPBurAIMM_ + _tPBurPO4M_ _ENDIF_;
_tNBurHumM_ = _IF_ (_FALSE_ _EQ_ _InclMarsh_ _OR_ _fMarsh_ _LE_ _NearZero_) _THEN_ 0.0 _ELSEIF_ (_vDeltaSM_ _GE_ 0.0) _THEN_ _rNDHumSM_ * _tDBurHumM_ _ELSE_ _cNDSoilOM_ * _tDBurHumM_ _ENDIF_;
_tNBurDetM_ = _IF_ (_FALSE_ _EQ_ _InclMarsh_ _OR_ _fMarsh_ _LE_ _NearZero_) _THEN_ 0.0 _ELSEIF_ (_vDeltaSM_ _GE_ 0.0) _THEN_ _rNDDetSM_ * _tDBurDetM_ _ELSE_ 0.0 _ENDIF_;
_tNBurNH4M_ = _IF_ (_FALSE_ _EQ_ _InclMarsh_ _OR_ _fMarsh_ _LE_ _NearZero_) _THEN_ 0.0 _ELSEIF_ (_vDeltaSM_ _GE_ 0.0) _THEN_ _sNH4SM_ *(_vDeltaSM_ / _cDepthSM_) _ELSE_ _cNH4Ground_ *(_bPorSM_ * _vDeltaSM_) _ENDIF_;
_tNBurNO3M_ = _IF_ (_FALSE_ _EQ_ _InclMarsh_ _OR_ _fMarsh_ _LE_ _NearZero_) _THEN_ 0.0 _ELSEIF_ (_vDeltaSM_ _GE_ 0.0) _THEN_ _sNO3SM_ *(_vDeltaSM_ / _cDepthSM_) _ELSE_ _cNO3Ground_ *(_bPorSM_ * _vDeltaSM_) _ENDIF_;
_tNBurTotM_ = _IF_ (_FALSE_ _EQ_ _InclMarsh_ _OR_ _fMarsh_ _LE_ _NearZero_) _THEN_ 0.0 _ELSEIF_ (_vDeltaSM_ _GE_ 0.0) _THEN_ _tNBurDetM_ + _tNBurHumM_ + _tNBurNH4M_ + _tNBurNO3M_ _ELSE_ _tNBurHumM_ + _tNBurNH4M_ + _tNBurNO3M_ _ENDIF_;
_tSiBurDetM_ = _IF_ (_FALSE_ _EQ_ _InclMarsh_ _OR_ _fMarsh_ _LE_ _NearZero_) _THEN_ 0.0 _ELSEIF_ (_vDeltaSM_ _GE_ 0.0) _THEN_ _rSiDDetSM_ * _tDBurDetM_ _ELSE_ 0.0 _ENDIF_;
_tSiBurTotM_ = _IF_ (_FALSE_ _EQ_ _InclMarsh_ _OR_ _fMarsh_ _LE_ _NearZero_) _THEN_ 0.0 _ELSEIF_ (_vDeltaSM_ _GE_ 0.0) _THEN_ _tSiBurDetM_ _ELSE_ 0.0 _ENDIF_;
_vDeltaWM_ = _IF_ (_FALSE_ _EQ_ _InclMarsh_ _OR_ _fMarsh_ _LE_ _NearZero_) _THEN_ 0.0 _ELSEIF_ (_ConstDepth_ _EQ_ _TRUE_) _THEN_ 0.0 _ELSE_ - _vDeltaSM_ _ENDIF_;
_aRelDeltaWM_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ _vDeltaWM_ / _sDepthWM_ _ELSE_ 0.0 _ENDIF_;
_tDSetTot_ = _tDSetIM_ + _tDSetDet_ + _tDSetPhyt_;
_tPSetTot_ = _tPSetAIM_ + _tPSetDet_ + _tPSetPhyt_;
_tNSetTot_ = _tNSetDet_ + _tNSetPhyt_;
_tDResusTot_ = _tDResusDead_ + _tDResusPhytTot_;
_tPResusTot_ = _tPResusDet_ + _tPResusAIM_ + _tPResusPhyt_ + _tPResusPO4_;
_tNResusTot_ = _tNResusDet_ + _tNResusNH4_ + _tNResusNO3_ + _tNResusPhyt_;
_bTimeDred_ = _IF_ (_sTime_ _GE_ _cDredStart_ * _DaysPerYear_) _THEN_ (_FLOOR_(_TimeYears_/_cDredInterval_) * _cDredInterval_) * _DaysPerYear_ _ELSE_ -9999.999 _ENDIF_;
_aDepthStart_ = _IF_ (_sTime_ _EQ_ _bTimeDred_) _THEN_ _sDepthW_ _ELSE_ _aDepthStart_ _ENDIF_;
_akDredDepth_ = _IF_ ((_sTime_ _GE_ _bTimeDred_) _AND_ (_sTime_ _LT_ _bTimeDred_ + _cLengDred_) _AND_ (_aDepthStart_ _LE_ _cDepthRef_ - _cDepthS_)) _THEN_ (_LN_(_cDepthRef_ / _aDepthStart_)) / _cLengDred_ _ELSE_ 0.0 _ENDIF_;
_akDred_ = _IF_ ((_sTime_ _GE_ _bTimeDred_) _AND_ (_sTime_ _LT_ _bTimeDred_ + _cLengDred_) _AND_ (_aDepthStart_ _LE_ _cDepthRef_ - _cDepthS_)) _THEN_ (- _LN_(1.0 - _fEffDred_)) / _cLengDred_ _ELSE_ 0.0 _ENDIF_;
_akDredBent_ = _IF_ ((_sTime_ _GE_ _bTimeDred_) _AND_ (_sTime_ _LT_ _bTimeDred_ + _cLengDred_) _AND_ (_aDepthStart_ _LE_ _cDepthRef_ - _cDepthS_)) _THEN_ (- _LN_(1.0 - _fEffDredBent_)) / _cLengDred_ _ELSE_ 0.0 _ENDIF_;
_vDredDepthW_ = _akDredDepth_ * _sDepthW_;
_tDDredDetS_ = _akDred_ * _sDDetS_;
_tPDredDetS_ = _akDred_ * _sPDetS_;
_tNDredDetS_ = _akDred_ * _sNDetS_;
_tSiDredDetS_ = _akDred_ * _sSiDetS_;
_tPDredAIMS_ = _akDred_ * _sPAIMS_;
_bRhoSolidSoil_ = _fDOrgSoil_ * _cRhoOM_ +(1.0 - _fDOrgSoil_) * _cRhoIM_;
_tDDredNetSoil_ = -(_tDDredDetS_ / _cRhoOM_) * _bRhoSolidSoil_;
_tDDredNetIMS_ = (1.0 - _fDOrgSoil_) * _tDDredNetSoil_;
_tDDredNetHumS_ = _fDOrgSoil_ * _tDDredNetSoil_;
_tPDredNetHumS_ = _cPDSoilOM_ * _tDDredNetHumS_;
_tNDredNetHumS_ = _cNDSoilOM_ * _tDDredNetHumS_;
_tDDredDiatS_ = _akDred_ * _sDDiatS_;
_tPDredDiatS_ = _akDred_ * _sPDiatS_;
_tNDredDiatS_ = _akDred_ * _sNDiatS_;
_tDDredGrenS_ = _akDred_ * _sDGrenS_;
_tPDredGrenS_ = _akDred_ * _sPGrenS_;
_tNDredGrenS_ = _akDred_ * _sNGrenS_;
_tDDredBlueS_ = _akDred_ * _sDBlueS_;
_tPDredBlueS_ = _akDred_ * _sPBlueS_;
_tNDredBlueS_ = _akDred_ * _sNBlueS_;
_tDDredPhytS_ = _tDDredDiatS_+_tDDredGrenS_+_tDDredBlueS_;
_tPDredPhytS_ = _tPDredDiatS_+_tPDredGrenS_+_tPDredBlueS_;
_tNDredPhytS_ = _tNDredDiatS_+_tNDredGrenS_+_tNDredBlueS_;
_tDDredBent_ = _IF_ (_InclWeb_ _EQ_ _TRUE_) _THEN_ _akDredBent_ * _sDBent_ _ELSE_ 0.0 _ENDIF_;
_tPDredBent_ = _IF_ (_InclWeb_ _EQ_ _TRUE_) _THEN_ _akDredBent_ * _sPBent_ _ELSE_ 0.0 _ENDIF_;
_tNDredBent_ = _IF_ (_InclWeb_ _EQ_ _TRUE_) _THEN_ _akDredBent_ * _sNBent_ _ELSE_ 0.0 _ENDIF_;
_tDDredVeg_ = _akDred_ * _sDVeg_;
_tPDredVeg_ = _akDred_ * _sPVeg_;
_tNDredVeg_ = _akDred_ * _sNVeg_;
_tDDredNetTot_ = _tDDredDetS_ - _tDDredNetSoil_ + _tDDredPhytS_ + _tDDredBent_ + _tDDredVeg_;
_tPDredNetTot_ = _tPDredDetS_ - _tPDredNetHumS_ + _tPDredAIMS_ + _tPDredPhytS_ + _tPDredBent_ + _tPDredVeg_;
_tNDredNetTot_ = _tNDredDetS_ - _tNDredNetHumS_ + _tNDredPhytS_ + _tNDredBent_ + _tNDredVeg_;
_tSiDredTot_ = _tSiDredDetS_ + _cSiDDiat_ * _tDDredDiatS_;
_tDIMS_ = _tDAbioIMS_;
_tDHumS_ = _tDAbioHumS_;
_tDDetS_ = _tDAbioDetS_ + _tDPrimDetS_ + _tDWebDetS_ + _tDBedDetS_;
_vDeltaS_ = (_tDIMS_ / _cRhoIM_ +(_tDHumS_ + _tDDetS_) / _cRhoOM_)/(1.0 - _bPorS_);
_tDBurIM_ = _IF_ (_vDeltaS_ _GE_ 0.0) _THEN_ ((_tDHumS_ + _tDDetS_) +(_cRhoOM_ / _cRhoIM_) * _tDIMS_) / ((_sDHumS_ + _sDDetS_) / _sDIMS_ + _cRhoOM_ / _cRhoIM_) _ELSE_ ((_tDHumS_ + _tDDetS_) +(_cRhoOM_ / _cRhoIM_) * _tDIMS_) / (_fDOrgSoil_ /(1.0 - _fDOrgSoil_) + _cRhoOM_ / _cRhoIM_) _ENDIF_;
_tDBurOM_ = _IF_ (_vDeltaS_ _GE_ 0.0) _THEN_ (_sDHumS_ + _sDDetS_) / _sDIMS_ * _tDBurIM_ _ELSE_ _fDOrgSoil_ /(1.0 - _fDOrgSoil_) * _tDBurIM_ _ENDIF_;
_tDBurDet_ = _IF_ (_vDeltaS_ _GE_ 0.0) _THEN_ _sDDetS_ /(_sDHumS_ + _sDDetS_) * _tDBurOM_ _ELSE_ 0.0 _ENDIF_;
_tDBurHum_ = _IF_ (_vDeltaS_ _GE_ 0.0) _THEN_ _tDBurOM_ - _tDBurDet_ _ELSE_ _tDBurOM_ _ENDIF_;
_tDBurTot_ = _IF_ (_vDeltaS_ _GE_ 0.0) _THEN_ _tDBurIM_ + _tDBurOM_ _ELSE_ _tDBurIM_ + _tDBurOM_ _ENDIF_;
_tPBurHum_ = _IF_ (_vDeltaS_ _GE_ 0.0) _THEN_ _rPDHumS_ * _tDBurHum_ _ELSE_ _cPDSoilOM_ * _tDBurHum_ _ENDIF_;
_tPBurDet_ = _IF_ (_vDeltaS_ _GE_ 0.0) _THEN_ _rPDDetS_ * _tDBurDet_ _ELSE_ 0.0 _ENDIF_;
_tPBurAIM_ = _IF_ (_vDeltaS_ _GE_ 0.0) _THEN_ _sPAIMS_ / _sDIMS_ * _tDBurIM_ _ELSE_ 0.0 _ENDIF_;
_tPBurPO4_ = _IF_ (_vDeltaS_ _GE_ 0.0) _THEN_ _sPO4S_ *(_vDeltaS_ / _cDepthS_) _ELSE_ _cPO4Ground_ *(_bPorS_ * _vDeltaS_) _ENDIF_;
_tPBurTot_ = _IF_ (_vDeltaS_ _GE_ 0.0) _THEN_ _tPBurDet_ + _tPBurHum_ + _tPBurAIM_ + _tPBurPO4_ _ELSE_ _tPBurHum_ + _tPBurAIM_ + _tPBurPO4_ _ENDIF_;
_tNBurHum_ = _IF_ (_vDeltaS_ _GE_ 0.0) _THEN_ _rNDHumS_ * _tDBurHum_ _ELSE_ _cNDSoilOM_ * _tDBurHum_ _ENDIF_;
_tNBurDet_ = _IF_ (_vDeltaS_ _GE_ 0.0) _THEN_ _rNDDetS_ * _tDBurDet_ _ELSE_ 0.0 _ENDIF_;
_tNBurNH4_ = _IF_ (_vDeltaS_ _GE_ 0.0) _THEN_ _sNH4S_ *(_vDeltaS_ / _cDepthS_) _ELSE_ _cNH4Ground_ *(_bPorS_ * _vDeltaS_) _ENDIF_;
_tNBurNO3_ = _IF_ (_vDeltaS_ _GE_ 0.0) _THEN_ _sNO3S_ *(_vDeltaS_ / _cDepthS_) _ELSE_ _cNO3Ground_ *(_bPorS_ * _vDeltaS_) _ENDIF_;
_tNBurTot_ = _IF_ (_vDeltaS_ _GE_ 0.0) _THEN_ _tNBurDet_ + _tNBurHum_ + _tNBurNH4_ + _tNBurNO3_ _ELSE_ _tNBurHum_ + _tNBurNH4_ + _tNBurNO3_ _ENDIF_;
_tSiBurDet_ = _IF_ (_vDeltaS_ _GE_ 0.0) _THEN_ _rSiDDetS_ * _tDBurDet_ _ELSE_ 0.0 _ENDIF_;
_tSiBurTot_ = _IF_ (_vDeltaS_ _GE_ 0.0) _THEN_ _tSiBurDet_ _ELSE_ 0.0 _ENDIF_;
_vDeltaW_ = _IF_ (_ConstDepth_ _EQ_ _TRUE_) _THEN_ 0.0 _ELSE_ - _vDeltaS_ _ENDIF_;
_aRelDeltaW_ = (_vDeltaW_ + _vDredDepthW_) / _sDepthW_;
_tDMarsTotT_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ (- _tDBurTotM_ - _wDMinDetWM_ * _sDepthWM_ -(1.0 - _fRefrDetS_) * _tDMinDetSM_ - _tDMinHumSM_ + _tDProdPhra_ - _tDRespShootPhra_ - _tDRespRootPhra_ - _tDManShootPhra_) * _fMarsh_ _ELSE_ 0.0 _ENDIF_;
_tPMarsTotT_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ (- _tPInfPO4SM_ - _tPDifGroundPO4M_ - _tPBurTotM_ - _tPChemPO4M_ - _tPManShootPhra_) * _fMarsh_ _ELSE_ 0.0 _ENDIF_;
_tNMarsTotT_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ (- _tNInfNH4SM_ - _tNInfNO3SM_ - _tNDifGroundNO3M_ - _tNDifGroundNH4M_ - _tNBurTotM_ - _wNDenitWM_ * _sDepthWM_ - _tNDenitSM_ - _tNManShootPhra_) * _fMarsh_ _ELSE_ 0.0 _ENDIF_;
_tSiMarsTotT_ = _IF_ (_InclMarsh_ _EQ_ _TRUE_ _AND_ _fMarsh_ _GT_ _NearZero_) _THEN_ - _tSiBurDetM_ * _fMarsh_ _ELSE_ 0.0 _ENDIF_;
_aDTotT_ = (_sDIMW_+_sDDetW_+_sDDiatW_+_sDGrenW_+_sDBlueW_+_sDZoo_) * _sDepthW_ +_aDFish_+_sDPisc_+_aDVeg_ +_sDIMS_+_sDHumS_+_sDDetS_+_sDDiatS_+_sDGrenS_+_sDBlueS_+_sDBent_ + _aDTotM_;
_aNTotT_ = (_sNH4W_+_sNO3W_+_sNDetW_+_sNDiatW_+_sNGrenW_+_sNBlueW_ +_sNZoo_)*_sDepthW_ +_aNFish_+_aNPisc_+_aNVeg_ +_sNH4S_+_sNO3S_+_sNDetS_+_sNHumS_+_sNDiatS_+_sNGrenS_+_sNBlueS_ +_sNBent_ + _aNTotM_;
_aPTotT_ = (_sPO4W_+_sPDetW_+_sPDiatW_+_sPGrenW_+_sPBlueW_ +_sPZoo_+_sPAIMW_) * _sDepthW_ +_aPFish_+_aPPisc_+_aPVeg_ +_sPO4S_+_sPDetS_+_sPHumS_+_sPDiatS_+_sPGrenS_+_sPBlueS_ +_sPAIMS_+_sPBent_ + _aPTotM_;
_aSiTotT_ = (_sSiO2W_ + _sSiDetW_ + _cSiDDiat_*_sDDiatW_) *_sDepthW_ + _sSiDetS_ + _cSiDDiat_*_sDDiatS_ + _aSiTotM_;
_aDError_ = _aDTotT_ - _sDExtTotT_;
_aNError_ = _aNTotT_ - _sNExtTotT_;
_aPError_ = _aPTotT_ - _sPExtTotT_;
_aSiError_ = _aSiTotT_ - _sSiExtTotT_;
